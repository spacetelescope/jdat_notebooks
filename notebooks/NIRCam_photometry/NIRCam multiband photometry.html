<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
  <title>
   Extended Aperture Photometry — STScI JDAT Notebooks
  </title>
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
  <link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
  <link href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
  <link as="font" crossorigin="" href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
  <link as="font" crossorigin="" href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
  <link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" rel="stylesheet" type="text/css"/>
  <link href="../../_static/togglebutton.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/copybutton.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/mystnb.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/main.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" rel="stylesheet" type="text/css"/>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
  <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js">
  </script>
  <script src="../../_static/jquery.js">
  </script>
  <script src="../../_static/underscore.js">
  </script>
  <script src="../../_static/doctools.js">
  </script>
  <script src="../../_static/clipboard.min.js">
  </script>
  <script src="../../_static/copybutton.js">
  </script>
  <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456">
  </script>
  <script>
   let toggleHintShow = 'Click to show';
  </script>
  <script>
   let toggleHintHide = 'Click to hide';
  </script>
  <script>
   let toggleOpenOnPrint = 'true';
  </script>
  <script src="../../_static/togglebutton.js">
  </script>
  <script>
   var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';
  </script>
  <script src="../../_static/design-tabs.js">
  </script>
  <script>
   const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
  </script>
  <script async="async" src="../../_static/sphinx-thebe.js">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js">
  </script>
  <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js">
  </script>
  <script>
   window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}
  </script>
  <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <link href="../../genindex.html" rel="index" title="Index"/>
  <link href="../../search.html" rel="search" title="Search"/>
  <link href="../psf_photometry/NIRCam_PSF_Photometry_Example.html" rel="next" title="PSF Photometry"/>
  <link href="../aperture_photometry/NIRCam_Aperture_Photometry_Example.html" rel="prev" title="Point Source Aperture Photometry"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <meta content="None" name="docsearch:language"/>
  <!-- Google Analytics -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-D46G4HKJY3">
  </script>
  <script>
   window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-D46G4HKJY3');
  </script>
 </head>
 <body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
  <!-- Checkboxes to toggle the left sidebar -->
  <input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
  <label class="overlay overlay-navbar" for="__navigation">
   <div class="visually-hidden">
    Toggle navigation sidebar
   </div>
  </label>
  <!-- Checkboxes to toggle the in-page toc -->
  <input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
  <label class="overlay overlay-pagetoc" for="__page-toc">
   <div class="visually-hidden">
    Toggle in-page Table of Contents
   </div>
  </label>
  <!-- Headers at the top -->
  <div class="announcement header-item noprint">
  </div>
  <div class="header header-item noprint">
  </div>
  <div class="container-fluid" id="banner">
  </div>
  <div class="container-xl">
   <div class="row">
    <!-- Sidebar -->
    <div class="bd-sidebar noprint" id="site-navigation">
     <div class="bd-sidebar__content">
      <div class="bd-sidebar__top">
       <div class="navbar-brand-box">
        <a class="navbar-brand text-wrap" href="../../index.html">
         <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
         <img alt="logo" class="logo" src="../../_static/stsci_logo2.png"/>
         <h1 class="site-logo" id="site-title">
          STScI JDAT Notebooks
         </h1>
        </a>
       </div>
       <form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
        <i class="icon fas fa-search">
        </i>
        <input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
       </form>
       <nav aria-label="Main" class="bd-links" id="bd-docs-nav">
        <div class="bd-toc-item active">
         <ul class="nav bd-sidenav bd-sidenav__home-link">
          <li class="toctree-l1">
           <a class="reference internal" href="../../intro.html">
           </a>
          </li>
         </ul>
         <p aria-level="2" class="caption" role="heading">
          <span class="caption-text">
           Cross-Instrument
          </span>
         </p>
         <ul class="nav bd-sidenav">
          <li class="toctree-l1">
           <a class="reference internal" href="../asdf_example/asdf_example.html">
            ASDF Example
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../background_estimation_imaging/Imaging%20Sky%20Background%20Estimation.html">
            Complex 2D Background
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../composite_model_fitting/specfit_demo_3.html">
            Composite Model Spectral Fitting
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../NIRSpec_MAST_Query/NIRSpec_MAST_Query.html">
            MAST Query
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../specviz_notebookGUI_interaction/specviz_notebook_gui_interaction_redshift.html">
            Specviz Simple Demo
           </a>
          </li>
         </ul>
         <p aria-level="2" class="caption" role="heading">
          <span class="caption-text">
           MIRI
          </span>
         </p>
         <ul class="nav bd-sidenav">
          <li class="toctree-l1">
           <a class="reference internal" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_runpipeline.html">
            MRS Mstar - Run Pipeline
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html">
            MRS Mstar - Data Analysis
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../MIRI_IFU_YSOs_in_the_LMC/isha_nayak_ysos_in_the_lmc.html">
            IFU of YSOs in LMC
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../MIRI_LRS_spectral_extraction/miri_lrs_spectral_extraction.html">
            LRS Optimal Spectral Extraction
           </a>
          </li>
         </ul>
         <p aria-level="2" class="caption" role="heading">
          <span class="caption-text">
           NIRCam
          </span>
         </p>
         <ul class="current nav bd-sidenav">
          <li class="toctree-l1">
           <a class="reference internal" href="../aperture_photometry/NIRCam_Aperture_Photometry_Example.html">
            Point Source Aperture Photometry
           </a>
          </li>
          <li class="toctree-l1 current active">
           <a class="current reference internal" href="#">
            Extended Aperture Photometry
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../psf_photometry/NIRCam_PSF_Photometry_Example.html">
            PSF Photometry
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html">
            Cross-Filter PSF Matching
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../preimaging/preimaging_01_mirage.html">
            NIRCam Preimaging: MIRAGE Simulations
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../preimaging/preimaging_02_calwebb.html">
            Preimaging - Pipeline Stages 1, 2
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../preimaging/preimaging_03_association.html">
            NIRCam Preimaging: Pipeline Stage 3
           </a>
          </li>
         </ul>
         <p aria-level="2" class="caption" role="heading">
          <span class="caption-text">
           NIRISS
          </span>
         </p>
         <ul class="nav bd-sidenav">
          <li class="toctree-l1">
           <a class="reference internal" href="../NIRISS_WFSS_postpipeline/00.%20Optimal%20extraction.html">
            WFSS Spectra - Optimal Extraction
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../NIRISS_WFSS_postpipeline/01.%20Combine%20and%20normalize%201D%20spectra.html">
            WFSS Spectra - Combine and Normalize 1D Spectra
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../NIRISS_WFSS_postpipeline/02.%20Cross%20correlation%20template.html">
            Part 2: Cross Correlation to Determine Redshift of NIRISS WFSS Spectra
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../NIRISS_WFSS_postpipeline/03.%20Spatially%20resolved%20emission%20line%20map.html">
            WFSS Spectra - Emission Line Map
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../niriss_ami_binary/1_niriss_ami_binary.html">
            AMI - MIRAGE
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../niriss_ami_binary/2_niriss_ami_binary.html">
            AMI - Pipeline
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../soss-transit-spectroscopy/HAT-P-1b-PART3-data-analysis.html">
            SOSS Transit Spectroscopy
           </a>
          </li>
         </ul>
         <p aria-level="2" class="caption" role="heading">
          <span class="caption-text">
           NIRSpec
          </span>
         </p>
         <ul class="nav bd-sidenav">
          <li class="toctree-l1">
           <a class="reference internal" href="../IFU_cube_continuum_fit/NGC4151_FeII_ContinuumFit.html">
            IFU Cube Fitting
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../cube_fitting/cube_fitting.html">
            IFU Cube Modeling
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../ifu_optimal/ifu_optimal.html">
            IFU Optimal Spectral Extraction
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../optimal_extraction_dynamic/Spectral%20Extraction.html">
            NIRSpec MOS Optimal Spectral Extraction
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../mos-spectroscopy/MOSspec_sv06_revised.html">
            MOS Spectroscopy of Extragalactic Field
           </a>
          </li>
          <li class="toctree-l1">
           <a class="reference internal" href="../transit_spectroscopy_notebook/Exoplanet_Transmission_Spectra_JWST.html">
            BOTS Time Series Observations
           </a>
          </li>
         </ul>
        </div>
       </nav>
      </div>
      <div class="bd-sidebar__bottom">
       <!-- To handle the deprecated key -->
       <div class="navbar_extra_footer">
        Powered by
        <a href="https://jupyterbook.org">
         Jupyter Book
        </a>
       </div>
      </div>
     </div>
     <div id="rtd-footer-container">
     </div>
    </div>
    <!-- A tiny helper pixel to detect if we've scrolled -->
    <div class="sbt-scroll-pixel-helper">
    </div>
    <!-- Main content -->
    <div class="col py-0 content-container">
     <div class="header-article row sticky-top noprint">
      <div class="col py-1 d-flex header-article-main">
       <div class="header-article__left">
        <label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
         <span class="headerbtn__icon-container">
          <i class="fas fa-bars">
          </i>
         </span>
        </label>
       </div>
       <div class="header-article__right">
        <div class="menu-dropdown menu-dropdown-launch-buttons">
         <button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
          <i class="fas fa-rocket">
          </i>
         </button>
         <div class="menu-dropdown__content">
          <ul>
           <li>
            <button class="headerbtn headerbtn-launch-thebe" data-placement="left" data-toggle="tooltip" onclick="initThebeSBT()" title="Launch Thebe">
             <span class="headerbtn__icon-container">
              <i class="fas fa-play">
              </i>
             </span>
             <span class="headerbtn__text-container">
              Live Code
             </span>
            </button>
           </li>
          </ul>
         </div>
        </div>
        <button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
         <span class="headerbtn__icon-container">
          <i class="fas fa-expand">
          </i>
         </span>
        </button>
        <div class="menu-dropdown menu-dropdown-repository-buttons">
         <button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
          <i class="fab fa-github">
          </i>
         </button>
         <div class="menu-dropdown__content">
          <ul>
           <li>
            <a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/spacetelescope/jdat_notebooks/" title="Source repository">
             <span class="headerbtn__icon-container">
              <i class="fab fa-github">
              </i>
             </span>
             <span class="headerbtn__text-container">
              repository
             </span>
            </a>
           </li>
           <li>
            <a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/spacetelescope/jdat_notebooks//issues/new?title=Issue%20on%20page%20%2Fnotebooks/NIRCam_photometry/NIRCam multiband photometry.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
             <span class="headerbtn__icon-container">
              <i class="fas fa-lightbulb">
              </i>
             </span>
             <span class="headerbtn__text-container">
              open issue
             </span>
            </a>
           </li>
          </ul>
         </div>
        </div>
        <div class="menu-dropdown menu-dropdown-download-buttons">
         <button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
          <i class="fas fa-download">
          </i>
         </button>
         <div class="menu-dropdown__content">
          <ul>
           <li>
            <a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../_sources/notebooks/NIRCam_photometry/NIRCam multiband photometry.ipynb" title="Download source file">
             <span class="headerbtn__icon-container">
              <i class="fas fa-file">
              </i>
             </span>
             <span class="headerbtn__text-container">
              .ipynb
             </span>
            </a>
           </li>
           <li>
            <button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
             <span class="headerbtn__icon-container">
              <i class="fas fa-file-pdf">
              </i>
             </span>
             <span class="headerbtn__text-container">
              .pdf
             </span>
            </button>
           </li>
          </ul>
         </div>
        </div>
        <label class="headerbtn headerbtn-page-toc" for="__page-toc">
         <span class="headerbtn__icon-container">
          <i class="fas fa-list">
          </i>
         </span>
        </label>
       </div>
      </div>
      <!-- Table of contents -->
      <div class="col-md-3 bd-toc show noprint">
       <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list">
        </i>
        Contents
       </div>
       <nav aria-label="Page" id="bd-toc-nav">
        <ul class="visible nav section-nav flex-column">
         <li class="toc-h1 nav-item toc-entry">
          <a class="reference internal nav-link" href="#">
           Extended Aperture Photometry
          </a>
          <ul class="visible nav section-nav flex-column">
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#introduction">
             Introduction
            </a>
           </li>
          </ul>
         </li>
         <li class="toc-h1 nav-item toc-entry">
          <a class="reference internal nav-link" href="#to-do">
           To Do
          </a>
          <ul class="visible nav section-nav flex-column">
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#import-packages">
             Import packages
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#matplotlib-setup-for-plotting">
             Matplotlib setup for plotting
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#create-list-of-images-to-be-loaded-and-analyzed">
             Create list of images to be loaded and analyzed
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#load-detection-image-f200w">
             Load detection image: F200W
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#report-image-size-and-field-of-view">
             Report image size and field of view
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#create-color-image-optional">
             Create color image (optional)
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#detect-sources-and-deblend-using-photutils">
             Detect Sources and Deblend using
             <code class="docutils literal notranslate">
              <span class="pre">
               photutils
              </span>
             </code>
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#measure-photometry-and-more-in-detection-image">
             Measure photometry (and more) in detection image
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#show-detections-alongside-images-optional">
             Show detections alongside images (optional)
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#view-all-measured-quantities-in-detection-image-optional">
             View all measured quantities in detection image (optional)
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#only-keep-some-quantities">
             Only keep some quantities
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#convert-measured-fluxes-data-units-to-magnitudes">
             Convert measured fluxes (data units) to magnitudes
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#multiband-photometry-using-isophotal-apertures-defined-in-detection-image">
             Multiband photometry using isophotal apertures defined in detection image
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#view-complete-results-optional">
             View complete results (optional)
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#save-photometry-as-output-catalog">
             Save photometry as output catalog
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#reformat-output-catalog-for-readability-optional">
             Reformat output catalog for readability (optional)
            </a>
           </li>
          </ul>
         </li>
         <li class="toc-h1 nav-item toc-entry">
          <a class="reference internal nav-link" href="#start-new-session-and-analyze-results">
           Start new session and analyze results
          </a>
          <ul class="visible nav section-nav flex-column">
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#load-catalog-and-segmentation-map">
             Load catalog and segmentation map
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#plot-number-counts-vs-magnitude">
             Plot number counts vs. magnitude
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#plot-f200w-vs-f090w-magnitudes-and-look-for-dropouts">
             Plot F200W vs. F090W magnitudes and look for dropouts
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#look-at-one-object">
             Look at one object
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#show-the-object-in-all-the-images">
             Show the object in all the images
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#plot-sed-spectral-energy-distribution">
             Plot SED (Spectral Energy Distribution)
            </a>
           </li>
           <li class="toc-h2 nav-item toc-entry">
            <a class="reference internal nav-link" href="#magnitude-conversion-fails-for-flux-0">
             Magnitude conversion fails for flux &lt;= 0
            </a>
           </li>
          </ul>
         </li>
        </ul>
       </nav>
      </div>
     </div>
     <div class="article row">
      <div class="col pl-md-3 pl-lg-5 content-container">
       <!-- Table of contents that is only displayed when printing the page -->
       <div class="onlyprint" id="jb-print-docs-body">
        <h1>
         Extended Aperture Photometry
        </h1>
        <!-- Table of contents -->
        <div id="print-main-content">
         <div id="jb-print-toc">
          <div>
           <h2>
            Contents
           </h2>
          </div>
          <nav aria-label="Page">
           <ul class="visible nav section-nav flex-column">
            <li class="toc-h1 nav-item toc-entry">
             <a class="reference internal nav-link" href="#">
              Extended Aperture Photometry
             </a>
             <ul class="visible nav section-nav flex-column">
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#introduction">
                Introduction
               </a>
              </li>
             </ul>
            </li>
            <li class="toc-h1 nav-item toc-entry">
             <a class="reference internal nav-link" href="#to-do">
              To Do
             </a>
             <ul class="visible nav section-nav flex-column">
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#import-packages">
                Import packages
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#matplotlib-setup-for-plotting">
                Matplotlib setup for plotting
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#create-list-of-images-to-be-loaded-and-analyzed">
                Create list of images to be loaded and analyzed
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#load-detection-image-f200w">
                Load detection image: F200W
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#report-image-size-and-field-of-view">
                Report image size and field of view
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#create-color-image-optional">
                Create color image (optional)
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#detect-sources-and-deblend-using-photutils">
                Detect Sources and Deblend using
                <code class="docutils literal notranslate">
                 <span class="pre">
                  photutils
                 </span>
                </code>
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#measure-photometry-and-more-in-detection-image">
                Measure photometry (and more) in detection image
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#show-detections-alongside-images-optional">
                Show detections alongside images (optional)
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#view-all-measured-quantities-in-detection-image-optional">
                View all measured quantities in detection image (optional)
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#only-keep-some-quantities">
                Only keep some quantities
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#convert-measured-fluxes-data-units-to-magnitudes">
                Convert measured fluxes (data units) to magnitudes
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#multiband-photometry-using-isophotal-apertures-defined-in-detection-image">
                Multiband photometry using isophotal apertures defined in detection image
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#view-complete-results-optional">
                View complete results (optional)
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#save-photometry-as-output-catalog">
                Save photometry as output catalog
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#reformat-output-catalog-for-readability-optional">
                Reformat output catalog for readability (optional)
               </a>
              </li>
             </ul>
            </li>
            <li class="toc-h1 nav-item toc-entry">
             <a class="reference internal nav-link" href="#start-new-session-and-analyze-results">
              Start new session and analyze results
             </a>
             <ul class="visible nav section-nav flex-column">
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#load-catalog-and-segmentation-map">
                Load catalog and segmentation map
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#plot-number-counts-vs-magnitude">
                Plot number counts vs. magnitude
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#plot-f200w-vs-f090w-magnitudes-and-look-for-dropouts">
                Plot F200W vs. F090W magnitudes and look for dropouts
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#look-at-one-object">
                Look at one object
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#show-the-object-in-all-the-images">
                Show the object in all the images
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#plot-sed-spectral-energy-distribution">
                Plot SED (Spectral Energy Distribution)
               </a>
              </li>
              <li class="toc-h2 nav-item toc-entry">
               <a class="reference internal nav-link" href="#magnitude-conversion-fails-for-flux-0">
                Magnitude conversion fails for flux &lt;= 0
               </a>
              </li>
             </ul>
            </li>
           </ul>
          </nav>
         </div>
        </div>
       </div>
       <main id="main-content" role="main">
        <div>
         <section class="tex2jax_ignore mathjax_ignore" id="extended-aperture-photometry">
          <h1>
           Extended Aperture Photometry
           <a class="headerlink" href="#extended-aperture-photometry" title="Permalink to this headline">
            #
           </a>
          </h1>
          <p>
           <strong>
            Use case:
           </strong>
           Measure galaxy photometry in a field. Related to
           <a class="reference external" href="https://jwst-docs.stsci.edu/near-infrared-camera/nircam-example-science-programs/nircam-deep-field-imaging-with-miri-imaging-parallels">
            JDox Science Use Case #22
           </a>
           .
           <br/>
           <strong>
            Data:
           </strong>
           WST simulated NIRCam images from
           <a class="reference external" href="http://fenrir.as.arizona.edu/jwstmock/">
            JADES JWST GTO extragalactic blank field
           </a>
           .
           <br/>
           (Williams et al. 2018)
           <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018ApJS..236...33W">
            https://ui.adsabs.harvard.edu/abs/2018ApJS..236…33W
           </a>
           .
           <br/>
           <strong>
            Tools:
           </strong>
           photutils, matplotlib, scipy, scikit.
           <br/>
           <strong>
            Cross-intrument:
           </strong>
           potentially MIRI.
           <br/>
           <strong>
            Documentation:
           </strong>
           This notebook is part of a STScI’s larger
           <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-post-pipeline-data-analysis">
            post-pipeline Data Analysis Tools Ecosystem
           </a>
           .
           <br/>
          </p>
          <section id="introduction">
           <h2>
            Introduction
            <a class="headerlink" href="#introduction" title="Permalink to this headline">
             #
            </a>
           </h2>
           <p>
            This notebook uses
            <code class="docutils literal notranslate">
             <span class="pre">
              photutils
             </span>
            </code>
            to detect objects/galaxies in NIRCam deep imaging.  Detections are first made in a F200W image, then isophotal photometry is obtained in all 9 filters (F090W, F115W, F150W, F200W, F277W, F335M, F356W, F410M, F444W). The catalog is loaded back in and some simple analysis is performed on the full catalog and on an individual galaxy.
           </p>
           <p>
            The notebook analyzes only the central 1000 x 1000 pixels (30” x 30”) of the full JADES simulation. These cutouts have been staged at STScI with permission from the authors (Williams et al.).
           </p>
           <p>
            <strong>
             NOTE:
            </strong>
            The photometry is aperture matched, but no PSF corrections are made. For more accurate color measurements, PSF corrections should be implemented, given the large range of wavelengths (and thus PSF FWHM) spanning a factor of &gt;4.
           </p>
           <p>
            <strong>
             NOTE:
            </strong>
            The simulated JADES images have different units (e-/s) than JWST pipeline products (MJy/sr).
           </p>
           <p>
            <strong>
             NOTE:
            </strong>
            An exposure map is missing but required to calculate flux uncertainties.
           </p>
          </section>
         </section>
         <section class="tex2jax_ignore mathjax_ignore" id="to-do">
          <h1>
           To Do
           <a class="headerlink" href="#to-do" title="Permalink to this headline">
            #
           </a>
          </h1>
          <ul class="simple">
           <li>
            <p>
             PSF corrections
            </p>
           </li>
           <li>
            <p>
             Check accuracy of photometry against simulated JADES catalog
            </p>
           </li>
           <li>
            <p>
             Exposure map required for input to error calculation
            </p>
           </li>
           <li>
            <p>
             ABmag units cannot be written to ecsv file (astropy update coming soon)
            </p>
           </li>
           <li>
            <p>
             plot with text labels looks horrible (I wish cursor hover would show id number instead)
            </p>
           </li>
           <li>
            <p>
             Fix plot secondary axis: mag vs. flux
            </p>
           </li>
           <li>
            <p>
             requirements.txt file – but I don’t know what versions are “required”
            </p>
           </li>
           <li>
            <p>
             rest of Robel’s comments:
             <a class="reference external" href="https://github.com/spacetelescope/dat_pyinthesky/pull/82#pullrequestreview-355206337">
              https://github.com/spacetelescope/dat_pyinthesky/pull/82#pullrequestreview-355206337
             </a>
            </p>
           </li>
          </ul>
          <section id="import-packages">
           <h2>
            Import packages
            <a class="headerlink" href="#import-packages" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">astropy.convolution</span> <span class="kn">import</span> <span class="n">Gaussian2DKernel</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="kn">import</span> <span class="n">gaussian_fwhm_to_sigma</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">QTable</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">make_lupton_rgb</span><span class="p">,</span> <span class="n">SqrtStretch</span><span class="p">,</span> <span class="n">ImageNormalize</span><span class="p">,</span> <span class="n">simple_norm</span>
<span class="kn">import</span> <span class="nn">astropy.wcs</span> <span class="k">as</span> <span class="nn">wcs</span>

<span class="kn">import</span> <span class="nn">photutils</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'photutils'</span><span class="p">,</span> <span class="n">photutils</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">photutils</span> <span class="kn">import</span> <span class="n">Background2D</span><span class="p">,</span> <span class="n">MedianBackground</span><span class="p">,</span> <span class="n">detect_sources</span><span class="p">,</span> <span class="n">deblend_sources</span><span class="p">,</span> <span class="n">SourceCatalog</span><span class="c1">#, source_properties (new API)</span>
<span class="kn">from</span> <span class="nn">photutils.utils</span> <span class="kn">import</span> <span class="n">calc_total_error</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>photutils 1.4.0
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="matplotlib-setup-for-plotting">
           <h2>
            Matplotlib setup for plotting
            <a class="headerlink" href="#matplotlib-setup-for-plotting" title="Permalink to this headline">
             #
            </a>
           </h2>
           <p>
            There are two versions
           </p>
           <ul class="simple">
            <li>
             <p>
              <code class="docutils literal notranslate">
               <span class="pre">
                notebook
               </span>
              </code>
              – gives interactive plots, but makes the overall notebook a bit harder to scroll
             </p>
            </li>
            <li>
             <p>
              <code class="docutils literal notranslate">
               <span class="pre">
                inline
               </span>
              </code>
              – gives non-interactive plots for better overall scrolling
             </p>
            </li>
           </ul>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<span class="c1"># Use this version for non-interactive plots (easier scrolling of the notebook)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Use this version if you want interactive plots</span>
<span class="c1"># %matplotlib notebook</span>

<span class="c1"># These gymnastics are needed to make the sizes of the figures</span>
<span class="c1"># be the same in both the inline and notebook versions</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.print_figure_kwargs = {'bbox_inches': None}

<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'savefig.dpi'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'figure.dpi'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="create-list-of-images-to-be-loaded-and-analyzed">
           <h2>
            Create list of images to be loaded and analyzed
            <a class="headerlink" href="#create-list-of-images-to-be-loaded-and-analyzed" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">baseurl</span> <span class="o">=</span> <span class="s1">'https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/'</span>

<span class="n">filters</span> <span class="o">=</span> <span class="s1">'F090W F115W F150W F200W F277W F335M F356W F410M F444W'</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="c1"># Data images [e-/s]</span>
<span class="n">imagefiles</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'jades_jwst_nircam_goods_s_crop_</span><span class="si">{</span><span class="n">filt</span><span class="si">}</span><span class="s1">.fits'</span>
    <span class="n">imagefiles</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">baseurl</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="c1"># Weight images (Inverse Variance Maps; IVM)</span>
<span class="n">weightfiles</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'jades_jwst_nircam_goods_s_crop_</span><span class="si">{</span><span class="n">filt</span><span class="si">}</span><span class="s1">_wht.fits'</span>
    <span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">baseurl</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="load-detection-image-f200w">
           <h2>
            Load detection image: F200W
            <a class="headerlink" href="#load-detection-image-f200w" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">filt</span> <span class="o">=</span> <span class="s1">'F200W'</span>
<span class="n">infile</span> <span class="o">=</span> <span class="n">imagefiles</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">imwcs</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">,</span> <span class="n">hdu</span><span class="p">)</span>

<span class="n">weight</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="report-image-size-and-field-of-view">
           <h2>
            Report image size and field of view
            <a class="headerlink" href="#report-image-size-and-field-of-view" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">pixscale</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">proj_plane_pixel_scales</span><span class="p">(</span><span class="n">imwcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> 
<span class="n">pixscale</span> <span class="o">*=</span> <span class="n">imwcs</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">cunit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">'arcsec'</span><span class="p">)</span>
<span class="n">outline</span> <span class="o">=</span> <span class="s1">'</span><span class="si">%d</span><span class="s1"> x </span><span class="si">%d</span><span class="s1"> pixels'</span> <span class="o">%</span> <span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">outline</span> <span class="o">+=</span> <span class="s1">' = </span><span class="si">%g</span><span class="s1">" x </span><span class="si">%g</span><span class="s1">"'</span> <span class="o">%</span> <span class="p">(</span><span class="n">ny</span> <span class="o">*</span> <span class="n">pixscale</span><span class="p">,</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">pixscale</span><span class="p">)</span>
<span class="n">outline</span> <span class="o">+=</span> <span class="s1">' (</span><span class="si">%.2f</span><span class="s1">" / pixel)'</span> <span class="o">%</span> <span class="n">pixscale</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outline</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>1000 x 1000 pixels = 30" x 30" (0.03" / pixel)
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="create-color-image-optional">
           <h2>
            Create color image (optional)
            <a class="headerlink" href="#create-color-image-optional" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="c1"># 3 NIRCam short wavelength channel images</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imagefiles</span><span class="p">[</span><span class="s1">'F200W'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imagefiles</span><span class="p">[</span><span class="s1">'F150W'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imagefiles</span><span class="p">[</span><span class="s1">'F090W'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">rgb</span> <span class="o">=</span> <span class="n">make_lupton_rgb</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>  <span class="c1"># , minimum=-0.001</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">imwcs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Right Ascension'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Declination'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <img alt="../../_images/NIRCam multiband photometry_14_0.png" src="../../_images/NIRCam multiband photometry_14_0.png"/>
            </div>
           </div>
          </section>
          <section id="detect-sources-and-deblend-using-photutils">
           <h2>
            Detect Sources and Deblend using
            <code class="docutils literal notranslate">
             <span class="pre">
              photutils
             </span>
            </code>
            <a class="headerlink" href="#detect-sources-and-deblend-using-photutils" title="Permalink to this headline">
             #
            </a>
           </h2>
           <p>
            <a class="reference external" href="https://photutils.readthedocs.io/en/latest/segmentation.html">
             https://photutils.readthedocs.io/en/latest/segmentation.html
            </a>
           </p>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="c1"># For detection, requiring 5 connected pixels 2-sigma above background</span>

<span class="c1"># Measure background and set detection threshold</span>
<span class="n">bkg_estimator</span> <span class="o">=</span> <span class="n">MedianBackground</span><span class="p">()</span>
<span class="n">bkg</span> <span class="o">=</span> <span class="n">Background2D</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">filter_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">bkg_estimator</span><span class="p">)</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">bkg</span><span class="o">.</span><span class="n">background</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">bkg</span><span class="o">.</span><span class="n">background_rms</span><span class="p">)</span>

<span class="c1"># Before detection, smooth image with Gaussian FWHM = 3 pixels</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">gaussian_fwhm_to_sigma</span>  
<span class="n">kernel</span> <span class="o">=</span> <span class="n">Gaussian2DKernel</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">x_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">y_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kernel</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>

<span class="c1"># Detect and deblend</span>
<span class="n">segm_detect</span> <span class="o">=</span> <span class="n">detect_sources</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">npixels</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">)</span>

<span class="n">segm_deblend</span> <span class="o">=</span> <span class="n">deblend_sources</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">segm_detect</span><span class="p">,</span> <span class="n">npixels</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">nlevels</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

<span class="c1"># Save segmentation map of detected objects</span>
<span class="n">segm_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">segm_deblend</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="n">imwcs</span><span class="o">.</span><span class="n">to_header</span><span class="p">())</span>
<span class="n">segm_hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">'JADES_detections_segm.fits'</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="measure-photometry-and-more-in-detection-image">
           <h2>
            Measure photometry (and more) in detection image
            <a class="headerlink" href="#measure-photometry-and-more-in-detection-image" title="Permalink to this headline">
             #
            </a>
           </h2>
           <p>
            <a class="reference external" href="https://photutils.readthedocs.io/en/latest/segmentation.html#centroids-photometry-and-morphological-properties">
             https://photutils.readthedocs.io/en/latest/segmentation.html#centroids-photometry-and-morphological-properties
            </a>
           </p>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="c1">#error = bkg.background_rms</span>
<span class="c1"># Input weight should be exposure map. Fudging for now.</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">calc_total_error</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bkg</span><span class="o">.</span><span class="n">background_rms</span><span class="p">,</span> <span class="n">weight</span><span class="o">/</span><span class="mi">500</span><span class="p">)</span>
<span class="c1">#cat = source_properties(data-bkg.background, segm_deblend, wcs=imwcs, background=bkg.background, error=error)</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">SourceCatalog</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">bkg</span><span class="o">.</span><span class="n">background</span><span class="p">,</span> <span class="n">segm_deblend</span><span class="p">,</span> <span class="n">wcs</span><span class="o">=</span><span class="n">imwcs</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="o">.</span><span class="n">background</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="show-detections-alongside-images-optional">
           <h2>
            Show detections alongside images (optional)
            <a class="headerlink" href="#show-detections-alongside-images-optional" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># For RA,Dec axes instead of pixels, add: , subplot_kw={'projection': imwcs})</span>

<span class="c1"># Color image</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Color Image'</span><span class="p">)</span>

<span class="c1"># Data</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">'sqrt'</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mf">99.</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Greys_r'</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Detection Image F200W'</span><span class="p">)</span>

<span class="c1"># Segmentation map</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">segm_deblend</span><span class="o">.</span><span class="n">make_cmap</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">segm_deblend</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Detections (Segmentation Image)'</span><span class="p">)</span>

<span class="c1"># Weight</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Greys_r'</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Weight Image F200W'</span><span class="p">)</span>

<span class="c1"># RMS</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bkg</span><span class="o">.</span><span class="n">background_rms</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Background RMS'</span><span class="p">)</span>

<span class="c1"># Total error including Poisson noise</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="s1">'sqrt'</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mf">99.</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'RMS + Poisson noise'</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <img alt="../../_images/NIRCam multiband photometry_20_0.png" src="../../_images/NIRCam multiband photometry_20_0.png"/>
            </div>
           </div>
          </section>
          <section id="view-all-measured-quantities-in-detection-image-optional">
           <h2>
            View all measured quantities in detection image (optional)
            <a class="headerlink" href="#view-all-measured-quantities-in-detection-image-optional" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">cat</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_html">
              <div>
               <i>
                QTable length=327
               </i>
               <table class="table-striped table-bordered table-condensed" id="table140216222042336">
                <thead>
                 <tr>
                  <th>
                   label
                  </th>
                  <th>
                   xcentroid
                  </th>
                  <th>
                   ycentroid
                  </th>
                  <th>
                   sky_centroid
                  </th>
                  <th>
                   bbox_xmin
                  </th>
                  <th>
                   bbox_xmax
                  </th>
                  <th>
                   bbox_ymin
                  </th>
                  <th>
                   bbox_ymax
                  </th>
                  <th>
                   area
                  </th>
                  <th>
                   semimajor_sigma
                  </th>
                  <th>
                   semiminor_sigma
                  </th>
                  <th>
                   orientation
                  </th>
                  <th>
                   eccentricity
                  </th>
                  <th>
                   min_value
                  </th>
                  <th>
                   max_value
                  </th>
                  <th>
                   local_background
                  </th>
                  <th>
                   segment_flux
                  </th>
                  <th>
                   segment_fluxerr
                  </th>
                  <th>
                   kron_flux
                  </th>
                  <th>
                   kron_fluxerr
                  </th>
                 </tr>
                </thead>
                <thead>
                 <tr>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   deg,deg
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   pix2
                  </th>
                  <th>
                   pix
                  </th>
                  <th>
                   pix
                  </th>
                  <th>
                   deg
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                 </tr>
                </thead>
                <thead>
                 <tr>
                  <th>
                   int64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   SkyCoord
                  </th>
                  <th>
                   int64
                  </th>
                  <th>
                   int64
                  </th>
                  <th>
                   int64
                  </th>
                  <th>
                   int64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                 </tr>
                </thead>
                <tr>
                 <td>
                  1
                 </td>
                 <td>
                  466.24461350033647
                 </td>
                 <td>
                  8.7975642602371
                 </td>
                 <td>
                  53.17381009103326,-27.805320830365776
                 </td>
                 <td>
                  460
                 </td>
                 <td>
                  472
                 </td>
                 <td>
                  3
                 </td>
                 <td>
                  14
                 </td>
                 <td>
                  101.0
                 </td>
                 <td>
                  3.121883592723396
                 </td>
                 <td>
                  1.687718238373556
                 </td>
                 <td>
                  -44.478947493786606
                 </td>
                 <td>
                  0.8412740063312978
                 </td>
                 <td>
                  0.0006697164628791134
                 </td>
                 <td>
                  0.03003565456943476
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.8863594626861904
                 </td>
                 <td>
                  0.04333105379347733
                 </td>
                 <td>
                  1.1523646398846878
                 </td>
                 <td>
                  0.055428643253112045
                 </td>
                </tr>
                <tr>
                 <td>
                  2
                 </td>
                 <td>
                  104.80681791619065
                 </td>
                 <td>
                  18.0821294110356
                 </td>
                 <td>
                  53.17721522973072,-27.805243193448323
                 </td>
                 <td>
                  95
                 </td>
                 <td>
                  116
                 </td>
                 <td>
                  10
                 </td>
                 <td>
                  27
                 </td>
                 <td>
                  271.0
                 </td>
                 <td>
                  4.43307602055267
                 </td>
                 <td>
                  2.8904310038200527
                 </td>
                 <td>
                  -26.549722105819686
                 </td>
                 <td>
                  0.7582062720085905
                 </td>
                 <td>
                  0.001169592682614256
                 </td>
                 <td>
                  0.05683289995260978
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  3.3850931796608226
                 </td>
                 <td>
                  0.10096273567434758
                 </td>
                 <td>
                  4.064307886560462
                 </td>
                 <td>
                  0.11784714328036967
                 </td>
                </tr>
                <tr>
                 <td>
                  3
                 </td>
                 <td>
                  15.04416396551755
                 </td>
                 <td>
                  13.21870964358083
                 </td>
                 <td>
                  53.178060898531776,-27.805283643045666
                 </td>
                 <td>
                  14
                 </td>
                 <td>
                  16
                 </td>
                 <td>
                  12
                 </td>
                 <td>
                  14
                 </td>
                 <td>
                  8.0
                 </td>
                 <td>
                  0.8501945455843772
                 </td>
                 <td>
                  0.6682678017840504
                 </td>
                 <td>
                  -38.1612276642421
                 </td>
                 <td>
                  0.6182042301587309
                 </td>
                 <td>
                  0.0035728101756059504
                 </td>
                 <td>
                  0.006067336431199741
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.04072228096572398
                 </td>
                 <td>
                  0.011222825585360585
                 </td>
                 <td>
                  0.10086850698470742
                 </td>
                 <td>
                  0.023152305782963536
                 </td>
                </tr>
                <tr>
                 <td>
                  4
                 </td>
                 <td>
                  710.3242889701858
                 </td>
                 <td>
                  14.259777138086877
                 </td>
                 <td>
                  53.17151058505514,-27.805275444028442
                 </td>
                 <td>
                  708
                 </td>
                 <td>
                  712
                 </td>
                 <td>
                  12
                 </td>
                 <td>
                  17
                 </td>
                 <td>
                  25.0
                 </td>
                 <td>
                  1.2749753643104456
                 </td>
                 <td>
                  1.117371994707132
                 </td>
                 <td>
                  -59.26178196559024
                 </td>
                 <td>
                  0.4816073152747641
                 </td>
                 <td>
                  0.0013530635966815864
                 </td>
                 <td>
                  0.015100956012602468
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.15496901383687856
                 </td>
                 <td>
                  0.018575211927226797
                 </td>
                 <td>
                  0.19011686546526946
                 </td>
                 <td>
                  0.023625589169720226
                 </td>
                </tr>
                <tr>
                 <td>
                  5
                 </td>
                 <td>
                  434.52931528855504
                 </td>
                 <td>
                  22.221938204336567
                 </td>
                 <td>
                  53.17410887486057,-27.80520894064138
                 </td>
                 <td>
                  424
                 </td>
                 <td>
                  447
                 </td>
                 <td>
                  14
                 </td>
                 <td>
                  30
                 </td>
                 <td>
                  268.0
                 </td>
                 <td>
                  3.954114371118456
                 </td>
                 <td>
                  2.6317387394125484
                 </td>
                 <td>
                  -8.167334484702078
                 </td>
                 <td>
                  0.7463356928864708
                 </td>
                 <td>
                  -0.0003420958396561837
                 </td>
                 <td>
                  0.10656058422736421
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  3.6163046777967858
                 </td>
                 <td>
                  0.08775119207431732
                 </td>
                 <td>
                  4.277364104456117
                 </td>
                 <td>
                  0.10081655301137071
                 </td>
                </tr>
                <tr>
                 <td>
                  6
                 </td>
                 <td>
                  289.38802515014896
                 </td>
                 <td>
                  17.281765562153954
                 </td>
                 <td>
                  53.17547627056455,-27.805250009193262
                 </td>
                 <td>
                  287
                 </td>
                 <td>
                  291
                 </td>
                 <td>
                  15
                 </td>
                 <td>
                  20
                 </td>
                 <td>
                  17.0
                 </td>
                 <td>
                  1.2913044931147235
                 </td>
                 <td>
                  1.1978568863866517
                 </td>
                 <td>
                  68.12270923149859
                 </td>
                 <td>
                  0.37349256122504115
                 </td>
                 <td>
                  0.0019512862197305747
                 </td>
                 <td>
                  0.008797215945005498
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.08513804286457863
                 </td>
                 <td>
                  0.0166428570162664
                 </td>
                 <td>
                  0.34384198668200716
                 </td>
                 <td>
                  0.045989916939691816
                 </td>
                </tr>
                <tr>
                 <td>
                  7
                 </td>
                 <td>
                  640.4863091995317
                 </td>
                 <td>
                  17.773429154661983
                 </td>
                 <td>
                  53.17216853452775,-27.805246129692247
                 </td>
                 <td>
                  638
                 </td>
                 <td>
                  642
                 </td>
                 <td>
                  15
                 </td>
                 <td>
                  20
                 </td>
                 <td>
                  21.0
                 </td>
                 <td>
                  1.5124916692884618
                 </td>
                 <td>
                  0.8803106550282112
                 </td>
                 <td>
                  -64.72678377811528
                 </td>
                 <td>
                  0.8131696183154983
                 </td>
                 <td>
                  0.0003576250881105088
                 </td>
                 <td>
                  0.009946935910809692
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.09708323832036175
                 </td>
                 <td>
                  0.014462494201596657
                 </td>
                 <td>
                  0.17695836262605436
                 </td>
                 <td>
                  0.026075310664432975
                 </td>
                </tr>
                <tr>
                 <td>
                  8
                 </td>
                 <td>
                  762.7604138509574
                 </td>
                 <td>
                  28.298129971963505
                 </td>
                 <td>
                  53.17101657158984,-27.805158481182374
                 </td>
                 <td>
                  754
                 </td>
                 <td>
                  771
                 </td>
                 <td>
                  21
                 </td>
                 <td>
                  36
                 </td>
                 <td>
                  201.0
                 </td>
                 <td>
                  3.160486625451918
                 </td>
                 <td>
                  2.3639871661119467
                 </td>
                 <td>
                  37.8486600348364
                 </td>
                 <td>
                  0.663718991542073
                 </td>
                 <td>
                  -0.0001941792050655057
                 </td>
                 <td>
                  0.10556121967783572
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  3.8253517307369536
                 </td>
                 <td>
                  0.08853590501277893
                 </td>
                 <td>
                  3.981147093372532
                 </td>
                 <td>
                  0.09151504375364357
                 </td>
                </tr>
                <tr>
                 <td>
                  9
                 </td>
                 <td>
                  801.0706722163886
                 </td>
                 <td>
                  32.58026118517374
                 </td>
                 <td>
                  53.17065564474934,-27.805122812753073
                 </td>
                 <td>
                  799
                 </td>
                 <td>
                  804
                 </td>
                 <td>
                  31
                 </td>
                 <td>
                  34
                 </td>
                 <td>
                  12.0
                 </td>
                 <td>
                  1.3349434908844906
                 </td>
                 <td>
                  0.6567170220834244
                 </td>
                 <td>
                  -28.75519616047975
                 </td>
                 <td>
                  0.8706270208190223
                 </td>
                 <td>
                  0.0018856854900614819
                 </td>
                 <td>
                  0.009336017794193286
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.05935203501404956
                 </td>
                 <td>
                  0.012189355644992149
                 </td>
                 <td>
                  0.17003504172320322
                 </td>
                 <td>
                  0.02777838643014956
                 </td>
                </tr>
                <tr>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                </tr>
                <tr>
                 <td>
                  318
                 </td>
                 <td>
                  638.7423056471345
                 </td>
                 <td>
                  555.4511129157931
                 </td>
                 <td>
                  53.1721846558466,-27.80076548202184
                 </td>
                 <td>
                  630
                 </td>
                 <td>
                  647
                 </td>
                 <td>
                  544
                 </td>
                 <td>
                  568
                 </td>
                 <td>
                  256.0
                 </td>
                 <td>
                  4.1970530491670495
                 </td>
                 <td>
                  1.802182158743307
                 </td>
                 <td>
                  64.56727691953016
                 </td>
                 <td>
                  0.903118084100567
                 </td>
                 <td>
                  0.0014816106246247486
                 </td>
                 <td>
                  0.2658198490126946
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  8.690357561191234
                 </td>
                 <td>
                  0.1588037351236894
                 </td>
                 <td>
                  8.781566974916299
                 </td>
                 <td>
                  0.16012188685841847
                 </td>
                </tr>
                <tr>
                 <td>
                  319
                 </td>
                 <td>
                  13.420348917244358
                 </td>
                 <td>
                  884.6989392529491
                 </td>
                 <td>
                  53.17807530216808,-27.798021307292935
                 </td>
                 <td>
                  6
                 </td>
                 <td>
                  21
                 </td>
                 <td>
                  877
                 </td>
                 <td>
                  892
                 </td>
                 <td>
                  184.0
                 </td>
                 <td>
                  3.2861175102309126
                 </td>
                 <td>
                  3.144571547794767
                 </td>
                 <td>
                  -12.816561509735381
                 </td>
                 <td>
                  0.290331667641004
                 </td>
                 <td>
                  0.0017370791511803075
                 </td>
                 <td>
                  0.03495382468946091
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  2.116006369446348
                 </td>
                 <td>
                  0.10780075329442451
                 </td>
                 <td>
                  3.410121934628213
                 </td>
                 <td>
                  0.15459247580504082
                 </td>
                </tr>
                <tr>
                 <td>
                  320
                 </td>
                 <td>
                  7.027176577444122
                 </td>
                 <td>
                  891.9727894960166
                 </td>
                 <td>
                  53.17813552144662,-27.797960686059632
                 </td>
                 <td>
                  5
                 </td>
                 <td>
                  11
                 </td>
                 <td>
                  889
                 </td>
                 <td>
                  895
                 </td>
                 <td>
                  29.0
                 </td>
                 <td>
                  1.603195468602836
                 </td>
                 <td>
                  1.3128724093575075
                 </td>
                 <td>
                  -82.75208405786572
                 </td>
                 <td>
                  0.5739223050191917
                 </td>
                 <td>
                  0.0019018454919824644
                 </td>
                 <td>
                  0.01347560203904176
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.21412965179118829
                 </td>
                 <td>
                  0.035024475587970415
                 </td>
                 <td>
                  0.6893013683010649
                 </td>
                 <td>
                  0.07610234326451544
                 </td>
                </tr>
                <tr>
                 <td>
                  321
                 </td>
                 <td>
                  143.93471643650219
                 </td>
                 <td>
                  953.7173230226308
                 </td>
                 <td>
                  53.17684572931822,-27.79744626725717
                 </td>
                 <td>
                  139
                 </td>
                 <td>
                  149
                 </td>
                 <td>
                  950
                 </td>
                 <td>
                  957
                 </td>
                 <td>
                  58.0
                 </td>
                 <td>
                  2.6519955833889846
                 </td>
                 <td>
                  1.3830963239962937
                 </td>
                 <td>
                  24.76422639478917
                 </td>
                 <td>
                  0.8532326993749456
                 </td>
                 <td>
                  0.0021617009219625062
                 </td>
                 <td>
                  0.021165230633174926
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.5651410634421303
                 </td>
                 <td>
                  0.05723718654011642
                 </td>
                 <td>
                  1.2524114346118043
                 </td>
                 <td>
                  0.10432157051791156
                 </td>
                </tr>
                <tr>
                 <td>
                  322
                 </td>
                 <td>
                  142.746173256619
                 </td>
                 <td>
                  959.5389917866399
                 </td>
                 <td>
                  53.176856920479636,-27.797397752374
                 </td>
                 <td>
                  139
                 </td>
                 <td>
                  147
                 </td>
                 <td>
                  957
                 </td>
                 <td>
                  963
                 </td>
                 <td>
                  48.0
                 </td>
                 <td>
                  2.1427436610213637
                 </td>
                 <td>
                  1.2555061677914512
                 </td>
                 <td>
                  -35.47427950196171
                 </td>
                 <td>
                  0.8103588434156908
                 </td>
                 <td>
                  0.00047583665796055224
                 </td>
                 <td>
                  0.030453184966657037
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.5637982114834339
                 </td>
                 <td>
                  0.0568718012708143
                 </td>
                 <td>
                  0.8893801784930939
                 </td>
                 <td>
                  0.08214060528713434
                 </td>
                </tr>
                <tr>
                 <td>
                  323
                 </td>
                 <td>
                  790.415367777511
                 </td>
                 <td>
                  955.3106960545537
                 </td>
                 <td>
                  53.17075559998907,-27.797433388936582
                 </td>
                 <td>
                  784
                 </td>
                 <td>
                  796
                 </td>
                 <td>
                  951
                 </td>
                 <td>
                  959
                 </td>
                 <td>
                  93.0
                 </td>
                 <td>
                  2.621691845359079
                 </td>
                 <td>
                  1.8772136125476881
                 </td>
                 <td>
                  5.157966396104574
                 </td>
                 <td>
                  0.6980681000951601
                 </td>
                 <td>
                  0.0005767950066928708
                 </td>
                 <td>
                  0.04023169644016939
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  1.115611206251331
                 </td>
                 <td>
                  0.07893942785469332
                 </td>
                 <td>
                  1.65211264929793
                 </td>
                 <td>
                  0.10804543306519863
                 </td>
                </tr>
                <tr>
                 <td>
                  324
                 </td>
                 <td>
                  797.3397409211948
                 </td>
                 <td>
                  965.5478941851635
                 </td>
                 <td>
                  53.17069036467991,-27.797348081794517
                 </td>
                 <td>
                  792
                 </td>
                 <td>
                  802
                 </td>
                 <td>
                  958
                 </td>
                 <td>
                  974
                 </td>
                 <td>
                  121.0
                 </td>
                 <td>
                  3.0304070507432326
                 </td>
                 <td>
                  1.7633197784086392
                 </td>
                 <td>
                  79.51657917516623
                 </td>
                 <td>
                  0.8132778374227926
                 </td>
                 <td>
                  0.002333420221800177
                 </td>
                 <td>
                  0.08761686954182783
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  2.116916544882111
                 </td>
                 <td>
                  0.10637880974470741
                 </td>
                 <td>
                  2.8478971911033626
                 </td>
                 <td>
                  0.1315925489047444
                 </td>
                </tr>
                <tr>
                 <td>
                  325
                 </td>
                 <td>
                  790.7983558965504
                 </td>
                 <td>
                  979.5822296300561
                 </td>
                 <td>
                  53.17075198078638,-27.79723112632807
                 </td>
                 <td>
                  781
                 </td>
                 <td>
                  799
                 </td>
                 <td>
                  972
                 </td>
                 <td>
                  989
                 </td>
                 <td>
                  133.0
                 </td>
                 <td>
                  4.506451359665357
                 </td>
                 <td>
                  1.4930454629944043
                 </td>
                 <td>
                  -44.19824469199431
                 </td>
                 <td>
                  0.9435209394229406
                 </td>
                 <td>
                  -0.001248849458808359
                 </td>
                 <td>
                  0.06943444193177313
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  2.002750597650743
                 </td>
                 <td>
                  0.10372107669936124
                 </td>
                 <td>
                  2.813577038594517
                 </td>
                 <td>
                  0.13630578304670984
                 </td>
                </tr>
                <tr>
                 <td>
                  326
                 </td>
                 <td>
                  307.76973240382
                 </td>
                 <td>
                  989.9933237644321
                 </td>
                 <td>
                  53.17530230279065,-27.797144093853966
                 </td>
                 <td>
                  305
                 </td>
                 <td>
                  311
                 </td>
                 <td>
                  987
                 </td>
                 <td>
                  993
                 </td>
                 <td>
                  36.0
                 </td>
                 <td>
                  1.7091274365898566
                 </td>
                 <td>
                  1.1796163441788732
                 </td>
                 <td>
                  -57.75342780537102
                 </td>
                 <td>
                  0.7236317221355874
                 </td>
                 <td>
                  0.0017972712412996086
                 </td>
                 <td>
                  0.030535860130823354
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.38480474350746313
                 </td>
                 <td>
                  0.04596586978565647
                 </td>
                 <td>
                  0.7331589389247967
                 </td>
                 <td>
                  0.07386435404843976
                 </td>
                </tr>
                <tr>
                 <td>
                  327
                 </td>
                 <td>
                  306.8506442261885
                 </td>
                 <td>
                  997.243644725512
                 </td>
                 <td>
                  53.1753109550711,-27.797083673855024
                 </td>
                 <td>
                  302
                 </td>
                 <td>
                  312
                 </td>
                 <td>
                  994
                 </td>
                 <td>
                  999
                 </td>
                 <td>
                  51.0
                 </td>
                 <td>
                  2.5021353669231527
                 </td>
                 <td>
                  1.4883885517566502
                 </td>
                 <td>
                  15.388098948641728
                 </td>
                 <td>
                  0.8038386961956926
                 </td>
                 <td>
                  0.002853197675265836
                 </td>
                 <td>
                  0.02047051119926145
                 </td>
                 <td>
                  0.0
                 </td>
                 <td>
                  0.5505454403242959
                 </td>
                 <td>
                  0.054603633353214456
                 </td>
                 <td>
                  0.7815995757165104
                 </td>
                 <td>
                  0.07181097204346876
                 </td>
                </tr>
               </table>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="only-keep-some-quantities">
           <h2>
            Only keep some quantities
            <a class="headerlink" href="#only-keep-some-quantities" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="s1">'label xcentroid ycentroid sky_centroid area semimajor_sigma semiminor_sigma ellipticity orientation gini'</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">to_table</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">tbl</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">'semimajor_sigma'</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">)</span>
<span class="n">tbl</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">'semiminor_sigma'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
           </div>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">tbl</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_html">
              <div>
               <i>
                QTable length=327
               </i>
               <table class="table-striped table-bordered table-condensed" id="table140216221694944">
                <thead>
                 <tr>
                  <th>
                   label
                  </th>
                  <th>
                   xcentroid
                  </th>
                  <th>
                   ycentroid
                  </th>
                  <th>
                   sky_centroid
                  </th>
                  <th>
                   area
                  </th>
                  <th>
                   a
                  </th>
                  <th>
                   b
                  </th>
                  <th>
                   ellipticity
                  </th>
                  <th>
                   orientation
                  </th>
                  <th>
                   gini
                  </th>
                 </tr>
                </thead>
                <thead>
                 <tr>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   deg,deg
                  </th>
                  <th>
                   pix2
                  </th>
                  <th>
                   pix
                  </th>
                  <th>
                   pix
                  </th>
                  <th>
                  </th>
                  <th>
                   deg
                  </th>
                  <th>
                  </th>
                 </tr>
                </thead>
                <thead>
                 <tr>
                  <th>
                   int64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   SkyCoord
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                 </tr>
                </thead>
                <tr>
                 <td>
                  1
                 </td>
                 <td>
                  466.24461350033647
                 </td>
                 <td>
                  8.7975642602371
                 </td>
                 <td>
                  53.17381009103326,-27.805320830365776
                 </td>
                 <td>
                  101.0
                 </td>
                 <td>
                  3.121883592723396
                 </td>
                 <td>
                  1.687718238373556
                 </td>
                 <td>
                  0.4593910412587602
                 </td>
                 <td>
                  -44.478947493786606
                 </td>
                 <td>
                  0.3750841422808698
                 </td>
                </tr>
                <tr>
                 <td>
                  2
                 </td>
                 <td>
                  104.80681791619065
                 </td>
                 <td>
                  18.0821294110356
                 </td>
                 <td>
                  53.17721522973072,-27.805243193448323
                 </td>
                 <td>
                  271.0
                 </td>
                 <td>
                  4.43307602055267
                 </td>
                 <td>
                  2.8904310038200527
                 </td>
                 <td>
                  0.34798523859744146
                 </td>
                 <td>
                  -26.549722105819686
                 </td>
                 <td>
                  0.4292034166747856
                 </td>
                </tr>
                <tr>
                 <td>
                  3
                 </td>
                 <td>
                  15.04416396551755
                 </td>
                 <td>
                  13.21870964358083
                 </td>
                 <td>
                  53.178060898531776,-27.805283643045666
                 </td>
                 <td>
                  8.0
                 </td>
                 <td>
                  0.8501945455843772
                 </td>
                 <td>
                  0.6682678017840504
                 </td>
                 <td>
                  0.21398248759086114
                 </td>
                 <td>
                  -38.1612276642421
                 </td>
                 <td>
                  0.10521135944081007
                 </td>
                </tr>
                <tr>
                 <td>
                  4
                 </td>
                 <td>
                  710.3242889701858
                 </td>
                 <td>
                  14.259777138086877
                 </td>
                 <td>
                  53.17151058505514,-27.805275444028442
                 </td>
                 <td>
                  25.0
                 </td>
                 <td>
                  1.2749753643104456
                 </td>
                 <td>
                  1.117371994707132
                 </td>
                 <td>
                  0.12361287442487268
                 </td>
                 <td>
                  -59.26178196559024
                 </td>
                 <td>
                  0.33737600483155716
                 </td>
                </tr>
                <tr>
                 <td>
                  5
                 </td>
                 <td>
                  434.52931528855504
                 </td>
                 <td>
                  22.221938204336567
                 </td>
                 <td>
                  53.17410887486057,-27.80520894064138
                 </td>
                 <td>
                  268.0
                 </td>
                 <td>
                  3.954114371118456
                 </td>
                 <td>
                  2.6317387394125484
                 </td>
                 <td>
                  0.33443029401596747
                 </td>
                 <td>
                  -8.167334484702078
                 </td>
                 <td>
                  0.5358632947802063
                 </td>
                </tr>
                <tr>
                 <td>
                  6
                 </td>
                 <td>
                  289.38802515014896
                 </td>
                 <td>
                  17.281765562153954
                 </td>
                 <td>
                  53.17547627056455,-27.805250009193262
                 </td>
                 <td>
                  17.0
                 </td>
                 <td>
                  1.2913044931147235
                 </td>
                 <td>
                  1.1978568863866517
                 </td>
                 <td>
                  0.07236682535090477
                 </td>
                 <td>
                  68.12270923149859
                 </td>
                 <td>
                  0.18041073594089005
                 </td>
                </tr>
                <tr>
                 <td>
                  7
                 </td>
                 <td>
                  640.4863091995317
                 </td>
                 <td>
                  17.773429154661983
                 </td>
                 <td>
                  53.17216853452775,-27.805246129692247
                 </td>
                 <td>
                  21.0
                 </td>
                 <td>
                  1.5124916692884618
                 </td>
                 <td>
                  0.8803106550282112
                 </td>
                 <td>
                  0.41797322067741016
                 </td>
                 <td>
                  -64.72678377811528
                 </td>
                 <td>
                  0.257339933672325
                 </td>
                </tr>
                <tr>
                 <td>
                  8
                 </td>
                 <td>
                  762.7604138509574
                 </td>
                 <td>
                  28.298129971963505
                 </td>
                 <td>
                  53.17101657158984,-27.805158481182374
                 </td>
                 <td>
                  201.0
                 </td>
                 <td>
                  3.160486625451918
                 </td>
                 <td>
                  2.3639871661119467
                 </td>
                 <td>
                  0.25201798132149345
                 </td>
                 <td>
                  37.8486600348364
                 </td>
                 <td>
                  0.5424978595419511
                 </td>
                </tr>
                <tr>
                 <td>
                  9
                 </td>
                 <td>
                  801.0706722163886
                 </td>
                 <td>
                  32.58026118517374
                 </td>
                 <td>
                  53.17065564474934,-27.805122812753073
                 </td>
                 <td>
                  12.0
                 </td>
                 <td>
                  1.3349434908844906
                 </td>
                 <td>
                  0.6567170220834244
                 </td>
                 <td>
                  0.5080563135685205
                 </td>
                 <td>
                  -28.75519616047975
                 </td>
                 <td>
                  0.28793220448127643
                 </td>
                </tr>
                <tr>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                </tr>
                <tr>
                 <td>
                  318
                 </td>
                 <td>
                  638.7423056471345
                 </td>
                 <td>
                  555.4511129157931
                 </td>
                 <td>
                  53.1721846558466,-27.80076548202184
                 </td>
                 <td>
                  256.0
                 </td>
                 <td>
                  4.1970530491670495
                 </td>
                 <td>
                  1.802182158743307
                 </td>
                 <td>
                  0.570607724603107
                 </td>
                 <td>
                  64.56727691953016
                 </td>
                 <td>
                  0.6381184942652184
                 </td>
                </tr>
                <tr>
                 <td>
                  319
                 </td>
                 <td>
                  13.420348917244358
                 </td>
                 <td>
                  884.6989392529491
                 </td>
                 <td>
                  53.17807530216808,-27.798021307292935
                 </td>
                 <td>
                  184.0
                 </td>
                 <td>
                  3.2861175102309126
                 </td>
                 <td>
                  3.144571547794767
                 </td>
                 <td>
                  0.04307391990562126
                 </td>
                 <td>
                  -12.816561509735381
                 </td>
                 <td>
                  0.3289496147364014
                 </td>
                </tr>
                <tr>
                 <td>
                  320
                 </td>
                 <td>
                  7.027176577444122
                 </td>
                 <td>
                  891.9727894960166
                 </td>
                 <td>
                  53.17813552144662,-27.797960686059632
                 </td>
                 <td>
                  29.0
                 </td>
                 <td>
                  1.603195468602836
                 </td>
                 <td>
                  1.3128724093575075
                 </td>
                 <td>
                  0.18109024440939903
                 </td>
                 <td>
                  -82.75208405786572
                 </td>
                 <td>
                  0.254070174248954
                 </td>
                </tr>
                <tr>
                 <td>
                  321
                 </td>
                 <td>
                  143.93471643650219
                 </td>
                 <td>
                  953.7173230226308
                 </td>
                 <td>
                  53.17684572931822,-27.79744626725717
                 </td>
                 <td>
                  58.0
                 </td>
                 <td>
                  2.6519955833889846
                 </td>
                 <td>
                  1.3830963239962937
                 </td>
                 <td>
                  0.47846959751387097
                 </td>
                 <td>
                  24.76422639478917
                 </td>
                 <td>
                  0.2767875433471226
                 </td>
                </tr>
                <tr>
                 <td>
                  322
                 </td>
                 <td>
                  142.746173256619
                 </td>
                 <td>
                  959.5389917866399
                 </td>
                 <td>
                  53.176856920479636,-27.797397752374
                 </td>
                 <td>
                  48.0
                 </td>
                 <td>
                  2.1427436610213637
                 </td>
                 <td>
                  1.2555061677914512
                 </td>
                 <td>
                  0.41406609169806174
                 </td>
                 <td>
                  -35.47427950196171
                 </td>
                 <td>
                  0.3421221334166607
                 </td>
                </tr>
                <tr>
                 <td>
                  323
                 </td>
                 <td>
                  790.415367777511
                 </td>
                 <td>
                  955.3106960545537
                 </td>
                 <td>
                  53.17075559998907,-27.797433388936582
                 </td>
                 <td>
                  93.0
                 </td>
                 <td>
                  2.621691845359079
                 </td>
                 <td>
                  1.8772136125476881
                 </td>
                 <td>
                  0.28396862664438105
                 </td>
                 <td>
                  5.157966396104574
                 </td>
                 <td>
                  0.37596577589838664
                 </td>
                </tr>
                <tr>
                 <td>
                  324
                 </td>
                 <td>
                  797.3397409211948
                 </td>
                 <td>
                  965.5478941851635
                 </td>
                 <td>
                  53.17069036467991,-27.797348081794517
                 </td>
                 <td>
                  121.0
                 </td>
                 <td>
                  3.0304070507432326
                 </td>
                 <td>
                  1.7633197784086392
                 </td>
                 <td>
                  0.4181244470190332
                 </td>
                 <td>
                  79.51657917516623
                 </td>
                 <td>
                  0.47716929153411286
                 </td>
                </tr>
                <tr>
                 <td>
                  325
                 </td>
                 <td>
                  790.7983558965504
                 </td>
                 <td>
                  979.5822296300561
                 </td>
                 <td>
                  53.17075198078638,-27.79723112632807
                 </td>
                 <td>
                  133.0
                 </td>
                 <td>
                  4.506451359665357
                 </td>
                 <td>
                  1.4930454629944043
                 </td>
                 <td>
                  0.6686871012615843
                 </td>
                 <td>
                  -44.19824469199431
                 </td>
                 <td>
                  0.42319913307021234
                 </td>
                </tr>
                <tr>
                 <td>
                  326
                 </td>
                 <td>
                  307.76973240382
                 </td>
                 <td>
                  989.9933237644321
                 </td>
                 <td>
                  53.17530230279065,-27.797144093853966
                 </td>
                 <td>
                  36.0
                 </td>
                 <td>
                  1.7091274365898566
                 </td>
                 <td>
                  1.1796163441788732
                 </td>
                 <td>
                  0.30981369854286145
                 </td>
                 <td>
                  -57.75342780537102
                 </td>
                 <td>
                  0.3499708478753841
                 </td>
                </tr>
                <tr>
                 <td>
                  327
                 </td>
                 <td>
                  306.8506442261885
                 </td>
                 <td>
                  997.243644725512
                 </td>
                 <td>
                  53.1753109550711,-27.797083673855024
                 </td>
                 <td>
                  51.0
                 </td>
                 <td>
                  2.5021353669231527
                 </td>
                 <td>
                  1.4883885517566502
                 </td>
                 <td>
                  0.4051526662256868
                 </td>
                 <td>
                  15.388098948641728
                 </td>
                 <td>
                  0.24216628412005226
                 </td>
                </tr>
               </table>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="convert-measured-fluxes-data-units-to-magnitudes">
           <h2>
            Convert measured fluxes (data units) to magnitudes
            <a class="headerlink" href="#convert-measured-fluxes-data-units-to-magnitudes" title="Permalink to this headline">
             #
            </a>
           </h2>
           <p>
            <a class="reference external" href="https://docs.astropy.org/en/stable/units/">
             https://docs.astropy.org/en/stable/units/
            </a>
           </p>
           <p>
            <a class="reference external" href="https://docs.astropy.org/en/stable/units/equivalencies.html#photometric-zero-point-equivalency">
             https://docs.astropy.org/en/stable/units/equivalencies.html#photometric-zero-point-equivalency
            </a>
           </p>
           <p>
            <a class="reference external" href="https://docs.astropy.org/en/stable/units/logarithmic_units.html#logarithmic-units">
             https://docs.astropy.org/en/stable/units/logarithmic_units.html#logarithmic-units
            </a>
           </p>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="c1"># not detected: mag =  99; magerr = 1-sigma upper limit assuming zero flux</span>
<span class="c1"># not observed: mag = -99; magerr = 0</span>
<span class="k">def</span> <span class="nf">fluxes2mags</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">fluxerr</span><span class="p">):</span>
    <span class="n">nondet</span> <span class="o">=</span> <span class="n">flux</span> <span class="o">&lt;</span> <span class="mi">0</span>  <span class="c1"># Non-detection if flux is negative</span>
    <span class="n">unobs</span> <span class="o">=</span> <span class="p">(</span><span class="n">fluxerr</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">fluxerr</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>  <span class="c1"># Unobserved if flux uncertainty is negative or infinity</span>

    <span class="n">mag</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">)</span>
    <span class="n">magupperlimit</span> <span class="o">=</span> <span class="n">fluxerr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">)</span>  <span class="c1"># 1-sigma upper limit if flux=0</span>

    <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nondet</span><span class="p">,</span> <span class="mi">99</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">,</span> <span class="n">mag</span><span class="p">)</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">unobs</span><span class="p">,</span> <span class="o">-</span><span class="mi">99</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">,</span> <span class="n">mag</span><span class="p">)</span>

    <span class="n">magerr</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">fluxerr</span><span class="o">/</span><span class="n">flux</span><span class="p">)</span> 
    <span class="n">magerr</span> <span class="o">=</span> <span class="n">magerr</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>

    <span class="n">magerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nondet</span><span class="p">,</span> <span class="n">magupperlimit</span><span class="p">,</span> <span class="n">magerr</span><span class="p">)</span>
    <span class="n">magerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">unobs</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">,</span> <span class="n">magerr</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">mag</span><span class="p">,</span> <span class="n">magerr</span>

<span class="c1"># Includes features I couldn't find in astropy:</span>
<span class="c1"># mag = 99 / -99 for non-detections / unobserved</span>
<span class="c1"># flux uncertainties -&gt; mag uncertainties</span>
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="multiband-photometry-using-isophotal-apertures-defined-in-detection-image">
           <h2>
            Multiband photometry using isophotal apertures defined in detection image
            <a class="headerlink" href="#multiband-photometry-using-isophotal-apertures-defined-in-detection-image" title="Permalink to this headline">
             #
            </a>
           </h2>
           <p>
            (Similar to running SourceExtractor in double-image mode)
           </p>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">filters</span> <span class="o">=</span> <span class="s1">'F090W F115W F150W F200W F277W F335M F356W F410M F444W'</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="n">imagefiles</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])</span>
    <span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">zp</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">'ABMAG'</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>  <span class="c1"># zeropoint</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
    <span class="c1"># Measure background</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="n">Background2D</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">filter_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">bkg_estimator</span><span class="p">)</span>
    <span class="c1">#error = bkg.background_rms</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">calc_total_error</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bkg</span><span class="o">.</span><span class="n">background_rms</span><span class="p">,</span> <span class="n">weight</span><span class="o">/</span><span class="mi">500</span><span class="p">)</span>
                             
    <span class="c1"># Measure properties in each image of previously detected objects </span>
    <span class="n">filtcat</span> <span class="o">=</span> <span class="n">SourceCatalog</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">bkg</span><span class="o">.</span><span class="n">background</span><span class="p">,</span> <span class="n">segm_deblend</span><span class="p">,</span> <span class="n">wcs</span><span class="o">=</span><span class="n">imwcs</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="o">.</span><span class="n">background</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>

    <span class="c1"># Convert measured fluxes to fluxes in nJy and to AB magnitudes</span>
    <span class="n">filttbl</span> <span class="o">=</span> <span class="n">filtcat</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">'_flux'</span><span class="p">]</span>    <span class="o">=</span> <span class="n">flux</span>    <span class="o">=</span> <span class="n">filttbl</span><span class="p">[</span><span class="s1">'segment_flux'</span><span class="p">]</span>     <span class="o">*</span> <span class="n">zp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">nJy</span><span class="p">)</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">'_fluxerr'</span><span class="p">]</span> <span class="o">=</span> <span class="n">fluxerr</span> <span class="o">=</span> <span class="n">filttbl</span><span class="p">[</span><span class="s1">'segment_fluxerr'</span><span class="p">]</span> <span class="o">*</span> <span class="n">zp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">nJy</span><span class="p">)</span>

    <span class="n">mag</span><span class="p">,</span> <span class="n">magerr</span> <span class="o">=</span> <span class="n">fluxes2mags</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">fluxerr</span><span class="p">)</span>
    <span class="c1">#mag = mag * u.ABmag  # incompatible with file writing</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">'_mag'</span><span class="p">]</span>    <span class="o">=</span> <span class="n">mag</span><span class="o">.</span><span class="n">value</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">'_magerr'</span><span class="p">]</span> <span class="o">=</span> <span class="n">magerr</span><span class="o">.</span><span class="n">value</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>F090W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F090W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F090W_wht.fits
</pre>
              </div>
             </div>
             <div class="output stderr highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>/usr/share/miniconda/lib/python3.9/site-packages/astropy/units/function/logarithmic.py:47: RuntimeWarning: invalid value encountered in log10
  return dex.to(self._function_unit, np.log10(x))
</pre>
              </div>
             </div>
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>F115W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F115W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F115W_wht.fits
</pre>
              </div>
             </div>
             <div class="output stderr highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>/usr/share/miniconda/lib/python3.9/site-packages/astropy/units/function/logarithmic.py:47: RuntimeWarning: invalid value encountered in log10
  return dex.to(self._function_unit, np.log10(x))
/usr/share/miniconda/lib/python3.9/site-packages/astropy/units/quantity.py:611: RuntimeWarning: invalid value encountered in log10
  result = super().__array_ufunc__(function, method, *arrays, **kwargs)
</pre>
              </div>
             </div>
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>F150W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F150W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F150W_wht.fits
</pre>
              </div>
             </div>
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>F200W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F200W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F200W_wht.fits
</pre>
              </div>
             </div>
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>F277W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F277W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F277W_wht.fits
</pre>
              </div>
             </div>
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>F335M
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F335M.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F335M_wht.fits
</pre>
              </div>
             </div>
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>F356W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F356W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F356W_wht.fits
</pre>
              </div>
             </div>
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>F410M
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F410M.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F410M_wht.fits
</pre>
              </div>
             </div>
             <div class="output stderr highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>/usr/share/miniconda/lib/python3.9/site-packages/astropy/units/function/logarithmic.py:47: RuntimeWarning: invalid value encountered in log10
  return dex.to(self._function_unit, np.log10(x))
/usr/share/miniconda/lib/python3.9/site-packages/astropy/units/quantity.py:611: RuntimeWarning: invalid value encountered in log10
  result = super().__array_ufunc__(function, method, *arrays, **kwargs)
</pre>
              </div>
             </div>
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>F444W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F444W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F444W_wht.fits
</pre>
              </div>
             </div>
             <div class="output stderr highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>/usr/share/miniconda/lib/python3.9/site-packages/astropy/units/function/logarithmic.py:47: RuntimeWarning: invalid value encountered in log10
  return dex.to(self._function_unit, np.log10(x))
/usr/share/miniconda/lib/python3.9/site-packages/astropy/units/quantity.py:611: RuntimeWarning: invalid value encountered in log10
  result = super().__array_ufunc__(function, method, *arrays, **kwargs)
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="view-complete-results-optional">
           <h2>
            View complete results (optional)
            <a class="headerlink" href="#view-complete-results-optional" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">tbl</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_html">
              <div>
               <i>
                QTable length=327
               </i>
               <table class="table-striped table-bordered table-condensed" id="table140216221694944">
                <thead>
                 <tr>
                  <th>
                   label
                  </th>
                  <th>
                   xcentroid
                  </th>
                  <th>
                   ycentroid
                  </th>
                  <th>
                   sky_centroid
                  </th>
                  <th>
                   area
                  </th>
                  <th>
                   a
                  </th>
                  <th>
                   b
                  </th>
                  <th>
                   ellipticity
                  </th>
                  <th>
                   orientation
                  </th>
                  <th>
                   gini
                  </th>
                  <th>
                   F090W_flux
                  </th>
                  <th>
                   F090W_fluxerr
                  </th>
                  <th>
                   F090W_mag
                  </th>
                  <th>
                   F090W_magerr
                  </th>
                  <th>
                   F115W_flux
                  </th>
                  <th>
                   F115W_fluxerr
                  </th>
                  <th>
                   F115W_mag
                  </th>
                  <th>
                   F115W_magerr
                  </th>
                  <th>
                   F150W_flux
                  </th>
                  <th>
                   F150W_fluxerr
                  </th>
                  <th>
                   F150W_mag
                  </th>
                  <th>
                   F150W_magerr
                  </th>
                  <th>
                   F200W_flux
                  </th>
                  <th>
                   F200W_fluxerr
                  </th>
                  <th>
                   F200W_mag
                  </th>
                  <th>
                   F200W_magerr
                  </th>
                  <th>
                   F277W_flux
                  </th>
                  <th>
                   F277W_fluxerr
                  </th>
                  <th>
                   F277W_mag
                  </th>
                  <th>
                   F277W_magerr
                  </th>
                  <th>
                   F335M_flux
                  </th>
                  <th>
                   F335M_fluxerr
                  </th>
                  <th>
                   F335M_mag
                  </th>
                  <th>
                   F335M_magerr
                  </th>
                  <th>
                   F356W_flux
                  </th>
                  <th>
                   F356W_fluxerr
                  </th>
                  <th>
                   F356W_mag
                  </th>
                  <th>
                   F356W_magerr
                  </th>
                  <th>
                   F410M_flux
                  </th>
                  <th>
                   F410M_fluxerr
                  </th>
                  <th>
                   F410M_mag
                  </th>
                  <th>
                   F410M_magerr
                  </th>
                  <th>
                   F444W_flux
                  </th>
                  <th>
                   F444W_fluxerr
                  </th>
                  <th>
                   F444W_mag
                  </th>
                  <th>
                   F444W_magerr
                  </th>
                 </tr>
                </thead>
                <thead>
                 <tr>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   deg,deg
                  </th>
                  <th>
                   pix2
                  </th>
                  <th>
                   pix
                  </th>
                  <th>
                   pix
                  </th>
                  <th>
                  </th>
                  <th>
                   deg
                  </th>
                  <th>
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                   nJy
                  </th>
                  <th>
                  </th>
                  <th>
                  </th>
                 </tr>
                </thead>
                <thead>
                 <tr>
                  <th>
                   int64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   SkyCoord
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                  <th>
                   float64
                  </th>
                 </tr>
                </thead>
                <tr>
                 <td>
                  1
                 </td>
                 <td>
                  466.24461350033647
                 </td>
                 <td>
                  8.7975642602371
                 </td>
                 <td>
                  53.17381009103326,-27.805320830365776
                 </td>
                 <td>
                  101.0
                 </td>
                 <td>
                  3.121883592723396
                 </td>
                 <td>
                  1.687718238373556
                 </td>
                 <td>
                  0.4593910412587602
                 </td>
                 <td>
                  -44.478947493786606
                 </td>
                 <td>
                  0.3750841422808698
                 </td>
                 <td>
                  9.172811374136076
                 </td>
                 <td>
                  0.8464272456741546
                 </td>
                 <td>
                  28.993743842627527
                 </td>
                 <td>
                  0.09583064251882532
                 </td>
                 <td>
                  15.251750665804146
                 </td>
                 <td>
                  0.7351866134486008
                 </td>
                 <td>
                  28.441700757864936
                 </td>
                 <td>
                  0.051113935660464196
                 </td>
                 <td>
                  18.356035098509803
                 </td>
                 <td>
                  0.9076155664349278
                 </td>
                 <td>
                  28.240552801409102
                 </td>
                 <td>
                  0.05239928633992559
                 </td>
                 <td>
                  20.355880166244727
                 </td>
                 <td>
                  0.9951286984899145
                 </td>
                 <td>
                  28.128275286137136
                 </td>
                 <td>
                  0.05182128829099082
                 </td>
                 <td>
                  15.30541463181222
                 </td>
                 <td>
                  0.37242909913150146
                 </td>
                 <td>
                  28.437887251597694
                 </td>
                 <td>
                  0.026103079843123198
                 </td>
                 <td>
                  14.02083788279239
                 </td>
                 <td>
                  0.4536467684272995
                 </td>
                 <td>
                  28.533065080581018
                 </td>
                 <td>
                  0.03457285577386587
                 </td>
                 <td>
                  14.174014573163747
                 </td>
                 <td>
                  0.3999261081137788
                 </td>
                 <td>
                  28.52126781262446
                 </td>
                 <td>
                  0.030210306451640984
                 </td>
                 <td>
                  13.880611681957355
                 </td>
                 <td>
                  0.46501162852267625
                 </td>
                 <td>
                  28.543978488116917
                 </td>
                 <td>
                  0.035777045316298495
                 </td>
                 <td>
                  13.807578444079855
                 </td>
                 <td>
                  0.4986392632950047
                 </td>
                 <td>
                  28.54970620192208
                 </td>
                 <td>
                  0.038518276199781994
                 </td>
                </tr>
                <tr>
                 <td>
                  2
                 </td>
                 <td>
                  104.80681791619065
                 </td>
                 <td>
                  18.0821294110356
                 </td>
                 <td>
                  53.17721522973072,-27.805243193448323
                 </td>
                 <td>
                  271.0
                 </td>
                 <td>
                  4.43307602055267
                 </td>
                 <td>
                  2.8904310038200527
                 </td>
                 <td>
                  0.34798523859744146
                 </td>
                 <td>
                  -26.549722105819686
                 </td>
                 <td>
                  0.4292034166747856
                 </td>
                 <td>
                  66.57967761225385
                 </td>
                 <td>
                  2.43625593694296
                 </td>
                 <td>
                  26.841645780216258
                 </td>
                 <td>
                  0.0390191974089124
                 </td>
                 <td>
                  67.80807330092654
                 </td>
                 <td>
                  1.7819304792547142
                 </td>
                 <td>
                  26.82179648873538
                 </td>
                 <td>
                  0.028163638950928188
                 </td>
                 <td>
                  70.39338412925109
                 </td>
                 <td>
                  2.1096858426785867
                 </td>
                 <td>
                  26.78117038947336
                 </td>
                 <td>
                  0.03206137981950343
                 </td>
                 <td>
                  77.74109040131492
                 </td>
                 <td>
                  2.318681567876357
                 </td>
                 <td>
                  26.6733734305523
                 </td>
                 <td>
                  0.031909302523638994
                 </td>
                 <td>
                  72.90069026757769
                 </td>
                 <td>
                  0.8318824113256227
                 </td>
                 <td>
                  26.743170898753043
                 </td>
                 <td>
                  0.012319367708500412
                 </td>
                 <td>
                  75.27250253951928
                 </td>
                 <td>
                  1.070603105909879
                 </td>
                 <td>
                  26.70840911249712
                 </td>
                 <td>
                  0.015333670289260427
                 </td>
                 <td>
                  71.48792896636016
                 </td>
                 <td>
                  0.9342131216075662
                 </td>
                 <td>
                  26.764418211087325
                 </td>
                 <td>
                  0.01409662645806182
                 </td>
                 <td>
                  61.42767389099904
                 </td>
                 <td>
                  0.9993087828855896
                 </td>
                 <td>
                  26.929089824977595
                 </td>
                 <td>
                  0.017520685942298195
                 </td>
                 <td>
                  57.2203760546637
                 </td>
                 <td>
                  1.051093157627436
                 </td>
                 <td>
                  27.00612323080047
                 </td>
                 <td>
                  0.019763151293857938
                 </td>
                </tr>
                <tr>
                 <td>
                  3
                 </td>
                 <td>
                  15.04416396551755
                 </td>
                 <td>
                  13.21870964358083
                 </td>
                 <td>
                  53.178060898531776,-27.805283643045666
                 </td>
                 <td>
                  8.0
                 </td>
                 <td>
                  0.8501945455843772
                 </td>
                 <td>
                  0.6682678017840504
                 </td>
                 <td>
                  0.21398248759086114
                 </td>
                 <td>
                  -38.1612276642421
                 </td>
                 <td>
                  0.10521135944081007
                 </td>
                 <td>
                  0.30189458075047043
                 </td>
                 <td>
                  0.22003285728886565
                 </td>
                 <td>
                  32.700361707101834
                 </td>
                 <td>
                  0.5943870285461557
                 </td>
                 <td>
                  0.7673344575647303
                 </td>
                 <td>
                  0.20049710455191738
                 </td>
                 <td>
                  31.68753824783774
                 </td>
                 <td>
                  0.25203769997123526
                 </td>
                 <td>
                  0.7185263104580911
                 </td>
                 <td>
                  0.22413744728361695
                 </td>
                 <td>
                  31.758893311421605
                 </td>
                 <td>
                  0.2947853370137946
                 </td>
                 <td>
                  0.9352163612291753
                 </td>
                 <td>
                  0.2577402310908106
                 </td>
                 <td>
                  31.47271975993688
                 </td>
                 <td>
                  0.2642813635409141
                 </td>
                 <td>
                  0.34971362332966227
                 </td>
                 <td>
                  0.06900286982371183
                 </td>
                 <td>
                  32.54071862281815
                 </td>
                 <td>
                  0.19551879280610807
                 </td>
                 <td>
                  0.5607617346802088
                 </td>
                 <td>
                  0.11336299849737182
                 </td>
                 <td>
                  32.02805407366013
                 </td>
                 <td>
                  0.19990472716017532
                 </td>
                 <td>
                  0.2668657682095152
                 </td>
                 <td>
                  0.07056536651518258
                 </td>
                 <td>
                  32.83426782771905
                 </td>
                 <td>
                  0.25473070870520814
                 </td>
                 <td>
                  -0.06031654176708369
                 </td>
                 <td>
                  0.08275804453775322
                 </td>
                 <td>
                  99.0
                 </td>
                 <td>
                  34.10547444921151
                 </td>
                 <td>
                  0.11765422427560634
                 </td>
                 <td>
                  0.08200758112663478
                 </td>
                 <td>
                  33.723481188078146
                 </td>
                 <td>
                  0.574218672619342
                 </td>
                </tr>
                <tr>
                 <td>
                  4
                 </td>
                 <td>
                  710.3242889701858
                 </td>
                 <td>
                  14.259777138086877
                 </td>
                 <td>
                  53.17151058505514,-27.805275444028442
                 </td>
                 <td>
                  25.0
                 </td>
                 <td>
                  1.2749753643104456
                 </td>
                 <td>
                  1.117371994707132
                 </td>
                 <td>
                  0.12361287442487268
                 </td>
                 <td>
                  -59.26178196559024
                 </td>
                 <td>
                  0.33737600483155716
                 </td>
                 <td>
                  2.6566836210797113
                 </td>
                 <td>
                  0.43714881228773556
                 </td>
                 <td>
                  30.33915040433974
                 </td>
                 <td>
                  0.1653923742295374
                 </td>
                 <td>
                  3.818279752499735
                 </td>
                 <td>
                  0.36055790754738243
                 </td>
                 <td>
                  29.94533063870602
                 </td>
                 <td>
                  0.09796938858281214
                 </td>
                 <td>
                  3.9761821744276116
                 </td>
                 <td>
                  0.4246250031936531
                 </td>
                 <td>
                  29.901334315002583
                 </td>
                 <td>
                  0.11016516567055634
                 </td>
                 <td>
                  3.5589744431503423
                 </td>
                 <td>
                  0.42659305165797895
                 </td>
                 <td>
                  30.02168782658959
                 </td>
                 <td>
                  0.12291324714108388
                 </td>
                 <td>
                  1.6962298219026282
                 </td>
                 <td>
                  0.12672768826931047
                 </td>
                 <td>
                  30.826288264009904
                 </td>
                 <td>
                  0.07822962940363361
                 </td>
                 <td>
                  1.590536535091481
                 </td>
                 <td>
                  0.16680910589172165
                 </td>
                 <td>
                  30.896140876425513
                 </td>
                 <td>
                  0.10828384762060109
                 </td>
                 <td>
                  1.9912255134558894
                 </td>
                 <td>
                  0.151127025768846
                 </td>
                 <td>
                  30.652198879435126
                 </td>
                 <td>
                  0.07942622592908809
                 </td>
                 <td>
                  1.9438353657449134
                 </td>
                 <td>
                  0.17889684257333507
                 </td>
                 <td>
                  30.67835130168316
                 </td>
                 <td>
                  0.09558932550457658
                 </td>
                 <td>
                  1.6253103136417588
                 </td>
                 <td>
                  0.17102441486844797
                 </td>
                 <td>
                  30.8726592718879
                 </td>
                 <td>
                  0.1086274373485027
                 </td>
                </tr>
                <tr>
                 <td>
                  5
                 </td>
                 <td>
                  434.52931528855504
                 </td>
                 <td>
                  22.221938204336567
                 </td>
                 <td>
                  53.17410887486057,-27.80520894064138
                 </td>
                 <td>
                  268.0
                 </td>
                 <td>
                  3.954114371118456
                 </td>
                 <td>
                  2.6317387394125484
                 </td>
                 <td>
                  0.33443029401596747
                 </td>
                 <td>
                  -8.167334484702078
                 </td>
                 <td>
                  0.5358632947802063
                 </td>
                 <td>
                  48.21536384426303
                 </td>
                 <td>
                  1.7917279404824316
                 </td>
                 <td>
                  27.19203637900948
                 </td>
                 <td>
                  0.039615375078573836
                 </td>
                 <td>
                  54.180491712205686
                 </td>
                 <td>
                  1.3655408576728798
                 </td>
                 <td>
                  27.065392644670535
                 </td>
                 <td>
                  0.02702525585364868
                 </td>
                 <td>
                  58.30054045382708
                 </td>
                 <td>
                  1.6237335307550271
                 </td>
                 <td>
                  26.98581854813561
                 </td>
                 <td>
                  0.02982550069042518
                 </td>
                 <td>
                  83.05102812663696
                 </td>
                 <td>
                  2.015269002596905
                 </td>
                 <td>
                  26.601637467123535
                 </td>
                 <td>
                  0.026031288898904284
                 </td>
                 <td>
                  133.15988061559287
                 </td>
                 <td>
                  1.0563434518773878
                 </td>
                 <td>
                  26.089066507204098
                 </td>
                 <td>
                  0.008579048595350228
                 </td>
                 <td>
                  133.46712655021906
                 </td>
                 <td>
                  1.2825865885346561
                 </td>
                 <td>
                  26.086564223686825
                 </td>
                 <td>
                  0.01038384697219314
                 </td>
                 <td>
                  144.03906284324478
                 </td>
                 <td>
                  1.2384188265720026
                 </td>
                 <td>
                  26.003799282319697
                 </td>
                 <td>
                  0.009295039598996597
                 </td>
                 <td>
                  161.60492000841137
                 </td>
                 <td>
                  1.4304450626852654
                 </td>
                 <td>
                  25.87886355352026
                 </td>
                 <td>
                  0.009568104243562612
                 </td>
                 <td>
                  148.3405102917476
                 </td>
                 <td>
                  1.5722804535154722
                 </td>
                 <td>
                  25.971850578368716
                 </td>
                 <td>
                  0.011447300801342226
                 </td>
                </tr>
                <tr>
                 <td>
                  6
                 </td>
                 <td>
                  289.38802515014896
                 </td>
                 <td>
                  17.281765562153954
                 </td>
                 <td>
                  53.17547627056455,-27.805250009193262
                 </td>
                 <td>
                  17.0
                 </td>
                 <td>
                  1.2913044931147235
                 </td>
                 <td>
                  1.1978568863866517
                 </td>
                 <td>
                  0.07236682535090477
                 </td>
                 <td>
                  68.12270923149859
                 </td>
                 <td>
                  0.18041073594089005
                 </td>
                 <td>
                  1.1303554308347756
                 </td>
                 <td>
                  0.3821670947419674
                 </td>
                 <td>
                  31.266962436913506
                 </td>
                 <td>
                  0.31621706491210366
                 </td>
                 <td>
                  1.5011462606731298
                 </td>
                 <td>
                  0.2867616114630805
                 </td>
                 <td>
                  30.958942478071556
                 </td>
                 <td>
                  0.18980531951535454
                 </td>
                 <td>
                  1.045624005692517
                 </td>
                 <td>
                  0.28930296367333985
                 </td>
                 <td>
                  31.35156113668441
                 </td>
                 <td>
                  0.2652049045520463
                 </td>
                 <td>
                  1.955256158588051
                 </td>
                 <td>
                  0.38221513653203576
                 </td>
                 <td>
                  30.671990843785842
                 </td>
                 <td>
                  0.1938565595483074
                 </td>
                 <td>
                  1.188616449626284
                 </td>
                 <td>
                  0.12368244418243222
                 </td>
                 <td>
                  31.212395659255414
                 </td>
                 <td>
                  0.10747756611504046
                 </td>
                 <td>
                  1.7708471014756073
                 </td>
                 <td>
                  0.19746701583101797
                 </td>
                 <td>
                  30.77954733764033
                 </td>
                 <td>
                  0.11478335606840086
                 </td>
                 <td>
                  1.4921438342127515
                 </td>
                 <td>
                  0.15067991684808457
                 </td>
                 <td>
                  30.96547327829425
                 </td>
                 <td>
                  0.10445071085094702
                 </td>
                 <td>
                  1.1433927169620364
                 </td>
                 <td>
                  0.17563750503987802
                 </td>
                 <td>
                  31.25451144606716
                 </td>
                 <td>
                  0.15514831191999282
                 </td>
                 <td>
                  0.5926553032606401
                 </td>
                 <td>
                  0.13657056678097335
                 </td>
                 <td>
                  31.967994562614585
                 </td>
                 <td>
                  0.22514973086947426
                 </td>
                </tr>
                <tr>
                 <td>
                  7
                 </td>
                 <td>
                  640.4863091995317
                 </td>
                 <td>
                  17.773429154661983
                 </td>
                 <td>
                  53.17216853452775,-27.805246129692247
                 </td>
                 <td>
                  21.0
                 </td>
                 <td>
                  1.5124916692884618
                 </td>
                 <td>
                  0.8803106550282112
                 </td>
                 <td>
                  0.41797322067741016
                 </td>
                 <td>
                  -64.72678377811528
                 </td>
                 <td>
                  0.257339933672325
                 </td>
                 <td>
                  1.7318562374159874
                 </td>
                 <td>
                  0.3544951971113632
                 </td>
                 <td>
                  30.80372040476935
                 </td>
                 <td>
                  0.20218906674628245
                 </td>
                 <td>
                  1.643429843026024
                 </td>
                 <td>
                  0.2498558061100988
                 </td>
                 <td>
                  30.86062207735413
                 </td>
                 <td>
                  0.1536624348793862
                 </td>
                 <td>
                  1.636102104727731
                 </td>
                 <td>
                  0.2840661458248788
                 </td>
                 <td>
                  30.865473991673777
                 </td>
                 <td>
                  0.17382220286646824
                 </td>
                 <td>
                  2.2295861313548446
                 </td>
                 <td>
                  0.3321415421916018
                 </td>
                 <td>
                  30.529439364296703
                 </td>
                 <td>
                  0.15077176392081712
                 </td>
                 <td>
                  1.0399598684843063
                 </td>
                 <td>
                  0.09617790287548722
                 </td>
                 <td>
                  31.35745854894559
                 </td>
                 <td>
                  0.09603604488615963
                 </td>
                 <td>
                  1.6537574517445193
                 </td>
                 <td>
                  0.1507209599380506
                 </td>
                 <td>
                  30.853820464729573
                 </td>
                 <td>
                  0.094699691326289
                 </td>
                 <td>
                  1.2604572236829945
                 </td>
                 <td>
                  0.11591912740405148
                 </td>
                 <td>
                  31.14867972112842
                 </td>
                 <td>
                  0.09552272603001735
                 </td>
                 <td>
                  0.40788132175057795
                 </td>
                 <td>
                  0.11575451167421515
                 </td>
                 <td>
                  32.37366545505972
                 </td>
                 <td>
                  0.2712388513520371
                 </td>
                 <td>
                  0.5688140707837224
                 </td>
                 <td>
                  0.10865005565010255
                 </td>
                 <td>
                  32.01257417244966
                 </td>
                 <td>
                  0.18978993015591247
                 </td>
                </tr>
                <tr>
                 <td>
                  8
                 </td>
                 <td>
                  762.7604138509574
                 </td>
                 <td>
                  28.298129971963505
                 </td>
                 <td>
                  53.17101657158984,-27.805158481182374
                 </td>
                 <td>
                  201.0
                 </td>
                 <td>
                  3.160486625451918
                 </td>
                 <td>
                  2.3639871661119467
                 </td>
                 <td>
                  0.25201798132149345
                 </td>
                 <td>
                  37.8486600348364
                 </td>
                 <td>
                  0.5424978595419511
                 </td>
                 <td>
                  52.90258045317187
                 </td>
                 <td>
                  1.7914935312003206
                 </td>
                 <td>
                  27.091307859172854
                 </td>
                 <td>
                  0.036158543593889224
                 </td>
                 <td>
                  55.89021246540487
                 </td>
                 <td>
                  1.3413162708320239
                 </td>
                 <td>
                  27.031660598550253
                 </td>
                 <td>
                  0.02574896528019833
                 </td>
                 <td>
                  61.671458415942496
                 </td>
                 <td>
                  1.630539484798694
                 </td>
                 <td>
                  26.92478945297725
                 </td>
                 <td>
                  0.028332995934327934
                 </td>
                 <td>
                  87.85194348648487
                 </td>
                 <td>
                  2.0332904975012602
                 </td>
                 <td>
                  26.540621566180963
                 </td>
                 <td>
                  0.024842449407777148
                 </td>
                 <td>
                  86.04008354445801
                 </td>
                 <td>
                  0.7878699856173026
                 </td>
                 <td>
                  26.563247941466912
                 </td>
                 <td>
                  0.009896854334870047
                 </td>
                 <td>
                  73.84294727616292
                 </td>
                 <td>
                  0.8942980843096469
                 </td>
                 <td>
                  26.729227444357107
                 </td>
                 <td>
                  0.013070161189289636
                 </td>
                 <td>
                  74.8225190478038
                 </td>
                 <td>
                  0.8372019588600241
                 </td>
                 <td>
                  26.714919186276617
                 </td>
                 <td>
                  0.012081025050606558
                 </td>
                 <td>
                  70.73942058751356
                 </td>
                 <td>
                  0.9010723240651843
                 </td>
                 <td>
                  26.775846254315468
                 </td>
                 <td>
                  0.013742667527438834
                 </td>
                 <td>
                  74.11117248879874
                 </td>
                 <td>
                  1.0396086825403072
                 </td>
                 <td>
                  26.725290789617205
                 </td>
                 <td>
                  0.015124537907185093
                 </td>
                </tr>
                <tr>
                 <td>
                  9
                 </td>
                 <td>
                  801.0706722163886
                 </td>
                 <td>
                  32.58026118517374
                 </td>
                 <td>
                  53.17065564474934,-27.805122812753073
                 </td>
                 <td>
                  12.0
                 </td>
                 <td>
                  1.3349434908844906
                 </td>
                 <td>
                  0.6567170220834244
                 </td>
                 <td>
                  0.5080563135685205
                 </td>
                 <td>
                  -28.75519616047975
                 </td>
                 <td>
                  0.28793220448127643
                 </td>
                 <td>
                  1.1246036170169136
                 </td>
                 <td>
                  0.30047864289476006
                 </td>
                 <td>
                  31.272501310051688
                 </td>
                 <td>
                  0.2571011445877932
                 </td>
                 <td>
                  1.2797476107076189
                 </td>
                 <td>
                  0.2305526012526087
                 </td>
                 <td>
                  31.13218918151494
                 </td>
                 <td>
                  0.17984738987799762
                 </td>
                 <td>
                  1.2734342232303713
                 </td>
                 <td>
                  0.2595936168660486
                 </td>
                 <td>
                  31.13755870689588
                 </td>
                 <td>
                  0.2014338114004866
                 </td>
                 <td>
                  1.3630620117794083
                 </td>
                 <td>
                  0.2799372864607707
                 </td>
                 <td>
                  31.063710964299986
                 </td>
                 <td>
                  0.20280440914679781
                 </td>
                 <td>
                  1.082787068323561
                 </td>
                 <td>
                  0.10030137862329397
                 </td>
                 <td>
                  31.313642349074232
                 </td>
                 <td>
                  0.09618538263285319
                 </td>
                 <td>
                  0.6781367101230981
                 </td>
                 <td>
                  0.1161012153749804
                 </td>
                 <td>
                  31.821706862430297
                 </td>
                 <td>
                  0.17158341526256443
                 </td>
                 <td>
                  0.5758891043153808
                 </td>
                 <td>
                  0.08989342817146666
                 </td>
                 <td>
                  31.999152845351176
                 </td>
                 <td>
                  0.15748383733187593
                 </td>
                 <td>
                  1.1076176036929606
                 </td>
                 <td>
                  0.13520585441853786
                 </td>
                 <td>
                  31.289025376253583
                 </td>
                 <td>
                  0.12504898101684045
                 </td>
                 <td>
                  1.113433002949251
                 </td>
                 <td>
                  0.1420534202367806
                 </td>
                 <td>
                  31.283339775099364
                 </td>
                 <td>
                  0.1303698266479056
                 </td>
                </tr>
                <tr>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                 <td>
                  ...
                 </td>
                </tr>
                <tr>
                 <td>
                  318
                 </td>
                 <td>
                  638.7423056471345
                 </td>
                 <td>
                  555.4511129157931
                 </td>
                 <td>
                  53.1721846558466,-27.80076548202184
                 </td>
                 <td>
                  256.0
                 </td>
                 <td>
                  4.1970530491670495
                 </td>
                 <td>
                  1.802182158743307
                 </td>
                 <td>
                  0.570607724603107
                 </td>
                 <td>
                  64.56727691953016
                 </td>
                 <td>
                  0.6381184942652184
                 </td>
                 <td>
                  120.11105123386255
                 </td>
                 <td>
                  3.1493498206593062
                 </td>
                 <td>
                  26.201042579971478
                 </td>
                 <td>
                  0.028101521142739623
                 </td>
                 <td>
                  165.08884566980734
                 </td>
                 <td>
                  2.6634625072222033
                 </td>
                 <td>
                  25.855705672804568
                 </td>
                 <td>
                  0.017376934126978157
                 </td>
                 <td>
                  210.82538772196136
                 </td>
                 <td>
                  3.5242585053841124
                 </td>
                 <td>
                  25.590192730758954
                 </td>
                 <td>
                  0.017999658427385466
                 </td>
                 <td>
                  199.580288319275
                 </td>
                 <td>
                  3.6470415652056585
                 </td>
                 <td>
                  25.64970588578926
                 </td>
                 <td>
                  0.0196611637646163
                 </td>
                 <td>
                  143.09847494169267
                 </td>
                 <td>
                  1.1923776093934582
                 </td>
                 <td>
                  26.010912486668634
                 </td>
                 <td>
                  0.009009485356804967
                 </td>
                 <td>
                  125.45620116997327
                 </td>
                 <td>
                  1.4001200026317673
                 </td>
                 <td>
                  26.15376966773193
                 </td>
                 <td>
                  0.01204994954280746
                 </td>
                 <td>
                  115.52181690810832
                 </td>
                 <td>
                  1.2496816373897293
                 </td>
                 <td>
                  26.243339973021605
                 </td>
                 <td>
                  0.011682107040887598
                 </td>
                 <td>
                  106.85877963435514
                 </td>
                 <td>
                  1.3121928145361486
                 </td>
                 <td>
                  26.32797447480941
                 </td>
                 <td>
                  0.013251309809061716
                 </td>
                 <td>
                  104.25292308993991
                 </td>
                 <td>
                  1.4630332682490081
                 </td>
                 <td>
                  26.354779398102927
                 </td>
                 <td>
                  0.015130755569956123
                 </td>
                </tr>
                <tr>
                 <td>
                  319
                 </td>
                 <td>
                  13.420348917244358
                 </td>
                 <td>
                  884.6989392529491
                 </td>
                 <td>
                  53.17807530216808,-27.798021307292935
                 </td>
                 <td>
                  184.0
                 </td>
                 <td>
                  3.2861175102309126
                 </td>
                 <td>
                  3.144571547794767
                 </td>
                 <td>
                  0.04307391990562126
                 </td>
                 <td>
                  -12.816561509735381
                 </td>
                 <td>
                  0.3289496147364014
                 </td>
                 <td>
                  18.876874905408805
                 </td>
                 <td>
                  1.9637765207284623
                 </td>
                 <td>
                  28.210174755454297
                 </td>
                 <td>
                  0.10745297992550883
                 </td>
                 <td>
                  31.863552850787098
                 </td>
                 <td>
                  1.71291063394621
                 </td>
                 <td>
                  27.64176450279784
                 </td>
                 <td>
                  0.05685188075824281
                 </td>
                 <td>
                  50.359881042840634
                 </td>
                 <td>
                  2.4093268273207156
                 </td>
                 <td>
                  27.144788261069834
                 </td>
                 <td>
                  0.05073969841713957
                 </td>
                 <td>
                  48.59560246237275
                 </td>
                 <td>
                  2.475721542185557
                 </td>
                 <td>
                  27.183507573384148
                 </td>
                 <td>
                  0.053950365684063833
                 </td>
                 <td>
                  36.65997645594317
                 </td>
                 <td>
                  0.8204411796141273
                 </td>
                 <td>
                  27.489519545724278
                 </td>
                 <td>
                  0.02403059943648705
                 </td>
                 <td>
                  33.29989013091067
                 </td>
                 <td>
                  1.0048745397608183
                 </td>
                 <td>
                  27.593892998487796
                 </td>
                 <td>
                  0.03227910956200879
                 </td>
                 <td>
                  34.258836181673466
                 </td>
                 <td>
                  0.9114471956318294
                 </td>
                 <td>
                  27.563068486705767
                 </td>
                 <td>
                  0.02850815562893502
                 </td>
                 <td>
                  31.59820599327046
                 </td>
                 <td>
                  1.0125589051776267
                 </td>
                 <td>
                  27.65084393501573
                 </td>
                 <td>
                  0.03424639870337512
                 </td>
                 <td>
                  31.743952751062974
                 </td>
                 <td>
                  1.10588219702589
                 </td>
                 <td>
                  27.645847489865684
                 </td>
                 <td>
                  0.037180469406228316
                 </td>
                </tr>
                <tr>
                 <td>
                  320
                 </td>
                 <td>
                  7.027176577444122
                 </td>
                 <td>
                  891.9727894960166
                 </td>
                 <td>
                  53.17813552144662,-27.797960686059632
                 </td>
                 <td>
                  29.0
                 </td>
                 <td>
                  1.603195468602836
                 </td>
                 <td>
                  1.3128724093575075
                 </td>
                 <td>
                  0.18109024440939903
                 </td>
                 <td>
                  -82.75208405786572
                 </td>
                 <td>
                  0.254070174248954
                 </td>
                 <td>
                  4.46599816086569
                 </td>
                 <td>
                  0.8826460487533626
                 </td>
                 <td>
                  29.775203650276346
                 </td>
                 <td>
                  0.19581292453422583
                 </td>
                 <td>
                  3.531493143831654
                 </td>
                 <td>
                  0.5906264815373176
                 </td>
                 <td>
                  30.03010408141747
                 </td>
                 <td>
                  0.16790555893120204
                 </td>
                 <td>
                  5.107472203839501
                 </td>
                 <td>
                  0.7850802444997992
                 </td>
                 <td>
                  29.629484970574794
                 </td>
                 <td>
                  0.1552436125126563
                 </td>
                 <td>
                  4.917640884310548
                 </td>
                 <td>
                  0.8043621780644387
                 </td>
                 <td>
                  29.670607973080685
                 </td>
                 <td>
                  0.16447818783217788
                 </td>
                 <td>
                  3.997287152346768
                 </td>
                 <td>
                  0.28436677684545053
                 </td>
                 <td>
                  29.895586630725628
                 </td>
                 <td>
                  0.07461553548507587
                 </td>
                 <td>
                  3.8377835048269504
                 </td>
                 <td>
                  0.3661371226929502
                 </td>
                 <td>
                  29.93979882029562
                 </td>
                 <td>
                  0.09893508954511895
                 </td>
                 <td>
                  3.4123744791286934
                 </td>
                 <td>
                  0.30628798885439634
                 </td>
                 <td>
                  30.067358286892155
                 </td>
                 <td>
                  0.09332518819096991
                 </td>
                 <td>
                  3.28526387152336
                 </td>
                 <td>
                  0.3549824646600952
                 </td>
                 <td>
                  30.10857435571395
                 </td>
                 <td>
                  0.11140128930453498
                 </td>
                 <td>
                  3.979156125410199
                 </td>
                 <td>
                  0.40496953684556536
                 </td>
                 <td>
                  29.900522551559803
                 </td>
                 <td>
                  0.10523003616876629
                 </td>
                </tr>
                <tr>
                 <td>
                  321
                 </td>
                 <td>
                  143.93471643650219
                 </td>
                 <td>
                  953.7173230226308
                 </td>
                 <td>
                  53.17684572931822,-27.79744626725717
                 </td>
                 <td>
                  58.0
                 </td>
                 <td>
                  2.6519955833889846
                 </td>
                 <td>
                  1.3830963239962937
                 </td>
                 <td>
                  0.47846959751387097
                 </td>
                 <td>
                  24.76422639478917
                 </td>
                 <td>
                  0.2767875433471226
                 </td>
                 <td>
                  5.25267816437387
                 </td>
                 <td>
                  1.0728918997500319
                 </td>
                 <td>
                  29.599048019845632
                 </td>
                 <td>
                  0.20179719606494398
                 </td>
                 <td>
                  5.833623054813162
                 </td>
                 <td>
                  0.7973416554938754
                 </td>
                 <td>
                  29.485154091662512
                 </td>
                 <td>
                  0.13909588321915103
                 </td>
                 <td>
                  7.139888054579577
                 </td>
                 <td>
                  0.9936751669084544
                 </td>
                 <td>
                  29.265771493549583
                 </td>
                 <td>
                  0.14147361042904144
                 </td>
                 <td>
                  12.978869464075444
                 </td>
                 <td>
                  1.3144930012171665
                 </td>
                 <td>
                  28.616907838734512
                 </td>
                 <td>
                  0.1047438565382814
                 </td>
                 <td>
                  8.314911352869782
                 </td>
                 <td>
                  0.41141015610520926
                 </td>
                 <td>
                  29.100355941326036
                 </td>
                 <td>
                  0.05243396610496494
                 </td>
                 <td>
                  6.622274866960971
                 </td>
                 <td>
                  0.5011520705718457
                 </td>
                 <td>
                  29.347481992995288
                 </td>
                 <td>
                  0.07920442863493232
                 </td>
                 <td>
                  6.3589945647895725
                 </td>
                 <td>
                  0.4220001550022493
                 </td>
                 <td>
                  29.391528865549652
                 </td>
                 <td>
                  0.0697623810541305
                 </td>
                 <td>
                  7.4586002239091185
                 </td>
                 <td>
                  0.5253410862821729
                 </td>
                 <td>
                  29.218356675310666
                 </td>
                 <td>
                  0.07390001481101394
                 </td>
                 <td>
                  6.662546579409225
                 </td>
                 <td>
                  0.5365182891738445
                 </td>
                 <td>
                  29.34089935425313
                 </td>
                 <td>
                  0.08408957144589889
                 </td>
                </tr>
                <tr>
                 <td>
                  322
                 </td>
                 <td>
                  142.746173256619
                 </td>
                 <td>
                  959.5389917866399
                 </td>
                 <td>
                  53.176856920479636,-27.797397752374
                 </td>
                 <td>
                  48.0
                 </td>
                 <td>
                  2.1427436610213637
                 </td>
                 <td>
                  1.2555061677914512
                 </td>
                 <td>
                  0.41406609169806174
                 </td>
                 <td>
                  -35.47427950196171
                 </td>
                 <td>
                  0.3421221334166607
                 </td>
                 <td>
                  6.9362362752687154
                 </td>
                 <td>
                  1.1392607898071851
                 </td>
                 <td>
                  29.297190303788632
                 </td>
                 <td>
                  0.165113462867927
                 </td>
                 <td>
                  7.903254851436269
                 </td>
                 <td>
                  0.8693971751605
                 </td>
                 <td>
                  29.1554850335146
                 </td>
                 <td>
                  0.11331229127610237
                 </td>
                 <td>
                  10.187623103416623
                 </td>
                 <td>
                  1.1263006739142138
                 </td>
                 <td>
                  28.879817825921563
                 </td>
                 <td>
                  0.11385094727898959
                 </td>
                 <td>
                  12.948029906646463
                 </td>
                 <td>
                  1.3061016666971015
                 </td>
                 <td>
                  28.619490765397067
                 </td>
                 <td>
                  0.10434267352803422
                 </td>
                 <td>
                  9.023017764882551
                 </td>
                 <td>
                  0.4184777153387269
                 </td>
                 <td>
                  29.011620468937362
                 </td>
                 <td>
                  0.049222442862693484
                 </td>
                 <td>
                  5.447014735335707
                 </td>
                 <td>
                  0.45676894530082573
                 </td>
                 <td>
                  29.559603624665375
                 </td>
                 <td>
                  0.08742971518734169
                 </td>
                 <td>
                  6.472888687598323
                 </td>
                 <td>
                  0.4196891132056483
                 </td>
                 <td>
                  29.372254653387305
                 </td>
                 <td>
                  0.06820884577947949
                 </td>
                 <td>
                  6.488348644754336
                 </td>
                 <td>
                  0.4869395067625267
                 </td>
                 <td>
                  29.369664554504258
                 </td>
                 <td>
                  0.07856993742528491
                 </td>
                 <td>
                  5.76627926777331
                 </td>
                 <td>
                  0.5007325407405385
                 </td>
                 <td>
                  29.497760820098495
                 </td>
                 <td>
                  0.09041210263092743
                 </td>
                </tr>
                <tr>
                 <td>
                  323
                 </td>
                 <td>
                  790.415367777511
                 </td>
                 <td>
                  955.3106960545537
                 </td>
                 <td>
                  53.17075559998907,-27.797433388936582
                 </td>
                 <td>
                  93.0
                 </td>
                 <td>
                  2.621691845359079
                 </td>
                 <td>
                  1.8772136125476881
                 </td>
                 <td>
                  0.28396862664438105
                 </td>
                 <td>
                  5.157966396104574
                 </td>
                 <td>
                  0.37596577589838664
                 </td>
                 <td>
                  20.729595474485713
                 </td>
                 <td>
                  1.8703470342638246
                 </td>
                 <td>
                  28.108522932043783
                 </td>
                 <td>
                  0.09379126794717856
                 </td>
                 <td>
                  28.033949477325784
                 </td>
                 <td>
                  1.5380517627080292
                 </td>
                 <td>
                  27.780789284195393
                 </td>
                 <td>
                  0.05799107353694447
                 </td>
                 <td>
                  25.74353540142662
                 </td>
                 <td>
                  1.7358437874071797
                 </td>
                 <td>
                  27.873329527427543
                 </td>
                 <td>
                  0.07084681983834616
                 </td>
                 <td>
                  25.620810723619343
                 </td>
                 <td>
                  1.8129005233748647
                 </td>
                 <td>
                  27.87851782980156
                 </td>
                 <td>
                  0.0742292377178118
                 </td>
                 <td>
                  21.15342216887344
                 </td>
                 <td>
                  0.6264899234444314
                 </td>
                 <td>
                  28.086548407739905
                 </td>
                 <td>
                  0.03168871406956518
                 </td>
                 <td>
                  18.828253167515435
                 </td>
                 <td>
                  0.7475941257205684
                 </td>
                 <td>
                  28.212974926843625
                 </td>
                 <td>
                  0.0422763481530479
                 </td>
                 <td>
                  17.964611476673056
                 </td>
                 <td>
                  0.6596358378746425
                 </td>
                 <td>
                  28.263955427272954
                 </td>
                 <td>
                  0.039152252468897156
                 </td>
                 <td>
                  12.790064955174342
                 </td>
                 <td>
                  0.6722158462709532
                 </td>
                 <td>
                  28.632818124807635
                 </td>
                 <td>
                  0.055614737300165064
                 </td>
                 <td>
                  13.580929019180171
                 </td>
                 <td>
                  0.7400945376355254
                 </td>
                 <td>
                  28.567676301555696
                 </td>
                 <td>
                  0.05761144934684234
                 </td>
                </tr>
                <tr>
                 <td>
                  324
                 </td>
                 <td>
                  797.3397409211948
                 </td>
                 <td>
                  965.5478941851635
                 </td>
                 <td>
                  53.17069036467991,-27.797348081794517
                 </td>
                 <td>
                  121.0
                 </td>
                 <td>
                  3.0304070507432326
                 </td>
                 <td>
                  1.7633197784086392
                 </td>
                 <td>
                  0.4181244470190332
                 </td>
                 <td>
                  79.51657917516623
                 </td>
                 <td>
                  0.47716929153411286
                 </td>
                 <td>
                  45.619197067374266
                 </td>
                 <td>
                  2.6518036896533936
                 </td>
                 <td>
                  27.25213090726468
                 </td>
                 <td>
                  0.06134666408712654
                 </td>
                 <td>
                  50.392274387451174
                 </td>
                 <td>
                  2.0188186620215176
                 </td>
                 <td>
                  27.14409009976304
                 </td>
                 <td>
                  0.042648142618281884
                 </td>
                 <td>
                  49.831752268463035
                 </td>
                 <td>
                  2.3567748843702083
                 </td>
                 <td>
                  27.156234602905972
                 </td>
                 <td>
                  0.05017220419278036
                 </td>
                 <td>
                  48.61650529342564
                 </td>
                 <td>
                  2.4430655896970648
                 </td>
                 <td>
                  27.183040657043588
                 </td>
                 <td>
                  0.053233558465096836
                 </td>
                 <td>
                  33.58368869698832
                 </td>
                 <td>
                  0.7779020039869248
                 </td>
                 <td>
                  27.58467901105726
                 </td>
                 <td>
                  0.02486216210030647
                 </td>
                 <td>
                  23.755213036076142
                 </td>
                 <td>
                  0.8523243778218816
                 </td>
                 <td>
                  27.960602676216816
                 </td>
                 <td>
                  0.03827306144215809
                 </td>
                 <td>
                  23.023865642202438
                 </td>
                 <td>
                  0.7592225503052475
                 </td>
                 <td>
                  27.994554394409516
                 </td>
                 <td>
                  0.03522501022197596
                 </td>
                 <td>
                  19.63315929047223
                 </td>
                 <td>
                  0.8078373356779335
                 </td>
                 <td>
                  28.167524524558377
                 </td>
                 <td>
                  0.043779690921258704
                 </td>
                 <td>
                  18.68731450154886
                 </td>
                 <td>
                  0.8633253572661256
                 </td>
                 <td>
                  28.221132763267338
                 </td>
                 <td>
                  0.04903520245704538
                 </td>
                </tr>
                <tr>
                 <td>
                  325
                 </td>
                 <td>
                  790.7983558965504
                 </td>
                 <td>
                  979.5822296300561
                 </td>
                 <td>
                  53.17075198078638,-27.79723112632807
                 </td>
                 <td>
                  133.0
                 </td>
                 <td>
                  4.506451359665357
                 </td>
                 <td>
                  1.4930454629944043
                 </td>
                 <td>
                  0.6686871012615843
                 </td>
                 <td>
                  -44.19824469199431
                 </td>
                 <td>
                  0.42319913307021234
                 </td>
                 <td>
                  34.20989140732531
                 </td>
                 <td>
                  2.353623907194827
                 </td>
                 <td>
                  27.564620760991172
                 </td>
                 <td>
                  0.07224061925741257
                 </td>
                 <td>
                  36.57135465011538
                 </td>
                 <td>
                  1.7557905358129404
                 </td>
                 <td>
                  27.492147381341525
                 </td>
                 <td>
                  0.05091356095590353
                 </td>
                 <td>
                  42.68849561449194
                 </td>
                 <td>
                  2.2064786020905602
                 </td>
                 <td>
                  27.324222874751488
                 </td>
                 <td>
                  0.05471719094739571
                 </td>
                 <td>
                  45.99460251160774
                 </td>
                 <td>
                  2.382028845957703
                 </td>
                 <td>
                  27.243232824978676
                 </td>
                 <td>
                  0.054821883877762746
                 </td>
                 <td>
                  34.80004302822041
                 </td>
                 <td>
                  0.7822981639992332
                 </td>
                 <td>
                  27.54605054768332
                 </td>
                 <td>
                  0.02413684700611632
                 </td>
                 <td>
                  23.40568188262023
                 </td>
                 <td>
                  0.8462317452688509
                 </td>
                 <td>
                  27.976696754900892
                 </td>
                 <td>
                  0.03856178701393753
                 </td>
                 <td>
                  22.767378194807595
                 </td>
                 <td>
                  0.7438457465179379
                 </td>
                 <td>
                  28.006717445540055
                 </td>
                 <td>
                  0.03490554080327223
                 </td>
                 <td>
                  20.501256369918995
                 </td>
                 <td>
                  0.820549850987213
                 </td>
                 <td>
                  28.120548808604052
                 </td>
                 <td>
                  0.0426087886820206
                 </td>
                 <td>
                  19.089604206836878
                 </td>
                 <td>
                  0.8667809534858215
                 </td>
                 <td>
                  28.198007689828906
                 </td>
                 <td>
                  0.048212383021397735
                 </td>
                </tr>
                <tr>
                 <td>
                  326
                 </td>
                 <td>
                  307.76973240382
                 </td>
                 <td>
                  989.9933237644321
                 </td>
                 <td>
                  53.17530230279065,-27.797144093853966
                 </td>
                 <td>
                  36.0
                 </td>
                 <td>
                  1.7091274365898566
                 </td>
                 <td>
                  1.1796163441788732
                 </td>
                 <td>
                  0.30981369854286145
                 </td>
                 <td>
                  -57.75342780537102
                 </td>
                 <td>
                  0.3499708478753841
                 </td>
                 <td>
                  7.069500195287273
                 </td>
                 <td>
                  1.085848779284399
                 </td>
                 <td>
                  29.276528222969418
                 </td>
                 <td>
                  0.15513459701350368
                 </td>
                 <td>
                  6.559003957176758
                 </td>
                 <td>
                  0.7627753344146362
                 </td>
                 <td>
                  29.357905267698598
                 </td>
                 <td>
                  0.11944685102063901
                 </td>
                 <td>
                  6.183740011134048
                 </td>
                 <td>
                  0.8634612114747284
                 </td>
                 <td>
                  29.42187194540521
                 </td>
                 <td>
                  0.14191362621343498
                 </td>
                 <td>
                  8.837316659881695
                 </td>
                 <td>
                  1.0556391356824744
                 </td>
                 <td>
                  29.03419895757817
                 </td>
                 <td>
                  0.12251412891582383
                 </td>
                 <td>
                  5.903891204071303
                 </td>
                 <td>
                  0.3375812207664306
                 </td>
                 <td>
                  29.472154135545033
                 </td>
                 <td>
                  0.060371775836015065
                 </td>
                 <td>
                  4.765659788621438
                 </td>
                 <td>
                  0.400524443536207
                 </td>
                 <td>
                  29.70469241084787
                 </td>
                 <td>
                  0.08761713475141415
                 </td>
                 <td>
                  7.125902945739509
                 </td>
                 <td>
                  0.40872358703286327
                 </td>
                 <td>
                  29.267900242506997
                 </td>
                 <td>
                  0.060554569012257996
                 </td>
                 <td>
                  4.037502746172116
                 </td>
                 <td>
                  0.3858677684749164
                 </td>
                 <td>
                  29.884717923170992
                 </td>
                 <td>
                  0.09910121989210244
                 </td>
                 <td>
                  4.493111158366823
                 </td>
                 <td>
                  0.4338262357870153
                 </td>
                 <td>
                  29.768632092362214
                 </td>
                 <td>
                  0.10007470185186942
                 </td>
                </tr>
                <tr>
                 <td>
                  327
                 </td>
                 <td>
                  306.8506442261885
                 </td>
                 <td>
                  997.243644725512
                 </td>
                 <td>
                  53.1753109550711,-27.797083673855024
                 </td>
                 <td>
                  51.0
                 </td>
                 <td>
                  2.5021353669231527
                 </td>
                 <td>
                  1.4883885517566502
                 </td>
                 <td>
                  0.4051526662256868
                 </td>
                 <td>
                  15.388098948641728
                 </td>
                 <td>
                  0.24216628412005226
                 </td>
                 <td>
                  8.140192313568475
                 </td>
                 <td>
                  1.178307247237591
                 </td>
                 <td>
                  29.123413336752737
                 </td>
                 <td>
                  0.14677830945057577
                 </td>
                 <td>
                  10.621922820493326
                 </td>
                 <td>
                  0.9579591024597239
                 </td>
                 <td>
                  28.834492146285715
                 </td>
                 <td>
                  0.09375247385075143
                 </td>
                 <td>
                  10.735153071224346
                 </td>
                 <td>
                  1.1138972411155168
                 </td>
                 <td>
                  28.822979396580244
                 </td>
                 <td>
                  0.1071882554332464
                 </td>
                 <td>
                  12.643670520931202
                 </td>
                 <td>
                  1.2540115652526385
                 </td>
                 <td>
                  28.645317074711215
                 </td>
                 <td>
                  0.10267300679924707
                 </td>
                 <td>
                  9.553009517952841
                 </td>
                 <td>
                  0.41693523286415374
                 </td>
                 <td>
                  28.94964947388319
                 </td>
                 <td>
                  0.04638135299187599
                 </td>
                 <td>
                  9.153235549670372
                 </td>
                 <td>
                  0.5151314172293293
                 </td>
                 <td>
                  28.99606340336343
                 </td>
                 <td>
                  0.05944621805492528
                 </td>
                 <td>
                  10.167634753780487
                 </td>
                 <td>
                  0.4754200471048225
                 </td>
                 <td>
                  28.881950157725086
                 </td>
                 <td>
                  0.04961590355201818
                 </td>
                 <td>
                  7.872874739121797
                 </td>
                 <td>
                  0.5029271829323597
                 </td>
                 <td>
                  29.159666645795102
                 </td>
                 <td>
                  0.06723264138084344
                 </td>
                 <td>
                  7.568902388401964
                 </td>
                 <td>
                  0.5444025773994181
                 </td>
                 <td>
                  29.202417738905766
                 </td>
                 <td>
                  0.07541224065721709
                 </td>
                </tr>
               </table>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="save-photometry-as-output-catalog">
           <h2>
            Save photometry as output catalog
            <a class="headerlink" href="#save-photometry-as-output-catalog" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">tbl</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'JADESphotometry.ecsv'</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
           </div>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="o">!</span>head -175 JADESphotometry.ecsv  # show the first <span class="m">175</span> lines
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span># %ECSV 1.0
# ---
# datatype:
# - {name: label, datatype: int64}
# - {name: xcentroid, datatype: float64}
# - {name: ycentroid, datatype: float64}
# - {name: sky_centroid.ra, unit: deg, datatype: float64}
# - {name: sky_centroid.dec, unit: deg, datatype: float64}
# - {name: area, unit: pix2, datatype: float64}
# - {name: a, unit: pix, datatype: float64}
# - {name: b, unit: pix, datatype: float64}
# - {name: ellipticity, datatype: float64}
# - {name: orientation, unit: deg, datatype: float64}
# - {name: gini, datatype: float64}
# - {name: F090W_flux, unit: nJy, datatype: float64}
# - {name: F090W_fluxerr, unit: nJy, datatype: float64}
# - {name: F090W_mag, datatype: float64}
# - {name: F090W_magerr, datatype: float64}
# - {name: F115W_flux, unit: nJy, datatype: float64}
# - {name: F115W_fluxerr, unit: nJy, datatype: float64}
# - {name: F115W_mag, datatype: float64}
# - {name: F115W_magerr, datatype: float64}
# - {name: F150W_flux, unit: nJy, datatype: float64}
# - {name: F150W_fluxerr, unit: nJy, datatype: float64}
# - {name: F150W_mag, datatype: float64}
# - {name: F150W_magerr, datatype: float64}
# - {name: F200W_flux, unit: nJy, datatype: float64}
# - {name: F200W_fluxerr, unit: nJy, datatype: float64}
# - {name: F200W_mag, datatype: float64}
# - {name: F200W_magerr, datatype: float64}
# - {name: F277W_flux, unit: nJy, datatype: float64}
# - {name: F277W_fluxerr, unit: nJy, datatype: float64}
# - {name: F277W_mag, datatype: float64}
# - {name: F277W_magerr, datatype: float64}
# - {name: F335M_flux, unit: nJy, datatype: float64}
# - {name: F335M_fluxerr, unit: nJy, datatype: float64}
# - {name: F335M_mag, datatype: float64}
# - {name: F335M_magerr, datatype: float64}
# - {name: F356W_flux, unit: nJy, datatype: float64}
# - {name: F356W_fluxerr, unit: nJy, datatype: float64}
# - {name: F356W_mag, datatype: float64}
# - {name: F356W_magerr, datatype: float64}
# - {name: F410M_flux, unit: nJy, datatype: float64}
# - {name: F410M_fluxerr, unit: nJy, datatype: float64}
# - {name: F410M_mag, datatype: float64}
# - {name: F410M_magerr, datatype: float64}
# - {name: F444W_flux, unit: nJy, datatype: float64}
# - {name: F444W_fluxerr, unit: nJy, datatype: float64}
# - {name: F444W_mag, datatype: float64}
# - {name: F444W_magerr, datatype: float64}
# meta:
#   __serialized_columns__:
#     F090W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: &amp;id001 !astropy.units.Unit {unit: nJy}
#       value: !astropy.table.SerializedColumn {name: F090W_flux}
#     F090W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F090W_fluxerr}
#     F115W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F115W_flux}
#     F115W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F115W_fluxerr}
#     F150W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F150W_flux}
#     F150W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F150W_fluxerr}
#     F200W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F200W_flux}
#     F200W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F200W_fluxerr}
#     F277W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F277W_flux}
#     F277W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F277W_fluxerr}
#     F335M_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F335M_flux}
#     F335M_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F335M_fluxerr}
#     F356W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F356W_flux}
#     F356W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F356W_fluxerr}
#     F410M_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F410M_flux}
#     F410M_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F410M_fluxerr}
#     F444W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F444W_flux}
#     F444W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F444W_fluxerr}
#     a:
#       __class__: astropy.units.quantity.Quantity
#       unit: !astropy.units.Unit {unit: pix}
#       value: !astropy.table.SerializedColumn {name: a}
#     area:
#       __class__: astropy.units.quantity.Quantity
#       unit: !astropy.units.Unit {unit: pix2}
#       value: !astropy.table.SerializedColumn {name: area}
#     b:
#       __class__: astropy.units.quantity.Quantity
#       unit: !astropy.units.Unit {unit: pix}
#       value: !astropy.table.SerializedColumn {name: b}
#     ellipticity:
#       __class__: astropy.units.quantity.Quantity
#       unit: !astropy.units.Unit {unit: ''}
#       value: !astropy.table.SerializedColumn {name: ellipticity}
#     orientation:
#       __class__: astropy.units.quantity.Quantity
#       unit: &amp;id002 !astropy.units.Unit {unit: deg}
#       value: !astropy.table.SerializedColumn {name: orientation}
#     sky_centroid:
#       __class__: astropy.coordinates.sky_coordinate.SkyCoord
#       dec: !astropy.table.SerializedColumn
#         __class__: astropy.coordinates.angles.Latitude
#         unit: *id002
#         value: !astropy.table.SerializedColumn {name: sky_centroid.dec}
#       frame: icrs
#       ra: !astropy.table.SerializedColumn
#         __class__: astropy.coordinates.angles.Longitude
#         unit: *id002
#         value: !astropy.table.SerializedColumn {name: sky_centroid.ra}
#         wrap_angle: !astropy.coordinates.Angle
#           unit: *id002
#           value: 360.0
#       representation_type: spherical
#   date: 2022-06-08 19:52:49 UTC
#   version: {Python: 3.9.12, astropy: '5.1', bottleneck: 1.3.4, gwcs: 0.18.1, matplotlib: 3.5.2, numpy: 1.22.4, photutils: 1.4.0, scipy: 1.8.1,
#     skimage: 0.19.2, sklearn: null}
# schema: astropy-2.0
label xcentroid ycentroid sky_centroid.ra sky_centroid.dec area a b ellipticity orientation gini F090W_flux F090W_fluxerr F090W_mag F090W_magerr F115W_flux F115W_fluxerr F115W_mag F115W_magerr F150W_flux F150W_fluxerr F150W_mag F150W_magerr F200W_flux F200W_fluxerr F200W_mag F200W_magerr F277W_flux F277W_fluxerr F277W_mag F277W_magerr F335M_flux F335M_fluxerr F335M_mag F335M_magerr F356W_flux F356W_fluxerr F356W_mag F356W_magerr F410M_flux F410M_fluxerr F410M_mag F410M_magerr F444W_flux F444W_fluxerr F444W_mag F444W_magerr
1 466.24461350033647 8.7975642602371 53.17381009103326 -27.805320830365776 101.0 3.121883592723396 1.687718238373556 0.4593910412587602 -44.478947493786606 0.3750841422808698 9.172811374136076 0.8464272456741546 28.993743842627527 0.09583064251882532 15.251750665804146 0.7351866134486008 28.441700757864936 0.051113935660464196 18.356035098509803 0.9076155664349278 28.240552801409102 0.05239928633992559 20.355880166244727 0.9951286984899145 28.128275286137136 0.05182128829099082 15.30541463181222 0.37242909913150146 28.437887251597694 0.026103079843123198 14.02083788279239 0.4536467684272995 28.533065080581018 0.03457285577386587 14.174014573163747 0.3999261081137788 28.52126781262446 0.030210306451640984 13.880611681957355 0.46501162852267625 28.543978488116917 0.035777045316298495 13.807578444079855 0.4986392632950047 28.54970620192208 0.038518276199781994
2 104.80681791619065 18.0821294110356 53.17721522973072 -27.805243193448323 271.0 4.43307602055267 2.8904310038200527 0.34798523859744146 -26.549722105819686 0.4292034166747856 66.57967761225385 2.43625593694296 26.841645780216258 0.0390191974089124 67.80807330092654 1.7819304792547142 26.82179648873538 0.028163638950928188 70.39338412925109 2.1096858426785867 26.78117038947336 0.03206137981950343 77.74109040131492 2.318681567876357 26.6733734305523 0.031909302523638994 72.90069026757769 0.8318824113256227 26.743170898753043 0.012319367708500412 75.27250253951928 1.070603105909879 26.70840911249712 0.015333670289260427 71.48792896636016 0.9342131216075662 26.764418211087325 0.01409662645806182 61.42767389099904 0.9993087828855896 26.929089824977595 0.017520685942298195 57.2203760546637 1.051093157627436 27.00612323080047 0.019763151293857938
3 15.04416396551755 13.21870964358083 53.178060898531776 -27.805283643045666 8.0 0.8501945455843772 0.6682678017840504 0.21398248759086114 -38.1612276642421 0.10521135944081007 0.30189458075047043 0.22003285728886565 32.700361707101834 0.5943870285461557 0.7673344575647303 0.20049710455191738 31.68753824783774 0.25203769997123526 0.7185263104580911 0.22413744728361695 31.758893311421605 0.2947853370137946 0.9352163612291753 0.2577402310908106 31.47271975993688 0.2642813635409141 0.34971362332966227 0.06900286982371183 32.54071862281815 0.19551879280610807 0.5607617346802088 0.11336299849737182 32.02805407366013 0.19990472716017532 0.2668657682095152 0.07056536651518258 32.83426782771905 0.25473070870520814 -0.06031654176708369 0.08275804453775322 99.0 34.10547444921151 0.11765422427560634 0.08200758112663478 33.723481188078146 0.574218672619342
4 710.3242889701858 14.259777138086877 53.17151058505514 -27.805275444028442 25.0 1.2749753643104456 1.117371994707132 0.12361287442487268 -59.26178196559024 0.33737600483155716 2.6566836210797113 0.43714881228773556 30.33915040433974 0.1653923742295374 3.818279752499735 0.36055790754738243 29.94533063870602 0.09796938858281214 3.9761821744276116 0.4246250031936531 29.901334315002583 0.11016516567055634 3.5589744431503423 0.42659305165797895 30.02168782658959 0.12291324714108388 1.6962298219026282 0.12672768826931047 30.826288264009904 0.07822962940363361 1.590536535091481 0.16680910589172165 30.896140876425513 0.10828384762060109 1.9912255134558894 0.151127025768846 30.652198879435126 0.07942622592908809 1.9438353657449134 0.17889684257333507 30.67835130168316 0.09558932550457658 1.6253103136417588 0.17102441486844797 30.8726592718879 0.1086274373485027
5 434.52931528855504 22.221938204336567 53.17410887486057 -27.80520894064138 268.0 3.954114371118456 2.6317387394125484 0.33443029401596747 -8.167334484702078 0.5358632947802063 48.21536384426303 1.7917279404824316 27.19203637900948 0.039615375078573836 54.180491712205686 1.3655408576728798 27.065392644670535 0.02702525585364868 58.30054045382708 1.6237335307550271 26.98581854813561 0.02982550069042518 83.05102812663696 2.015269002596905 26.601637467123535 0.026031288898904284 133.15988061559287 1.0563434518773878 26.089066507204098 0.008579048595350228 133.46712655021906 1.2825865885346561 26.086564223686825 0.01038384697219314 144.03906284324478 1.2384188265720026 26.003799282319697 0.009295039598996597 161.60492000841137 1.4304450626852654 25.87886355352026 0.009568104243562612 148.3405102917476 1.5722804535154722 25.971850578368716 0.011447300801342226
6 289.38802515014896 17.281765562153954 53.17547627056455 -27.805250009193262 17.0 1.2913044931147235 1.1978568863866517 0.07236682535090477 68.12270923149859 0.18041073594089005 1.1303554308347756 0.3821670947419674 31.266962436913506 0.31621706491210366 1.5011462606731298 0.2867616114630805 30.958942478071556 0.18980531951535454 1.045624005692517 0.28930296367333985 31.35156113668441 0.2652049045520463 1.955256158588051 0.38221513653203576 30.671990843785842 0.1938565595483074 1.188616449626284 0.12368244418243222 31.212395659255414 0.10747756611504046 1.7708471014756073 0.19746701583101797 30.77954733764033 0.11478335606840086 1.4921438342127515 0.15067991684808457 30.96547327829425 0.10445071085094702 1.1433927169620364 0.17563750503987802 31.25451144606716 0.15514831191999282 0.5926553032606401 0.13657056678097335 31.967994562614585 0.22514973086947426
7 640.4863091995317 17.773429154661983 53.17216853452775 -27.805246129692247 21.0 1.5124916692884618 0.8803106550282112 0.41797322067741016 -64.72678377811528 0.257339933672325 1.7318562374159874 0.3544951971113632 30.80372040476935 0.20218906674628245 1.643429843026024 0.2498558061100988 30.86062207735413 0.1536624348793862 1.636102104727731 0.2840661458248788 30.865473991673777 0.17382220286646824 2.2295861313548446 0.3321415421916018 30.529439364296703 0.15077176392081712 1.0399598684843063 0.09617790287548722 31.35745854894559 0.09603604488615963 1.6537574517445193 0.1507209599380506 30.853820464729573 0.094699691326289 1.2604572236829945 0.11591912740405148 31.14867972112842 0.09552272603001735 0.40788132175057795 0.11575451167421515 32.37366545505972 0.2712388513520371 0.5688140707837224 0.10865005565010255 32.01257417244966 0.18978993015591247
8 762.7604138509574 28.298129971963505 53.17101657158984 -27.805158481182374 201.0 3.160486625451918 2.3639871661119467 0.25201798132149345 37.8486600348364 0.5424978595419511 52.90258045317187 1.7914935312003206 27.091307859172854 0.036158543593889224 55.89021246540487 1.3413162708320239 27.031660598550253 0.02574896528019833 61.671458415942496 1.630539484798694 26.92478945297725 0.028332995934327934 87.85194348648487 2.0332904975012602 26.540621566180963 0.024842449407777148 86.04008354445801 0.7878699856173026 26.563247941466912 0.009896854334870047 73.84294727616292 0.8942980843096469 26.729227444357107 0.013070161189289636 74.8225190478038 0.8372019588600241 26.714919186276617 0.012081025050606558 70.73942058751356 0.9010723240651843 26.775846254315468 0.013742667527438834 74.11117248879874 1.0396086825403072 26.725290789617205 0.015124537907185093
9 801.0706722163886 32.58026118517374 53.17065564474934 -27.805122812753073 12.0 1.3349434908844906 0.6567170220834244 0.5080563135685205 -28.75519616047975 0.28793220448127643 1.1246036170169136 0.30047864289476006 31.272501310051688 0.2571011445877932 1.2797476107076189 0.2305526012526087 31.13218918151494 0.17984738987799762 1.2734342232303713 0.2595936168660486 31.13755870689588 0.2014338114004866 1.3630620117794083 0.2799372864607707 31.063710964299986 0.20280440914679781 1.082787068323561 0.10030137862329397 31.313642349074232 0.09618538263285319 0.6781367101230981 0.1161012153749804 31.821706862430297 0.17158341526256443 0.5758891043153808 0.08989342817146666 31.999152845351176 0.15748383733187593 1.1076176036929606 0.13520585441853786 31.289025376253583 0.12504898101684045 1.113433002949251 0.1420534202367806 31.283339775099364 0.1303698266479056
10 707.3760560806973 39.28937571152668 53.17153834753934 -27.805066862704358 82.0 3.1307940806826573 1.6124555790789692 0.48496913641558326 55.8923927860422 0.27559239091193805 10.320029621240023 0.8280084227061209 28.86579764041479 0.08379374572241056 11.089034514793784 0.6115899311988519 28.787765661937883 0.05828826207510431 12.2321805913463 0.7376338189044386 28.681240289467137 0.0635746935977975 11.575204797587379 0.7530156078144226 28.74117829090995 0.06842926628135788 7.720035490573591 0.252221382763414 29.180951757798987 0.034904966837602545 5.038571438592023 0.2933627938516409 29.64423144870763 0.06144340846589908 5.174509545401452 0.24482649985590615 29.615327018938437 0.05019222350207672 4.692108713708783 0.29384965878495856 29.72157983515892 0.0659514558612371 3.979968869565824 0.2718794913443546 29.90030081217046 0.071745230494349
11 81.06347574585027 39.57607196082029 53.17743889735022 -27.805064056923975 41.0 1.759652484012289 1.2832033093920074 0.2707632211184684 58.57556167321943 0.34890100100068466 7.321077513618291 0.8325255800595969 29.238562487319882 0.11693640423307518 8.14747959616596 0.629891106639782 29.12244179617626 0.08085289793626055 7.441630639018473 0.7032530098617956 29.220829724329953 0.09804193611617099 7.594125218910888 0.7495987189379812 29.198805615227293 0.10220543147833863 5.263108091146871 0.22753908936904527 29.596894276407223 0.04595312039292095 4.137488474532359 0.28403445846500064 29.858158007484047 0.0720877122361088 3.798608579505653 0.2255054358147708 29.950938637999705 0.06261433074552476 3.242322029007169 0.2655807929209611 30.12285963251322 0.08547851693569392 2.8455383491268726 0.24868666309393583 30.26458889264752 0.09096862372607398
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="reformat-output-catalog-for-readability-optional">
           <h2>
            Reformat output catalog for readability (optional)
            <a class="headerlink" href="#reformat-output-catalog-for-readability-optional" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="c1"># Remove units (pixels) from area</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">'area'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">'area'</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Replace sky_centroid with ra, dec</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">'ra'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">'sky_centroid'</span><span class="p">]</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">degree</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">'dec'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">'sky_centroid'</span><span class="p">]</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">degree</span>

<span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tbl</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'ra'</span><span class="p">,</span> <span class="s1">'dec'</span><span class="p">]</span> <span class="o">+</span> <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="n">tbl</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
</pre>
              </div>
             </div>
            </div>
           </div>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">'.4f'</span>

<span class="n">tbl</span><span class="p">[</span><span class="s1">'ra'</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">'11.7f'</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">'dec'</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">'11.7f'</span>

<span class="n">tbl</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">'d'</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">'area'</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">'d'</span>
</pre>
              </div>
             </div>
            </div>
           </div>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">tbl</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'JADESphotometry.cat'</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">'ascii.fixed_width_two_line'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">' '</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
           </div>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="o">!</span>head -10 JADESphotometry.cat  # show the first <span class="m">10</span> lines
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output stream highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>label xcentroid ycentroid          ra         dec area       a      b ellipticity orientation   gini F090W_flux F090W_fluxerr F090W_mag F090W_magerr F115W_flux F115W_fluxerr F115W_mag F115W_magerr F150W_flux F150W_fluxerr F150W_mag F150W_magerr F200W_flux F200W_fluxerr F200W_mag F200W_magerr F277W_flux F277W_fluxerr F277W_mag F277W_magerr F335M_flux F335M_fluxerr F335M_mag F335M_magerr F356W_flux F356W_fluxerr F356W_mag F356W_magerr F410M_flux F410M_fluxerr F410M_mag F410M_magerr F444W_flux F444W_fluxerr F444W_mag F444W_magerr
----- --------- --------- ----------- ----------- ---- ------- ------ ----------- ----------- ------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------
    1  466.2446    8.7976  53.1738101 -27.8053208  101  3.1219 1.6877      0.4594    -44.4789 0.3751     9.1728        0.8464   28.9937       0.0958    15.2518        0.7352   28.4417       0.0511    18.3560        0.9076   28.2406       0.0524    20.3559        0.9951   28.1283       0.0518    15.3054        0.3724   28.4379       0.0261    14.0208        0.4536   28.5331       0.0346    14.1740        0.3999   28.5213       0.0302    13.8806        0.4650   28.5440       0.0358    13.8076        0.4986   28.5497       0.0385
    2  104.8068   18.0821  53.1772152 -27.8052432  271  4.4331 2.8904      0.3480    -26.5497 0.4292    66.5797        2.4363   26.8416       0.0390    67.8081        1.7819   26.8218       0.0282    70.3934        2.1097   26.7812       0.0321    77.7411        2.3187   26.6734       0.0319    72.9007        0.8319   26.7432       0.0123    75.2725        1.0706   26.7084       0.0153    71.4879        0.9342   26.7644       0.0141    61.4277        0.9993   26.9291       0.0175    57.2204        1.0511   27.0061       0.0198
    3   15.0442   13.2187  53.1780609 -27.8052836    8  0.8502 0.6683      0.2140    -38.1612 0.1052     0.3019        0.2200   32.7004       0.5944     0.7673        0.2005   31.6875       0.2520     0.7185        0.2241   31.7589       0.2948     0.9352        0.2577   31.4727       0.2643     0.3497        0.0690   32.5407       0.1955     0.5608        0.1134   32.0281       0.1999     0.2669        0.0706   32.8343       0.2547    -0.0603        0.0828   99.0000      34.1055     0.1177        0.0820   33.7235       0.5742
    4  710.3243   14.2598  53.1715106 -27.8052754   25  1.2750 1.1174      0.1236    -59.2618 0.3374     2.6567        0.4371   30.3392       0.1654     3.8183        0.3606   29.9453       0.0980     3.9762        0.4246   29.9013       0.1102     3.5590        0.4266   30.0217       0.1229     1.6962        0.1267   30.8263       0.0782     1.5905        0.1668   30.8961       0.1083     1.9912        0.1511   30.6522       0.0794     1.9438        0.1789   30.6784       0.0956     1.6253        0.1710   30.8727       0.1086
    5  434.5293   22.2219  53.1741089 -27.8052089  268  3.9541 2.6317      0.3344     -8.1673 0.5359    48.2154        1.7917   27.1920       0.0396    54.1805        1.3655   27.0654       0.0270    58.3005        1.6237   26.9858       0.0298    83.0510        2.0153   26.6016       0.0260   133.1599        1.0563   26.0891       0.0086   133.4671        1.2826   26.0866       0.0104   144.0391        1.2384   26.0038       0.0093   161.6049        1.4304   25.8789       0.0096   148.3405        1.5723   25.9719       0.0114
    6  289.3880   17.2818  53.1754763 -27.8052500   17  1.2913 1.1979      0.0724     68.1227 0.1804     1.1304        0.3822   31.2670       0.3162     1.5011        0.2868   30.9589       0.1898     1.0456        0.2893   31.3516       0.2652     1.9553        0.3822   30.6720       0.1939     1.1886        0.1237   31.2124       0.1075     1.7708        0.1975   30.7795       0.1148     1.4921        0.1507   30.9655       0.1045     1.1434        0.1756   31.2545       0.1551     0.5927        0.1366   31.9680       0.2251
    7  640.4863   17.7734  53.1721685 -27.8052461   21  1.5125 0.8803      0.4180    -64.7268 0.2573     1.7319        0.3545   30.8037       0.2022     1.6434        0.2499   30.8606       0.1537     1.6361        0.2841   30.8655       0.1738     2.2296        0.3321   30.5294       0.1508     1.0400        0.0962   31.3575       0.0960     1.6538        0.1507   30.8538       0.0947     1.2605        0.1159   31.1487       0.0955     0.4079        0.1158   32.3737       0.2712     0.5688        0.1087   32.0126       0.1898
    8  762.7604   28.2981  53.1710166 -27.8051585  201  3.1605 2.3640      0.2520     37.8487 0.5425    52.9026        1.7915   27.0913       0.0362    55.8902        1.3413   27.0317       0.0257    61.6715        1.6305   26.9248       0.0283    87.8519        2.0333   26.5406       0.0248    86.0401        0.7879   26.5632       0.0099    73.8429        0.8943   26.7292       0.0131    74.8225        0.8372   26.7149       0.0121    70.7394        0.9011   26.7758       0.0137    74.1112        1.0396   26.7253       0.0151
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
         </section>
         <section class="tex2jax_ignore mathjax_ignore" id="start-new-session-and-analyze-results">
          <h1>
           Start new session and analyze results
           <a class="headerlink" href="#start-new-session-and-analyze-results" title="Permalink to this headline">
            #
           </a>
          </h1>
          <section id="load-catalog-and-segmentation-map">
           <h2>
            Load catalog and segmentation map
            <a class="headerlink" href="#load-catalog-and-segmentation-map" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="c1"># Catalog: ecsv format preserves units for loading in Python notebooks</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">QTable</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'JADESphotometry.ecsv'</span><span class="p">)</span>

<span class="c1"># Reconstitute filter list</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">tbl</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">'_mag'</span><span class="p">:</span>
        <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Segmentation map</span>
<span class="n">segmfile</span> <span class="o">=</span> <span class="s1">'JADES_detections_segm.fits'</span>
<span class="n">segm</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">segmfile</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">segm</span> <span class="o">=</span> <span class="n">photutils</span><span class="o">.</span><span class="n">segmentation</span><span class="o">.</span><span class="n">SegmentationImage</span><span class="p">(</span><span class="n">segm</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="plot-number-counts-vs-magnitude">
           <h2>
            Plot number counts vs. magnitude
            <a class="headerlink" href="#plot-number-counts-vs-magnitude" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">filt</span> <span class="o">=</span> <span class="s1">'F200W'</span>
<span class="n">mag1</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span> <span class="o">+</span> <span class="s1">'_mag'</span><span class="p">]</span>

<span class="n">mag1</span> <span class="o">=</span> <span class="n">mag1</span><span class="p">[(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">mag1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mag1</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">)]</span>  <span class="c1"># detections only</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mag1</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">'step'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">filt</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'AB magnitude'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Number counts'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_plain highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>&lt;matplotlib.legend.Legend at 0x7f86b14072b0&gt;
</pre>
              </div>
             </div>
             <img alt="../../_images/NIRCam multiband photometry_44_1.png" src="../../_images/NIRCam multiband photometry_44_1.png"/>
            </div>
           </div>
          </section>
          <section id="plot-f200w-vs-f090w-magnitudes-and-look-for-dropouts">
           <h2>
            Plot F200W vs. F090W magnitudes and look for dropouts
            <a class="headerlink" href="#plot-f200w-vs-f090w-magnitudes-and-look-for-dropouts" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="c1">#import mplcursors</span>
<span class="c1"># Would love a better solution here!</span>

<span class="n">mag1</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">'F090W_mag'</span><span class="p">]</span>
<span class="n">mag2</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">'F200W_mag'</span><span class="p">]</span>

<span class="c1"># Only plot detections in F200W</span>
<span class="n">det2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">mag2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mag2</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">)</span>

<span class="n">mag1</span> <span class="o">=</span> <span class="n">mag1</span><span class="p">[</span><span class="n">det2</span><span class="p">]</span>
<span class="n">mag2</span> <span class="o">=</span> <span class="n">mag2</span><span class="p">[</span><span class="n">det2</span><span class="p">]</span>
<span class="n">ids</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">'label'</span><span class="p">][</span><span class="n">det2</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mag1</span><span class="p">,</span> <span class="n">mag2</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mag1</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mag1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mag2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'F090W AB magnitude'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'F200W AB magnitude'</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_plain highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>Text(0, 0.5, 'F200W AB magnitude')
</pre>
              </div>
             </div>
             <img alt="../../_images/NIRCam multiband photometry_46_1.png" src="../../_images/NIRCam multiband photometry_46_1.png"/>
            </div>
           </div>
          </section>
          <section id="look-at-one-object">
           <h2>
            Look at one object
            <a class="headerlink" href="#look-at-one-object" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="c1"># Could select object by position</span>
<span class="c1">#x, y = 905, 276</span>
<span class="c1">#id = segm.data[y,x]</span>

<span class="c1"># Select by ID number</span>
<span class="nb">id</span> <span class="o">=</span> <span class="mi">261</span>  <span class="c1"># F090W dropout</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="nb">id</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre>
              </div>
             </div>
            </div>
           </div>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">obj</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_html">
              <i>
               Row index=260
              </i>
              <table id="table140216220640976">
               <thead>
                <tr>
                 <th>
                  label
                 </th>
                 <th>
                  xcentroid
                 </th>
                 <th>
                  ycentroid
                 </th>
                 <th>
                  sky_centroid
                 </th>
                 <th>
                  area
                 </th>
                 <th>
                  a
                 </th>
                 <th>
                  b
                 </th>
                 <th>
                  ellipticity
                 </th>
                 <th>
                  orientation
                 </th>
                 <th>
                  gini
                 </th>
                 <th>
                  F090W_flux
                 </th>
                 <th>
                  F090W_fluxerr
                 </th>
                 <th>
                  F090W_mag
                 </th>
                 <th>
                  F090W_magerr
                 </th>
                 <th>
                  F115W_flux
                 </th>
                 <th>
                  F115W_fluxerr
                 </th>
                 <th>
                  F115W_mag
                 </th>
                 <th>
                  F115W_magerr
                 </th>
                 <th>
                  F150W_flux
                 </th>
                 <th>
                  F150W_fluxerr
                 </th>
                 <th>
                  F150W_mag
                 </th>
                 <th>
                  F150W_magerr
                 </th>
                 <th>
                  F200W_flux
                 </th>
                 <th>
                  F200W_fluxerr
                 </th>
                 <th>
                  F200W_mag
                 </th>
                 <th>
                  F200W_magerr
                 </th>
                 <th>
                  F277W_flux
                 </th>
                 <th>
                  F277W_fluxerr
                 </th>
                 <th>
                  F277W_mag
                 </th>
                 <th>
                  F277W_magerr
                 </th>
                 <th>
                  F335M_flux
                 </th>
                 <th>
                  F335M_fluxerr
                 </th>
                 <th>
                  F335M_mag
                 </th>
                 <th>
                  F335M_magerr
                 </th>
                 <th>
                  F356W_flux
                 </th>
                 <th>
                  F356W_fluxerr
                 </th>
                 <th>
                  F356W_mag
                 </th>
                 <th>
                  F356W_magerr
                 </th>
                 <th>
                  F410M_flux
                 </th>
                 <th>
                  F410M_fluxerr
                 </th>
                 <th>
                  F410M_mag
                 </th>
                 <th>
                  F410M_magerr
                 </th>
                 <th>
                  F444W_flux
                 </th>
                 <th>
                  F444W_fluxerr
                 </th>
                 <th>
                  F444W_mag
                 </th>
                 <th>
                  F444W_magerr
                 </th>
                </tr>
               </thead>
               <thead>
                <tr>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                  deg,deg
                 </th>
                 <th>
                  pix2
                 </th>
                 <th>
                  pix
                 </th>
                 <th>
                  pix
                 </th>
                 <th>
                 </th>
                 <th>
                  deg
                 </th>
                 <th>
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                  nJy
                 </th>
                 <th>
                 </th>
                 <th>
                 </th>
                </tr>
               </thead>
               <thead>
                <tr>
                 <th>
                  int64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  SkyCoord
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                 <th>
                  float64
                 </th>
                </tr>
               </thead>
               <tr>
                <td>
                 261
                </td>
                <td>
                 159.85524275404117
                </td>
                <td>
                 861.9318626458592
                </td>
                <td>
                 53.176695835547065,-27.798211159078907
                </td>
                <td>
                 84.0
                </td>
                <td>
                 2.093686819569325
                </td>
                <td>
                 1.79058244822613
                </td>
                <td>
                 0.14477063546951296
                </td>
                <td>
                 -19.69058730182542
                </td>
                <td>
                 0.45043886443149744
                </td>
                <td>
                 26.774434064613025
                </td>
                <td>
                 2.0658110901729394
                </td>
                <td>
                 27.830699250373154
                </td>
                <td>
                 0.08069661976679288
                </td>
                <td>
                 28.175269127668553
                </td>
                <td>
                 1.5397584962598831
                </td>
                <td>
                 27.775329817299298
                </td>
                <td>
                 0.05777016311636403
                </td>
                <td>
                 39.57360585028314
                </td>
                <td>
                 2.1084830072098417
                </td>
                <td>
                 27.40648594019712
                </td>
                <td>
                 0.05635962790702117
                </td>
                <td>
                 44.290538079545186
                </td>
                <td>
                 2.343861005477472
                </td>
                <td>
                 27.284222608750856
                </td>
                <td>
                 0.05598857116137783
                </td>
                <td>
                 37.57756572414375
                </td>
                <td>
                 0.8148383871956767
                </td>
                <td>
                 27.462678392335242
                </td>
                <td>
                 0.023291662964628788
                </td>
                <td>
                 25.27509316486492
                </td>
                <td>
                 0.8308497106067699
                </td>
                <td>
                 27.893268087273935
                </td>
                <td>
                 0.03511654568010063
                </td>
                <td>
                 26.943645179708977
                </td>
                <td>
                 0.7886404460448742
                </td>
                <td>
                 27.82385912339398
                </td>
                <td>
                 0.0313232846940502
                </td>
                <td>
                 30.95946346003939
                </td>
                <td>
                 0.9375521233464907
                </td>
                <td>
                 27.67301643605517
                </td>
                <td>
                 0.03239156248336977
                </td>
                <td>
                 27.219608981522722
                </td>
                <td>
                 1.008787266766099
                </td>
                <td>
                 27.812795294671048
                </td>
                <td>
                 0.03951080740432303
                </td>
               </tr>
              </table>
             </div>
            </div>
           </div>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">obj</span><span class="p">[</span><span class="s1">'ellipticity'</span><span class="p">]</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_latex math notranslate nohighlight">
              \[0.14477064 \; \mathrm{}\]
             </div>
            </div>
           </div>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">segmobj</span> <span class="o">=</span> <span class="n">segm</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="n">segm</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="nb">id</span><span class="p">)]</span>
<span class="n">segmobj</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_plain highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>&lt;photutils.segmentation.core.Segment&gt;
label: 261
slices: (slice(857, 867, None), slice(155, 166, None))
area: 84
</pre>
              </div>
             </div>
            </div>
           </div>
          </section>
          <section id="show-the-object-in-all-the-images">
           <h2>
            Show the object in all the images
            <a class="headerlink" href="#show-the-object-in-all-the-images" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="n">segmobj</span><span class="o">.</span><span class="n">slices</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">segmobj</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Color'</span><span class="p">)</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">segm</span><span class="o">.</span><span class="n">make_cmap</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>  <span class="c1"># ERROR</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">segm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">segmobj</span><span class="o">.</span><span class="n">slices</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">segmobj</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
               <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Segment'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">filt</span> <span class="o">=</span> <span class="n">filters</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Show data on top row</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imagefiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">stamp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">segmobj</span><span class="o">.</span><span class="n">slices</span><span class="p">]</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>  <span class="c1"># scale each filter individually</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">segmobj</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Greys_r'</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">filt</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

    <span class="c1"># Show weights on bottom row</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">stamp</span> <span class="o">=</span> <span class="n">weight</span><span class="p">[</span><span class="n">segmobj</span><span class="o">.</span><span class="n">slices</span><span class="p">]</span>
    <span class="c1"># set black to zero weight (no exposure time / bad pixel)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">segmobj</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Greys_r'</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Data'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Weight'</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_plain highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>Text(0, 0.5, 'Weight')
</pre>
              </div>
             </div>
             <img alt="../../_images/NIRCam multiband photometry_53_1.png" src="../../_images/NIRCam multiband photometry_53_1.png"/>
            </div>
           </div>
          </section>
          <section id="plot-sed-spectral-energy-distribution">
           <h2>
            Plot SED (Spectral Energy Distribution)
            <a class="headerlink" href="#plot-sed-spectral-energy-distribution" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">'_flux'</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">'_fluxerr'</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'.'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'b'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">':'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Wavelength ($\mu$m)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Flux (nJy)'</span><span class="p">)</span>

<span class="n">mlim</span> <span class="o">=</span> <span class="mf">31.4</span>
<span class="n">flim</span> <span class="o">=</span> <span class="n">mlim</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>
<span class="n">flim</span> <span class="o">=</span> <span class="n">flim</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">nJy</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="c1"># Add AB magnitudes as secondary x-axis at right</span>
<span class="c1"># https://matplotlib.org/gallery/subplots_axes_and_figures/secondary_axis.html#sphx-glr-gallery-subplots-axes-and-figures-secondary-axis-py</span>
<span class="k">def</span> <span class="nf">AB2nJy</span><span class="p">(</span><span class="n">mAB</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">mAB</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">nJy</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">value</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;</span> <span class="n">flim</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">flim</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>

<span class="k">def</span> <span class="nf">nJy2AB</span><span class="p">(</span><span class="n">F_nJy</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">F_nJy</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">nJy</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">value</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">m</span> <span class="o">&lt;</span> <span class="n">mlim</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">mlim</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">flim</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">secax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">secondary_yaxis</span><span class="p">(</span><span class="s1">'right'</span><span class="p">,</span> <span class="n">functions</span><span class="o">=</span><span class="p">(</span><span class="n">nJy2AB</span><span class="p">,</span> <span class="n">AB2nJy</span><span class="p">))</span>
<span class="n">secax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'magnitude (AB)'</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_plain highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>Text(0, 0.5, 'magnitude (AB)')
</pre>
              </div>
             </div>
             <img alt="../../_images/NIRCam multiband photometry_55_1.png" src="../../_images/NIRCam multiband photometry_55_1.png"/>
            </div>
           </div>
          </section>
          <section id="magnitude-conversion-fails-for-flux-0">
           <h2>
            Magnitude conversion fails for flux &lt;= 0
            <a class="headerlink" href="#magnitude-conversion-fails-for-flux-0" title="Permalink to this headline">
             #
            </a>
           </h2>
           <div class="cell docutils container">
            <div class="cell_input docutils container">
             <div class="highlight-ipython3 notranslate">
              <div class="highlight">
               <pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">'_flux'</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">'_fluxerr'</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'.'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'b'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">':'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Wavelength ($\mu$m)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Flux (nJy)'</span><span class="p">)</span>

<span class="n">f0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.4</span> <span class="o">*</span> <span class="mf">31.4</span><span class="p">)</span>  <span class="c1"># flux [nJy] at zero magnitude</span>
<span class="n">b0</span> <span class="o">=</span> <span class="mf">1.e-12</span>  <span class="c1"># this should be filter dependent</span>

<span class="c1"># Add AB magnitudes as secondary x-axis at right</span>
<span class="c1"># https://matplotlib.org/gallery/subplots_axes_and_figures/secondary_axis.html#sphx-glr-gallery-subplots-axes-and-figures-secondary-axis-py</span>
<span class="k">def</span> <span class="nf">AB2nJy</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">b0</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">f0</span>
    <span class="k">return</span> <span class="n">f</span>

<span class="c1"># Luptitudes</span>
<span class="c1"># https://www.sdss.org/dr12/algorithms/magnitudes/</span>
<span class="k">def</span> <span class="nf">nJy2AB</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">((</span><span class="n">f</span> <span class="o">/</span> <span class="n">f0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">b0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="c1">#plt.ylim(flim, plt.ylim()[1])</span>

<span class="n">secax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">secondary_yaxis</span><span class="p">(</span><span class="s1">'right'</span><span class="p">,</span> <span class="n">functions</span><span class="o">=</span><span class="p">(</span><span class="n">nJy2AB</span><span class="p">,</span> <span class="n">AB2nJy</span><span class="p">))</span>
<span class="n">secax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'asinh magnitude (AB)'</span><span class="p">)</span>
</pre>
              </div>
             </div>
            </div>
            <div class="cell_output docutils container">
             <div class="output text_plain highlight-myst-ansi notranslate">
              <div class="highlight">
               <pre><span></span>Text(0, 0.5, 'asinh magnitude (AB)')
</pre>
              </div>
             </div>
             <img alt="../../_images/NIRCam multiband photometry_57_1.png" src="../../_images/NIRCam multiband photometry_57_1.png"/>
            </div>
           </div>
          </section>
         </section>
         <script type="text/x-thebe-config">
          {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/jdat_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/NIRCam_photometry"
        },
        predefinedOutput: true
    }
         </script>
         <script>
          kernelName = 'python3'
         </script>
        </div>
       </main>
       <footer class="footer-article noprint">
        <!-- Previous / next buttons -->
        <div class="prev-next-area">
         <a class="left-prev" href="../aperture_photometry/NIRCam_Aperture_Photometry_Example.html" id="prev-link" title="previous page">
          <i class="fas fa-angle-left">
          </i>
          <div class="prev-next-info">
           <p class="prev-next-subtitle">
            previous
           </p>
           <p class="prev-next-title">
            Point Source Aperture Photometry
           </p>
          </div>
         </a>
         <a class="right-next" href="../psf_photometry/NIRCam_PSF_Photometry_Example.html" id="next-link" title="next page">
          <div class="prev-next-info">
           <p class="prev-next-subtitle">
            next
           </p>
           <p class="prev-next-title">
            PSF Photometry
           </p>
          </div>
          <i class="fas fa-angle-right">
          </i>
         </a>
        </div>
       </footer>
      </div>
     </div>
     <div class="footer-content row">
      <footer class="col footer">
       <p>
        By STScI
        <br/>
        © Copyright 2022.
        <br/>
       </p>
      </footer>
     </div>
    </div>
   </div>
  </div>
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  </script>
 </body>
</html>