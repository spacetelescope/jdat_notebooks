

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>MOS Spectroscopy of Extragalactic Field &#8212; STScI JDAT Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D46G4HKJY3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D46G4HKJY3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/mos-spectroscopy/MOSspec_sv06_revised';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/stsci_logo2.png" class="logo__image only-light" alt="STScI JDAT Notebooks - Home"/>
    <script>document.write(`<img src="../../_static/stsci_logo2.png" class="logo__image only-dark" alt="STScI JDAT Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">General</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/notebook_development_workflow.html">Notebook Development Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/submitting_notebooks.html">Submitting Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/requirements.html">Requirements file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/data_files.html">Data Files</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GitHub Guidelines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/github_setup.html">GitHub Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/github_workflow.html">GitHub Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/github_pr.html">GitHub PR</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cross-Instrument</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cross_instrument/asdf_example/asdf_example.html">ASDF Example</a></li>

<li class="toctree-l1"><a class="reference internal" href="../cross_instrument/background_estimation_imaging/Imaging_Sky_Background_Estimation.html">Complex 2D Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cross_instrument/composite_model_fitting/specfit_demo_3.html">Composite Model Spectral Fitting</a></li>


<li class="toctree-l1"><a class="reference internal" href="../cross_instrument/NIRSpec_MAST_Query/NIRSpec_MAST_Query.html">MAST Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cross_instrument/rgb_imviz/imviz_rgb_carina.html">RGB images with Imviz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cross_instrument/specviz_notebookGUI_interaction/specviz_notebook_gui_interaction_redshift.html">Specviz Simple Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cross_instrument/update_pure_parallel_wcs/NIRISS_correct_pure_parallel_WCS.html">Improving Accuracy of WCS of Pure Parallel Dataset</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MIRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../MIRI/MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html">MRS Mstar - Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI/MIRI_IFU_YSOs_in_the_LMC/isha_nayak_ysos_in_the_lmc.html">IFU of YSOs in LMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI/MIRI_LRS_spectral_extraction/miri_lrs_advanced_extraction_part1.html">LRS Optimal Spectral Extraction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRCam</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../NIRCam/aperture_photometry/NIRCam_Aperture_Photometry_Example.html">Point Source Aperture Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRCam/NIRCam_photometry/NIRCam_multiband_photometry.html">Extended Aperture Photometry</a></li>


<li class="toctree-l1"><a class="reference internal" href="../NIRCam/NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html">Cross-Filter PSF Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRCam/psf_photometry/NIRCam_PSF_Photometry_Example.html">PSF Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRCam/NIRCam_wisp_subtraction/nircam_wisp_subtraction.html">NIRCam Wisp Removal</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRISS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../NIRISS/NIRISS_WFSS_postpipeline/00_Optimal_extraction.html">WFSS Spectra - Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRISS/NIRISS_WFSS_postpipeline/01_Combine_and_normalize_1D_spectra.html">WFSS Spectra - Combine and Normalize 1D Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRISS/NIRISS_WFSS_postpipeline/02_Cross_correlation_template.html">WFSS Spectra - Cross-Correlation Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRISS/NIRISS_WFSS_postpipeline/03_Spatially_resolved_emission_line_map.html">WFSS Spectra - Emission Line Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRISS/NIRISS_WFSS_advanced/00_niriss_mast_query_data_setup.html">NIRISS MAST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRISS/NIRISS_WFSS_advanced/01_niriss_wfss_image2_image3.html">Direct imaging for WFSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRISS/NIRISS_WFSS_advanced/02_niriss_wfss_spec2.html">Spec2 pipeline for WFSS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRSpec</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/IFU_cube_continuum_fit/NGC4151_FeII_ContinuumFit.html">IFU Cube Fitting</a></li>

<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/cube_fitting/cube_fitting.html">IFU Cube Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/ifu_optimal/ifu_optimal.html">IFU Optimal Spectral Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/optimal_extraction/Spectral_Extraction-static.html">MOS Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/mos_spectroscopy_advanced/MOSspec_advanced.html">MOS Spectroscopy of Extragalactic Field</a></li>

<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/transit_spectroscopy_notebook/Exoplanet_Transmission_Spectra_JWST.html">BOTS Time Series Observations</a></li>








<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/galaxy_redshift/redshift_fitting.html">Redshift and Template Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/NIRSpec_NSClean/FS_NSClean_example.html">FS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/NIRSpec_NSClean/IFU_NSClean_example.html">IFU Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/NIRSpec_NSClean/MOS_NSClean_example.html">MOS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRSpec/NIRSpec_NSClean/BOTS_NSClean_example.html">BOTS Products with NSClean</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/mos-spectroscopy/MOSspec_sv06_revised.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/mos-spectroscopy/MOSspec_sv06_revised.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MOS Spectroscopy of Extragalactic Field</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-versions-should-be">Check versions. Should be:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-path-to-data-and-download-from-box-link">Set path to data and download from box link</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-one-galaxy">Choose one galaxy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-its-2d-spectrum">Inspect its 2D spectrum</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#developer-note">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-work-with-1d-spectrum">Now work with 1D spectrum</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrate-in-wavelength-inspect-and-write-in-spectrum1d-object">Calibrate (in wavelength), inspect, and write in Spectrum1D object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#go-with-specutils">Go with specutils</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Developer note</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smooth-to-better-inspect-the-features">Smooth to better inspect the features</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-the-non-smoothed-spectrum-to-find-lines">Back to the non-smoothed spectrum to find lines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#so-fit-continuum-first">So fit continuum first</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-continuum-subtracted-spectrum">Creating the continuum-subtracted spectrum</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-look-for-the-lines">Now look for the lines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#works-better-with-find-lines-threshold">Works better with find_lines_threshold</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Developer note</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measure-line-centroids-and-fluxes">Measure line centroids and fluxes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-the-line-with-a-gaussian">Fit the line with a Gaussian</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measure-the-equivalent-width-of-the-lines">Measure the equivalent width of the lines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-best-fitting-template">Find the best-fitting template</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-next-steps">Potential next steps:</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mos-spectroscopy-of-extragalactic-field">
<h1>MOS Spectroscopy of Extragalactic Field<a class="headerlink" href="#mos-spectroscopy-of-extragalactic-field" title="Permalink to this heading">#</a></h1>
<p><strong>Use case:</strong> emission-line measurements and template matching on 1D spectra.<br>
<strong>Data:</strong> <a class="reference external" href="https://www2.mpia-hd.mpg.de/home/legac/">LEGA-C</a> spectra and galaxy template spectra; optical rest-frame.<br>
<strong>Tools:</strong>  specutils, astropy, matplotlib, pandas.<br>
<strong>Cross-intrument:</strong> NIRSpec <br>
<strong>Documentation:</strong> This notebook is part of a STScI’s larger <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-post-pipeline-data-analysis">post-pipeline Data Analysis Tools Ecosystem</a>.<br></p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>This notebook will perform a seris of spectroscopic analyses on multiple spectra, including smoothing, continuum fitting and subtraction, line identification, centroiding and flux measurements, gaussian fitting, equivalent widths, and template fitting.</p>
<p><strong>Note:</strong> This notebook is intended to ultimately be compatible with the final data products (1D and 2D spectra) from the JWST pipeline. These data products are not available yet, so the notebook uses LEGA-C data (van der Wel et al. 2016, Straatmann et al. 2018) for now.</p>
<p>LEGA-C is a galaxy survey of about 3000 galaxies at z~0.8 and M* &gt; 10^10 M_sun in the COSMOS field. The spectra sample the rest-frame optical between ~3000A and 5000A at high resolution and very high signal-to-noise ratio. More information about the survey can be found here: http://www.mpia.de/home/legac/</p>
<p>First, set the environment with astroconda and specutils.</p>
<p><code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">create</span> <span class="pre">-n</span> <span class="pre">astroutils</span> <span class="pre">stsci</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">activate</span> <span class="pre">astroutils</span></code></p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#general os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.request</span>

<span class="c1">#general plotting</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span><span class="s1">&#39;18&#39;</span><span class="p">,</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span><span class="s1">&#39;18&#39;</span><span class="p">,</span>
        <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span><span class="s1">&#39;18&#39;</span><span class="p">,</span><span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span><span class="s1">&#39;18&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span><span class="s1">&#39;18&#39;</span><span class="p">,</span><span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;axes.linewidth&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;animation.html&#39;</span><span class="p">:</span> <span class="s1">&#39;html5&#39;</span><span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.max_open_warning&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

<span class="c1">#table/math handling</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>  <span class="c1"># hides irrelevant warnings about divide-by-zero, etc</span>

<span class="c1">#astropy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span><span class="p">,</span><span class="n">ascii</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.nddata</span><span class="w"> </span><span class="kn">import</span> <span class="n">StdDevUncertainty</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.modeling</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">quantity_support</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>

<span class="c1">#specutils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">specutils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">Spectrum1D</span><span class="p">,</span> <span class="n">SpectralRegion</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.manipulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">gaussian_smooth</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.fitting</span><span class="w"> </span><span class="kn">import</span> <span class="n">fit_generic_continuum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.fitting</span><span class="w"> </span><span class="kn">import</span> <span class="n">find_lines_derivative</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.fitting</span><span class="w"> </span><span class="kn">import</span> <span class="n">find_lines_threshold</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.fitting</span><span class="w"> </span><span class="kn">import</span> <span class="n">fit_lines</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.manipulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">noise_region_uncertainty</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">centroid</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">line_flux</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">equivalent_width</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">specutils.analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">template_comparison</span>

<span class="n">quantity_support</span><span class="p">();</span>  <span class="c1"># auto-recognizes units on matplotlib plots</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-versions-should-be">
<h2>Check versions. Should be:<a class="headerlink" href="#check-versions-should-be" title="Permalink to this heading">#</a></h2>
<p>Pandas:  1.0.1</p>
<p>Numpy:  1.18.1</p>
<p>Astropy:  4.0</p>
<p>Specutils:  0.7</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pandas: &quot;</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numpy: &quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Astropy: &quot;</span><span class="p">,</span><span class="n">astropy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Specutils: &quot;</span><span class="p">,</span><span class="n">specutils</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pandas:  2.1.4
Numpy:  1.26.2
Astropy:  6.0.0
Specutils:  1.12.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-path-to-data-and-download-from-box-link">
<h2>Set path to data and download from box link<a class="headerlink" href="#set-path-to-data-and-download-from-box-link" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boxlink</span> <span class="o">=</span> <span class="s1">&#39;https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/mos_spectroscopy/mos_spectroscopy.zip&#39;</span>
<span class="n">boxfile</span> <span class="o">=</span> <span class="s1">&#39;./mos_spectroscopy.zip&#39;</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">boxlink</span><span class="p">,</span> <span class="n">boxfile</span><span class="p">)</span>

<span class="n">zf</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">boxfile</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">zf</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span>

<span class="n">observedfiles</span> <span class="o">=</span> <span class="s1">&#39;./mos_spectroscopy/observed/&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="choose-one-galaxy">
<h2>Choose one galaxy<a class="headerlink" href="#choose-one-galaxy" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file1d</span> <span class="o">=</span> <span class="n">observedfiles</span> <span class="o">+</span> <span class="s1">&#39;legac_M1_v3.7_spec1d_130902.fits&#39;</span>
<span class="n">file1dwht</span> <span class="o">=</span> <span class="n">observedfiles</span> <span class="o">+</span> <span class="s1">&#39;legac_M1_v3.7_wht1d_130902.fits&#39;</span>
<span class="n">file2d</span> <span class="o">=</span> <span class="n">observedfiles</span> <span class="o">+</span> <span class="s1">&#39;legac_M1_v3.7_spec2d_130902.fits&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="inspect-its-2d-spectrum">
<h2>Inspect its 2D spectrum<a class="headerlink" href="#inspect-its-2d-spectrum" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu2d</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file2d</span><span class="p">)</span>
<span class="n">hdu2d</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: ./mos_spectroscopy/observed/legac_M1_v3.7_spec2d_130902.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     716   (6166, 81)   float32   
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu2d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SIMPLE  =                    T / file does conform to FITS standard             
BITPIX  =                  -32 / number of bits per data pixel                  
NAXIS   =                    2 / number of data axes                            
NAXIS1  =                 6166 / length of data axis 1                          
NAXIS2  =                   81 / length of data axis 2                          
EXTEND  =                    T / FITS dataset may contain extensions            
COMMENT   FITS (Flexible Image Transport System) format is defined in &#39;Astronomy
COMMENT   and Astrophysics&#39;, volume 376, page 359; bibcode: 2001A&amp;A...376..359H 
DATE    = &#39;2015-01-26T12:24:07&#39; / file creation date (YYYY-MM-DDThh:mm:ss UT)   
ORIGIN  = &#39;ESO     &#39;           / European Southern Observatory                  
MJD-OBS =       57040.16930682 / Obs start 2015-01-18T04:03:48.109              
DATE-OBS= &#39;2015-01-18T04:03:48.108&#39; / Date of observation                       
EXPTIME =             1199.997 / Total integration time. 00:19:59.997           
TELESCOP= &#39;ESO-VLT-U3&#39;         / ESO &lt;TEL&gt;                                      
RA      =           150.220555 / 10:00:52.9 RA (J2000) pointing                 
DEC     =              2.41104 / 02:24:39.7  DEC (J2000) pointing               
EQUINOX =                2000. / Standard FK5                                   
RADECSYS= &#39;FK5     &#39;           / Coordinate reference frame                     
LST     =            25866.379 / 07:11:06.379 LST at start                      
UTC     =               14623. / 04:03:43.000 UT at start                       
OBSERVER= &#39;VIMOS   &#39;           / Name of observer                               
INSTRUME= &#39;VIMOS   &#39;           / Instrument used                                
PI-COI  = &#39;555555555&#39;          / Name of PI and COI                             
OBJECT  = &#39;COSMOS_M01&#39;         / Original target                                
CRVAL1  =               5800.3 / 10:00:52.9, RA at ref pixel                    
CRPIX1  =                   1. / Reference pixel in X                           
CTYPE1  = &#39;LINEAR  &#39;           / pixel coordinate system                        
CRVAL2  =                   1. / 02:24:39.7, DEC at ref pixel                   
CRPIX2  =                   1. / Reference pixel in Y                           
CTYPE2  = &#39;PIXEL   &#39;           / pixel coordinate system                        
INHERIT =                    T / denotes the INHERIT keyword convention         
CD1_1   =                  0.6 / Translation matrix element                     
CD1_2   =                   0. / Translation matrix element                     
CD2_1   =                   0. / Translation matrix element                     
CD2_2   =                   1. / Translation matrix element                     
DATAMD5 = &#39;77a1ef86719040e2fea8d1d96fef35e0&#39; / MD5 checksum                     
PIPEFILE= &#39;mos_science_sky_extracted.fits&#39; / Filename of data product           
ARCFILE = &#39;VIMOS.2015-01-18T04:03:48.110.fits&#39; / Archive File Name              
HIERARCH ESO OBS DID = &#39;ESO-VLT-DIC.OBS-1.12&#39; / OBS Dictionary                  
HIERARCH ESO OBS EXECTIME = 6835 / Expected execution time                      
HIERARCH ESO OBS GRP = &#39;0       &#39; / linked blocks                               
HIERARCH ESO OBS ID =  1163772 / Observation block ID                           
HIERARCH ESO OBS NAME = &#39;legac_M01_2&#39; / OB name                                 
HIERARCH ESO OBS OBSERVER = &#39;UNKNOWN &#39; / Observer Name                          
HIERARCH ESO OBS PI-COI ID = 73498 / ESO internal PI-COI ID                     
HIERARCH ESO OBS PI-COI NAME = &#39;UNKNOWN &#39; / PI-COI name                         
HIERARCH ESO OBS PROG ID = &#39;194.A-2005(B)&#39; / ESO program identification         
HIERARCH ESO OBS START = &#39;2015-01-18T03:38:14&#39; / OB start time                  
HIERARCH ESO OBS NTPL =      3 / Number of templates within OB                  
HIERARCH ESO OBS TPLNO =     2 / Template number within OB                      
HIERARCH ESO OBS AIRM =     2. / Req. max. airmass                              
HIERARCH ESO OBS AMBI FWHM = 1.3 / Req. max. seeing                             
HIERARCH ESO OBS AMBI TRANS = &#39;2CLR    &#39; / Req. sky transparency                
HIERARCH ESO OBS ATM = &#39;NATM    &#39; / Req. Atmospheric Turbulence Model           
HIERARCH ESO OBS CONTAINER ID = -999 / Scheduling container ID                  
HIERARCH ESO OBS CONTAINER TYPE = &#39;U       &#39; / Scheduling container type        
HIERARCH ESO OBS MOON DIST = 120 / Req. min. angular dist. from moon            
HIERARCH ESO OBS MOON FLI = 0.3 / Req. max. fractional lunar illum.             
HIERARCH ESO OBS STREHLRATIO = 0. / Req. strehl ratio                           
HIERARCH ESO OBS TARG NAME = &#39;COSMOS_M01&#39; / OB target name                      
HIERARCH ESO OBS TWILIGHT = -15 / Req. twilight                                 
HIERARCH ESO OBS WATERVAPOUR = 0. / Req. water vapour                           
HIERARCH ESO TPL FILE DIRNAME = &#39;$INS_ROOT/$INS_USER/ADF&#39; / Storage filename    
HIERARCH ESO TPL FILE KEEP = T / paramfile keep-flag                            
HIERARCH ESO TPL DID = &#39;ESO-VLT-DIC.TPL-1.9&#39; / Data dictionary for TPL          
HIERARCH ESO TPL ID = &#39;VIMOS_mos_obs_Offset&#39; / Template signature ID            
HIERARCH ESO TPL NAME = &#39;MOS Observation&#39; / Template name                       
HIERARCH ESO TPL PRESEQ = &#39;VIMOS_mos_obs_Offset&#39; / Sequencer script             
HIERARCH ESO TPL START = &#39;2015-01-18T04:01:12&#39; / TPL start time                 
HIERARCH ESO TPL VERSION = &#39;@(#) $Revision: 77996 $&#39; / Version of the templa    
HIERARCH ESO TPL NEXP =      4 / Number of exposures within templat             
HIERARCH ESO TPL EXPNO =     1 / Exposure number within template                
HIERARCH ESO TEL DID = &#39;ESO-VLT-DIC.TCS&#39; / Data dictionary for TEL              
HIERARCH ESO TEL ID = &#39;v 261159&#39; / TCS version number                           
HIERARCH ESO TEL DATE = &#39;2000-01-01T00:00:00&#39; / TCS installation date           
HIERARCH ESO TEL ALT =  40.643 / Alt angle at start                             
HIERARCH ESO TEL AZ =  243.107 / Az angle at start S=0,W=90                     
HIERARCH ESO TEL GEOELEV = 2648. / Elevation above sea level (m)                
HIERARCH ESO TEL GEOLAT = -24.6268 / Tel geo latitute (+=North)                 
HIERARCH ESO TEL GEOLON = -70.4045 / Tel geo longitude (+=East)                 
HIERARCH ESO TEL OPER = &#39;I, Condor&#39; / Telescope Operator                        
HIERARCH ESO TEL FOCU ID = &#39;NB      &#39; / Telescope focus station ID              
HIERARCH ESO TEL FOCU LEN = 120. / Focal length                                 
HIERARCH ESO TEL FOCU SCALE = 1.718 / Focal scale                               
HIERARCH ESO TEL FOCU VALUE = -31.348 / M2 setting                              
HIERARCH ESO TEL PARANG START = -125.768 / Parallactic angle at start           
HIERARCH ESO TEL AIRM START = 1.533 / Airmass at start                          
HIERARCH ESO TEL AMBI FWHM START = 1.08 / Observatory Seeing queried from AS    
HIERARCH ESO TEL AMBI PRES START = 744.4 / Observatory ambient air pressure q   
HIERARCH ESO TEL AMBI WINDSP = 0.82 / Observatory ambient wind speed que        
HIERARCH ESO TEL AMBI WINDDIR = 325.5 / Observatory ambient wind direction      
HIERARCH ESO TEL AMBI RHUM = 3. / Observatory ambient relative humid            
HIERARCH ESO TEL AMBI TEMP = 15.77 / Observatory ambient temperature qu         
HIERARCH ESO TEL MOON RA = 265.331996 / 17:41:19.6 RA (J2000)                   
HIERARCH ESO TEL MOON DEC = -17.93387 / -17:56:01.9 DEC (J2000)                 
HIERARCH ESO TEL TH M1 TEMP = 13.63 / M1 superficial temperature                
HIERARCH ESO TEL TRAK STATUS = &#39;NORMAL  &#39; / Tracking status                     
HIERARCH ESO TEL DOME STATUS = &#39;FULLY-OPEN&#39; / Dome status                       
HIERARCH ESO TEL CHOP ST =   F / True when chopping is active                   
HIERARCH ESO TEL TARG ALPHA = 100052.8 / Alpha coordinate for the target        
HIERARCH ESO TEL TARG DELTA = 22436. / Delta coordinate for the target          
HIERARCH ESO TEL TARG EPOCH = 2000. / Epoch                                     
HIERARCH ESO TEL TARG EPOCHSYSTEM = &#39;J       &#39; / Epoch system (default J=Julian)
HIERARCH ESO TEL TARG EQUINOX = 2000. / Equinox                                 
HIERARCH ESO TEL TARG PMA = 0. / Proper Motion Alpha                            
HIERARCH ESO TEL TARG PMD = 0. / Proper motion Delta                            
HIERARCH ESO TEL TARG RADVEL = 0. / Radial velocity                             
HIERARCH ESO TEL TARG PARALLAX = 0. / Parallax                                  
HIERARCH ESO TEL TARG COORDTYPE = &#39;M       &#39; / Coordinate type (M=mean A=apparen
HIERARCH ESO TEL PARANG END = -128.789 / Parallactic angle at end               
HIERARCH ESO TEL AIRM END = 1.421 / Airmass at end                              
HIERARCH ESO TEL AMBI FWHM END = 1.03 / Observatory Seeing queried from AS      
HIERARCH ESO TEL IA FWHM =  1. / Delivered seeing corrected by airm             
HIERARCH ESO TEL IA FWHMLIN = 1.01 / Delivered seeing on IA detector (l         
HIERARCH ESO TEL IA FWHMLINOBS = 1.25 / Delivered seeing on IA detector (l      
HIERARCH ESO TEL AMBI PRES END = 744.3 / Observatory ambient air pressure q     
HIERARCH ESO TEL AMBI TAU0 = 0.0039 / Average coherence time                    
HIERARCH ESO TEL GS1 ALPHA = 100057.969 / Guide Star alpha                      
HIERARCH ESO TEL GS1 DELTA = 23539.05 / Guide Star delta                        
HIERARCH ESO TEL GS1 PPOS = &#39;NEG     &#39; / Selected probe position (POS or NE     
HIERARCH ESO TEL TARG NAME = &#39;        &#39; / Name of special target position       
HIERARCH ESO INS SWSIM = &#39;NORMAL  &#39; / Software simulation                       
HIERARCH ESO INS ID = &#39;VIMOS   &#39; / Instrument identification                    
HIERARCH ESO INS DID = &#39;ESO-VLT-DIC.VIMOS_ICS-242857&#39; / Data dictionary         
HIERARCH ESO INS SOFT DATE = &#39;Mar 20 2014&#39; / Instrument SW Release date         
HIERARCH ESO INS SOFT ID = &#39;186976  &#39; / Version of ICS                          
HIERARCH ESO INS FOCU1 TEMP = 14.61792 / Temperature(C) for the beam            
HIERARCH ESO INS ADF TYPE = &#39;MOS     &#39; / Type of ADF                            
HIERARCH ESO INS ADF VERSION = 3.28 / Version of ADF                            
HIERARCH ESO INS ADF UNIT = &#39;MILLIMETER&#39; / Unit of slit/object coordinates      
HIERARCH ESO INS ADF ID = &#39;legac_M1Q1_HR_Red_M1Q1.adp&#39; / Name for the ADF       
HIERARCH ESO INS ADF ADMID = &#39;2015-01-18T03:38:06-101-1.adm&#39; / Name for the *.  
HIERARCH ESO INS ADF COMMENT = &#39;        &#39; / Optional user comment for ADF       
HIERARCH ESO INS MASK1 ID = 103063 / Mask identification number                 
HIERARCH ESO INS ADF GRISM NAME = &#39;HR_Red  &#39; / Grism name                       
HIERARCH ESO INS ADF GRISM SPECTLEN = 4096. / Spectrum length in pixels         
HIERARCH ESO INS ADF SKYREG = 1.8 / Sky region in arcsec                        
HIERARCH ESO INS REF NO =    1 / Number of reference apertures                  
HIERARCH ESO INS ARC NO =    0 / Number of curved apertures                     
HIERARCH ESO INS SLIT NO =  33 / Number of all apertures but refere             
HIERARCH ESO INS SHU NO =    1 / Number of shutter positions                    
HIERARCH ESO INS SHU1 POSL = 0. / Lower shutter positions                       
HIERARCH ESO INS SHU1 POSH = 2440. / Upper shutter positions                    
HIERARCH ESO INS REF1 TYPE = &#39;SQUARE  &#39; / Type of REF i                         
HIERARCH ESO INS REF1 ID = 132308 / ID of REF i                                 
HIERARCH ESO INS REF1 OBJ RA = 150.345742 / RA (J2000) of object                
HIERARCH ESO INS REF1 OBJ DEC = 2.347825 / DEC (J2000) of object                
HIERARCH ESO INS REF1 X = -27.353 / x co-ordinate of REF i                      
HIERARCH ESO INS REF1 Y = 105.937 / y co-ordinate of REF i                      
HIERARCH ESO INS REF1 DIMX = 3.576 / Size in x direction of REF i               
HIERARCH ESO INS REF1 DIMY = 3.579 / Size in y direction of REF i               
HIERARCH ESO INS SLIT1 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT1 ID = 135357 / ID of SLIT i                               
HIERARCH ESO INS SLIT1 OBJ RA = 150.295375 / RA (J2000) of object               
HIERARCH ESO INS SLIT1 OBJ DEC = 2.387456 / DEC (J2000) of object               
HIERARCH ESO INS SLIT1 X = -114.091 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT1 Y = 0.598 / y co-ordinate of SLIT i                      
HIERARCH ESO INS SLIT1 DIMX = 11.926 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT1 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT2 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT2 ID = 135418 / ID of SLIT i                               
HIERARCH ESO INS SLIT2 OBJ RA = 150.294267 / RA (J2000) of object               
HIERARCH ESO INS SLIT2 OBJ DEC = 2.384864 / DEC (J2000) of object               
HIERARCH ESO INS SLIT2 X = -105.266 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT2 Y = -1.718 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT2 DIMX = 5.247 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT2 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT3 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT3 ID = 134929 / ID of SLIT i                               
HIERARCH ESO INS SLIT3 OBJ RA = 150.314113 / RA (J2000) of object               
HIERARCH ESO INS SLIT3 OBJ DEC = 2.381319 / DEC (J2000) of object               
HIERARCH ESO INS SLIT3 X = -98.833 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT3 Y = 39.782 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT3 DIMX = 7.155 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT3 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT4 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT4 ID = 134657 / ID of SLIT i                               
HIERARCH ESO INS SLIT4 OBJ RA = 150.333579 / RA (J2000) of object               
HIERARCH ESO INS SLIT4 OBJ DEC = 2.377983 / DEC (J2000) of object               
HIERARCH ESO INS SLIT4 X = -91.636 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT4 Y = 80.503 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT4 DIMX = 6.799 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT4 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT5 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT5 ID = 134371 / ID of SLIT i                               
HIERARCH ESO INS SLIT5 OBJ RA = 150.297429 / RA (J2000) of object               
HIERARCH ESO INS SLIT5 OBJ DEC = 2.374828 / DEC (J2000) of object               
HIERARCH ESO INS SLIT5 X = -84.818 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT5 Y = 4.892 / y co-ordinate of SLIT i                      
HIERARCH ESO INS SLIT5 DIMX = 6.318 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT5 DIMY = 0.581 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT6 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT6 ID = 134169 / ID of SLIT i                               
HIERARCH ESO INS SLIT6 OBJ RA = 150.29875 / RA (J2000) of object                
HIERARCH ESO INS SLIT6 OBJ DEC = 2.372181 / DEC (J2000) of object               
HIERARCH ESO INS SLIT6 X = -78.739 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT6 Y = 7.657 / y co-ordinate of SLIT i                      
HIERARCH ESO INS SLIT6 DIMX = 5.364 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT6 DIMY = 0.581 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT7 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT7 ID = 133783 / ID of SLIT i                               
HIERARCH ESO INS SLIT7 OBJ RA = 150.279029 / RA (J2000) of object               
HIERARCH ESO INS SLIT7 OBJ DEC = 2.368242 / DEC (J2000) of object               
HIERARCH ESO INS SLIT7 X = -71.828 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT7 Y = -33.576 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT7 DIMX = 7.987 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT7 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT8 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT8 ID = 133480 / ID of SLIT i                               
HIERARCH ESO INS SLIT8 OBJ RA = 150.338367 / RA (J2000) of object               
HIERARCH ESO INS SLIT8 OBJ DEC = 2.364314 / DEC (J2000) of object               
HIERARCH ESO INS SLIT8 X = -63.618 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT8 Y = 90.513 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT8 DIMX = 7.988 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT8 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT9 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT9 ID = 133163 / ID of SLIT i                               
HIERARCH ESO INS SLIT9 OBJ RA = 150.336546 / RA (J2000) of object               
HIERARCH ESO INS SLIT9 OBJ DEC = 2.36105 / DEC (J2000) of object                
HIERARCH ESO INS SLIT9 X = -56.106 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT9 Y = 86.692 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT9 DIMX = 6.557 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT9 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT10 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT10 ID = 133098 / ID of SLIT i                              
HIERARCH ESO INS SLIT10 OBJ RA = 150.292 / RA (J2000) of object                 
HIERARCH ESO INS SLIT10 OBJ DEC = 2.358644 / DEC (J2000) of object              
HIERARCH ESO INS SLIT10 X = -50.193 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT10 Y = -6.454 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT10 DIMX = 4.767 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT10 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT11 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT11 ID = 132633 / ID of SLIT i                              
HIERARCH ESO INS SLIT11 OBJ RA = 150.276625 / RA (J2000) of object              
HIERARCH ESO INS SLIT11 OBJ DEC = 2.355419 / DEC (J2000) of object              
HIERARCH ESO INS SLIT11 X = -44.294 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT11 Y = -38.594 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT11 DIMX = 6.555 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT11 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT12 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT12 ID = 132419 / ID of SLIT i                              
HIERARCH ESO INS SLIT12 OBJ RA = 150.280325 / RA (J2000) of object              
HIERARCH ESO INS SLIT12 OBJ DEC = 2.351606 / DEC (J2000) of object              
HIERARCH ESO INS SLIT12 X = -35.117 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT12 Y = -30.854 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT12 DIMX = 11.322 / Size in x direction of SLIT i           
HIERARCH ESO INS SLIT12 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT13 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT13 ID = 132048 / ID of SLIT i                              
HIERARCH ESO INS SLIT13 OBJ RA = 150.254533 / RA (J2000) of object              
HIERARCH ESO INS SLIT13 OBJ DEC = 2.343506 / DEC (J2000) of object              
HIERARCH ESO INS SLIT13 X = -20.753 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT13 Y = -84.791 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT13 DIMX = 9.297 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT13 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT14 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT14 ID = 131393 / ID of SLIT i                              
HIERARCH ESO INS SLIT14 OBJ RA = 150.300879 / RA (J2000) of object              
HIERARCH ESO INS SLIT14 OBJ DEC = 2.340411 / DEC (J2000) of object              
HIERARCH ESO INS SLIT14 X = -12.715 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT14 Y = 12.107 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT14 DIMX = 6.315 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT14 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT15 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT15 ID = 131127 / ID of SLIT i                              
HIERARCH ESO INS SLIT15 OBJ RA = 150.265312 / RA (J2000) of object              
HIERARCH ESO INS SLIT15 OBJ DEC = 2.337044 / DEC (J2000) of object              
HIERARCH ESO INS SLIT15 X = -5.918 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT15 Y = -62.244 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT15 DIMX = 6.793 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT15 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT16 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT16 ID = 131013 / ID of SLIT i                              
HIERARCH ESO INS SLIT16 OBJ RA = 150.283083 / RA (J2000) of object              
HIERARCH ESO INS SLIT16 OBJ DEC = 2.334078 / DEC (J2000) of object              
HIERARCH ESO INS SLIT16 X = 0.693 / x co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT16 Y = -25.086 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT16 DIMX = 5.958 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT16 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT17 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT17 ID = 130497 / ID of SLIT i                              
HIERARCH ESO INS SLIT17 OBJ RA = 150.326658 / RA (J2000) of object              
HIERARCH ESO INS SLIT17 OBJ DEC = 2.330731 / DEC (J2000) of object              
HIERARCH ESO INS SLIT17 X = 7.242 / x co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT17 Y = 66.006 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT17 DIMX = 6.673 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT17 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT18 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT18 ID = 130276 / ID of SLIT i                              
HIERARCH ESO INS SLIT18 OBJ RA = 150.348 / RA (J2000) of object                 
HIERARCH ESO INS SLIT18 OBJ DEC = 2.326914 / DEC (J2000) of object              
HIERARCH ESO INS SLIT18 X = 14.692 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT18 Y = 110.66 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT18 DIMX = 7.748 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT18 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT19 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT19 ID = 129957 / ID of SLIT i                              
HIERARCH ESO INS SLIT19 OBJ RA = 150.3202 / RA (J2000) of object                
HIERARCH ESO INS SLIT19 OBJ DEC = 2.323739 / DEC (J2000) of object              
HIERARCH ESO INS SLIT19 X = 22.018 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT19 Y = 52.509 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT19 DIMX = 6.435 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT19 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT20 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT20 ID = 129553 / ID of SLIT i                              
HIERARCH ESO INS SLIT20 OBJ RA = 150.2657 / RA (J2000) of object                
HIERARCH ESO INS SLIT20 OBJ DEC = 2.320875 / DEC (J2000) of object              
HIERARCH ESO INS SLIT20 X = 28.405 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT20 Y = -61.437 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT20 DIMX = 5.84 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT20 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT21 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT21 ID = 129940 / ID of SLIT i                              
HIERARCH ESO INS SLIT21 OBJ RA = 150.358563 / RA (J2000) of object              
HIERARCH ESO INS SLIT21 OBJ DEC = 2.317225 / DEC (J2000) of object              
HIERARCH ESO INS SLIT21 X = 35.264 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT21 Y = 132.797 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT21 DIMX = 7.394 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT21 DIMY = 0.583 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT22 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT22 ID = 129028 / ID of SLIT i                              
HIERARCH ESO INS SLIT22 OBJ RA = 150.302108 / RA (J2000) of object              
HIERARCH ESO INS SLIT22 OBJ DEC = 2.314742 / DEC (J2000) of object              
HIERARCH ESO INS SLIT22 X = 41.623 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT22 Y = 14.682 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT22 DIMX = 4.886 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT22 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT23 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT23 ID = 128901 / ID of SLIT i                              
HIERARCH ESO INS SLIT23 OBJ RA = 150.318517 / RA (J2000) of object              
HIERARCH ESO INS SLIT23 OBJ DEC = 2.31175 / DEC (J2000) of object               
HIERARCH ESO INS SLIT23 X = 47.343 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT23 Y = 48.991 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT23 DIMX = 6.079 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT23 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT24 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT24 ID = 128682 / ID of SLIT i                              
HIERARCH ESO INS SLIT24 OBJ RA = 150.324967 / RA (J2000) of object              
HIERARCH ESO INS SLIT24 OBJ DEC = 2.309175 / DEC (J2000) of object              
HIERARCH ESO INS SLIT24 X = 53.185 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT24 Y = 62.484 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT24 DIMX = 5.126 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT24 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT25 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT25 ID = 128528 / ID of SLIT i                              
HIERARCH ESO INS SLIT25 OBJ RA = 150.324742 / RA (J2000) of object              
HIERARCH ESO INS SLIT25 OBJ DEC = 2.305881 / DEC (J2000) of object              
HIERARCH ESO INS SLIT25 X = 59.324 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT25 Y = 62.007 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT25 DIMX = 6.676 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT25 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT26 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT26 ID = 128053 / ID of SLIT i                              
HIERARCH ESO INS SLIT26 OBJ RA = 150.301421 / RA (J2000) of object              
HIERARCH ESO INS SLIT26 OBJ DEC = 2.302322 / DEC (J2000) of object              
HIERARCH ESO INS SLIT26 X = 66.473 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT26 Y = 13.246 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT26 DIMX = 7.152 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT26 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT27 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT27 ID = 128133 / ID of SLIT i                              
HIERARCH ESO INS SLIT27 OBJ RA = 150.313362 / RA (J2000) of object              
HIERARCH ESO INS SLIT27 OBJ DEC = 2.299283 / DEC (J2000) of object              
HIERARCH ESO INS SLIT27 X = 73.388 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT27 Y = 38.213 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT27 DIMX = 6.199 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT27 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT28 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT28 ID = 127508 / ID of SLIT i                              
HIERARCH ESO INS SLIT28 OBJ RA = 150.323738 / RA (J2000) of object              
HIERARCH ESO INS SLIT28 OBJ DEC = 2.294797 / DEC (J2000) of object              
HIERARCH ESO INS SLIT28 X = 81.321 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT28 Y = 59.917 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT28 DIMX = 9.182 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT28 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT29 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT29 ID = 127314 / ID of SLIT i                              
HIERARCH ESO INS SLIT29 OBJ RA = 150.296713 / RA (J2000) of object              
HIERARCH ESO INS SLIT29 OBJ DEC = 2.291669 / DEC (J2000) of object              
HIERARCH ESO INS SLIT29 X = 89.244 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT29 Y = 3.402 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT29 DIMX = 6.2 / Size in x direction of SLIT i              
HIERARCH ESO INS SLIT29 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT30 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT30 ID = 127180 / ID of SLIT i                              
HIERARCH ESO INS SLIT30 OBJ RA = 150.317087 / RA (J2000) of object              
HIERARCH ESO INS SLIT30 OBJ DEC = 2.288025 / DEC (J2000) of object              
HIERARCH ESO INS SLIT30 X = 96.283 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT30 Y = 46.016 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT30 DIMX = 7.394 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT30 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT31 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT31 ID = 127438 / ID of SLIT i                              
HIERARCH ESO INS SLIT31 OBJ RA = 150.321308 / RA (J2000) of object              
HIERARCH ESO INS SLIT31 OBJ DEC = 2.28495 / DEC (J2000) of object               
HIERARCH ESO INS SLIT31 X = 103.324 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT31 Y = 54.842 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT31 DIMX = 6.203 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT31 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT32 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT32 ID = 126585 / ID of SLIT i                              
HIERARCH ESO INS SLIT32 OBJ RA = 150.324013 / RA (J2000) of object              
HIERARCH ESO INS SLIT32 OBJ DEC = 2.282417 / DEC (J2000) of object              
HIERARCH ESO INS SLIT32 X = 109.233 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT32 Y = 60.508 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT32 DIMX = 5.13 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT32 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT33 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT33 ID = 126275 / ID of SLIT i                              
HIERARCH ESO INS SLIT33 OBJ RA = 150.301817 / RA (J2000) of object              
HIERARCH ESO INS SLIT33 OBJ DEC = 2.279189 / DEC (J2000) of object              
HIERARCH ESO INS SLIT33 X = 117.03 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT33 Y = 14.079 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT33 DIMX = 10.02 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT33 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS PIXSCALE = 0.205 / Pixel scale                                 
HIERARCH ESO INS MODE = &#39;MOS     &#39; / Instrument Observation Mode                
HIERARCH ESO INS FILT1 FIX = F / Filter mode degraded                           
HIERARCH ESO INS FILT1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FILT1 NAME = &#39;GG475   &#39; / Filter name                          
HIERARCH ESO INS FILT1 ID = &#39;vm-GG475-1.10&#39; / Filter ESO ID                     
HIERARCH ESO INS MASK1 FIX = F / Mask mode degraded                             
HIERARCH ESO INS MASK1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS MASK1 NO =  3 / Mask set number                                
HIERARCH ESO INS FOCU1 FIX = F / Focusing mode degraded                         
HIERARCH ESO INS FOCU1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU1 VALUE = 6976.122982 / Camera lens position(micron)       
HIERARCH ESO INS FOCU3 FIX = F / Focusing mode degraded                         
HIERARCH ESO INS FOCU3 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU3 TEMP = 14.629684 / Temperature(C) for the beam           
HIERARCH ESO INS FOCU3 VALUE = 5181.099499 / Camera lens position(micron)       
HIERARCH ESO INS FOCU2 FIX = F / Focusing mode degraded                         
HIERARCH ESO INS FOCU2 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU2 TEMP = 14.841312 / Temperature(C) for the beam           
HIERARCH ESO INS FOCU2 VALUE = 6081.203659 / Camera lens position(micron)       
HIERARCH ESO INS MSHU1 FIX = F / Mask Shutter mode degraded                     
HIERARCH ESO INS MSHU1 SIM = T / Device Hardware Simulation                     
HIERARCH ESO INS MSHU1 MODE = &#39;OFF     &#39; / Mask Shutter mode                    
HIERARCH ESO INS MSHU1 POSH = 7.348085 / High Mask Shutters positions (mm)      
HIERARCH ESO INS MSHU1 POSL = 7.348085 / Low Mask Shutters position (mm)        
HIERARCH ESO INS GRIS1 FIX = F / Grism mode degraded                            
HIERARCH ESO INS GRIS1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS GRIS1 NAME = &#39;HR_red  &#39; / Grism name                           
HIERARCH ESO INS GRIS1 ID = &#39;vm-HRredHolog-1.1&#39; / Grism ESO ID                  
HIERARCH ESO INS AFC11 FIX = F / AFC mode degraded                              
HIERARCH ESO INS AFC11 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS AFC12 FIX = F / AFC mode degraded                              
HIERARCH ESO INS AFC12 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU4 FIX = F / Focusing mode degraded                         
HIERARCH ESO INS FOCU4 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU4 TEMP = 14.588951 / Temperature(C) for the beam           
HIERARCH ESO INS FOCU4 VALUE = 7108.120407 / Camera lens position(micron)       
HIERARCH ESO INS LAMP1 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP1 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP1 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP1 NAME = &#39;QTH50   &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP1 ID = &#39;vm-QTH50-1&#39; / Calib. lamp ESO identification       
HIERARCH ESO INS LAMP2 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP2 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP2 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP2 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP2 NAME = &#39;QTH10   &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP2 ID = &#39;vm-QTH10-2&#39; / Calib. lamp ESO identification       
HIERARCH ESO INS IFUM1 FIX = F / IFU Mask mode degraded                         
HIERARCH ESO INS IFUM1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS IFUM1 MODE = &#39;OFF     &#39; / IFU Mask mode                        
HIERARCH ESO INS LAMP3 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP3 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP3 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP3 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP3 NAME = &#39;He      &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP3 ID = &#39;vm-He-3 &#39; / Calib. lamp ESO identification         
HIERARCH ESO INS IFUM2 FIX = F / IFU Mask mode degraded                         
HIERARCH ESO INS IFUM2 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS IFUM2 MODE = &#39;OFF     &#39; / IFU Mask mode                        
HIERARCH ESO INS LAMP4 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP4 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP4 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP4 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP4 NAME = &#39;Ne      &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP4 ID = &#39;vm-Ne-4 &#39; / Calib. lamp ESO identification         
HIERARCH ESO INS LAMP5 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP5 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP5 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP5 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP5 NAME = &#39;Ar      &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP5 ID = &#39;vm-Ar-5 &#39; / Calib. lamp ESO identification         
HIERARCH ESO INS LAMP6 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP6 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP6 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP6 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP6 NAME = &#39;Afc     &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP6 ID = &#39;vm-Afc-6&#39; / Calib. lamp ESO identification         
HIERARCH ESO INS IFUE FIX =  F / IFU Elongator mode degraded                    
HIERARCH ESO INS IFUE SIM =  F / Device Hardware Simulation                     
HIERARCH ESO INS IFUE MAG = &#39;1:1     &#39; / IFU Magnification 0.33(1:2) or 0.6     
HIERARCH ESO INS IFUS FIX =  F / IFU Shutter mode degraded                      
HIERARCH ESO INS IFUS SIM =  F / Device Hardware Simulation                     
HIERARCH ESO INS IFUS MODE = &#39;OFF     &#39; / IFU Shutter CLOSED(ON) or OPEN(OFF    
HIERARCH ESO DET CHIP1 INDEX = 1 / Chip index                                   
HIERARCH ESO DET CHIP1 ID = &#39;BRIAN   &#39; / Detector chip identification           
HIERARCH ESO DET CHIP1 NAME = &#39;EEV CCD-44-82&#39; / Detector chip name              
HIERARCH ESO DET CHIP1 DATE = &#39;2000-08-30&#39; / Date of installation [YYYY-MM-DD]  
HIERARCH ESO DET CHIP1 X =   1 / X location in array                            
HIERARCH ESO DET CHIP1 Y =   1 / Y location in array                            
HIERARCH ESO DET CHIP1 NX = 2048 / # of pixels along X                          
HIERARCH ESO DET CHIP1 NY = 4096 / # of pixels along Y                          
HIERARCH ESO DET CHIP1 PSZX = 15. / Size of pixel in X                          
HIERARCH ESO DET CHIP1 PSZY = 15. / Size of pixel in Y                          
HIERARCH ESO DET CHIP1 XGAP = 0. / Gap between chips along x                    
HIERARCH ESO DET CHIP1 YGAP = 0. / Gap between chips along y                    
HIERARCH ESO DET OUT1 INDEX = 1 / Output index                                  
HIERARCH ESO DET OUT1 ID = &#39;L       &#39; / Output ID as from manufacturer          
HIERARCH ESO DET OUT1 NAME = &#39;L       &#39; / Description of output                 
HIERARCH ESO DET OUT1 CHIP = 1 / index of chip it belongs to                    
HIERARCH ESO DET OUT1 X =    1 / X location of output                           
HIERARCH ESO DET OUT1 Y =    1 / Y location of output                           
HIERARCH ESO DET OUT1 NX = 2048 / valid pixels along X                          
HIERARCH ESO DET OUT1 NY = 4096 / valid pixels along Y                          
HIERARCH ESO DET OUT1 CONAD = 0.55 / Conversion from ADUs to electrons          
HIERARCH ESO DET OUT1 RON = 3.21 / [e-] Readout noise per output (ele           
HIERARCH ESO DET OUT1 GAIN = 1.82 / Conversion from electrons to ADU            
HIERARCH ESO DET ID = &#39;CCD FIERA - Rev: 238334&#39; / Detector system Id            
HIERARCH ESO DET NAME = &#39;Vimosb - vimosb&#39; / Name of detector system             
HIERARCH ESO DET DATE = &#39;2010-07-01&#39; / Installation date                        
HIERARCH ESO DET DID = &#39;ESO-VLT-DIC.CCDDCS,ESO-VLT-DIC.FCDDCS&#39; / Diction        
HIERARCH ESO DET BITS =     16 / Bits per pixel readout                         
HIERARCH ESO DET RA =       0. / Apparent 00:00:00.0 RA at start                
HIERARCH ESO DET DEC =      0. / Apparent 00:00:00.0 DEC at start               
HIERARCH ESO DET CHIPS =     1 / # of chips in detector array                   
HIERARCH ESO DET OUTPUTS =   1 / # of outputs                                   
HIERARCH ESO DET OUTREF =    0 / reference output                               
HIERARCH ESO DET WINDOWS =   1 / # of windows readout                           
HIERARCH ESO DET SOFW MODE = &#39;Normal  &#39; / CCD sw operational mode               
HIERARCH ESO DET EXP NO = 42197 / Unique exposure ID number                     
HIERARCH ESO DET EXP TYPE = &#39;Normal  &#39; / Exposure type                          
HIERARCH ESO DET EXP RDTTIME = 30.939 / image readout time                      
HIERARCH ESO DET EXP XFERTIM = 44.981 / image transfer time                     
HIERARCH ESO DET WIN1 ST =   T / If T, window enabled                           
HIERARCH ESO DET WIN1 STRX = 1 / Lower left pixel in X                          
HIERARCH ESO DET WIN1 STRY = 1 / Lower left pixel in Y                          
HIERARCH ESO DET WIN1 NX = 2148 / # of pixels along X                           
HIERARCH ESO DET WIN1 NY = 4096 / # of pixels along Y                           
HIERARCH ESO DET WIN1 BINX = 1 / Binning factor along X                         
HIERARCH ESO DET WIN1 BINY = 1 / Binning factor along Y                         
HIERARCH ESO DET WIN1 NDIT = 1 / # of subintegrations                           
HIERARCH ESO DET WIN1 UIT1 = 1200. / user defined subintegration time           
HIERARCH ESO DET WIN1 DIT1 = 1199.997383 / actual subintegration time           
HIERARCH ESO DET WIN1 DKTM = 1200.0992 / Dark current time                      
HIERARCH ESO DET READ MODE = &#39;normal  &#39; / Readout method                        
HIERARCH ESO DET READ SPEED = &#39;medium  &#39; / Readout speed                        
HIERARCH ESO DET READ CLOCK = &#39;225kHz,1port,HG&#39; / Readout clock pattern used    
HIERARCH ESO DET READ NFRAM = 1 / Number of readouts buffered in sin            
HIERARCH ESO DET FRAM ID =   1 / Image sequencial number                        
HIERARCH ESO DET FRAM TYPE = &#39;Normal  &#39; / Type of frame                         
HIERARCH ESO DET SHUT TYPE = &#39;seso    &#39; / type of shutter                       
HIERARCH ESO DET SHUT ID = &#39;VIMOS shutter&#39; / Shutter unique identifier          
HIERARCH ESO DET SHUT TMOPEN = 0.074 / Time taken to open shutter               
HIERARCH ESO DET SHUT TMCLOS = 0.069 / Time taken to close shutter              
HIERARCH ESO DET TELE INT = 900. / Interval between two successive te           
HIERARCH ESO DET TELE NO =   7 / # of sources active                            
HIERARCH ESO DET TLM1 NAME = &#39;CCD Cold Plate&#39; / Description of telemetry param  
HIERARCH ESO DET TLM1 ID = &#39;CCD_B1_T1&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM1 START = 140.1 / Telemetry value at read start             
HIERARCH ESO DET TLM1 END = 139.9 / Telemetry value at read completion          
HIERARCH ESO DET TLM2 NAME = &#39;CCD Cold Plate2&#39; / Description of telemetry para  
HIERARCH ESO DET TLM2 ID = &#39;CCD_B1_T2&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM2 START = 151.6 / Telemetry value at read start             
HIERARCH ESO DET TLM2 END = 151.4 / Telemetry value at read completion          
HIERARCH ESO DET TLM3 NAME = &#39;CCD Cold Plate&#39; / Description of telemetry param  
HIERARCH ESO DET TLM3 ID = &#39;CCD_B4_T1&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM3 START = 140. / Telemetry value at read start              
HIERARCH ESO DET TLM3 END = 140. / Telemetry value at read completion           
HIERARCH ESO DET TLM4 NAME = &#39;CCD Cold Plate2&#39; / Description of telemetry para  
HIERARCH ESO DET TLM4 ID = &#39;CCD_B4_T2&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM4 START = 140.6 / Telemetry value at read start             
HIERARCH ESO DET TLM4 END = 140.6 / Telemetry value at read completion          
HIERARCH ESO DET TLM5 NAME = &#39;FBOX    &#39; / Description of telemetry param.       
HIERARCH ESO DET TLM5 ID = &#39;FBOX    &#39; / ID of telemetry sensor                  
HIERARCH ESO DET TLM5 START = 288.8 / Telemetry value at read start             
HIERARCH ESO DET TLM5 END = 288.7 / Telemetry value at read completion          
HIERARCH ESO DET TLM6 NAME = &#39;Vaccum_B1&#39; / Description of telemetry param.      
HIERARCH ESO DET TLM6 ID = &#39;Vaccum_B1&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM6 START = 0. / Telemetry value at read start                
HIERARCH ESO DET TLM6 END = 0. / Telemetry value at read completion             
HIERARCH ESO DET TLM7 NAME = &#39;Vaccum_B4&#39; / Description of telemetry param.      
HIERARCH ESO DET TLM7 ID = &#39;Vaccum_B4&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM7 START = 0. / Telemetry value at read start                
HIERARCH ESO DET TLM7 END = 0. / Telemetry value at read completion             
HIERARCH ESO PRO EXPTTOT = 4799.988                                             
HIERARCH ESO PRO ANCESTOR = &#39;VIMOS.2015-01-18T04:03:48.110.fits&#39;                
HIERARCH ESO PRO DID = &#39;PRO-1.15&#39; / Data dictionary for PRO                     
HIERARCH ESO PRO CATG = &#39;MOS_SCIENCE_SKY_EXTRACTED&#39; / Category of pipeline produ
HIERARCH ESO PRO TYPE = &#39;REDUCED &#39; / Product type                               
HIERARCH ESO PRO TECH = &#39;MOS     &#39; / Observation technique                      
HIERARCH ESO PRO SCIENCE =   T / Scientific product if T                        
HIERARCH ESO PRO REC1 ID = &#39;vmmosscience&#39; / Pipeline recipe (unique) identifier 
HIERARCH ESO PRO REC1 DRS ID = &#39;cpl-6.5.1&#39; / Data Reduction System identifier   
HIERARCH ESO PRO REC1 PIPE ID = &#39;vimos-2.9.15&#39; / Pipeline (unique) identifier   
HIERARCH ESO PRO REC1 RAW1 NAME = &#39;VIMOS.2015-01-18T04:03:48.110.fits&#39; / File na
HIERARCH ESO PRO REC1 RAW1 CATG = &#39;MOS_SCIENCE&#39; / Category of raw frame         
HIERARCH ESO PRO REC1 RAW2 NAME = &#39;VIMOS.2015-01-18T04:24:43.107.fits&#39; / File na
HIERARCH ESO PRO REC1 RAW2 CATG = &#39;MOS_SCIENCE&#39; / Category of raw frame         
HIERARCH ESO PRO REC1 RAW3 NAME = &#39;VIMOS.2015-01-18T04:45:38.102.fits&#39; / File na
HIERARCH ESO PRO REC1 RAW3 CATG = &#39;MOS_SCIENCE&#39; / Category of raw frame         
HIERARCH ESO PRO REC1 RAW4 NAME = &#39;VIMOS.2015-01-18T05:06:33.097.fits&#39; / File na
HIERARCH ESO PRO REC1 RAW4 CATG = &#39;MOS_SCIENCE&#39; / Category of raw frame         
HIERARCH ESO PRO DATANCOM =  4 / Number of combined frames                      
HIERARCH ESO PRO REC1 CAL1 NAME = &#39;M.VIMOS.2010-08-19T16:16:17.563.fits&#39; / File 
HIERARCH ESO PRO REC1 CAL1 CATG = &#39;CONFIG_TABLE&#39; / Category of calibration frame
HIERARCH ESO PRO REC1 CAL1 DATAMD5 = &#39;827358dea0214d1587a3f99820ec5810&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL2 NAME = &#39;master_bias.fits&#39; / File name of calibration 
HIERARCH ESO PRO REC1 CAL2 CATG = &#39;MASTER_BIAS&#39; / Category of calibration frame 
HIERARCH ESO PRO REC1 CAL2 DATAMD5 = &#39;e61a66abf72ac06c6b41c8c3770404e3&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL3 NAME = &#39;mos_curv_coeff.fits&#39; / File name of calibrati
HIERARCH ESO PRO REC1 CAL3 CATG = &#39;MOS_CURV_COEFF&#39; / Category of calibration fra
HIERARCH ESO PRO REC1 CAL3 DATAMD5 = &#39;8c4b8da9b95016a47162e7a44741b6e9&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL4 NAME = &#39;mos_disp_coeff.fits&#39; / File name of calibrati
HIERARCH ESO PRO REC1 CAL4 CATG = &#39;MOS_DISP_COEFF&#39; / Category of calibration fra
HIERARCH ESO PRO REC1 CAL4 DATAMD5 = &#39;1c1a4eb0e8edb0d621c99d716b0c63ae&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL5 NAME = &#39;mos_master_screen_flat.fits&#39; / File name of c
HIERARCH ESO PRO REC1 CAL5 CATG = &#39;MOS_MASTER_SCREEN_FLAT&#39; / Category of calibra
HIERARCH ESO PRO REC1 CAL5 DATAMD5 = &#39;0f2d03e3af5e30f7485a0a300f70b02f&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL6 NAME = &#39;mos_slit_location.fits&#39; / File name of calibr
HIERARCH ESO PRO REC1 CAL6 CATG = &#39;MOS_SLIT_LOCATION&#39; / Category of calibration 
HIERARCH ESO PRO REC1 CAL6 DATAMD5 = &#39;f53c43722c662a5763c5b94db9b2468e&#39; / MD5 si
HIERARCH ESO PRO REC1 PARAM1 NAME = &#39;dispersion&#39; / Resampling step (Angstrom/pix
HIERARCH ESO PRO REC1 PARAM1 VALUE = &#39;0.6     &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM2 NAME = &#39;skyalign&#39; / Polynomial order for sky lines 
HIERARCH ESO PRO REC1 PARAM2 VALUE = &#39;0       &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM3 NAME = &#39;wcolumn &#39; / Name of sky line catalog table 
HIERARCH ESO PRO REC1 PARAM3 VALUE = &#39;WLEN    &#39; / Default: &#39;WLEN&#39;               
HIERARCH ESO PRO REC1 PARAM4 NAME = &#39;startwavelength&#39; / Start wavelength in spec
HIERARCH ESO PRO REC1 PARAM4 VALUE = &#39;5800    &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM5 NAME = &#39;endwavelength&#39; / End wavelength in spectral
HIERARCH ESO PRO REC1 PARAM5 VALUE = &#39;9500    &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM6 NAME = &#39;reference&#39; / Reference wavelength for calib
HIERARCH ESO PRO REC1 PARAM6 VALUE = &#39;7948.18 &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM7 NAME = &#39;flux    &#39; / Apply flux conservation        
HIERARCH ESO PRO REC1 PARAM7 VALUE = &#39;true    &#39; / Default: true                 
HIERARCH ESO PRO REC1 PARAM8 NAME = &#39;flatfield&#39; / Apply flat field              
HIERARCH ESO PRO REC1 PARAM8 VALUE = &#39;true    &#39; / Default: true                 
HIERARCH ESO PRO REC1 PARAM9 NAME = &#39;skyglobal&#39; / Subtract global sky spectrum f
HIERARCH ESO PRO REC1 PARAM9 VALUE = &#39;false   &#39; / Default: false                
HIERARCH ESO PRO REC1 PARAM10 NAME = &#39;skymedian&#39; / Sky subtraction from extracte
HIERARCH ESO PRO REC1 PARAM10 VALUE = &#39;false   &#39; / Default: false               
HIERARCH ESO PRO REC1 PARAM11 NAME = &#39;skylocal&#39; / Sky subtraction from CCD slit 
HIERARCH ESO PRO REC1 PARAM11 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM12 NAME = &#39;cosmics &#39; / Eliminate cosmic rays hits (on
HIERARCH ESO PRO REC1 PARAM12 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM13 NAME = &#39;slit_margin&#39; / Number of pixels to exclude
HIERARCH ESO PRO REC1 PARAM13 VALUE = &#39;3       &#39; / Default: 3                   
HIERARCH ESO PRO REC1 PARAM14 NAME = &#39;ext_radius&#39; / Maximum extraction radius fo
HIERARCH ESO PRO REC1 PARAM14 VALUE = &#39;6       &#39; / Default: 6                   
HIERARCH ESO PRO REC1 PARAM15 NAME = &#39;cont_radius&#39; / Minimum distance at which t
HIERARCH ESO PRO REC1 PARAM15 VALUE = &#39;0       &#39; / Default: 0                   
HIERARCH ESO PRO REC1 PARAM16 NAME = &#39;ext_mode&#39; / Object extraction method: 0 = 
HIERARCH ESO PRO REC1 PARAM16 VALUE = &#39;1       &#39; / Default: 1                   
HIERARCH ESO PRO REC1 PARAM17 NAME = &#39;detection&#39; / Object detection threshold (A
HIERARCH ESO PRO REC1 PARAM17 VALUE = &#39;2       &#39; / Default: 2                   
HIERARCH ESO PRO REC1 PARAM18 NAME = &#39;time_normalise&#39; / Normalise output spectra
HIERARCH ESO PRO REC1 PARAM18 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM19 NAME = &#39;anyframe&#39; / Look for a standard star in an
HIERARCH ESO PRO REC1 PARAM19 VALUE = &#39;false   &#39; / Default: false               
HIERARCH ESO PRO REC1 PARAM20 NAME = &#39;response&#39; / Order of polynomial modeling t
HIERARCH ESO PRO REC1 PARAM20 VALUE = &#39;5       &#39; / Default: 5                   
HIERARCH ESO PRO REC1 PARAM21 NAME = &#39;alignment&#39; / Type of alignment of dithered
HIERARCH ESO PRO REC1 PARAM21 VALUE = &#39;integer &#39; / Default: &#39;integer&#39;           
HIERARCH ESO PRO REC1 PARAM22 NAME = &#39;stack_method&#39; / Frames combination method 
HIERARCH ESO PRO REC1 PARAM22 VALUE = &#39;average &#39; / Default: &#39;average&#39;           
HIERARCH ESO PRO REC1 PARAM23 NAME = &#39;minrejection&#39; / Number of lowest values to
HIERARCH ESO PRO REC1 PARAM23 VALUE = &#39;1       &#39; / Default: 1                   
HIERARCH ESO PRO REC1 PARAM24 NAME = &#39;maxrejection&#39; / Number of highest values t
HIERARCH ESO PRO REC1 PARAM24 VALUE = &#39;1       &#39; / Default: 1                   
HIERARCH ESO PRO REC1 PARAM25 NAME = &#39;klow    &#39; / Low threshold in ksigma method
HIERARCH ESO PRO REC1 PARAM25 VALUE = &#39;3       &#39; / Default: 3                   
HIERARCH ESO PRO REC1 PARAM26 NAME = &#39;khigh   &#39; / High threshold in ksigma metho
HIERARCH ESO PRO REC1 PARAM26 VALUE = &#39;3       &#39; / Default: 3                   
HIERARCH ESO PRO REC1 PARAM27 NAME = &#39;kiter   &#39; / Max number of iterations in ks
HIERARCH ESO PRO REC1 PARAM27 VALUE = &#39;999     &#39; / Default: 999                 
HIERARCH ESO PRO REC1 PARAM28 NAME = &#39;dither  &#39; / Align dithered frames before s
HIERARCH ESO PRO REC1 PARAM28 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM29 NAME = &#39;compute &#39; / Compute offsets of dithered im
HIERARCH ESO PRO REC1 PARAM29 VALUE = &#39;false   &#39; / Default: false               
HIERARCH ESO PRO REC1 PARAM30 NAME = &#39;fringing&#39; / Apply fringing correction (onl
HIERARCH ESO PRO REC1 PARAM30 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM31 NAME = &#39;offset  &#39; / Minimum required offset betwee
HIERARCH ESO PRO REC1 PARAM31 VALUE = &#39;3       &#39; / Default: 3                   
HIERARCH ESO PRO REC1 PARAM32 NAME = &#39;qc      &#39; / Compute QC1 parameters        
HIERARCH ESO PRO REC1 PARAM32 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO ADA ABSROT START = 21.56262 / Abs rot angle at exp start           
HIERARCH ESO ADA POSANG =  90. / Position angle at start                        
HIERARCH ESO ADA GUID STATUS = &#39;ON      &#39; / Status of autoguider                
HIERARCH ESO ADA GUID RA = 150.241537 / 10:00:57.9 Guide star RA J2000          
HIERARCH ESO ADA GUID DEC = 2.59418 / 02:35:39.0 Guide star DEC J2000           
HIERARCH ESO ADA ABSROT PPOS = &#39;NEG     &#39; / sign of probe position              
HIERARCH ESO ADA ABSROT END = 20.56639 / Abs rot angle at exp end               
HIERARCH ESO OCS CON QUAD =  1 / Quadrant Number                                
HIERARCH ESO OCS CMF FILE1 NAME = &#39;MOS_sky2ccd_1.cmf&#39; / Calibration matrix file 
HIERARCH ESO OCS CMF FILE1 CRTEDATE = &#39;2012-05-18T14:37:53&#39; / Calibration matrix
HIERARCH ESO OCS CMF FILE2 NAME = &#39;MOS_wavecal_HR_red_1.cmf&#39; / Calibration matri
HIERARCH ESO OCS CMF FILE2 CRTEDATE = &#39;2005-10-20T17:18:57&#39; / Calibration matrix
HIERARCH ESO OCS COMP ID = &#39;226602 2012-03-18 17:49:45Z&#39; / OS Software Versi    
HIERARCH ESO OCS DID = &#39;ESO-VLT-DIC.VIMOS_OS-0.2&#39; / Data dictionary for         
HISTORY FTU-2_5_2/2015-01-18/REMOVE: XTENSION, &quot;IMAGE&quot;                          
HISTORY FTU-2_5_2/2015-01-18/REMOVE: EXTNAME, &quot;BRIAN&quot;                           
HISTORY FTU-2_5_2/2015-01-18/REMOVE: ORIGIN, &quot;VIRMOS OS Software&quot;               
HISTORY FTU-2_5_2/2015-01-18/REMOVE: CDELT1, 1.00000000                         
HISTORY FTU-2_5_2/2015-01-18/REMOVE: CDELT2, 1.00000000                         
HISTORY FTU-2_5_2/2015-01-18/CHANGE: DET.CHIPS, 1                               
HISTORY FTU-2_5_2/2015-01-18/CHANGE: DET.OUTPUTS, 1                             
HISTORY FTU-2_5_2/2015-01-18/CHANGE: DET.WIN1.NX, 2148                          
COMMENT FTU-2_5_2/2015-01-18T04:24:44/vimos.ftt                                 
CHECKSUM= &#39;NMTOQMTNNMTNNMTN&#39;   / HDU checksum updated 2015-01-26T12:24:13       
DATASUM = &#39;338047765&#39;          / data unit checksum updated 2015-01-26T12:24:13 
</pre></div>
</div>
</div>
</div>
<section id="developer-note">
<h3>Developer note<a class="headerlink" href="#developer-note" title="Permalink to this heading">#</a></h3>
<p>I would appreciate the interactive tools here to zoom and pan through the 2D spectrum. Hoovering to know the precise wavelength of a feature would also be very useful. With that, the interactive tool could show automatically the calibration in wavelength reading it from the header.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hdu2d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">3000</span><span class="p">)</span> <span class="c1">#spec is very big, plot just a bit</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2000.0, 3000.0)
</pre></div>
</div>
<img alt="../../_images/e3147c3f1c243e122359a3b70738b4c1256fd601d04ffc39a7dc74a53cc4cfcf.png" src="../../_images/e3147c3f1c243e122359a3b70738b4c1256fd601d04ffc39a7dc74a53cc4cfcf.png" />
</div>
</div>
</section>
</section>
<section id="now-work-with-1d-spectrum">
<h2>Now work with 1D spectrum<a class="headerlink" href="#now-work-with-1d-spectrum" title="Permalink to this heading">#</a></h2>
</section>
<section id="calibrate-in-wavelength-inspect-and-write-in-spectrum1d-object">
<h2>Calibrate (in wavelength), inspect, and write in Spectrum1D object<a class="headerlink" href="#calibrate-in-wavelength-inspect-and-write-in-spectrum1d-object" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu1d</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file1d</span><span class="p">)</span>
<span class="n">hdu1dwht</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file1dwht</span><span class="p">)</span>
<span class="n">hdu1d</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: ./mos_spectroscopy/observed/legac_M1_v3.7_spec1d_130902.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     715   (6166,)   float32   
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu1d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SIMPLE  =                    T / file does conform to FITS standard             
BITPIX  =                  -32 / number of bits per data pixel                  
NAXIS   =                    1 / number of data axes                            
NAXIS1  =                 6166 / length of data axis 1                          
EXTEND  =                    T / FITS dataset may contain extensions            
COMMENT   FITS (Flexible Image Transport System) format is defined in &#39;Astronomy
COMMENT   and Astrophysics&#39;, volume 376, page 359; bibcode: 2001A&amp;A...376..359H 
DATE    = &#39;2015-01-26T12:24:07&#39; / file creation date (YYYY-MM-DDThh:mm:ss UT)   
ORIGIN  = &#39;ESO     &#39;           / European Southern Observatory                  
MJD-OBS =       57040.16930682 / Obs start 2015-01-18T04:03:48.109              
DATE-OBS= &#39;2015-01-18T04:03:48.108&#39; / Date of observation                       
EXPTIME =             1199.997 / Total integration time. 00:19:59.997           
TELESCOP= &#39;ESO-VLT-U3&#39;         / ESO &lt;TEL&gt;                                      
RA      =           150.220555 / 10:00:52.9 RA (J2000) pointing                 
DEC     =              2.41104 / 02:24:39.7  DEC (J2000) pointing               
EQUINOX =                2000. / Standard FK5                                   
RADECSYS= &#39;FK5     &#39;           / Coordinate reference frame                     
LST     =            25866.379 / 07:11:06.379 LST at start                      
UTC     =               14623. / 04:03:43.000 UT at start                       
OBSERVER= &#39;VIMOS   &#39;           / Name of observer                               
INSTRUME= &#39;VIMOS   &#39;           / Instrument used                                
PI-COI  = &#39;555555555&#39;          / Name of PI and COI                             
OBJECT  = &#39;COSMOS_M01&#39;         / Original target                                
CRVAL1  =               5800.3 / 10:00:52.9, RA at ref pixel                    
CRPIX1  =                   1. / Reference pixel in X                           
CTYPE1  = &#39;LINEAR  &#39;           / pixel coordinate system                        
CRVAL2  =                   1. / 02:24:39.7, DEC at ref pixel                   
CRPIX2  =                   1. / Reference pixel in Y                           
CTYPE2  = &#39;PIXEL   &#39;           / pixel coordinate system                        
INHERIT =                    T / denotes the INHERIT keyword convention         
CD1_1   =                  0.6 / Translation matrix element                     
CD1_2   =                   0. / Translation matrix element                     
CD2_1   =                   0. / Translation matrix element                     
CD2_2   =                   1. / Translation matrix element                     
DATAMD5 = &#39;77a1ef86719040e2fea8d1d96fef35e0&#39; / MD5 checksum                     
PIPEFILE= &#39;mos_science_sky_extracted.fits&#39; / Filename of data product           
ARCFILE = &#39;VIMOS.2015-01-18T04:03:48.110.fits&#39; / Archive File Name              
HIERARCH ESO OBS DID = &#39;ESO-VLT-DIC.OBS-1.12&#39; / OBS Dictionary                  
HIERARCH ESO OBS EXECTIME = 6835 / Expected execution time                      
HIERARCH ESO OBS GRP = &#39;0       &#39; / linked blocks                               
HIERARCH ESO OBS ID =  1163772 / Observation block ID                           
HIERARCH ESO OBS NAME = &#39;legac_M01_2&#39; / OB name                                 
HIERARCH ESO OBS OBSERVER = &#39;UNKNOWN &#39; / Observer Name                          
HIERARCH ESO OBS PI-COI ID = 73498 / ESO internal PI-COI ID                     
HIERARCH ESO OBS PI-COI NAME = &#39;UNKNOWN &#39; / PI-COI name                         
HIERARCH ESO OBS PROG ID = &#39;194.A-2005(B)&#39; / ESO program identification         
HIERARCH ESO OBS START = &#39;2015-01-18T03:38:14&#39; / OB start time                  
HIERARCH ESO OBS NTPL =      3 / Number of templates within OB                  
HIERARCH ESO OBS TPLNO =     2 / Template number within OB                      
HIERARCH ESO OBS AIRM =     2. / Req. max. airmass                              
HIERARCH ESO OBS AMBI FWHM = 1.3 / Req. max. seeing                             
HIERARCH ESO OBS AMBI TRANS = &#39;2CLR    &#39; / Req. sky transparency                
HIERARCH ESO OBS ATM = &#39;NATM    &#39; / Req. Atmospheric Turbulence Model           
HIERARCH ESO OBS CONTAINER ID = -999 / Scheduling container ID                  
HIERARCH ESO OBS CONTAINER TYPE = &#39;U       &#39; / Scheduling container type        
HIERARCH ESO OBS MOON DIST = 120 / Req. min. angular dist. from moon            
HIERARCH ESO OBS MOON FLI = 0.3 / Req. max. fractional lunar illum.             
HIERARCH ESO OBS STREHLRATIO = 0. / Req. strehl ratio                           
HIERARCH ESO OBS TARG NAME = &#39;COSMOS_M01&#39; / OB target name                      
HIERARCH ESO OBS TWILIGHT = -15 / Req. twilight                                 
HIERARCH ESO OBS WATERVAPOUR = 0. / Req. water vapour                           
HIERARCH ESO TPL FILE DIRNAME = &#39;$INS_ROOT/$INS_USER/ADF&#39; / Storage filename    
HIERARCH ESO TPL FILE KEEP = T / paramfile keep-flag                            
HIERARCH ESO TPL DID = &#39;ESO-VLT-DIC.TPL-1.9&#39; / Data dictionary for TPL          
HIERARCH ESO TPL ID = &#39;VIMOS_mos_obs_Offset&#39; / Template signature ID            
HIERARCH ESO TPL NAME = &#39;MOS Observation&#39; / Template name                       
HIERARCH ESO TPL PRESEQ = &#39;VIMOS_mos_obs_Offset&#39; / Sequencer script             
HIERARCH ESO TPL START = &#39;2015-01-18T04:01:12&#39; / TPL start time                 
HIERARCH ESO TPL VERSION = &#39;@(#) $Revision: 77996 $&#39; / Version of the templa    
HIERARCH ESO TPL NEXP =      4 / Number of exposures within templat             
HIERARCH ESO TPL EXPNO =     1 / Exposure number within template                
HIERARCH ESO TEL DID = &#39;ESO-VLT-DIC.TCS&#39; / Data dictionary for TEL              
HIERARCH ESO TEL ID = &#39;v 261159&#39; / TCS version number                           
HIERARCH ESO TEL DATE = &#39;2000-01-01T00:00:00&#39; / TCS installation date           
HIERARCH ESO TEL ALT =  40.643 / Alt angle at start                             
HIERARCH ESO TEL AZ =  243.107 / Az angle at start S=0,W=90                     
HIERARCH ESO TEL GEOELEV = 2648. / Elevation above sea level (m)                
HIERARCH ESO TEL GEOLAT = -24.6268 / Tel geo latitute (+=North)                 
HIERARCH ESO TEL GEOLON = -70.4045 / Tel geo longitude (+=East)                 
HIERARCH ESO TEL OPER = &#39;I, Condor&#39; / Telescope Operator                        
HIERARCH ESO TEL FOCU ID = &#39;NB      &#39; / Telescope focus station ID              
HIERARCH ESO TEL FOCU LEN = 120. / Focal length                                 
HIERARCH ESO TEL FOCU SCALE = 1.718 / Focal scale                               
HIERARCH ESO TEL FOCU VALUE = -31.348 / M2 setting                              
HIERARCH ESO TEL PARANG START = -125.768 / Parallactic angle at start           
HIERARCH ESO TEL AIRM START = 1.533 / Airmass at start                          
HIERARCH ESO TEL AMBI FWHM START = 1.08 / Observatory Seeing queried from AS    
HIERARCH ESO TEL AMBI PRES START = 744.4 / Observatory ambient air pressure q   
HIERARCH ESO TEL AMBI WINDSP = 0.82 / Observatory ambient wind speed que        
HIERARCH ESO TEL AMBI WINDDIR = 325.5 / Observatory ambient wind direction      
HIERARCH ESO TEL AMBI RHUM = 3. / Observatory ambient relative humid            
HIERARCH ESO TEL AMBI TEMP = 15.77 / Observatory ambient temperature qu         
HIERARCH ESO TEL MOON RA = 265.331996 / 17:41:19.6 RA (J2000)                   
HIERARCH ESO TEL MOON DEC = -17.93387 / -17:56:01.9 DEC (J2000)                 
HIERARCH ESO TEL TH M1 TEMP = 13.63 / M1 superficial temperature                
HIERARCH ESO TEL TRAK STATUS = &#39;NORMAL  &#39; / Tracking status                     
HIERARCH ESO TEL DOME STATUS = &#39;FULLY-OPEN&#39; / Dome status                       
HIERARCH ESO TEL CHOP ST =   F / True when chopping is active                   
HIERARCH ESO TEL TARG ALPHA = 100052.8 / Alpha coordinate for the target        
HIERARCH ESO TEL TARG DELTA = 22436. / Delta coordinate for the target          
HIERARCH ESO TEL TARG EPOCH = 2000. / Epoch                                     
HIERARCH ESO TEL TARG EPOCHSYSTEM = &#39;J       &#39; / Epoch system (default J=Julian)
HIERARCH ESO TEL TARG EQUINOX = 2000. / Equinox                                 
HIERARCH ESO TEL TARG PMA = 0. / Proper Motion Alpha                            
HIERARCH ESO TEL TARG PMD = 0. / Proper motion Delta                            
HIERARCH ESO TEL TARG RADVEL = 0. / Radial velocity                             
HIERARCH ESO TEL TARG PARALLAX = 0. / Parallax                                  
HIERARCH ESO TEL TARG COORDTYPE = &#39;M       &#39; / Coordinate type (M=mean A=apparen
HIERARCH ESO TEL PARANG END = -128.789 / Parallactic angle at end               
HIERARCH ESO TEL AIRM END = 1.421 / Airmass at end                              
HIERARCH ESO TEL AMBI FWHM END = 1.03 / Observatory Seeing queried from AS      
HIERARCH ESO TEL IA FWHM =  1. / Delivered seeing corrected by airm             
HIERARCH ESO TEL IA FWHMLIN = 1.01 / Delivered seeing on IA detector (l         
HIERARCH ESO TEL IA FWHMLINOBS = 1.25 / Delivered seeing on IA detector (l      
HIERARCH ESO TEL AMBI PRES END = 744.3 / Observatory ambient air pressure q     
HIERARCH ESO TEL AMBI TAU0 = 0.0039 / Average coherence time                    
HIERARCH ESO TEL GS1 ALPHA = 100057.969 / Guide Star alpha                      
HIERARCH ESO TEL GS1 DELTA = 23539.05 / Guide Star delta                        
HIERARCH ESO TEL GS1 PPOS = &#39;NEG     &#39; / Selected probe position (POS or NE     
HIERARCH ESO TEL TARG NAME = &#39;        &#39; / Name of special target position       
HIERARCH ESO INS SWSIM = &#39;NORMAL  &#39; / Software simulation                       
HIERARCH ESO INS ID = &#39;VIMOS   &#39; / Instrument identification                    
HIERARCH ESO INS DID = &#39;ESO-VLT-DIC.VIMOS_ICS-242857&#39; / Data dictionary         
HIERARCH ESO INS SOFT DATE = &#39;Mar 20 2014&#39; / Instrument SW Release date         
HIERARCH ESO INS SOFT ID = &#39;186976  &#39; / Version of ICS                          
HIERARCH ESO INS FOCU1 TEMP = 14.61792 / Temperature(C) for the beam            
HIERARCH ESO INS ADF TYPE = &#39;MOS     &#39; / Type of ADF                            
HIERARCH ESO INS ADF VERSION = 3.28 / Version of ADF                            
HIERARCH ESO INS ADF UNIT = &#39;MILLIMETER&#39; / Unit of slit/object coordinates      
HIERARCH ESO INS ADF ID = &#39;legac_M1Q1_HR_Red_M1Q1.adp&#39; / Name for the ADF       
HIERARCH ESO INS ADF ADMID = &#39;2015-01-18T03:38:06-101-1.adm&#39; / Name for the *.  
HIERARCH ESO INS ADF COMMENT = &#39;        &#39; / Optional user comment for ADF       
HIERARCH ESO INS MASK1 ID = 103063 / Mask identification number                 
HIERARCH ESO INS ADF GRISM NAME = &#39;HR_Red  &#39; / Grism name                       
HIERARCH ESO INS ADF GRISM SPECTLEN = 4096. / Spectrum length in pixels         
HIERARCH ESO INS ADF SKYREG = 1.8 / Sky region in arcsec                        
HIERARCH ESO INS REF NO =    1 / Number of reference apertures                  
HIERARCH ESO INS ARC NO =    0 / Number of curved apertures                     
HIERARCH ESO INS SLIT NO =  33 / Number of all apertures but refere             
HIERARCH ESO INS SHU NO =    1 / Number of shutter positions                    
HIERARCH ESO INS SHU1 POSL = 0. / Lower shutter positions                       
HIERARCH ESO INS SHU1 POSH = 2440. / Upper shutter positions                    
HIERARCH ESO INS REF1 TYPE = &#39;SQUARE  &#39; / Type of REF i                         
HIERARCH ESO INS REF1 ID = 132308 / ID of REF i                                 
HIERARCH ESO INS REF1 OBJ RA = 150.345742 / RA (J2000) of object                
HIERARCH ESO INS REF1 OBJ DEC = 2.347825 / DEC (J2000) of object                
HIERARCH ESO INS REF1 X = -27.353 / x co-ordinate of REF i                      
HIERARCH ESO INS REF1 Y = 105.937 / y co-ordinate of REF i                      
HIERARCH ESO INS REF1 DIMX = 3.576 / Size in x direction of REF i               
HIERARCH ESO INS REF1 DIMY = 3.579 / Size in y direction of REF i               
HIERARCH ESO INS SLIT1 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT1 ID = 135357 / ID of SLIT i                               
HIERARCH ESO INS SLIT1 OBJ RA = 150.295375 / RA (J2000) of object               
HIERARCH ESO INS SLIT1 OBJ DEC = 2.387456 / DEC (J2000) of object               
HIERARCH ESO INS SLIT1 X = -114.091 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT1 Y = 0.598 / y co-ordinate of SLIT i                      
HIERARCH ESO INS SLIT1 DIMX = 11.926 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT1 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT2 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT2 ID = 135418 / ID of SLIT i                               
HIERARCH ESO INS SLIT2 OBJ RA = 150.294267 / RA (J2000) of object               
HIERARCH ESO INS SLIT2 OBJ DEC = 2.384864 / DEC (J2000) of object               
HIERARCH ESO INS SLIT2 X = -105.266 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT2 Y = -1.718 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT2 DIMX = 5.247 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT2 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT3 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT3 ID = 134929 / ID of SLIT i                               
HIERARCH ESO INS SLIT3 OBJ RA = 150.314113 / RA (J2000) of object               
HIERARCH ESO INS SLIT3 OBJ DEC = 2.381319 / DEC (J2000) of object               
HIERARCH ESO INS SLIT3 X = -98.833 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT3 Y = 39.782 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT3 DIMX = 7.155 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT3 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT4 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT4 ID = 134657 / ID of SLIT i                               
HIERARCH ESO INS SLIT4 OBJ RA = 150.333579 / RA (J2000) of object               
HIERARCH ESO INS SLIT4 OBJ DEC = 2.377983 / DEC (J2000) of object               
HIERARCH ESO INS SLIT4 X = -91.636 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT4 Y = 80.503 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT4 DIMX = 6.799 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT4 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT5 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT5 ID = 134371 / ID of SLIT i                               
HIERARCH ESO INS SLIT5 OBJ RA = 150.297429 / RA (J2000) of object               
HIERARCH ESO INS SLIT5 OBJ DEC = 2.374828 / DEC (J2000) of object               
HIERARCH ESO INS SLIT5 X = -84.818 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT5 Y = 4.892 / y co-ordinate of SLIT i                      
HIERARCH ESO INS SLIT5 DIMX = 6.318 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT5 DIMY = 0.581 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT6 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT6 ID = 134169 / ID of SLIT i                               
HIERARCH ESO INS SLIT6 OBJ RA = 150.29875 / RA (J2000) of object                
HIERARCH ESO INS SLIT6 OBJ DEC = 2.372181 / DEC (J2000) of object               
HIERARCH ESO INS SLIT6 X = -78.739 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT6 Y = 7.657 / y co-ordinate of SLIT i                      
HIERARCH ESO INS SLIT6 DIMX = 5.364 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT6 DIMY = 0.581 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT7 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT7 ID = 133783 / ID of SLIT i                               
HIERARCH ESO INS SLIT7 OBJ RA = 150.279029 / RA (J2000) of object               
HIERARCH ESO INS SLIT7 OBJ DEC = 2.368242 / DEC (J2000) of object               
HIERARCH ESO INS SLIT7 X = -71.828 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT7 Y = -33.576 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT7 DIMX = 7.987 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT7 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT8 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT8 ID = 133480 / ID of SLIT i                               
HIERARCH ESO INS SLIT8 OBJ RA = 150.338367 / RA (J2000) of object               
HIERARCH ESO INS SLIT8 OBJ DEC = 2.364314 / DEC (J2000) of object               
HIERARCH ESO INS SLIT8 X = -63.618 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT8 Y = 90.513 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT8 DIMX = 7.988 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT8 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT9 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                      
HIERARCH ESO INS SLIT9 ID = 133163 / ID of SLIT i                               
HIERARCH ESO INS SLIT9 OBJ RA = 150.336546 / RA (J2000) of object               
HIERARCH ESO INS SLIT9 OBJ DEC = 2.36105 / DEC (J2000) of object                
HIERARCH ESO INS SLIT9 X = -56.106 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT9 Y = 86.692 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT9 DIMX = 6.557 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT9 DIMY = 0.582 / Size in y direction of SLIT i             
HIERARCH ESO INS SLIT10 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT10 ID = 133098 / ID of SLIT i                              
HIERARCH ESO INS SLIT10 OBJ RA = 150.292 / RA (J2000) of object                 
HIERARCH ESO INS SLIT10 OBJ DEC = 2.358644 / DEC (J2000) of object              
HIERARCH ESO INS SLIT10 X = -50.193 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT10 Y = -6.454 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT10 DIMX = 4.767 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT10 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT11 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT11 ID = 132633 / ID of SLIT i                              
HIERARCH ESO INS SLIT11 OBJ RA = 150.276625 / RA (J2000) of object              
HIERARCH ESO INS SLIT11 OBJ DEC = 2.355419 / DEC (J2000) of object              
HIERARCH ESO INS SLIT11 X = -44.294 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT11 Y = -38.594 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT11 DIMX = 6.555 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT11 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT12 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT12 ID = 132419 / ID of SLIT i                              
HIERARCH ESO INS SLIT12 OBJ RA = 150.280325 / RA (J2000) of object              
HIERARCH ESO INS SLIT12 OBJ DEC = 2.351606 / DEC (J2000) of object              
HIERARCH ESO INS SLIT12 X = -35.117 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT12 Y = -30.854 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT12 DIMX = 11.322 / Size in x direction of SLIT i           
HIERARCH ESO INS SLIT12 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT13 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT13 ID = 132048 / ID of SLIT i                              
HIERARCH ESO INS SLIT13 OBJ RA = 150.254533 / RA (J2000) of object              
HIERARCH ESO INS SLIT13 OBJ DEC = 2.343506 / DEC (J2000) of object              
HIERARCH ESO INS SLIT13 X = -20.753 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT13 Y = -84.791 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT13 DIMX = 9.297 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT13 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT14 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT14 ID = 131393 / ID of SLIT i                              
HIERARCH ESO INS SLIT14 OBJ RA = 150.300879 / RA (J2000) of object              
HIERARCH ESO INS SLIT14 OBJ DEC = 2.340411 / DEC (J2000) of object              
HIERARCH ESO INS SLIT14 X = -12.715 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT14 Y = 12.107 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT14 DIMX = 6.315 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT14 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT15 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT15 ID = 131127 / ID of SLIT i                              
HIERARCH ESO INS SLIT15 OBJ RA = 150.265312 / RA (J2000) of object              
HIERARCH ESO INS SLIT15 OBJ DEC = 2.337044 / DEC (J2000) of object              
HIERARCH ESO INS SLIT15 X = -5.918 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT15 Y = -62.244 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT15 DIMX = 6.793 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT15 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT16 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT16 ID = 131013 / ID of SLIT i                              
HIERARCH ESO INS SLIT16 OBJ RA = 150.283083 / RA (J2000) of object              
HIERARCH ESO INS SLIT16 OBJ DEC = 2.334078 / DEC (J2000) of object              
HIERARCH ESO INS SLIT16 X = 0.693 / x co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT16 Y = -25.086 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT16 DIMX = 5.958 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT16 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT17 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT17 ID = 130497 / ID of SLIT i                              
HIERARCH ESO INS SLIT17 OBJ RA = 150.326658 / RA (J2000) of object              
HIERARCH ESO INS SLIT17 OBJ DEC = 2.330731 / DEC (J2000) of object              
HIERARCH ESO INS SLIT17 X = 7.242 / x co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT17 Y = 66.006 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT17 DIMX = 6.673 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT17 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT18 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT18 ID = 130276 / ID of SLIT i                              
HIERARCH ESO INS SLIT18 OBJ RA = 150.348 / RA (J2000) of object                 
HIERARCH ESO INS SLIT18 OBJ DEC = 2.326914 / DEC (J2000) of object              
HIERARCH ESO INS SLIT18 X = 14.692 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT18 Y = 110.66 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT18 DIMX = 7.748 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT18 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT19 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT19 ID = 129957 / ID of SLIT i                              
HIERARCH ESO INS SLIT19 OBJ RA = 150.3202 / RA (J2000) of object                
HIERARCH ESO INS SLIT19 OBJ DEC = 2.323739 / DEC (J2000) of object              
HIERARCH ESO INS SLIT19 X = 22.018 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT19 Y = 52.509 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT19 DIMX = 6.435 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT19 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT20 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT20 ID = 129553 / ID of SLIT i                              
HIERARCH ESO INS SLIT20 OBJ RA = 150.2657 / RA (J2000) of object                
HIERARCH ESO INS SLIT20 OBJ DEC = 2.320875 / DEC (J2000) of object              
HIERARCH ESO INS SLIT20 X = 28.405 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT20 Y = -61.437 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT20 DIMX = 5.84 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT20 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT21 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT21 ID = 129940 / ID of SLIT i                              
HIERARCH ESO INS SLIT21 OBJ RA = 150.358563 / RA (J2000) of object              
HIERARCH ESO INS SLIT21 OBJ DEC = 2.317225 / DEC (J2000) of object              
HIERARCH ESO INS SLIT21 X = 35.264 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT21 Y = 132.797 / y co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT21 DIMX = 7.394 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT21 DIMY = 0.583 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT22 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT22 ID = 129028 / ID of SLIT i                              
HIERARCH ESO INS SLIT22 OBJ RA = 150.302108 / RA (J2000) of object              
HIERARCH ESO INS SLIT22 OBJ DEC = 2.314742 / DEC (J2000) of object              
HIERARCH ESO INS SLIT22 X = 41.623 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT22 Y = 14.682 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT22 DIMX = 4.886 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT22 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT23 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT23 ID = 128901 / ID of SLIT i                              
HIERARCH ESO INS SLIT23 OBJ RA = 150.318517 / RA (J2000) of object              
HIERARCH ESO INS SLIT23 OBJ DEC = 2.31175 / DEC (J2000) of object               
HIERARCH ESO INS SLIT23 X = 47.343 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT23 Y = 48.991 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT23 DIMX = 6.079 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT23 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT24 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT24 ID = 128682 / ID of SLIT i                              
HIERARCH ESO INS SLIT24 OBJ RA = 150.324967 / RA (J2000) of object              
HIERARCH ESO INS SLIT24 OBJ DEC = 2.309175 / DEC (J2000) of object              
HIERARCH ESO INS SLIT24 X = 53.185 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT24 Y = 62.484 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT24 DIMX = 5.126 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT24 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT25 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT25 ID = 128528 / ID of SLIT i                              
HIERARCH ESO INS SLIT25 OBJ RA = 150.324742 / RA (J2000) of object              
HIERARCH ESO INS SLIT25 OBJ DEC = 2.305881 / DEC (J2000) of object              
HIERARCH ESO INS SLIT25 X = 59.324 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT25 Y = 62.007 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT25 DIMX = 6.676 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT25 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT26 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT26 ID = 128053 / ID of SLIT i                              
HIERARCH ESO INS SLIT26 OBJ RA = 150.301421 / RA (J2000) of object              
HIERARCH ESO INS SLIT26 OBJ DEC = 2.302322 / DEC (J2000) of object              
HIERARCH ESO INS SLIT26 X = 66.473 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT26 Y = 13.246 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT26 DIMX = 7.152 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT26 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT27 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT27 ID = 128133 / ID of SLIT i                              
HIERARCH ESO INS SLIT27 OBJ RA = 150.313362 / RA (J2000) of object              
HIERARCH ESO INS SLIT27 OBJ DEC = 2.299283 / DEC (J2000) of object              
HIERARCH ESO INS SLIT27 X = 73.388 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT27 Y = 38.213 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT27 DIMX = 6.199 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT27 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT28 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT28 ID = 127508 / ID of SLIT i                              
HIERARCH ESO INS SLIT28 OBJ RA = 150.323738 / RA (J2000) of object              
HIERARCH ESO INS SLIT28 OBJ DEC = 2.294797 / DEC (J2000) of object              
HIERARCH ESO INS SLIT28 X = 81.321 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT28 Y = 59.917 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT28 DIMX = 9.182 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT28 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT29 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT29 ID = 127314 / ID of SLIT i                              
HIERARCH ESO INS SLIT29 OBJ RA = 150.296713 / RA (J2000) of object              
HIERARCH ESO INS SLIT29 OBJ DEC = 2.291669 / DEC (J2000) of object              
HIERARCH ESO INS SLIT29 X = 89.244 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT29 Y = 3.402 / y co-ordinate of SLIT i                     
HIERARCH ESO INS SLIT29 DIMX = 6.2 / Size in x direction of SLIT i              
HIERARCH ESO INS SLIT29 DIMY = 0.581 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT30 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT30 ID = 127180 / ID of SLIT i                              
HIERARCH ESO INS SLIT30 OBJ RA = 150.317087 / RA (J2000) of object              
HIERARCH ESO INS SLIT30 OBJ DEC = 2.288025 / DEC (J2000) of object              
HIERARCH ESO INS SLIT30 X = 96.283 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT30 Y = 46.016 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT30 DIMX = 7.394 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT30 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT31 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT31 ID = 127438 / ID of SLIT i                              
HIERARCH ESO INS SLIT31 OBJ RA = 150.321308 / RA (J2000) of object              
HIERARCH ESO INS SLIT31 OBJ DEC = 2.28495 / DEC (J2000) of object               
HIERARCH ESO INS SLIT31 X = 103.324 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT31 Y = 54.842 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT31 DIMX = 6.203 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT31 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT32 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT32 ID = 126585 / ID of SLIT i                              
HIERARCH ESO INS SLIT32 OBJ RA = 150.324013 / RA (J2000) of object              
HIERARCH ESO INS SLIT32 OBJ DEC = 2.282417 / DEC (J2000) of object              
HIERARCH ESO INS SLIT32 X = 109.233 / x co-ordinate of SLIT i                   
HIERARCH ESO INS SLIT32 Y = 60.508 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT32 DIMX = 5.13 / Size in x direction of SLIT i             
HIERARCH ESO INS SLIT32 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS SLIT33 TYPE = &#39;RECTANGLE&#39; / Type of SLIT i                     
HIERARCH ESO INS SLIT33 ID = 126275 / ID of SLIT i                              
HIERARCH ESO INS SLIT33 OBJ RA = 150.301817 / RA (J2000) of object              
HIERARCH ESO INS SLIT33 OBJ DEC = 2.279189 / DEC (J2000) of object              
HIERARCH ESO INS SLIT33 X = 117.03 / x co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT33 Y = 14.079 / y co-ordinate of SLIT i                    
HIERARCH ESO INS SLIT33 DIMX = 10.02 / Size in x direction of SLIT i            
HIERARCH ESO INS SLIT33 DIMY = 0.582 / Size in y direction of SLIT i            
HIERARCH ESO INS PIXSCALE = 0.205 / Pixel scale                                 
HIERARCH ESO INS MODE = &#39;MOS     &#39; / Instrument Observation Mode                
HIERARCH ESO INS FILT1 FIX = F / Filter mode degraded                           
HIERARCH ESO INS FILT1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FILT1 NAME = &#39;GG475   &#39; / Filter name                          
HIERARCH ESO INS FILT1 ID = &#39;vm-GG475-1.10&#39; / Filter ESO ID                     
HIERARCH ESO INS MASK1 FIX = F / Mask mode degraded                             
HIERARCH ESO INS MASK1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS MASK1 NO =  3 / Mask set number                                
HIERARCH ESO INS FOCU1 FIX = F / Focusing mode degraded                         
HIERARCH ESO INS FOCU1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU1 VALUE = 6976.122982 / Camera lens position(micron)       
HIERARCH ESO INS FOCU3 FIX = F / Focusing mode degraded                         
HIERARCH ESO INS FOCU3 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU3 TEMP = 14.629684 / Temperature(C) for the beam           
HIERARCH ESO INS FOCU3 VALUE = 5181.099499 / Camera lens position(micron)       
HIERARCH ESO INS FOCU2 FIX = F / Focusing mode degraded                         
HIERARCH ESO INS FOCU2 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU2 TEMP = 14.841312 / Temperature(C) for the beam           
HIERARCH ESO INS FOCU2 VALUE = 6081.203659 / Camera lens position(micron)       
HIERARCH ESO INS MSHU1 FIX = F / Mask Shutter mode degraded                     
HIERARCH ESO INS MSHU1 SIM = T / Device Hardware Simulation                     
HIERARCH ESO INS MSHU1 MODE = &#39;OFF     &#39; / Mask Shutter mode                    
HIERARCH ESO INS MSHU1 POSH = 7.348085 / High Mask Shutters positions (mm)      
HIERARCH ESO INS MSHU1 POSL = 7.348085 / Low Mask Shutters position (mm)        
HIERARCH ESO INS GRIS1 FIX = F / Grism mode degraded                            
HIERARCH ESO INS GRIS1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS GRIS1 NAME = &#39;HR_red  &#39; / Grism name                           
HIERARCH ESO INS GRIS1 ID = &#39;vm-HRredHolog-1.1&#39; / Grism ESO ID                  
HIERARCH ESO INS AFC11 FIX = F / AFC mode degraded                              
HIERARCH ESO INS AFC11 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS AFC12 FIX = F / AFC mode degraded                              
HIERARCH ESO INS AFC12 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU4 FIX = F / Focusing mode degraded                         
HIERARCH ESO INS FOCU4 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS FOCU4 TEMP = 14.588951 / Temperature(C) for the beam           
HIERARCH ESO INS FOCU4 VALUE = 7108.120407 / Camera lens position(micron)       
HIERARCH ESO INS LAMP1 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP1 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP1 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP1 NAME = &#39;QTH50   &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP1 ID = &#39;vm-QTH50-1&#39; / Calib. lamp ESO identification       
HIERARCH ESO INS LAMP2 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP2 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP2 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP2 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP2 NAME = &#39;QTH10   &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP2 ID = &#39;vm-QTH10-2&#39; / Calib. lamp ESO identification       
HIERARCH ESO INS IFUM1 FIX = F / IFU Mask mode degraded                         
HIERARCH ESO INS IFUM1 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS IFUM1 MODE = &#39;OFF     &#39; / IFU Mask mode                        
HIERARCH ESO INS LAMP3 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP3 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP3 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP3 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP3 NAME = &#39;He      &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP3 ID = &#39;vm-He-3 &#39; / Calib. lamp ESO identification         
HIERARCH ESO INS IFUM2 FIX = F / IFU Mask mode degraded                         
HIERARCH ESO INS IFUM2 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS IFUM2 MODE = &#39;OFF     &#39; / IFU Mask mode                        
HIERARCH ESO INS LAMP4 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP4 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP4 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP4 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP4 NAME = &#39;Ne      &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP4 ID = &#39;vm-Ne-4 &#39; / Calib. lamp ESO identification         
HIERARCH ESO INS LAMP5 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP5 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP5 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP5 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP5 NAME = &#39;Ar      &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP5 ID = &#39;vm-Ar-5 &#39; / Calib. lamp ESO identification         
HIERARCH ESO INS LAMP6 FIX = F / Lamp[i] mode degraded                          
HIERARCH ESO INS LAMP6 SIM = F / Device Hardware Simulation                     
HIERARCH ESO INS LAMP6 TIME = 0 / Lamp lightening time                          
HIERARCH ESO INS LAMP6 STATE = &#39;OFF     &#39; / State for this lamp in each box     
HIERARCH ESO INS LAMP6 NAME = &#39;Afc     &#39; / Calibration lamp name                
HIERARCH ESO INS LAMP6 ID = &#39;vm-Afc-6&#39; / Calib. lamp ESO identification         
HIERARCH ESO INS IFUE FIX =  F / IFU Elongator mode degraded                    
HIERARCH ESO INS IFUE SIM =  F / Device Hardware Simulation                     
HIERARCH ESO INS IFUE MAG = &#39;1:1     &#39; / IFU Magnification 0.33(1:2) or 0.6     
HIERARCH ESO INS IFUS FIX =  F / IFU Shutter mode degraded                      
HIERARCH ESO INS IFUS SIM =  F / Device Hardware Simulation                     
HIERARCH ESO INS IFUS MODE = &#39;OFF     &#39; / IFU Shutter CLOSED(ON) or OPEN(OFF    
HIERARCH ESO DET CHIP1 INDEX = 1 / Chip index                                   
HIERARCH ESO DET CHIP1 ID = &#39;BRIAN   &#39; / Detector chip identification           
HIERARCH ESO DET CHIP1 NAME = &#39;EEV CCD-44-82&#39; / Detector chip name              
HIERARCH ESO DET CHIP1 DATE = &#39;2000-08-30&#39; / Date of installation [YYYY-MM-DD]  
HIERARCH ESO DET CHIP1 X =   1 / X location in array                            
HIERARCH ESO DET CHIP1 Y =   1 / Y location in array                            
HIERARCH ESO DET CHIP1 NX = 2048 / # of pixels along X                          
HIERARCH ESO DET CHIP1 NY = 4096 / # of pixels along Y                          
HIERARCH ESO DET CHIP1 PSZX = 15. / Size of pixel in X                          
HIERARCH ESO DET CHIP1 PSZY = 15. / Size of pixel in Y                          
HIERARCH ESO DET CHIP1 XGAP = 0. / Gap between chips along x                    
HIERARCH ESO DET CHIP1 YGAP = 0. / Gap between chips along y                    
HIERARCH ESO DET OUT1 INDEX = 1 / Output index                                  
HIERARCH ESO DET OUT1 ID = &#39;L       &#39; / Output ID as from manufacturer          
HIERARCH ESO DET OUT1 NAME = &#39;L       &#39; / Description of output                 
HIERARCH ESO DET OUT1 CHIP = 1 / index of chip it belongs to                    
HIERARCH ESO DET OUT1 X =    1 / X location of output                           
HIERARCH ESO DET OUT1 Y =    1 / Y location of output                           
HIERARCH ESO DET OUT1 NX = 2048 / valid pixels along X                          
HIERARCH ESO DET OUT1 NY = 4096 / valid pixels along Y                          
HIERARCH ESO DET OUT1 CONAD = 0.55 / Conversion from ADUs to electrons          
HIERARCH ESO DET OUT1 RON = 3.21 / [e-] Readout noise per output (ele           
HIERARCH ESO DET OUT1 GAIN = 1.82 / Conversion from electrons to ADU            
HIERARCH ESO DET ID = &#39;CCD FIERA - Rev: 238334&#39; / Detector system Id            
HIERARCH ESO DET NAME = &#39;Vimosb - vimosb&#39; / Name of detector system             
HIERARCH ESO DET DATE = &#39;2010-07-01&#39; / Installation date                        
HIERARCH ESO DET DID = &#39;ESO-VLT-DIC.CCDDCS,ESO-VLT-DIC.FCDDCS&#39; / Diction        
HIERARCH ESO DET BITS =     16 / Bits per pixel readout                         
HIERARCH ESO DET RA =       0. / Apparent 00:00:00.0 RA at start                
HIERARCH ESO DET DEC =      0. / Apparent 00:00:00.0 DEC at start               
HIERARCH ESO DET CHIPS =     1 / # of chips in detector array                   
HIERARCH ESO DET OUTPUTS =   1 / # of outputs                                   
HIERARCH ESO DET OUTREF =    0 / reference output                               
HIERARCH ESO DET WINDOWS =   1 / # of windows readout                           
HIERARCH ESO DET SOFW MODE = &#39;Normal  &#39; / CCD sw operational mode               
HIERARCH ESO DET EXP NO = 42197 / Unique exposure ID number                     
HIERARCH ESO DET EXP TYPE = &#39;Normal  &#39; / Exposure type                          
HIERARCH ESO DET EXP RDTTIME = 30.939 / image readout time                      
HIERARCH ESO DET EXP XFERTIM = 44.981 / image transfer time                     
HIERARCH ESO DET WIN1 ST =   T / If T, window enabled                           
HIERARCH ESO DET WIN1 STRX = 1 / Lower left pixel in X                          
HIERARCH ESO DET WIN1 STRY = 1 / Lower left pixel in Y                          
HIERARCH ESO DET WIN1 NX = 2148 / # of pixels along X                           
HIERARCH ESO DET WIN1 NY = 4096 / # of pixels along Y                           
HIERARCH ESO DET WIN1 BINX = 1 / Binning factor along X                         
HIERARCH ESO DET WIN1 BINY = 1 / Binning factor along Y                         
HIERARCH ESO DET WIN1 NDIT = 1 / # of subintegrations                           
HIERARCH ESO DET WIN1 UIT1 = 1200. / user defined subintegration time           
HIERARCH ESO DET WIN1 DIT1 = 1199.997383 / actual subintegration time           
HIERARCH ESO DET WIN1 DKTM = 1200.0992 / Dark current time                      
HIERARCH ESO DET READ MODE = &#39;normal  &#39; / Readout method                        
HIERARCH ESO DET READ SPEED = &#39;medium  &#39; / Readout speed                        
HIERARCH ESO DET READ CLOCK = &#39;225kHz,1port,HG&#39; / Readout clock pattern used    
HIERARCH ESO DET READ NFRAM = 1 / Number of readouts buffered in sin            
HIERARCH ESO DET FRAM ID =   1 / Image sequencial number                        
HIERARCH ESO DET FRAM TYPE = &#39;Normal  &#39; / Type of frame                         
HIERARCH ESO DET SHUT TYPE = &#39;seso    &#39; / type of shutter                       
HIERARCH ESO DET SHUT ID = &#39;VIMOS shutter&#39; / Shutter unique identifier          
HIERARCH ESO DET SHUT TMOPEN = 0.074 / Time taken to open shutter               
HIERARCH ESO DET SHUT TMCLOS = 0.069 / Time taken to close shutter              
HIERARCH ESO DET TELE INT = 900. / Interval between two successive te           
HIERARCH ESO DET TELE NO =   7 / # of sources active                            
HIERARCH ESO DET TLM1 NAME = &#39;CCD Cold Plate&#39; / Description of telemetry param  
HIERARCH ESO DET TLM1 ID = &#39;CCD_B1_T1&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM1 START = 140.1 / Telemetry value at read start             
HIERARCH ESO DET TLM1 END = 139.9 / Telemetry value at read completion          
HIERARCH ESO DET TLM2 NAME = &#39;CCD Cold Plate2&#39; / Description of telemetry para  
HIERARCH ESO DET TLM2 ID = &#39;CCD_B1_T2&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM2 START = 151.6 / Telemetry value at read start             
HIERARCH ESO DET TLM2 END = 151.4 / Telemetry value at read completion          
HIERARCH ESO DET TLM3 NAME = &#39;CCD Cold Plate&#39; / Description of telemetry param  
HIERARCH ESO DET TLM3 ID = &#39;CCD_B4_T1&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM3 START = 140. / Telemetry value at read start              
HIERARCH ESO DET TLM3 END = 140. / Telemetry value at read completion           
HIERARCH ESO DET TLM4 NAME = &#39;CCD Cold Plate2&#39; / Description of telemetry para  
HIERARCH ESO DET TLM4 ID = &#39;CCD_B4_T2&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM4 START = 140.6 / Telemetry value at read start             
HIERARCH ESO DET TLM4 END = 140.6 / Telemetry value at read completion          
HIERARCH ESO DET TLM5 NAME = &#39;FBOX    &#39; / Description of telemetry param.       
HIERARCH ESO DET TLM5 ID = &#39;FBOX    &#39; / ID of telemetry sensor                  
HIERARCH ESO DET TLM5 START = 288.8 / Telemetry value at read start             
HIERARCH ESO DET TLM5 END = 288.7 / Telemetry value at read completion          
HIERARCH ESO DET TLM6 NAME = &#39;Vaccum_B1&#39; / Description of telemetry param.      
HIERARCH ESO DET TLM6 ID = &#39;Vaccum_B1&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM6 START = 0. / Telemetry value at read start                
HIERARCH ESO DET TLM6 END = 0. / Telemetry value at read completion             
HIERARCH ESO DET TLM7 NAME = &#39;Vaccum_B4&#39; / Description of telemetry param.      
HIERARCH ESO DET TLM7 ID = &#39;Vaccum_B4&#39; / ID of telemetry sensor                 
HIERARCH ESO DET TLM7 START = 0. / Telemetry value at read start                
HIERARCH ESO DET TLM7 END = 0. / Telemetry value at read completion             
HIERARCH ESO PRO EXPTTOT = 4799.988                                             
HIERARCH ESO PRO ANCESTOR = &#39;VIMOS.2015-01-18T04:03:48.110.fits&#39;                
HIERARCH ESO PRO DID = &#39;PRO-1.15&#39; / Data dictionary for PRO                     
HIERARCH ESO PRO CATG = &#39;MOS_SCIENCE_SKY_EXTRACTED&#39; / Category of pipeline produ
HIERARCH ESO PRO TYPE = &#39;REDUCED &#39; / Product type                               
HIERARCH ESO PRO TECH = &#39;MOS     &#39; / Observation technique                      
HIERARCH ESO PRO SCIENCE =   T / Scientific product if T                        
HIERARCH ESO PRO REC1 ID = &#39;vmmosscience&#39; / Pipeline recipe (unique) identifier 
HIERARCH ESO PRO REC1 DRS ID = &#39;cpl-6.5.1&#39; / Data Reduction System identifier   
HIERARCH ESO PRO REC1 PIPE ID = &#39;vimos-2.9.15&#39; / Pipeline (unique) identifier   
HIERARCH ESO PRO REC1 RAW1 NAME = &#39;VIMOS.2015-01-18T04:03:48.110.fits&#39; / File na
HIERARCH ESO PRO REC1 RAW1 CATG = &#39;MOS_SCIENCE&#39; / Category of raw frame         
HIERARCH ESO PRO REC1 RAW2 NAME = &#39;VIMOS.2015-01-18T04:24:43.107.fits&#39; / File na
HIERARCH ESO PRO REC1 RAW2 CATG = &#39;MOS_SCIENCE&#39; / Category of raw frame         
HIERARCH ESO PRO REC1 RAW3 NAME = &#39;VIMOS.2015-01-18T04:45:38.102.fits&#39; / File na
HIERARCH ESO PRO REC1 RAW3 CATG = &#39;MOS_SCIENCE&#39; / Category of raw frame         
HIERARCH ESO PRO REC1 RAW4 NAME = &#39;VIMOS.2015-01-18T05:06:33.097.fits&#39; / File na
HIERARCH ESO PRO REC1 RAW4 CATG = &#39;MOS_SCIENCE&#39; / Category of raw frame         
HIERARCH ESO PRO DATANCOM =  4 / Number of combined frames                      
HIERARCH ESO PRO REC1 CAL1 NAME = &#39;M.VIMOS.2010-08-19T16:16:17.563.fits&#39; / File 
HIERARCH ESO PRO REC1 CAL1 CATG = &#39;CONFIG_TABLE&#39; / Category of calibration frame
HIERARCH ESO PRO REC1 CAL1 DATAMD5 = &#39;827358dea0214d1587a3f99820ec5810&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL2 NAME = &#39;master_bias.fits&#39; / File name of calibration 
HIERARCH ESO PRO REC1 CAL2 CATG = &#39;MASTER_BIAS&#39; / Category of calibration frame 
HIERARCH ESO PRO REC1 CAL2 DATAMD5 = &#39;e61a66abf72ac06c6b41c8c3770404e3&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL3 NAME = &#39;mos_curv_coeff.fits&#39; / File name of calibrati
HIERARCH ESO PRO REC1 CAL3 CATG = &#39;MOS_CURV_COEFF&#39; / Category of calibration fra
HIERARCH ESO PRO REC1 CAL3 DATAMD5 = &#39;8c4b8da9b95016a47162e7a44741b6e9&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL4 NAME = &#39;mos_disp_coeff.fits&#39; / File name of calibrati
HIERARCH ESO PRO REC1 CAL4 CATG = &#39;MOS_DISP_COEFF&#39; / Category of calibration fra
HIERARCH ESO PRO REC1 CAL4 DATAMD5 = &#39;1c1a4eb0e8edb0d621c99d716b0c63ae&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL5 NAME = &#39;mos_master_screen_flat.fits&#39; / File name of c
HIERARCH ESO PRO REC1 CAL5 CATG = &#39;MOS_MASTER_SCREEN_FLAT&#39; / Category of calibra
HIERARCH ESO PRO REC1 CAL5 DATAMD5 = &#39;0f2d03e3af5e30f7485a0a300f70b02f&#39; / MD5 si
HIERARCH ESO PRO REC1 CAL6 NAME = &#39;mos_slit_location.fits&#39; / File name of calibr
HIERARCH ESO PRO REC1 CAL6 CATG = &#39;MOS_SLIT_LOCATION&#39; / Category of calibration 
HIERARCH ESO PRO REC1 CAL6 DATAMD5 = &#39;f53c43722c662a5763c5b94db9b2468e&#39; / MD5 si
HIERARCH ESO PRO REC1 PARAM1 NAME = &#39;dispersion&#39; / Resampling step (Angstrom/pix
HIERARCH ESO PRO REC1 PARAM1 VALUE = &#39;0.6     &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM2 NAME = &#39;skyalign&#39; / Polynomial order for sky lines 
HIERARCH ESO PRO REC1 PARAM2 VALUE = &#39;0       &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM3 NAME = &#39;wcolumn &#39; / Name of sky line catalog table 
HIERARCH ESO PRO REC1 PARAM3 VALUE = &#39;WLEN    &#39; / Default: &#39;WLEN&#39;               
HIERARCH ESO PRO REC1 PARAM4 NAME = &#39;startwavelength&#39; / Start wavelength in spec
HIERARCH ESO PRO REC1 PARAM4 VALUE = &#39;5800    &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM5 NAME = &#39;endwavelength&#39; / End wavelength in spectral
HIERARCH ESO PRO REC1 PARAM5 VALUE = &#39;9500    &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM6 NAME = &#39;reference&#39; / Reference wavelength for calib
HIERARCH ESO PRO REC1 PARAM6 VALUE = &#39;7948.18 &#39; / Default: 0                    
HIERARCH ESO PRO REC1 PARAM7 NAME = &#39;flux    &#39; / Apply flux conservation        
HIERARCH ESO PRO REC1 PARAM7 VALUE = &#39;true    &#39; / Default: true                 
HIERARCH ESO PRO REC1 PARAM8 NAME = &#39;flatfield&#39; / Apply flat field              
HIERARCH ESO PRO REC1 PARAM8 VALUE = &#39;true    &#39; / Default: true                 
HIERARCH ESO PRO REC1 PARAM9 NAME = &#39;skyglobal&#39; / Subtract global sky spectrum f
HIERARCH ESO PRO REC1 PARAM9 VALUE = &#39;false   &#39; / Default: false                
HIERARCH ESO PRO REC1 PARAM10 NAME = &#39;skymedian&#39; / Sky subtraction from extracte
HIERARCH ESO PRO REC1 PARAM10 VALUE = &#39;false   &#39; / Default: false               
HIERARCH ESO PRO REC1 PARAM11 NAME = &#39;skylocal&#39; / Sky subtraction from CCD slit 
HIERARCH ESO PRO REC1 PARAM11 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM12 NAME = &#39;cosmics &#39; / Eliminate cosmic rays hits (on
HIERARCH ESO PRO REC1 PARAM12 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM13 NAME = &#39;slit_margin&#39; / Number of pixels to exclude
HIERARCH ESO PRO REC1 PARAM13 VALUE = &#39;3       &#39; / Default: 3                   
HIERARCH ESO PRO REC1 PARAM14 NAME = &#39;ext_radius&#39; / Maximum extraction radius fo
HIERARCH ESO PRO REC1 PARAM14 VALUE = &#39;6       &#39; / Default: 6                   
HIERARCH ESO PRO REC1 PARAM15 NAME = &#39;cont_radius&#39; / Minimum distance at which t
HIERARCH ESO PRO REC1 PARAM15 VALUE = &#39;0       &#39; / Default: 0                   
HIERARCH ESO PRO REC1 PARAM16 NAME = &#39;ext_mode&#39; / Object extraction method: 0 = 
HIERARCH ESO PRO REC1 PARAM16 VALUE = &#39;1       &#39; / Default: 1                   
HIERARCH ESO PRO REC1 PARAM17 NAME = &#39;detection&#39; / Object detection threshold (A
HIERARCH ESO PRO REC1 PARAM17 VALUE = &#39;2       &#39; / Default: 2                   
HIERARCH ESO PRO REC1 PARAM18 NAME = &#39;time_normalise&#39; / Normalise output spectra
HIERARCH ESO PRO REC1 PARAM18 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM19 NAME = &#39;anyframe&#39; / Look for a standard star in an
HIERARCH ESO PRO REC1 PARAM19 VALUE = &#39;false   &#39; / Default: false               
HIERARCH ESO PRO REC1 PARAM20 NAME = &#39;response&#39; / Order of polynomial modeling t
HIERARCH ESO PRO REC1 PARAM20 VALUE = &#39;5       &#39; / Default: 5                   
HIERARCH ESO PRO REC1 PARAM21 NAME = &#39;alignment&#39; / Type of alignment of dithered
HIERARCH ESO PRO REC1 PARAM21 VALUE = &#39;integer &#39; / Default: &#39;integer&#39;           
HIERARCH ESO PRO REC1 PARAM22 NAME = &#39;stack_method&#39; / Frames combination method 
HIERARCH ESO PRO REC1 PARAM22 VALUE = &#39;average &#39; / Default: &#39;average&#39;           
HIERARCH ESO PRO REC1 PARAM23 NAME = &#39;minrejection&#39; / Number of lowest values to
HIERARCH ESO PRO REC1 PARAM23 VALUE = &#39;1       &#39; / Default: 1                   
HIERARCH ESO PRO REC1 PARAM24 NAME = &#39;maxrejection&#39; / Number of highest values t
HIERARCH ESO PRO REC1 PARAM24 VALUE = &#39;1       &#39; / Default: 1                   
HIERARCH ESO PRO REC1 PARAM25 NAME = &#39;klow    &#39; / Low threshold in ksigma method
HIERARCH ESO PRO REC1 PARAM25 VALUE = &#39;3       &#39; / Default: 3                   
HIERARCH ESO PRO REC1 PARAM26 NAME = &#39;khigh   &#39; / High threshold in ksigma metho
HIERARCH ESO PRO REC1 PARAM26 VALUE = &#39;3       &#39; / Default: 3                   
HIERARCH ESO PRO REC1 PARAM27 NAME = &#39;kiter   &#39; / Max number of iterations in ks
HIERARCH ESO PRO REC1 PARAM27 VALUE = &#39;999     &#39; / Default: 999                 
HIERARCH ESO PRO REC1 PARAM28 NAME = &#39;dither  &#39; / Align dithered frames before s
HIERARCH ESO PRO REC1 PARAM28 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM29 NAME = &#39;compute &#39; / Compute offsets of dithered im
HIERARCH ESO PRO REC1 PARAM29 VALUE = &#39;false   &#39; / Default: false               
HIERARCH ESO PRO REC1 PARAM30 NAME = &#39;fringing&#39; / Apply fringing correction (onl
HIERARCH ESO PRO REC1 PARAM30 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO PRO REC1 PARAM31 NAME = &#39;offset  &#39; / Minimum required offset betwee
HIERARCH ESO PRO REC1 PARAM31 VALUE = &#39;3       &#39; / Default: 3                   
HIERARCH ESO PRO REC1 PARAM32 NAME = &#39;qc      &#39; / Compute QC1 parameters        
HIERARCH ESO PRO REC1 PARAM32 VALUE = &#39;true    &#39; / Default: true                
HIERARCH ESO ADA ABSROT START = 21.56262 / Abs rot angle at exp start           
HIERARCH ESO ADA POSANG =  90. / Position angle at start                        
HIERARCH ESO ADA GUID STATUS = &#39;ON      &#39; / Status of autoguider                
HIERARCH ESO ADA GUID RA = 150.241537 / 10:00:57.9 Guide star RA J2000          
HIERARCH ESO ADA GUID DEC = 2.59418 / 02:35:39.0 Guide star DEC J2000           
HIERARCH ESO ADA ABSROT PPOS = &#39;NEG     &#39; / sign of probe position              
HIERARCH ESO ADA ABSROT END = 20.56639 / Abs rot angle at exp end               
HIERARCH ESO OCS CON QUAD =  1 / Quadrant Number                                
HIERARCH ESO OCS CMF FILE1 NAME = &#39;MOS_sky2ccd_1.cmf&#39; / Calibration matrix file 
HIERARCH ESO OCS CMF FILE1 CRTEDATE = &#39;2012-05-18T14:37:53&#39; / Calibration matrix
HIERARCH ESO OCS CMF FILE2 NAME = &#39;MOS_wavecal_HR_red_1.cmf&#39; / Calibration matri
HIERARCH ESO OCS CMF FILE2 CRTEDATE = &#39;2005-10-20T17:18:57&#39; / Calibration matrix
HIERARCH ESO OCS COMP ID = &#39;226602 2012-03-18 17:49:45Z&#39; / OS Software Versi    
HIERARCH ESO OCS DID = &#39;ESO-VLT-DIC.VIMOS_OS-0.2&#39; / Data dictionary for         
HISTORY FTU-2_5_2/2015-01-18/REMOVE: XTENSION, &quot;IMAGE&quot;                          
HISTORY FTU-2_5_2/2015-01-18/REMOVE: EXTNAME, &quot;BRIAN&quot;                           
HISTORY FTU-2_5_2/2015-01-18/REMOVE: ORIGIN, &quot;VIRMOS OS Software&quot;               
HISTORY FTU-2_5_2/2015-01-18/REMOVE: CDELT1, 1.00000000                         
HISTORY FTU-2_5_2/2015-01-18/REMOVE: CDELT2, 1.00000000                         
HISTORY FTU-2_5_2/2015-01-18/CHANGE: DET.CHIPS, 1                               
HISTORY FTU-2_5_2/2015-01-18/CHANGE: DET.OUTPUTS, 1                             
HISTORY FTU-2_5_2/2015-01-18/CHANGE: DET.WIN1.NX, 2148                          
COMMENT FTU-2_5_2/2015-01-18T04:24:44/vimos.ftt                                 
CHECKSUM= &#39;NMTOQMTNNMTNNMTN&#39;   / HDU checksum updated 2015-01-26T12:24:13       
DATASUM = &#39;338047765&#39;          / data unit checksum updated 2015-01-26T12:24:13 
</pre></div>
</div>
</div>
</div>
<p>If i want to do it in Pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flux</span> <span class="o">=</span> <span class="n">hdu1d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">byteswap</span><span class="p">()</span><span class="o">.</span><span class="n">newbyteorder</span><span class="p">()</span>
<span class="n">wht</span> <span class="o">=</span> <span class="n">hdu1dwht</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">byteswap</span><span class="p">()</span><span class="o">.</span><span class="n">newbyteorder</span><span class="p">()</span>
<span class="n">unc</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">wht</span><span class="p">)</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">flux</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">hdu1d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CD1_1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">hdu1d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CRVAL1&#39;</span><span class="p">]</span>

<span class="c1">##for certain functions, I need to cut the spectrum where the weight is 0.</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wavelength&#39;</span><span class="p">:</span><span class="n">wave</span><span class="p">,</span> <span class="s1">&#39;flux&#39;</span><span class="p">:</span><span class="n">flux</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="n">wht</span><span class="p">,</span> <span class="s1">&#39;uncertainty&#39;</span><span class="p">:</span><span class="n">unc</span><span class="p">}</span>
<span class="n">dataspec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>

<span class="c1">##define subset where wht&gt;0</span>
<span class="n">dataspec_sub</span> <span class="o">=</span> <span class="n">dataspec</span><span class="p">[</span><span class="n">dataspec</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataspec_sub</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wavelength</th>
      <th>flux</th>
      <th>weight</th>
      <th>uncertainty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6229.3</td>
      <td>14.757169</td>
      <td>0.207031</td>
      <td>2.197769</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6229.9</td>
      <td>26.817886</td>
      <td>0.148122</td>
      <td>2.598306</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6230.5</td>
      <td>23.955254</td>
      <td>0.142191</td>
      <td>2.651945</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6231.1</td>
      <td>22.239902</td>
      <td>0.141403</td>
      <td>2.659323</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6231.7</td>
      <td>22.505369</td>
      <td>0.136912</td>
      <td>2.702580</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If I want to do it in astropy Tables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flux</span> <span class="o">=</span> <span class="n">hdu1d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">wht</span> <span class="o">=</span> <span class="n">hdu1dwht</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">unc</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">wht</span><span class="p">)</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">flux</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">hdu1d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CD1_1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">hdu1d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CRVAL1&#39;</span><span class="p">]</span>

<span class="n">spec_unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;10^-19 erg s^-1 cm^-2 angstrom^-1&#39;</span><span class="p">)</span>
<span class="n">dataspec</span> <span class="o">=</span> <span class="n">QTable</span><span class="p">([</span><span class="n">wave</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">angstrom</span><span class="p">,</span> <span class="n">flux</span><span class="o">*</span><span class="n">spec_unit</span><span class="p">,</span> <span class="n">wht</span><span class="p">,</span> <span class="n">unc</span><span class="o">*</span><span class="n">spec_unit</span><span class="p">],</span> 
                   <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;wavelength&#39;</span><span class="p">,</span><span class="s1">&#39;flux&#39;</span><span class="p">,</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span><span class="s1">&#39;uncertainty&#39;</span><span class="p">))</span>
<span class="n">dataspec_sub</span> <span class="o">=</span> <span class="n">dataspec</span><span class="p">[</span><span class="n">dataspec</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">]</span>
<span class="n">dataspec_sub</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=4059</i>
<table id="table140201585755728" class="table-striped table-bordered table-condensed">
<thead><tr><th>wavelength</th><th>flux</th><th>weight</th><th>uncertainty</th></tr></thead>
<thead><tr><th>Angstrom</th><th>1e-19 erg / (Angstrom s cm2)</th><th></th><th>1e-19 erg / (Angstrom s cm2)</th></tr></thead>
<thead><tr><th>float64</th><th>float32</th><th>float32</th><th>float32</th></tr></thead>
<tr><td>6229.3</td><td>14.757168769836426</td><td>0.20703126</td><td>2.1977689266204834</td></tr>
<tr><td>6229.900000000001</td><td>26.817886352539062</td><td>0.14812198</td><td>2.5983057022094727</td></tr>
<tr><td>6230.5</td><td>23.95525360107422</td><td>0.14219064</td><td>2.651945114135742</td></tr>
<tr><td>6231.1</td><td>22.23990249633789</td><td>0.14140277</td><td>2.659322738647461</td></tr>
<tr><td>6231.7</td><td>22.505369186401367</td><td>0.13691239</td><td>2.702580213546753</td></tr>
<tr><td>6232.3</td><td>21.266435623168945</td><td>0.12861502</td><td>2.788393974304199</td></tr>
<tr><td>6232.900000000001</td><td>21.235198974609375</td><td>0.11325585</td><td>2.9714584350585938</td></tr>
<tr><td>6233.5</td><td>24.18277359008789</td><td>0.096821204</td><td>3.2137696743011475</td></tr>
<tr><td>6234.1</td><td>32.75020980834961</td><td>0.085573986</td><td>3.4184489250183105</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>8677.9</td><td>46.554779052734375</td><td>0.08704492</td><td>3.3894426822662354</td></tr>
<tr><td>8678.5</td><td>45.3433837890625</td><td>0.08504387</td><td>3.429086923599243</td></tr>
<tr><td>8679.1</td><td>46.19153594970703</td><td>0.06836141</td><td>3.824674606323242</td></tr>
<tr><td>8679.7</td><td>49.632057189941406</td><td>0.058549482</td><td>4.132743835449219</td></tr>
<tr><td>8680.3</td><td>40.599159240722656</td><td>0.04911178</td><td>4.51239538192749</td></tr>
<tr><td>8680.9</td><td>46.05984115600586</td><td>0.0454888</td><td>4.6886491775512695</td></tr>
<tr><td>8681.5</td><td>53.85580825805664</td><td>0.049859755</td><td>4.478421211242676</td></tr>
<tr><td>8682.1</td><td>51.271400451660156</td><td>0.058481682</td><td>4.135138511657715</td></tr>
<tr><td>8682.7</td><td>51.61949920654297</td><td>0.069049306</td><td>3.805575370788574</td></tr>
<tr><td>8683.3</td><td>51.20613098144531</td><td>0.08998948</td><td>3.3335282802581787</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">],</span>
                 <span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;uncertainty&#39;</span><span class="p">],</span>
                 <span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;uncertainty&#39;</span><span class="p">],</span>
                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;uncertainty&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">],</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Observed spectrum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/eb721e276b4bba24287aca60479706766416f09a64152061f6c7bfee1d47ac53.png" src="../../_images/eb721e276b4bba24287aca60479706766416f09a64152061f6c7bfee1d47ac53.png" />
</div>
</div>
</section>
<section id="go-with-specutils">
<h2>Go with specutils<a class="headerlink" href="#go-with-specutils" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#write Spectrum1D object</span>
<span class="n">spec1d</span> <span class="o">=</span> <span class="n">Spectrum1D</span><span class="p">(</span><span class="n">spectral_axis</span><span class="o">=</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;wavelength&#39;</span><span class="p">],</span> 
                    <span class="n">flux</span><span class="o">=</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">],</span> 
                    <span class="n">uncertainty</span><span class="o">=</span><span class="n">StdDevUncertainty</span><span class="p">(</span><span class="n">dataspec_sub</span><span class="p">[</span><span class="s1">&#39;uncertainty&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3>Developer note<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>For supported datasets (like final JWST data products), this will be as simple as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spec1d</span> <span class="o">=</span> <span class="n">Spectrum1d</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;datafile.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3>Developer note<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>Implemented but not yet released: <code class="docutils literal notranslate"><span class="pre">snr_threshold</span></code>, which will allow cutting the spectrum using that function.</p>
</section>
</section>
<section id="smooth-to-better-inspect-the-features">
<h2>Smooth to better inspect the features<a class="headerlink" href="#smooth-to-better-inspect-the-features" title="Permalink to this heading">#</a></h2>
<section id="id3">
<h3>Developer note<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>The uncertainty is not carried over, but would be useful. Same comment on the interactive tool as before: it would be very useful to be able to zoom, pan, hoover, etc. on the spectrum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spec1d_gsmooth</span> <span class="o">=</span> <span class="n">gaussian_smooth</span><span class="p">(</span><span class="n">spec1d</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_gsmooth</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span><span class="n">spec1d_gsmooth</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_gsmooth</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_gsmooth</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Smoothed observed spectrum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/adf7db55e728ed7bad5402e5d7f633d025bb8a513c628d1575444a0337ec966a.png" src="../../_images/adf7db55e728ed7bad5402e5d7f633d025bb8a513c628d1575444a0337ec966a.png" />
</div>
</div>
</section>
</section>
<section id="back-to-the-non-smoothed-spectrum-to-find-lines">
<h2>Back to the non-smoothed spectrum to find lines<a class="headerlink" href="#back-to-the-non-smoothed-spectrum-to-find-lines" title="Permalink to this heading">#</a></h2>
<p>Documentation says I need a continuum subtracted spectrum.</p>
</section>
<section id="so-fit-continuum-first">
<h2>So fit continuum first<a class="headerlink" href="#so-fit-continuum-first" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cont_spec1d</span> <span class="o">=</span> <span class="n">fit_generic_continuum</span><span class="p">(</span><span class="n">spec1d</span><span class="p">)</span>
<span class="n">cont_fit</span> <span class="o">=</span> <span class="n">cont_spec1d</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Model is linear in parameters; consider using linear fitting methods. [astropy.modeling.fitting]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec1d</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">cont_fit</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;modeled continuum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Observed spectrum and fitted continuum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec1d</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;uncertainty ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Uncertianty of observed spectrum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bbbd09f15d1fac957675e16edf6e3ea4181c028046506f0b40c6508d33496f7d.png" src="../../_images/bbbd09f15d1fac957675e16edf6e3ea4181c028046506f0b40c6508d33496f7d.png" />
<img alt="../../_images/ff9cdf51228380c2a597da92926143a5ca1db068f6373b2a32559b02f2735d8a.png" src="../../_images/ff9cdf51228380c2a597da92926143a5ca1db068f6373b2a32559b02f2735d8a.png" />
</div>
</div>
<section id="creating-the-continuum-subtracted-spectrum">
<h3>Creating the continuum-subtracted spectrum<a class="headerlink" href="#creating-the-continuum-subtracted-spectrum" title="Permalink to this heading">#</a></h3>
<p>Specutils will figure out what to do with the uncertainty!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spec1d_sub</span> <span class="o">=</span> <span class="n">spec1d</span> <span class="o">-</span> <span class="n">cont_fit</span>
<span class="n">spec1d_sub</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Spectrum1D(flux=&lt;Quantity [-9.11481202,  2.92418963,  0.03985127, ...,  2.46770635,
            2.81985914,  2.41054724] 1e-19 erg / (Angstrom s cm2)&gt;, spectral_axis=&lt;SpectralAxis 
   (observer to target:
      radial_velocity=0.0 km / s
      redshift=0.0)
  [6229.3, 6229.9, 6230.5, ..., 8682.1, 8682.7, 8683.3] Angstrom&gt;, uncertainty=StdDevUncertainty([2.197769 , 2.5983057, 2.651945 , ..., 4.1351385,
                   3.8055754, 3.3335283]))&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Continuum-subracted spectrum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;uncertainty ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Uncertainty of continuum-subracted spectrum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/012b67ca8619e9c1f2fe352cf5fda204897322d47a8ae6528cff3d9bf65973fc.png" src="../../_images/012b67ca8619e9c1f2fe352cf5fda204897322d47a8ae6528cff3d9bf65973fc.png" />
<img alt="../../_images/0dc93c82fbb22650a806865df95f11dc1fdcc90a3cf0ee5de4af640ed9b228a5.png" src="../../_images/0dc93c82fbb22650a806865df95f11dc1fdcc90a3cf0ee5de4af640ed9b228a5.png" />
</div>
</div>
</section>
</section>
<section id="now-look-for-the-lines">
<h2>Now look for the lines<a class="headerlink" href="#now-look-for-the-lines" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lines</span> <span class="o">=</span> <span class="n">find_lines_derivative</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="p">,</span> <span class="n">flux_threshold</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">lines</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=4</i>
<table id="table140201602989200" class="table-striped table-bordered table-condensed">
<thead><tr><th>line_center</th><th>line_type</th><th>line_center_index</th></tr></thead>
<thead><tr><th>Angstrom</th><th></th><th></th></tr></thead>
<thead><tr><th>float64</th><th>str8</th><th>int64</th></tr></thead>
<tr><td>6549.1</td><td>emission</td><td>528</td></tr>
<tr><td>6553.900000000001</td><td>emission</td><td>536</td></tr>
<tr><td>6558.7</td><td>emission</td><td>544</td></tr>
<tr><td>8550.7</td><td>emission</td><td>3837</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;line_center&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;emission/absorption lines&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;line_center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Continuum-subtracted spectrum and marked lines using find_lines_derivative&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cfff7e1243022e591a2a70682c404239d8666cae10e0678fcc45374bb9d9092e.png" src="../../_images/cfff7e1243022e591a2a70682c404239d8666cae10e0678fcc45374bb9d9092e.png" />
</div>
</div>
<p>This works for cases where you understand the thresholds well, but doesn’t automate as well with noisy spectra.</p>
<section id="works-better-with-find-lines-threshold">
<h3>Works better with find_lines_threshold<a class="headerlink" href="#works-better-with-find-lines-threshold" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lines</span> <span class="o">=</span> <span class="n">find_lines_threshold</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="p">,</span> <span class="n">noise_factor</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">lines</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=18</i>
<table id="table140201600727696" class="table-striped table-bordered table-condensed">
<thead><tr><th>line_center</th><th>line_type</th><th>line_center_index</th></tr></thead>
<thead><tr><th>Angstrom</th><th></th><th></th></tr></thead>
<thead><tr><th>float64</th><th>str10</th><th>int64</th></tr></thead>
<tr><td>6554.5</td><td>emission</td><td>537</td></tr>
<tr><td>7478.5</td><td>emission</td><td>2062</td></tr>
<tr><td>7488.1</td><td>emission</td><td>2072</td></tr>
<tr><td>8546.5</td><td>emission</td><td>3830</td></tr>
<tr><td>8551.3</td><td>emission</td><td>3838</td></tr>
<tr><td>6635.5</td><td>absorption</td><td>667</td></tr>
<tr><td>6671.5</td><td>absorption</td><td>727</td></tr>
<tr><td>6681.1</td><td>absorption</td><td>743</td></tr>
<tr><td>6739.9</td><td>absorption</td><td>841</td></tr>
<tr><td>6746.5</td><td>absorption</td><td>852</td></tr>
<tr><td>6913.3</td><td>absorption</td><td>1124</td></tr>
<tr><td>6916.9</td><td>absorption</td><td>1130</td></tr>
<tr><td>6975.7</td><td>absorption</td><td>1228</td></tr>
<tr><td>6979.9</td><td>absorption</td><td>1235</td></tr>
<tr><td>7205.5</td><td>absorption</td><td>1610</td></tr>
<tr><td>7217.5</td><td>absorption</td><td>1630</td></tr>
<tr><td>8079.700000000001</td><td>absorption</td><td>3055</td></tr>
<tr><td>8541.1</td><td>absorption</td><td>3821</td></tr>
</table></div></div></div>
</div>
<p>Plot lines on the spectrum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;line_center&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;emission/absorption lines&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;line_center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Continuum-subtracted spectrum and marked lines using find_lines_threshold&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/38ed1be0dc9c2e0bd0efd344cab7426477c12538fa3dcad420c42baa76b7a27d.png" src="../../_images/38ed1be0dc9c2e0bd0efd344cab7426477c12538fa3dcad420c42baa76b7a27d.png" />
</div>
</div>
<section id="id4">
<h4>Developer note<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h4>
<p>It would be useful to have a tool to cycle through the lines, show a zoom of the spectrum, and inspect how good the line identification is. For now I do it by hand on a single line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;line_center&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[OII]&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;line_center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">6500</span><span class="p">,</span><span class="mi">6600</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Continuum-subtracted spectrum zoomed on [OII]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fa954b0ec765493dd0981860b80b8d1e1c1b4e180647f3ecfe4c0e8b38be6e92.png" src="../../_images/fa954b0ec765493dd0981860b80b8d1e1c1b4e180647f3ecfe4c0e8b38be6e92.png" />
</div>
</div>
</section>
</section>
</section>
<section id="measure-line-centroids-and-fluxes">
<h2>Measure line centroids and fluxes<a class="headerlink" href="#measure-line-centroids-and-fluxes" title="Permalink to this heading">#</a></h2>
<p>These too need spectra continuum subtracted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#example with just one line</span>
<span class="n">centroid</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="p">,</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="mi">6540</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mi">6580</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[6554.415 \; \mathrm{\mathring{A}}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sline</span> <span class="o">=</span> <span class="n">centroid</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="p">,</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="mi">6540</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mi">6580</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">sline</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;[OII]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;flux = 0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">6500</span><span class="p">,</span><span class="mi">6600</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Continuum-subtracted spectrum zoomed on [OII]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/11b044977023a626c0591230bb6893284df03f4d1d4894e87ccab5e3747527b2.png" src="../../_images/11b044977023a626c0591230bb6893284df03f4d1d4894e87ccab5e3747527b2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line_flux</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="p">,</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="mi">6540</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mi">6570</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">))</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[965.51743 \; \mathrm{1 \times 10^{-19}\,\frac{erg}{s\,cm^{2}}}\]</div>
</div>
</div>
</section>
<section id="fit-the-line-with-a-gaussian">
<h2>Fit the line with a Gaussian<a class="headerlink" href="#fit-the-line-with-a-gaussian" title="Permalink to this heading">#</a></h2>
<section id="id5">
<h3>Developer note<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>Fitting lines with Gaussians is so common that it might make sense to have a one-line to iterate this over the list of lines, with sensible initialization of parameters and fit ranges for each line so that the fits generally work.</p>
<p>Also, the interactive tool here could allow one to select the continuum region and position of the line by clicking on the spectrum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g_init</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Gaussian1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="mf">1e-19</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">erg</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">6554</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
<span class="n">g_fit</span> <span class="o">=</span> <span class="n">fit_lines</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="p">,</span> <span class="n">g_init</span><span class="p">)</span>
<span class="n">spec1d_fit</span> <span class="o">=</span> <span class="n">g_fit</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">wavelength</span><span class="p">)</span>
<span class="n">g_fit</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Gaussian1D(amplitude=116.3316537 1e-19 erg / (Angstrom s cm2), mean=6554.93917566 Angstrom, stddev=3.71890257 Angstrom)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#calculate the velocity dispertion from the stddev</span>
<span class="n">vel</span> <span class="o">=</span> <span class="p">((</span><span class="mf">3.71890256</span><span class="o">/</span><span class="mf">6554.415</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>170.0989240877931 km / s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span><span class="n">spec1d_fit</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">6500</span><span class="p">,</span><span class="mi">6600</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gaussian fit to the [OII] line&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f5f16759986c2184ded03613872cc466933aae13a7430c94d08bdc0ca0942419.png" src="../../_images/f5f16759986c2184ded03613872cc466933aae13a7430c94d08bdc0ca0942419.png" />
</div>
</div>
</section>
</section>
<section id="measure-the-equivalent-width-of-the-lines">
<h2>Measure the equivalent width of the lines<a class="headerlink" href="#measure-the-equivalent-width-of-the-lines" title="Permalink to this heading">#</a></h2>
<p>This needs the spectrum continuum normalized.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spec1d_norm</span> <span class="o">=</span> <span class="n">spec1d</span> <span class="o">/</span> <span class="n">cont_fit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_norm</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec1d_norm</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;flux = 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_norm</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux (normalized)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">6500</span><span class="p">,</span><span class="mi">6600</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Continuum-normalized spectrum, zoomed on [OII]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d_norm</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec1d_norm</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_norm</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;uncertainty (normalized)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">6500</span><span class="p">,</span><span class="mi">6600</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Uncertainty of continuum-normalized spectrum, zoomed on [OII]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/23fb9e53c394f7453edfeadf62f666acce8275da1307b72c70adcce1aa379934.png" src="../../_images/23fb9e53c394f7453edfeadf62f666acce8275da1307b72c70adcce1aa379934.png" />
<img alt="../../_images/77a1347aca5d21a74ab418681ab37585ec3898a24c45e42a72151e02ba5050ba.png" src="../../_images/77a1347aca5d21a74ab418681ab37585ec3898a24c45e42a72151e02ba5050ba.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">equivalent_width</span><span class="p">(</span><span class="n">spec1d_norm</span><span class="p">,</span> <span class="n">regions</span><span class="o">=</span><span class="n">SpectralRegion</span><span class="p">(</span><span class="mi">6540</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="mi">6570</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[-28.243948 \; \mathrm{\mathring{A}}\]</div>
</div>
</div>
</section>
<section id="find-the-best-fitting-template">
<h2>Find the best-fitting template<a class="headerlink" href="#find-the-best-fitting-template" title="Permalink to this heading">#</a></h2>
<p>It needs a list of templates and the redshift of the observed galaxy. For the templates, I am using a set of model SEDs generated with Bruzual &amp; Charlot stellar population models, emission lines, and dust attenuation as described in Pacifici et al. (2012).</p>
<section id="id6">
<h3>Developer note<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<p>Maybe there is a way to speed this up (maybe using astropy model_sets)? This fit is run with 100 models, but ideally, if we want to extract physical parameters from this, we would need at least 10,000 models.</p>
<p>A dictionary structure with meaningful keys (which can be, e.g., tuples of the relevant physical parameters) could be better than a list? It could make later analysis much clearer than having to map from the list indices back to the relevant parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">templatedir</span> <span class="o">=</span> <span class="s1">&#39;./mos_spectroscopy/templates/&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zz</span> <span class="o">=</span> <span class="mf">0.758</span>

<span class="n">templatelist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">):</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}{1:05d}</span><span class="s2">.dat&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">templatedir</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>
    <span class="n">temp1d</span> <span class="o">=</span> <span class="n">Spectrum1D</span><span class="p">(</span><span class="n">spectral_axis</span><span class="o">=</span><span class="n">template</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span><span class="n">flux</span><span class="o">=</span><span class="n">template</span><span class="p">[</span><span class="s1">&#39;col2&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
    <span class="n">templatelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp1d</span><span class="p">)</span>
    
    
<span class="n">tm_results</span> <span class="o">=</span> <span class="n">template_comparison</span><span class="o">.</span><span class="n">template_match</span><span class="p">(</span><span class="n">observed_spectrum</span><span class="o">=</span><span class="n">spec1d</span><span class="p">,</span> <span class="n">spectral_templates</span><span class="o">=</span><span class="n">templatelist</span><span class="p">,</span> <span class="n">resample_method</span><span class="o">=</span><span class="s2">&quot;flux_conserving&quot;</span><span class="p">,</span> <span class="n">redshift</span><span class="o">=</span><span class="n">zz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tm_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Spectrum1D(flux=&lt;Quantity [0.        , 0.        , 0.        , ..., 0.09480264, 0.09410727,
           0.09341189] 1e-19 erg / (Angstrom s cm2)&gt;, spectral_axis=&lt;SpectralAxis [   177.0306,    178.6128,    180.195 , ..., 170526.    , 171229.2   ,
   171932.4   ] Angstrom&gt;)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec1d</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">spec1d</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tm_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">tm_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">6000</span><span class="p">,</span> <span class="mi">9000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_norm</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec1d_sub</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Observed spectrum and best-fitting model template&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e4175dd71461945439d610e0e349d7f888b646f67a66a2b5ca4a3bc8ef9e5559.png" src="../../_images/e4175dd71461945439d610e0e349d7f888b646f67a66a2b5ca4a3bc8ef9e5559.png" />
</div>
</div>
</section>
</section>
<section id="potential-next-steps">
<h2>Potential next steps:<a class="headerlink" href="#potential-next-steps" title="Permalink to this heading">#</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- Automatic template *fitting* to get the redshift
- Measure if emission-line profile is consistent with PSF
- Measure line intensities in 2D
- Convert distances from pixels to kpc
- Run the line measurements on a set of lines
- Run the whole procedure on all galaxies detected on a mask
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/mos-spectroscopy"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-versions-should-be">Check versions. Should be:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-path-to-data-and-download-from-box-link">Set path to data and download from box link</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-one-galaxy">Choose one galaxy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-its-2d-spectrum">Inspect its 2D spectrum</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#developer-note">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-work-with-1d-spectrum">Now work with 1D spectrum</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrate-in-wavelength-inspect-and-write-in-spectrum1d-object">Calibrate (in wavelength), inspect, and write in Spectrum1D object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#go-with-specutils">Go with specutils</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Developer note</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smooth-to-better-inspect-the-features">Smooth to better inspect the features</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-the-non-smoothed-spectrum-to-find-lines">Back to the non-smoothed spectrum to find lines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#so-fit-continuum-first">So fit continuum first</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-continuum-subtracted-spectrum">Creating the continuum-subtracted spectrum</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-look-for-the-lines">Now look for the lines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#works-better-with-find-lines-threshold">Works better with find_lines_threshold</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Developer note</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measure-line-centroids-and-fluxes">Measure line centroids and fluxes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-the-line-with-a-gaussian">Fit the line with a Gaussian</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measure-the-equivalent-width-of-the-lines">Measure the equivalent width of the lines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-best-fitting-template">Find the best-fitting template</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Developer note</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-next-steps">Potential next steps:</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>