
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extended Aperture Photometry &#8212; STScI JDAT Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css?v=b44a18d9" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D46G4HKJY3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D46G4HKJY3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D46G4HKJY3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"023d1b9df26e417d8ccc20369265e911": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "167de6b40bf140c1958928aeb9a17895": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_bea14c9254cd4663aa05101ab16407ef", "placeholder": "\u200b", "style": "IPY_MODEL_a19f035161ab4208bd0973ec175f50b3", "tabbable": null, "tooltip": null, "value": "Deblending:\u2007100%"}}, "3c44c9ce11c04c47a65bd1a8cc60b31f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "4ab0dc13713f4f47bfbcb71c7b27228c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "4e21e20df1f447daaf1d4dc273628eb7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_167de6b40bf140c1958928aeb9a17895", "IPY_MODEL_7882ade2253848a18aa591fe315a08ec", "IPY_MODEL_f30d8a3ca2e94ab4ae8646ac725beb3b"], "layout": "IPY_MODEL_023d1b9df26e417d8ccc20369265e911", "tabbable": null, "tooltip": null}}, "5e3773dd6ef449debe5cd06e04d49ede": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7882ade2253848a18aa591fe315a08ec": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c430667c8e284011bc9ae1fe62eb701d", "max": 255.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_3c44c9ce11c04c47a65bd1a8cc60b31f", "tabbable": null, "tooltip": null, "value": 255.0}}, "a19f035161ab4208bd0973ec175f50b3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "bea14c9254cd4663aa05101ab16407ef": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c430667c8e284011bc9ae1fe62eb701d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f30d8a3ca2e94ab4ae8646ac725beb3b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_5e3773dd6ef449debe5cd06e04d49ede", "placeholder": "\u200b", "style": "IPY_MODEL_4ab0dc13713f4f47bfbcb71c7b27228c", "tabbable": null, "tooltip": null, "value": "\u2007255/255\u2007[00:00&lt;00:00,\u2007253.94it/s,\u2007ID:\u2007303]"}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/NIRCam/NIRCam_photometry/NIRCam_multiband_photometry';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Cross-Filter PSF Matching" href="../NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html" />
    <link rel="prev" title="Point Source Aperture Photometry" href="../aperture_photometry/NIRCam_Aperture_Photometry_Example.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="STScI JDAT Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="STScI JDAT Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">General</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebook_development_workflow.html">Notebook Development Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/submitting_notebooks.html">Submitting Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/requirements.html">Requirements file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/data_files.html">Data Files</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GitHub Guidelines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_setup.html">GitHub Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_workflow.html">GitHub Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_pr.html">GitHub PR</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">JDAViz Demo Notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../jdaviz_demo/notebooks/Cubeviz.html">Cubeviz with NIRSpec data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jdaviz_demo/notebooks/Imviz.html">Jdaviz Imviz Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jdaviz_demo/notebooks/Specviz_Specviz2d.html">Specviz and Specviz2D Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jdaviz_demo/notebooks/specreduce_extraction.html">Specreduce Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cross-Instrument</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/asdf_example/asdf_example.html">ASDF Example</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/background_estimation_imaging/Imaging_Sky_Background_Estimation.html">Complex 2D Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/composite_model_fitting/specfit_demo_3.html">Composite Model Spectral Fitting</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/rgb_imviz/imviz_rgb_carina.html">RGB images with Imviz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/specviz_notebookGUI_interaction/specviz_notebook_gui_interaction_redshift.html">Specviz Simple Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/update_pure_parallel_wcs/NIRISS_correct_pure_parallel_WCS.html">Improving Accuracy of WCS of Pure Parallel Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/photometry_extragalactic/imviz.html">Photometry with JWST - Imviz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/photometry_extragalactic/photutils_example.html">Photometry of a JWST/NIRCam extragalactic field with Photutils</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/stpsf_examples/stpsf_examples.html">JWST PSFs Using Wavefronts Measured On Orbit</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MIRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../MIRI/MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html">MRS Mstar - Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../MIRI/MIRI_IFU_YSOs_in_the_LMC/isha_nayak_ysos_in_the_lmc.html">IFU of YSOs in LMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../MIRI/psf_photometry/miri_1028.html">MIRI PSF Photometry With Space_Phot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../MIRI/psf_photometry/miri_1028_photutils.html">MIRI PSF Photometry with Photutils</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../MIRI/psf_photometry/miri_photutils.html">MIRI PSF Photometry with Photutils</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../MIRI/psf_photometry/miri_spacephot.html">MIRI PSF Photometry With Space_Phot</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRCam</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../aperture_photometry/NIRCam_Aperture_Photometry_Example.html">Point Source Aperture Photometry</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Extended Aperture Photometry</a></li>


<li class="toctree-l1"><a class="reference internal" href="../NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html">Cross-Filter PSF Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../psf_photometry/NIRCam_PSF_Photometry_Example.html">PSF Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRCam_wisp_subtraction/nircam_wisp_subtraction.html">NIRCam Wisp Removal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRCam_claw_detection/nircam_claw_detection.html">NIRCam Claw Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRCam_WFSS_Box_extraction/BoxExtraction_using_Grismconf_CRDS.html">WFSS Box Extraction Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NIRCam_WFSS_simulating_spectra/Simulating_WFSS_spectra_CRDS.html">WFSS Spectra Simulation for Contamination Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../psf_photometry_basics/psf_photometry_basics.html">PSF Photometry Basics with Photutils</a></li>









<li class="toctree-l1"><a class="reference internal" href="../psf_photometry_with_space_phot/nircam_spacephot.html">NIRCam PSF Photometry With Space_Phot</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRISS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/00_Optimal_extraction.html">WFSS Spectra - Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/01_Combine_and_normalize_1D_spectra.html">WFSS Spectra - Combine and Normalize 1D Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/02_Cross_correlation_template.html">WFSS Spectra - Cross-Correlation Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/03_Spatially_resolved_emission_line_map.html">WFSS Spectra - Emission Line Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/00_niriss_mast_query_data_setup.html">NIRISS MAST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/01_niriss_wfss_image2_image3.html">Direct imaging for WFSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/02_niriss_wfss_spec2.html">Spec2 pipeline for WFSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/extra_niriss_individual_steps.html">Running Individual Pipline Steps</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRSpec</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/IFU_cube_continuum_fit/NGC4151_FeII_ContinuumFit.html">IFU Cube Fitting</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/cube_fitting/cube_fitting.html">IFU Cube Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/ifu_optimal/ifu_optimal.html">IFU Optimal Spectral Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/optimal_extraction/Spectral_Extraction-static.html">MOS Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/mos_spectroscopy_advanced/MOSspec_advanced.html">MOS Spectroscopy of Extragalactic Field</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/mos_master_background/Master_Background_MOS_Demo.html">Master Background Subtraction for Multi-Object Spectroscopy (MOS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/msa_metafile/NIRSpec_MOS_MSA_metafile.html">NIRSpec MOS MSA Metafile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/mos_slits_to_sky/NIRSpec_MOS_slits_to_sky.html">NIRSpec MOS Slits to Sky</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/transit_spectroscopy_notebook/Exoplanet_Transmission_Spectra_JWST.html">BOTS Time Series Observations</a></li>








<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/galaxy_redshift/redshift_fitting.html">Redshift and Template Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/FS_NSClean_example.html">FS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/IFU_NSClean_example.html">IFU Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/MOS_NSClean_example.html">MOS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/BOTS_NSClean_example.html">BOTS Products with NSClean</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/NIRCam/NIRCam_photometry/NIRCam_multiband_photometry.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/NIRCam/NIRCam_photometry/NIRCam_multiband_photometry.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Extended Aperture Photometry</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Extended Aperture Photometry</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#to-do">To Do</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-webbpsf-data">Download WEBBPSF Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matplotlib-setup-for-plotting">Matplotlib setup for plotting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-list-of-images-to-be-loaded-and-analyzed">Create list of images to be loaded and analyzed</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-detection-image-f200w">Load detection image: F200W</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#report-image-size-and-field-of-view">Report image size and field of view</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-color-image-optional">Create color image (optional)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detect-sources-and-deblend-using-photutils">Detect Sources and Deblend using <code class="docutils literal notranslate"><span class="pre">photutils</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measure-photometry-and-more-in-detection-image">Measure photometry (and more) in detection image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#show-detections-alongside-images-optional">Show detections alongside images (optional)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-all-measured-quantities-in-detection-image-optional">View all measured quantities in detection image (optional)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#only-keep-some-quantities">Only keep some quantities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-measured-fluxes-data-units-to-magnitudes">Convert measured fluxes (data units) to magnitudes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiband-photometry-using-isophotal-apertures-defined-in-detection-image">Multiband photometry using isophotal apertures defined in detection image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-complete-results-optional">View complete results (optional)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-photometry-as-output-catalog">Save photometry as output catalog</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reformat-output-catalog-for-readability-optional">Reformat output catalog for readability (optional)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#start-new-session-and-analyze-results">Start new session and analyze results</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-catalog-and-segmentation-map">Load catalog and segmentation map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-number-counts-vs-magnitude">Plot number counts vs. magnitude</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-f200w-vs-f090w-magnitudes-and-look-for-dropouts">Plot F200W vs. F090W magnitudes and look for dropouts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#look-at-one-object">Look at one object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#show-the-object-in-all-the-images">Show the object in all the images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-sed-spectral-energy-distribution">Plot SED (Spectral Energy Distribution)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#magnitude-conversion-fails-for-flux-0">Magnitude conversion fails for flux &lt;= 0</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="extended-aperture-photometry">
<h1>Extended Aperture Photometry<a class="headerlink" href="#extended-aperture-photometry" title="Link to this heading">#</a></h1>
<p><strong>Use case:</strong> Measure galaxy photometry in a field. Related to <a class="reference external" href="https://jwst-docs.stsci.edu/near-infrared-camera/nircam-example-science-programs/nircam-deep-field-imaging-with-miri-imaging-parallels">JDox Science Use Case #22</a>.<br>
<strong>Data:</strong> WST simulated NIRCam images from <a class="reference external" href="http://fenrir.as.arizona.edu/jwstmock/">JADES JWST GTO extragalactic blank field</a>.<br>
(Williams et al. 2018) https://ui.adsabs.harvard.edu/abs/2018ApJS..236…33W.<br>
<strong>Tools:</strong>  photutils, matplotlib, scipy, scikit.<br>
<strong>Cross-intrument:</strong> potentially MIRI.<br>
<strong>Documentation:</strong> This notebook is part of a STScI’s larger <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-post-pipeline-data-analysis">post-pipeline Data Analysis Tools Ecosystem</a>.<br></p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This notebook uses <code class="docutils literal notranslate"><span class="pre">photutils</span></code> to detect objects/galaxies in NIRCam deep imaging.  Detections are first made in a F200W image, then isophotal photometry is obtained in all 9 filters (F090W, F115W, F150W, F200W, F277W, F335M, F356W, F410M, F444W). The catalog is loaded back in and some simple analysis is performed on the full catalog and on an individual galaxy.</p>
<p>The notebook analyzes only the central 1000 x 1000 pixels (30” x 30”) of the full JADES simulation. These cutouts have been staged at STScI with permission from the authors (Williams et al.).</p>
<p><strong>NOTE:</strong> The photometry is aperture matched, but no PSF corrections are made. For more accurate color measurements, PSF corrections should be implemented, given the large range of wavelengths (and thus PSF FWHM) spanning a factor of &gt;4.</p>
<p><strong>NOTE:</strong> The simulated JADES images have different units (e-/s) than JWST pipeline products (MJy/sr).</p>
<p><strong>NOTE:</strong> An exposure map is missing but required to calculate flux uncertainties.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="to-do">
<h1>To Do<a class="headerlink" href="#to-do" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>PSF corrections</p></li>
<li><p>Check accuracy of photometry against simulated JADES catalog</p></li>
<li><p>Exposure map required for input to error calculation</p></li>
<li><p>ABmag units cannot be written to ecsv file (astropy update coming soon)</p></li>
<li><p>plot with text labels looks horrible (I wish cursor hover would show id number instead)</p></li>
<li><p>Fix plot secondary axis: mag vs. flux</p></li>
<li><p>requirements.txt file – but I don’t know what versions are “required”</p></li>
<li><p>rest of Robel’s comments: https://github.com/spacetelescope/dat_pyinthesky/pull/82#pullrequestreview-355206337</p></li>
</ul>
<section id="download-webbpsf-data">
<h2>Download WEBBPSF Data<a class="headerlink" href="#download-webbpsf-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tarfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">urllib.request</span>

<span class="n">boxlink</span> <span class="o">=</span> <span class="s1">&#39;https://stsci.box.com/shared/static/34o0keicz2iujyilg4uz617va46ks6u9.gz&#39;</span>                                                           
<span class="n">boxfile</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data/webbpsf-data-1.0.0.tar.gz&#39;</span>

<span class="n">webbpsf_folder</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data&#39;</span>

<span class="c1"># Check whether the specified path exists or not</span>
<span class="n">isExist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">isExist</span><span class="p">:</span>
  <span class="c1"># Create a new directory because it does not exist </span>
  <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
    
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">boxlink</span><span class="p">,</span> <span class="n">boxfile</span><span class="p">)</span>
<span class="n">gzf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">boxfile</span><span class="p">)</span>
<span class="n">gzf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span> <span class="c1"># add filter=&#39;data&#39; to skip absolute (/) or relative (..) paths</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-packages">
<h2>Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.convolution</span><span class="w"> </span><span class="kn">import</span> <span class="n">convolve</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">gaussian_fwhm_to_sigma</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTable</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_lupton_rgb</span><span class="p">,</span> <span class="n">SqrtStretch</span><span class="p">,</span> <span class="n">ImageNormalize</span><span class="p">,</span> <span class="n">simple_norm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.wcs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wcs</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">photutils.background</span><span class="w"> </span><span class="kn">import</span> <span class="n">Background2D</span><span class="p">,</span> <span class="n">MedianBackground</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">photutils.segmentation</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">detect_sources</span><span class="p">,</span> <span class="n">deblend_sources</span><span class="p">,</span> <span class="n">SourceCatalog</span><span class="p">,</span>
                                    <span class="n">make_2dgaussian_kernel</span><span class="p">,</span> <span class="n">SegmentationImage</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">photutils.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">calc_total_error</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="matplotlib-setup-for-plotting">
<h2>Matplotlib setup for plotting<a class="headerlink" href="#matplotlib-setup-for-plotting" title="Link to this heading">#</a></h2>
<p>There are two versions</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">notebook</span></code> – gives interactive plots, but makes the overall notebook a bit harder to scroll</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inline</span></code> – gives non-interactive plots for better overall scrolling</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>

<span class="c1"># Use this version for non-interactive plots (easier scrolling of the notebook)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Use this version if you want interactive plots</span>
<span class="c1"># %matplotlib notebook</span>

<span class="c1"># These gymnastics are needed to make the sizes of the figures</span>
<span class="c1"># be the same in both the inline and notebook versions</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.print_figure_kwargs = {&#39;bbox_inches&#39;: None}

<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-list-of-images-to-be-loaded-and-analyzed">
<h2>Create list of images to be loaded and analyzed<a class="headerlink" href="#create-list-of-images-to-be-loaded-and-analyzed" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">baseurl</span> <span class="o">=</span> <span class="s1">&#39;https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/&#39;</span>

<span class="n">filters</span> <span class="o">=</span> <span class="s1">&#39;F090W F115W F150W F200W F277W F335M F356W F410M F444W&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="c1"># Data images [e-/s]</span>
<span class="n">imagefiles</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;jades_jwst_nircam_goods_s_crop_</span><span class="si">{</span><span class="n">filt</span><span class="si">}</span><span class="s1">.fits&#39;</span>
    <span class="n">imagefiles</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">baseurl</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="c1"># Weight images (Inverse Variance Maps; IVM)</span>
<span class="n">weightfiles</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;jades_jwst_nircam_goods_s_crop_</span><span class="si">{</span><span class="n">filt</span><span class="si">}</span><span class="s1">_wht.fits&#39;</span>
    <span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">baseurl</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-detection-image-f200w">
<h2>Load detection image: F200W<a class="headerlink" href="#load-detection-image-f200w" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filt</span> <span class="o">=</span> <span class="s1">&#39;F200W&#39;</span>
<span class="n">infile</span> <span class="o">=</span> <span class="n">imagefiles</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">imwcs</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">,</span> <span class="n">hdu</span><span class="p">)</span>

<span class="n">weight</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="report-image-size-and-field-of-view">
<h2>Report image size and field of view<a class="headerlink" href="#report-image-size-and-field-of-view" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">pixscale</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">proj_plane_pixel_scales</span><span class="p">(</span><span class="n">imwcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> 
<span class="n">pixscale</span> <span class="o">*=</span> <span class="n">imwcs</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">cunit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;arcsec&#39;</span><span class="p">)</span>
<span class="n">outline</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> x </span><span class="si">%d</span><span class="s1"> pixels&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">outline</span> <span class="o">+=</span> <span class="s1">&#39; = </span><span class="si">%g</span><span class="s1">&quot; x </span><span class="si">%g</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ny</span> <span class="o">*</span> <span class="n">pixscale</span><span class="p">,</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">pixscale</span><span class="p">)</span>
<span class="n">outline</span> <span class="o">+=</span> <span class="s1">&#39; (</span><span class="si">%.2f</span><span class="s1">&quot; / pixel)&#39;</span> <span class="o">%</span> <span class="n">pixscale</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outline</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000 x 1000 pixels = 30&quot; x 30&quot; (0.03&quot; / pixel)
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-color-image-optional">
<h2>Create color image (optional)<a class="headerlink" href="#create-color-image-optional" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3 NIRCam short wavelength channel images</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imagefiles</span><span class="p">[</span><span class="s1">&#39;F200W&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imagefiles</span><span class="p">[</span><span class="s1">&#39;F150W&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imagefiles</span><span class="p">[</span><span class="s1">&#39;F090W&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">rgb</span> <span class="o">=</span> <span class="n">make_lupton_rgb</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>  <span class="c1"># , minimum=-0.001</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">imwcs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Right Ascension&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Declination&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/8790ccdd09cd7d0ac23be058be02c9860b57082998e4f114336fedeecfca4c50.png" src="../../../_images/8790ccdd09cd7d0ac23be058be02c9860b57082998e4f114336fedeecfca4c50.png" />
</div>
</div>
</section>
<section id="detect-sources-and-deblend-using-photutils">
<h2>Detect Sources and Deblend using <code class="docutils literal notranslate"><span class="pre">photutils</span></code><a class="headerlink" href="#detect-sources-and-deblend-using-photutils" title="Link to this heading">#</a></h2>
<p>https://photutils.readthedocs.io/en/latest/segmentation.html</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For detection, requiring 5 connected pixels 2-sigma above background</span>

<span class="c1"># Measure background and set detection threshold</span>
<span class="n">bkg_estimator</span> <span class="o">=</span> <span class="n">MedianBackground</span><span class="p">()</span>
<span class="n">bkg</span> <span class="o">=</span> <span class="n">Background2D</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">filter_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">bkg_estimator</span><span class="p">)</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">bkg</span><span class="o">.</span><span class="n">background</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">bkg</span><span class="o">.</span><span class="n">background_rms</span><span class="p">)</span>

<span class="c1"># Before detection, smooth image with Gaussian FWHM = 3 pixels</span>
<span class="n">smooth_kernel</span> <span class="o">=</span> <span class="n">make_2dgaussian_kernel</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">convolved_data</span> <span class="o">=</span> <span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">smooth_kernel</span><span class="p">)</span>

<span class="c1"># Detect and deblend</span>
<span class="n">segm_detect</span> <span class="o">=</span> <span class="n">detect_sources</span><span class="p">(</span><span class="n">convolved_data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">npixels</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">segm_deblend</span> <span class="o">=</span> <span class="n">deblend_sources</span><span class="p">(</span><span class="n">convolved_data</span><span class="p">,</span> <span class="n">segm_detect</span><span class="p">,</span> <span class="n">npixels</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">nlevels</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

<span class="c1"># Save segmentation map of detected objects</span>
<span class="n">segm_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">segm_deblend</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="n">imwcs</span><span class="o">.</span><span class="n">to_header</span><span class="p">())</span>
<span class="n">segm_hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;JADES_detections_segm.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img style="display: block; margin: auto; width: 50%;" src="../../../jdaviz_placeholder_new.png">
</div>
</section>
<section id="measure-photometry-and-more-in-detection-image">
<h2>Measure photometry (and more) in detection image<a class="headerlink" href="#measure-photometry-and-more-in-detection-image" title="Link to this heading">#</a></h2>
<p>https://photutils.readthedocs.io/en/latest/segmentation.html#centroids-photometry-and-morphological-properties</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#error = bkg.background_rms</span>
<span class="c1"># Input weight should be exposure map. Fudging for now.</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">calc_total_error</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bkg</span><span class="o">.</span><span class="n">background_rms</span><span class="p">,</span> <span class="n">weight</span><span class="o">/</span><span class="mi">500</span><span class="p">)</span>
<span class="c1">#cat = source_properties(data-bkg.background, segm_deblend, wcs=imwcs, background=bkg.background, error=error)</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">SourceCatalog</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">bkg</span><span class="o">.</span><span class="n">background</span><span class="p">,</span> <span class="n">segm_deblend</span><span class="p">,</span> <span class="n">wcs</span><span class="o">=</span><span class="n">imwcs</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="o">.</span><span class="n">background</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="show-detections-alongside-images-optional">
<h2>Show detections alongside images (optional)<a class="headerlink" href="#show-detections-alongside-images-optional" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># For RA,Dec axes instead of pixels, add: , subplot_kw={&#39;projection&#39;: imwcs})</span>

<span class="c1"># Color image</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Color Image&#39;</span><span class="p">)</span>

<span class="c1"># Data</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mf">99.</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Detection Image F200W&#39;</span><span class="p">)</span>

<span class="c1"># Segmentation map</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">segm_deblend</span><span class="o">.</span><span class="n">make_cmap</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">segm_deblend</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Detections (Segmentation Image)&#39;</span><span class="p">)</span>

<span class="c1"># Weight</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Weight Image F200W&#39;</span><span class="p">)</span>

<span class="c1"># RMS</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bkg</span><span class="o">.</span><span class="n">background_rms</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Background RMS&#39;</span><span class="p">)</span>

<span class="c1"># Total error including Poisson noise</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mf">99.</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;RMS + Poisson noise&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ee8413fc53bdb94d8a29cc0bedc0e4b981f58390f8038a90ea7c246c207a1d94.png" src="../../../_images/ee8413fc53bdb94d8a29cc0bedc0e4b981f58390f8038a90ea7c246c207a1d94.png" />
</div>
</div>
</section>
<section id="view-all-measured-quantities-in-detection-image-optional">
<h2>View all measured quantities in detection image (optional)<a class="headerlink" href="#view-all-measured-quantities-in-detection-image-optional" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=326</i>
<table id="table139666232495760" class="table-striped table-bordered table-condensed">
<thead><tr><th>label</th><th>xcentroid</th><th>ycentroid</th><th>sky_centroid</th><th>bbox_xmin</th><th>bbox_xmax</th><th>bbox_ymin</th><th>bbox_ymax</th><th>area</th><th>semimajor_sigma</th><th>semiminor_sigma</th><th>orientation</th><th>eccentricity</th><th>min_value</th><th>max_value</th><th>local_background</th><th>segment_flux</th><th>segment_fluxerr</th><th>kron_flux</th><th>kron_fluxerr</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th>deg,deg</th><th></th><th></th><th></th><th></th><th>pix2</th><th>pix</th><th>pix</th><th>deg</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>int32</th><th>float64</th><th>float64</th><th>SkyCoord</th><th>int64</th><th>int64</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1</td><td>466.24461350033647</td><td>8.7975642602371</td><td>53.17381009103326,-27.805320830365776</td><td>460</td><td>472</td><td>3</td><td>14</td><td>101.0</td><td>3.121883592723396</td><td>1.687718238373556</td><td>-44.478947493786606</td><td>0.8412740063312978</td><td>0.0006697164628791134</td><td>0.03003565456943476</td><td>0.0</td><td>0.8863594626861904</td><td>0.04333105379347733</td><td>1.1523646398846878</td><td>0.05542864325311204</td></tr>
<tr><td>2</td><td>104.80681791619067</td><td>18.082129411035602</td><td>53.17721522973072,-27.805243193448323</td><td>95</td><td>116</td><td>10</td><td>27</td><td>271.0</td><td>4.4330760205526705</td><td>2.8904310038200527</td><td>-26.54972210581966</td><td>0.7582062720085906</td><td>0.001169592682614256</td><td>0.05683289995260978</td><td>0.0</td><td>3.3850931796608226</td><td>0.10096273567434758</td><td>4.064307886560463</td><td>0.1178471432803697</td></tr>
<tr><td>3</td><td>15.04416396551755</td><td>13.21870964358083</td><td>53.178060898531776,-27.805283643045666</td><td>14</td><td>16</td><td>12</td><td>14</td><td>8.0</td><td>0.8501945455843772</td><td>0.6682678017840504</td><td>-38.1612276642421</td><td>0.6182042301587309</td><td>0.0035728101756059504</td><td>0.006067336431199741</td><td>0.0</td><td>0.04072228096572398</td><td>0.011222825585360583</td><td>0.10086850698470742</td><td>0.02315230578296353</td></tr>
<tr><td>4</td><td>710.3242889701858</td><td>14.259777138086877</td><td>53.17151058505514,-27.805275444028442</td><td>708</td><td>712</td><td>12</td><td>17</td><td>25.0</td><td>1.2749753643104456</td><td>1.117371994707132</td><td>-59.26178196559024</td><td>0.4816073152747641</td><td>0.0013530635966815864</td><td>0.015100956012602468</td><td>0.0</td><td>0.15496901383687856</td><td>0.018575211927226793</td><td>0.19011686546526946</td><td>0.023625589169720226</td></tr>
<tr><td>5</td><td>434.5294891713508</td><td>22.219091527997158</td><td>53.17410887322447,-27.8052089643638</td><td>424</td><td>447</td><td>14</td><td>30</td><td>268.0</td><td>3.9551276120227397</td><td>2.6287674709150584</td><td>-8.140060370882344</td><td>0.7471566761152122</td><td>-0.0003420958396561837</td><td>0.10656058422736421</td><td>0.0</td><td>3.6147863822998016</td><td>0.08773502088121837</td><td>4.278741209374845</td><td>0.10086436727140968</td></tr>
<tr><td>6</td><td>289.38802515014896</td><td>17.281765562153954</td><td>53.17547627056455,-27.805250009193262</td><td>287</td><td>291</td><td>15</td><td>20</td><td>17.0</td><td>1.2913044931147235</td><td>1.1978568863866517</td><td>68.12270923149859</td><td>0.37349256122504115</td><td>0.0019512862197305747</td><td>0.008797215945005498</td><td>0.0</td><td>0.08513804286457863</td><td>0.0166428570162664</td><td>0.34384198668200716</td><td>0.045989916939691816</td></tr>
<tr><td>7</td><td>640.4863091995317</td><td>17.773429154661983</td><td>53.17216853452775,-27.805246129692247</td><td>638</td><td>642</td><td>15</td><td>20</td><td>21.0</td><td>1.5124916692884618</td><td>0.8803106550282112</td><td>-64.72678377811528</td><td>0.8131696183154983</td><td>0.0003576250881105088</td><td>0.009946935910809692</td><td>0.0</td><td>0.09708323832036175</td><td>0.014462494201596655</td><td>0.17695836262605436</td><td>0.026075310664432968</td></tr>
<tr><td>8</td><td>762.762291737285</td><td>28.289914155884627</td><td>53.171016553902064,-27.805158549648304</td><td>754</td><td>771</td><td>21</td><td>36</td><td>200.0</td><td>3.160315774736445</td><td>2.3536095208280066</td><td>37.520056617399476</td><td>0.6673561574146197</td><td>-0.0001941792050655057</td><td>0.10556121967783572</td><td>0.0</td><td>3.8212752545169955</td><td>0.08847910158114891</td><td>3.9811392641181644</td><td>0.09150995786991047</td></tr>
<tr><td>9</td><td>801.0706722163886</td><td>32.58026118517374</td><td>53.17065564474934,-27.805122812753073</td><td>799</td><td>804</td><td>31</td><td>34</td><td>12.0</td><td>1.3349434908844906</td><td>0.6567170220834244</td><td>-28.75519616047975</td><td>0.8706270208190223</td><td>0.0018856854900614819</td><td>0.009336017794193286</td><td>0.0</td><td>0.05935203501404956</td><td>0.012189355644992149</td><td>0.17003504172320322</td><td>0.027778386430149567</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>318</td><td>13.420742051379385</td><td>884.694395861645</td><td>53.17807529846922,-27.798021345154865</td><td>6</td><td>21</td><td>877</td><td>892</td><td>185.0</td><td>3.285450616131066</td><td>3.147908093244288</td><td>-13.393044858704108</td><td>0.2863139002521662</td><td>0.0014361034419094758</td><td>0.03495382468946091</td><td>0.0</td><td>2.117442472888257</td><td>0.10785932211319861</td><td>3.411588966877565</td><td>0.15467709845637975</td></tr>
<tr><td>319</td><td>7.027176577444122</td><td>891.9727894960166</td><td>53.17813552144662,-27.797960686059632</td><td>5</td><td>11</td><td>889</td><td>895</td><td>29.0</td><td>1.603195468602836</td><td>1.3128724093575075</td><td>-82.75208405786572</td><td>0.5739223050191917</td><td>0.0019018454919824644</td><td>0.01347560203904176</td><td>0.0</td><td>0.21412965179118829</td><td>0.035024475587970415</td><td>0.6893013683010651</td><td>0.07610234326451545</td></tr>
<tr><td>320</td><td>143.92969676102126</td><td>953.6973600108524</td><td>53.17684577662435,-27.797446433611444</td><td>139</td><td>149</td><td>950</td><td>957</td><td>59.0</td><td>2.6507581110195266</td><td>1.3964068465385502</td><td>25.19703083525805</td><td>0.849992199281631</td><td>0.0021617009219625062</td><td>0.021165230633174926</td><td>0.0</td><td>0.5681924075559929</td><td>0.05743803199966468</td><td>1.254760987505672</td><td>0.10492362090925443</td></tr>
<tr><td>321</td><td>142.746173256619</td><td>959.5389917866399</td><td>53.176856920479636,-27.797397752374</td><td>139</td><td>147</td><td>957</td><td>963</td><td>48.0</td><td>2.1427436610213637</td><td>1.2555061677914512</td><td>-35.47427950196171</td><td>0.8103588434156908</td><td>0.00047583665796055224</td><td>0.030453184966657037</td><td>0.0</td><td>0.5637982114834339</td><td>0.0568718012708143</td><td>0.8893801784930943</td><td>0.08214060528713435</td></tr>
<tr><td>322</td><td>790.415367777511</td><td>955.3106960545537</td><td>53.17075559998907,-27.797433388936582</td><td>784</td><td>796</td><td>951</td><td>959</td><td>93.0</td><td>2.621691845359079</td><td>1.8772136125476881</td><td>5.157966396104574</td><td>0.6980681000951601</td><td>0.0005767950066928708</td><td>0.04023169644016939</td><td>0.0</td><td>1.115611206251331</td><td>0.07893942785469334</td><td>1.6521126492979301</td><td>0.10804543306519865</td></tr>
<tr><td>323</td><td>797.3397409211948</td><td>965.5478941851635</td><td>53.17069036467991,-27.797348081794517</td><td>792</td><td>802</td><td>958</td><td>974</td><td>121.0</td><td>3.0304070507432326</td><td>1.7633197784086392</td><td>79.51657917516623</td><td>0.8132778374227926</td><td>0.002333420221800177</td><td>0.08761686954182783</td><td>0.0</td><td>2.116916544882111</td><td>0.10637880974470741</td><td>2.8478971911033626</td><td>0.1315925489047444</td></tr>
<tr><td>324</td><td>790.7983558965504</td><td>979.5822296300561</td><td>53.17075198078638,-27.79723112632807</td><td>781</td><td>799</td><td>972</td><td>989</td><td>133.0</td><td>4.506451359665357</td><td>1.493045462994405</td><td>-44.19824469199431</td><td>0.9435209394229406</td><td>-0.001248849458808359</td><td>0.06943444193177313</td><td>0.0</td><td>2.002750597650743</td><td>0.10372107669936124</td><td>2.813577038594517</td><td>0.13630578304670982</td></tr>
<tr><td>325</td><td>307.7502590912509</td><td>989.993370703415</td><td>53.175302486237165,-27.797144093448775</td><td>305</td><td>311</td><td>987</td><td>993</td><td>37.0</td><td>1.707727984108737</td><td>1.1914329585464343</td><td>-56.82602073196763</td><td>0.7164179156288306</td><td>0.0017972712412996086</td><td>0.030535860130823354</td><td>0.0</td><td>0.3875293679154765</td><td>0.046167097763049746</td><td>0.7369473920493916</td><td>0.07417814641467854</td></tr>
<tr><td>326</td><td>306.8506442261885</td><td>997.243644725512</td><td>53.1753109550711,-27.797083673855024</td><td>302</td><td>312</td><td>994</td><td>999</td><td>51.0</td><td>2.5021353669231527</td><td>1.4883885517566502</td><td>15.388098948641728</td><td>0.8038386961956926</td><td>0.002853197675265836</td><td>0.02047051119926145</td><td>0.0</td><td>0.5505454403242959</td><td>0.05460363335321445</td><td>0.7777606691520305</td><td>0.07156975624994025</td></tr>
</table></div></div></div>
</div>
</section>
<section id="only-keep-some-quantities">
<h2>Only keep some quantities<a class="headerlink" href="#only-keep-some-quantities" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;label xcentroid ycentroid sky_centroid area semimajor_sigma semiminor_sigma ellipticity orientation gini&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">to_table</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">tbl</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;semimajor_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">tbl</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s1">&#39;semiminor_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tbl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=326</i>
<table id="table139666230325584" class="table-striped table-bordered table-condensed">
<thead><tr><th>label</th><th>xcentroid</th><th>ycentroid</th><th>sky_centroid</th><th>area</th><th>a</th><th>b</th><th>ellipticity</th><th>orientation</th><th>gini</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th>deg,deg</th><th>pix2</th><th>pix</th><th>pix</th><th></th><th>deg</th><th></th></tr></thead>
<thead><tr><th>int32</th><th>float64</th><th>float64</th><th>SkyCoord</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1</td><td>466.24461350033647</td><td>8.7975642602371</td><td>53.17381009103326,-27.805320830365776</td><td>101.0</td><td>3.121883592723396</td><td>1.687718238373556</td><td>0.4593910412587602</td><td>-44.478947493786606</td><td>0.3750841422808698</td></tr>
<tr><td>2</td><td>104.80681791619067</td><td>18.082129411035602</td><td>53.17721522973072,-27.805243193448323</td><td>271.0</td><td>4.4330760205526705</td><td>2.8904310038200527</td><td>0.34798523859744157</td><td>-26.54972210581966</td><td>0.4292034166747856</td></tr>
<tr><td>3</td><td>15.04416396551755</td><td>13.21870964358083</td><td>53.178060898531776,-27.805283643045666</td><td>8.0</td><td>0.8501945455843772</td><td>0.6682678017840504</td><td>0.21398248759086114</td><td>-38.1612276642421</td><td>0.10521135944081007</td></tr>
<tr><td>4</td><td>710.3242889701858</td><td>14.259777138086877</td><td>53.17151058505514,-27.805275444028442</td><td>25.0</td><td>1.2749753643104456</td><td>1.117371994707132</td><td>0.12361287442487268</td><td>-59.26178196559024</td><td>0.33737600483155716</td></tr>
<tr><td>5</td><td>434.5294891713508</td><td>22.219091527997158</td><td>53.17410887322447,-27.8052089643638</td><td>268.0</td><td>3.9551276120227397</td><td>2.6287674709150584</td><td>0.33535204706817323</td><td>-8.140060370882344</td><td>0.5363680123723463</td></tr>
<tr><td>6</td><td>289.38802515014896</td><td>17.281765562153954</td><td>53.17547627056455,-27.805250009193262</td><td>17.0</td><td>1.2913044931147235</td><td>1.1978568863866517</td><td>0.07236682535090477</td><td>68.12270923149859</td><td>0.18041073594089005</td></tr>
<tr><td>7</td><td>640.4863091995317</td><td>17.773429154661983</td><td>53.17216853452775,-27.805246129692247</td><td>21.0</td><td>1.5124916692884618</td><td>0.8803106550282112</td><td>0.41797322067741016</td><td>-64.72678377811528</td><td>0.257339933672325</td></tr>
<tr><td>8</td><td>762.762291737285</td><td>28.289914155884627</td><td>53.171016553902064,-27.805158549648304</td><td>200.0</td><td>3.160315774736445</td><td>2.3536095208280066</td><td>0.2552612812799423</td><td>37.520056617399476</td><td>0.5417393494467531</td></tr>
<tr><td>9</td><td>801.0706722163886</td><td>32.58026118517374</td><td>53.17065564474934,-27.805122812753073</td><td>12.0</td><td>1.3349434908844906</td><td>0.6567170220834244</td><td>0.5080563135685205</td><td>-28.75519616047975</td><td>0.28793220448127643</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>318</td><td>13.420742051379385</td><td>884.694395861645</td><td>53.17807529846922,-27.798021345154865</td><td>185.0</td><td>3.285450616131066</td><td>3.147908093244288</td><td>0.041864127316802446</td><td>-13.393044858704108</td><td>0.331692826709577</td></tr>
<tr><td>319</td><td>7.027176577444122</td><td>891.9727894960166</td><td>53.17813552144662,-27.797960686059632</td><td>29.0</td><td>1.603195468602836</td><td>1.3128724093575075</td><td>0.18109024440939903</td><td>-82.75208405786572</td><td>0.254070174248954</td></tr>
<tr><td>320</td><td>143.92969676102126</td><td>953.6973600108524</td><td>53.17684577662435,-27.797446433611444</td><td>59.0</td><td>2.6507581110195266</td><td>1.3964068465385502</td><td>0.47320472557133164</td><td>25.19703083525805</td><td>0.2823870637944277</td></tr>
<tr><td>321</td><td>142.746173256619</td><td>959.5389917866399</td><td>53.176856920479636,-27.797397752374</td><td>48.0</td><td>2.1427436610213637</td><td>1.2555061677914512</td><td>0.41406609169806174</td><td>-35.47427950196171</td><td>0.3421221334166607</td></tr>
<tr><td>322</td><td>790.415367777511</td><td>955.3106960545537</td><td>53.17075559998907,-27.797433388936582</td><td>93.0</td><td>2.621691845359079</td><td>1.8772136125476881</td><td>0.28396862664438105</td><td>5.157966396104574</td><td>0.37596577589838664</td></tr>
<tr><td>323</td><td>797.3397409211948</td><td>965.5478941851635</td><td>53.17069036467991,-27.797348081794517</td><td>121.0</td><td>3.0304070507432326</td><td>1.7633197784086392</td><td>0.4181244470190332</td><td>79.51657917516623</td><td>0.47716929153411286</td></tr>
<tr><td>324</td><td>790.7983558965504</td><td>979.5822296300561</td><td>53.17075198078638,-27.79723112632807</td><td>133.0</td><td>4.506451359665357</td><td>1.493045462994405</td><td>0.6686871012615841</td><td>-44.19824469199431</td><td>0.42319913307021234</td></tr>
<tr><td>325</td><td>307.7502590912509</td><td>989.993370703415</td><td>53.175302486237165,-27.797144093448775</td><td>37.0</td><td>1.707727984108737</td><td>1.1914329585464343</td><td>0.3023286087519126</td><td>-56.82602073196763</td><td>0.35854189153102795</td></tr>
<tr><td>326</td><td>306.8506442261885</td><td>997.243644725512</td><td>53.1753109550711,-27.797083673855024</td><td>51.0</td><td>2.5021353669231527</td><td>1.4883885517566502</td><td>0.4051526662256868</td><td>15.388098948641728</td><td>0.24216628412005226</td></tr>
</table></div></div></div>
</div>
</section>
<section id="convert-measured-fluxes-data-units-to-magnitudes">
<h2>Convert measured fluxes (data units) to magnitudes<a class="headerlink" href="#convert-measured-fluxes-data-units-to-magnitudes" title="Link to this heading">#</a></h2>
<p>https://docs.astropy.org/en/stable/units/</p>
<p>https://docs.astropy.org/en/stable/units/equivalencies.html#photometric-zero-point-equivalency</p>
<p>https://docs.astropy.org/en/stable/units/logarithmic_units.html#logarithmic-units</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># not detected: mag =  99; magerr = 1-sigma upper limit assuming zero flux</span>
<span class="c1"># not observed: mag = -99; magerr = 0</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fluxes2mags</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">fluxerr</span><span class="p">):</span>
    <span class="n">nondet</span> <span class="o">=</span> <span class="n">flux</span> <span class="o">&lt;</span> <span class="mi">0</span>  <span class="c1"># Non-detection if flux is negative</span>
    <span class="n">unobs</span> <span class="o">=</span> <span class="p">(</span><span class="n">fluxerr</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">fluxerr</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>  <span class="c1"># Unobserved if flux uncertainty is negative or infinity</span>

    <span class="n">mag</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">)</span>
    <span class="n">magupperlimit</span> <span class="o">=</span> <span class="n">fluxerr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">)</span>  <span class="c1"># 1-sigma upper limit if flux=0</span>

    <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nondet</span><span class="p">,</span> <span class="mi">99</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">,</span> <span class="n">mag</span><span class="p">)</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">unobs</span><span class="p">,</span> <span class="o">-</span><span class="mi">99</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">,</span> <span class="n">mag</span><span class="p">)</span>

    <span class="n">magerr</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">fluxerr</span><span class="o">/</span><span class="n">flux</span><span class="p">)</span> 
    <span class="n">magerr</span> <span class="o">=</span> <span class="n">magerr</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>

    <span class="n">magerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nondet</span><span class="p">,</span> <span class="n">magupperlimit</span><span class="p">,</span> <span class="n">magerr</span><span class="p">)</span>
    <span class="n">magerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">unobs</span><span class="p">,</span> <span class="mi">0</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">,</span> <span class="n">magerr</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">mag</span><span class="p">,</span> <span class="n">magerr</span>

<span class="c1"># Includes features I couldn&#39;t find in astropy:</span>
<span class="c1"># mag = 99 / -99 for non-detections / unobserved</span>
<span class="c1"># flux uncertainties -&gt; mag uncertainties</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="multiband-photometry-using-isophotal-apertures-defined-in-detection-image">
<h2>Multiband photometry using isophotal apertures defined in detection image<a class="headerlink" href="#multiband-photometry-using-isophotal-apertures-defined-in-detection-image" title="Link to this heading">#</a></h2>
<p>(Similar to running SourceExtractor in double-image mode)</p>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filters</span> <span class="o">=</span> <span class="s1">&#39;F090W F115W F150W F200W F277W F335M F356W F410M F444W&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="n">imagefiles</span><span class="p">[</span><span class="n">filt</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])</span>
    <span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">zp</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;ABMAG&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>  <span class="c1"># zeropoint</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
    <span class="c1"># Measure background</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="n">Background2D</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">filter_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">bkg_estimator</span><span class="p">)</span>
    <span class="c1">#error = bkg.background_rms</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">calc_total_error</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bkg</span><span class="o">.</span><span class="n">background_rms</span><span class="p">,</span> <span class="n">weight</span><span class="o">/</span><span class="mi">500</span><span class="p">)</span>
                             
    <span class="c1"># Measure properties in each image of previously detected objects </span>
    <span class="n">filtcat</span> <span class="o">=</span> <span class="n">SourceCatalog</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">bkg</span><span class="o">.</span><span class="n">background</span><span class="p">,</span> <span class="n">segm_deblend</span><span class="p">,</span> <span class="n">wcs</span><span class="o">=</span><span class="n">imwcs</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="o">.</span><span class="n">background</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>

    <span class="c1"># Convert measured fluxes to fluxes in nJy and to AB magnitudes</span>
    <span class="n">filttbl</span> <span class="o">=</span> <span class="n">filtcat</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">&#39;_flux&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">flux</span>    <span class="o">=</span> <span class="n">filttbl</span><span class="p">[</span><span class="s1">&#39;segment_flux&#39;</span><span class="p">]</span>     <span class="o">*</span> <span class="n">zp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">nJy</span><span class="p">)</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">&#39;_fluxerr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fluxerr</span> <span class="o">=</span> <span class="n">filttbl</span><span class="p">[</span><span class="s1">&#39;segment_fluxerr&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">zp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">nJy</span><span class="p">)</span>

    <span class="n">mag</span><span class="p">,</span> <span class="n">magerr</span> <span class="o">=</span> <span class="n">fluxes2mags</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">fluxerr</span><span class="p">)</span>
    <span class="c1">#mag = mag * u.ABmag  # incompatible with file writing</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">&#39;_mag&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">mag</span><span class="o">.</span><span class="n">value</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">&#39;_magerr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">magerr</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F090W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F090W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F090W_wht.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/astropy/units/function/logarithmic.py:67: RuntimeWarning: invalid value encountered in log10
  return dex.to(self._function_unit, np.log10(x))
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F115W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F115W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F115W_wht.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/astropy/units/function/logarithmic.py:67: RuntimeWarning: invalid value encountered in log10
  return dex.to(self._function_unit, np.log10(x))
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/astropy/units/quantity.py:659: RuntimeWarning: invalid value encountered in log10
  result = super().__array_ufunc__(function, method, *arrays, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F150W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F150W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F150W_wht.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F200W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F200W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F200W_wht.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F277W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F277W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F277W_wht.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F335M
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F335M.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F335M_wht.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F356W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F356W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F356W_wht.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F410M
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F410M.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F410M_wht.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/astropy/units/function/logarithmic.py:67: RuntimeWarning: invalid value encountered in log10
  return dex.to(self._function_unit, np.log10(x))
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/astropy/units/quantity.py:659: RuntimeWarning: invalid value encountered in log10
  result = super().__array_ufunc__(function, method, *arrays, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F444W
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F444W.fits
https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/nircam_photometry/jades_jwst_nircam_goods_s_crop_F444W_wht.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/astropy/units/function/logarithmic.py:67: RuntimeWarning: invalid value encountered in log10
  return dex.to(self._function_unit, np.log10(x))
/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/astropy/units/quantity.py:659: RuntimeWarning: invalid value encountered in log10
  result = super().__array_ufunc__(function, method, *arrays, **kwargs)
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-complete-results-optional">
<h2>View complete results (optional)<a class="headerlink" href="#view-complete-results-optional" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tbl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=326</i>
<table id="table139666230325584" class="table-striped table-bordered table-condensed">
<thead><tr><th>label</th><th>xcentroid</th><th>ycentroid</th><th>sky_centroid</th><th>area</th><th>a</th><th>b</th><th>ellipticity</th><th>orientation</th><th>gini</th><th>F090W_flux</th><th>F090W_fluxerr</th><th>F090W_mag</th><th>F090W_magerr</th><th>F115W_flux</th><th>F115W_fluxerr</th><th>F115W_mag</th><th>F115W_magerr</th><th>F150W_flux</th><th>F150W_fluxerr</th><th>F150W_mag</th><th>F150W_magerr</th><th>F200W_flux</th><th>F200W_fluxerr</th><th>F200W_mag</th><th>F200W_magerr</th><th>F277W_flux</th><th>F277W_fluxerr</th><th>F277W_mag</th><th>F277W_magerr</th><th>F335M_flux</th><th>F335M_fluxerr</th><th>F335M_mag</th><th>F335M_magerr</th><th>F356W_flux</th><th>F356W_fluxerr</th><th>F356W_mag</th><th>F356W_magerr</th><th>F410M_flux</th><th>F410M_fluxerr</th><th>F410M_mag</th><th>F410M_magerr</th><th>F444W_flux</th><th>F444W_fluxerr</th><th>F444W_mag</th><th>F444W_magerr</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th>deg,deg</th><th>pix2</th><th>pix</th><th>pix</th><th></th><th>deg</th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th></tr></thead>
<thead><tr><th>int32</th><th>float64</th><th>float64</th><th>SkyCoord</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1</td><td>466.24461350033647</td><td>8.7975642602371</td><td>53.17381009103326,-27.805320830365776</td><td>101.0</td><td>3.121883592723396</td><td>1.687718238373556</td><td>0.4593910412587602</td><td>-44.478947493786606</td><td>0.3750841422808698</td><td>9.172811357600109</td><td>0.846427300685747</td><td>28.9937438445848</td><td>0.09583064864551505</td><td>15.251750655416094</td><td>0.7351865962388724</td><td>28.441700758604433</td><td>0.05111393452569058</td><td>18.35603511311358</td><td>0.9076155199954206</td><td>28.240552800545306</td><td>0.05239928368180803</td><td>20.355880166244727</td><td>0.9951286984899145</td><td>28.128275286137136</td><td>0.05182128829099082</td><td>15.305414631812216</td><td>0.3724290991315014</td><td>28.437887251597694</td><td>0.02610307984312319</td><td>14.02083788279239</td><td>0.45364676842729956</td><td>28.533065080581018</td><td>0.03457285577386587</td><td>14.174014574304143</td><td>0.399926108118267</td><td>28.521267812537104</td><td>0.030210306449578152</td><td>13.880611681957355</td><td>0.46501162852267625</td><td>28.543978488116917</td><td>0.035777045316298495</td><td>13.807578444079855</td><td>0.4986392632950047</td><td>28.54970620192208</td><td>0.038518276199782</td></tr>
<tr><td>2</td><td>104.80681791619067</td><td>18.082129411035602</td><td>53.17721522973072,-27.805243193448323</td><td>271.0</td><td>4.4330760205526705</td><td>2.8904310038200527</td><td>0.34798523859744157</td><td>-26.54972210581966</td><td>0.4292034166747856</td><td>66.5796776126402</td><td>2.4362560236234203</td><td>26.841645780209955</td><td>0.03901919877231887</td><td>67.80807336882998</td><td>1.7819304084598673</td><td>26.82179648764812</td><td>0.028163637818553414</td><td>70.39338414035721</td><td>2.1096860156757153</td><td>26.781170389302055</td><td>0.03206138240515755</td><td>77.74109040131492</td><td>2.318681567876357</td><td>26.6733734305523</td><td>0.031909302523638994</td><td>72.90069026757769</td><td>0.8318824113256227</td><td>26.743170898753043</td><td>0.012319367708500414</td><td>75.27250253951928</td><td>1.070603105909879</td><td>26.708409112497115</td><td>0.015333670289260427</td><td>71.48792896636</td><td>0.9342131216075652</td><td>26.764418211087325</td><td>0.01409662645806206</td><td>61.42767389099904</td><td>0.9993087828855896</td><td>26.929089824977595</td><td>0.017520685942298192</td><td>57.2203760546637</td><td>1.051093157627436</td><td>27.00612323080047</td><td>0.019763151293857934</td></tr>
<tr><td>3</td><td>15.04416396551755</td><td>13.21870964358083</td><td>53.178060898531776,-27.805283643045666</td><td>8.0</td><td>0.8501945455843772</td><td>0.6682678017840504</td><td>0.21398248759086114</td><td>-38.1612276642421</td><td>0.10521135944081007</td><td>0.3018945818243589</td><td>0.22003285728443536</td><td>32.700361703239686</td><td>0.5943870269087477</td><td>0.7673344664190465</td><td>0.20049710017234815</td><td>31.68753823530937</td><td>0.25203769246273966</td><td>0.7185263134982874</td><td>0.22413743795870192</td><td>31.758893306827684</td><td>0.29478532518129674</td><td>0.9352163612291753</td><td>0.25774023109081057</td><td>31.47271975993688</td><td>0.26428136354091386</td><td>0.34971362332966227</td><td>0.06900286982371183</td><td>32.54071862281815</td><td>0.19551879280610804</td><td>0.5607617346802088</td><td>0.11336299849737179</td><td>32.02805407366013</td><td>0.19990472716017532</td><td>0.26686576820951446</td><td>0.07056536651518255</td><td>32.83426782771906</td><td>0.2547307087052087</td><td>-0.06031654176708369</td><td>0.08275804453775322</td><td>99.0</td><td>34.10547444921151</td><td>0.11765422427560634</td><td>0.08200758112663485</td><td>33.723481188078146</td><td>0.5742186726193422</td></tr>
<tr><td>4</td><td>710.3242889701858</td><td>14.259777138086877</td><td>53.17151058505514,-27.805275444028442</td><td>25.0</td><td>1.2749753643104456</td><td>1.117371994707132</td><td>0.12361287442487268</td><td>-59.26178196559024</td><td>0.33737600483155716</td><td>2.656683621955139</td><td>0.4371488086973456</td><td>30.339150403981968</td><td>0.16539237291898956</td><td>3.818279739887424</td><td>0.36055789873066885</td><td>29.945330642292358</td><td>0.09796938660150925</td><td>3.9761821672022384</td><td>0.4246249997227718</td><td>29.901334316975543</td><td>0.11016516500461197</td><td>3.5589744431503423</td><td>0.42659305165797884</td><td>30.02168782658959</td><td>0.12291324714108388</td><td>1.6962298219026282</td><td>0.12672768826931047</td><td>30.826288264009904</td><td>0.07822962940363362</td><td>1.590536535091481</td><td>0.16680910589172168</td><td>30.896140876425513</td><td>0.10828384762060109</td><td>1.9912255148410796</td><td>0.1511270257305008</td><td>30.652198878679833</td><td>0.07942622585637474</td><td>1.9438353657449134</td><td>0.178896842573335</td><td>30.67835130168316</td><td>0.09558932550457658</td><td>1.6253103136417588</td><td>0.17102441486844794</td><td>30.8726592718879</td><td>0.1086274373485027</td></tr>
<tr><td>5</td><td>434.5294891713508</td><td>22.219091527997158</td><td>53.17410887322447,-27.8052089643638</td><td>268.0</td><td>3.9551276120227397</td><td>2.6287674709150584</td><td>0.33535204706817323</td><td>-8.140060370882344</td><td>0.5363680123723463</td><td>48.23502206197299</td><td>1.7919985963294953</td><td>27.191593796249776</td><td>0.039605394744160985</td><td>54.21551584153409</td><td>1.365885151142132</td><td>27.064691014279646</td><td>0.027014737948708123</td><td>58.28722242134141</td><td>1.6235799372401896</td><td>26.98606659938477</td><td>0.02982943923746284</td><td>83.01615938264015</td><td>2.014897619560197</td><td>26.602093406179243</td><td>0.026037350500330014</td><td>133.10191702875915</td><td>1.0561372293002846</td><td>26.089539223653347</td><td>0.008581100944569356</td><td>133.48409670470673</td><td>1.2826536715221066</td><td>26.086426182655003</td><td>0.010383073588802694</td><td>144.0530215352144</td><td>1.2384723583999508</td><td>26.003694069729168</td><td>0.009294542790104875</td><td>161.5683820059277</td><td>1.4303041800759473</td><td>25.879109060386504</td><td>0.009569320100872941</td><td>148.33362636536881</td><td>1.5722468769659783</td><td>25.971900964480472</td><td>0.01144758607362489</td></tr>
<tr><td>6</td><td>289.38802515014896</td><td>17.281765562153954</td><td>53.17547627056455,-27.805250009193262</td><td>17.0</td><td>1.2913044931147235</td><td>1.1978568863866517</td><td>0.07236682535090477</td><td>68.12270923149859</td><td>0.18041073594089005</td><td>1.1303554119583668</td><td>0.3821670936376741</td><td>31.266962455044794</td><td>0.31621706870061633</td><td>1.501146258557748</td><td>0.2867615998533397</td><td>30.95894247960155</td><td>0.1898053127105452</td><td>1.0456239960240308</td><td>0.28930296167070935</td><td>31.3515611467238</td><td>0.2652049050989649</td><td>1.955256158588051</td><td>0.38221513653203576</td><td>30.671990843785842</td><td>0.1938565595483074</td><td>1.188616449626284</td><td>0.1236824441824322</td><td>31.212395659255414</td><td>0.10747756611504025</td><td>1.7708471014756073</td><td>0.19746701583101794</td><td>30.77954733764033</td><td>0.11478335606840087</td><td>1.492143834211169</td><td>0.15067991684803003</td><td>30.965473278295406</td><td>0.10445071085101643</td><td>1.1433927169620364</td><td>0.17563750503987804</td><td>31.25451144606716</td><td>0.15514831191999282</td><td>0.5926553032606401</td><td>0.13657056678097335</td><td>31.967994562614585</td><td>0.2251497308694742</td></tr>
<tr><td>7</td><td>640.4863091995317</td><td>17.773429154661983</td><td>53.17216853452775,-27.805246129692247</td><td>21.0</td><td>1.5124916692884618</td><td>0.8803106550282112</td><td>0.41797322067741016</td><td>-64.72678377811528</td><td>0.257339933672325</td><td>1.7318562240696873</td><td>0.35449520565926584</td><td>30.803720413136418</td><td>0.20218907261626817</td><td>1.6434298396482203</td><td>0.24985582837207415</td><td>30.86062207958568</td><td>0.1536624479403839</td><td>1.6361021041937924</td><td>0.2840661438634781</td><td>30.865473992028104</td><td>0.17382220180983635</td><td>2.2295861313548446</td><td>0.33214154219160175</td><td>30.529439364296703</td><td>0.15077176392081712</td><td>1.0399598684843063</td><td>0.09617790287548726</td><td>31.357458548945587</td><td>0.09603604488615963</td><td>1.6537574517445193</td><td>0.1507209599380506</td><td>30.853820464729573</td><td>0.094699691326289</td><td>1.2604572151760263</td><td>0.11591912740405148</td><td>31.148679728456177</td><td>0.0955227266471647</td><td>0.40788132175057795</td><td>0.11575451167421517</td><td>32.37366545505972</td><td>0.27123885135203707</td><td>0.5688140707837224</td><td>0.10865005565010251</td><td>32.01257417244966</td><td>0.18978993015591245</td></tr>
<tr><td>8</td><td>762.762291737285</td><td>28.289914155884627</td><td>53.171016553902064,-27.805158549648304</td><td>200.0</td><td>3.160315774736445</td><td>2.3536095208280066</td><td>0.2552612812799423</td><td>37.520056617399476</td><td>0.5417393494467531</td><td>52.88457336395036</td><td>1.7905820052498276</td><td>27.091677487207892</td><td>0.03615255179943194</td><td>55.84480419763607</td><td>1.3404039005228823</td><td>27.032543068603033</td><td>0.025752333237818836</td><td>61.65651418808454</td><td>1.6299731658033907</td><td>26.925052580457162</td><td>0.028330058735061472</td><td>87.75832428916449</td><td>2.0319859659923534</td><td>26.54177919509308</td><td>0.024852875576127663</td><td>85.91084431487936</td><td>0.7872047738101092</td><td>26.564880031956896</td><td>0.009903344287860692</td><td>73.69676407989382</td><td>0.8932394257702934</td><td>26.73137895243849</td><td>0.013080521346957403</td><td>74.68199206424094</td><td>0.8363385018198523</td><td>26.716960265540358</td><td>0.012091217376307159</td><td>70.61910087228084</td><td>0.9001197500128227</td><td>26.777694540519555</td><td>0.013751473288938415</td><td>73.9961654528609</td><td>1.0387154150809097</td><td>26.726976963031056</td><td>0.015134956407915642</td></tr>
<tr><td>9</td><td>801.0706722163886</td><td>32.58026118517374</td><td>53.17065564474934,-27.805122812753073</td><td>12.0</td><td>1.3349434908844906</td><td>0.6567170220834244</td><td>0.5080563135685205</td><td>-28.75519616047975</td><td>0.28793220448127643</td><td>1.1246036221856506</td><td>0.3004786448361928</td><td>31.272501305061585</td><td>0.2571011450147618</td><td>1.2797476041233058</td><td>0.23055260850377246</td><td>31.132189187101062</td><td>0.1798473959435111</td><td>1.2734342201222038</td><td>0.25959362782849404</td><td>31.13755870954592</td><td>0.2014338196131599</td><td>1.3630620117794083</td><td>0.2799372864607707</td><td>31.063710964299986</td><td>0.20280440914679781</td><td>1.082787068323561</td><td>0.10030137862329394</td><td>31.313642349074232</td><td>0.0961853826328532</td><td>0.6781367101230981</td><td>0.1161012153749803</td><td>31.821706862430293</td><td>0.17158341526256418</td><td>0.5758891042338462</td><td>0.08989342817468729</td><td>31.99915284550489</td><td>0.1574838373578829</td><td>1.1076176036929608</td><td>0.13520585441853786</td><td>31.289025376253583</td><td>0.12504898101684045</td><td>1.113433002949251</td><td>0.14205342023678058</td><td>31.283339775099364</td><td>0.1303698266479056</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>318</td><td>13.420742051379385</td><td>884.694395861645</td><td>53.17807529846922,-27.798021345154865</td><td>185.0</td><td>3.285450616131066</td><td>3.147908093244288</td><td>0.041864127316802446</td><td>-13.393044858704108</td><td>0.331692826709577</td><td>18.866842045199054</td><td>1.965226560149265</td><td>28.210751966216968</td><td>0.10758295905106971</td><td>31.87824391461666</td><td>1.7141355153754645</td><td>27.64126402678436</td><td>0.05686594445019743</td><td>50.41198352100823</td><td>2.41110923471416</td><td>27.143665535948294</td><td>0.05072509909406772</td><td>48.62858360693147</td><td>2.477066617075186</td><td>27.182770949596527</td><td>0.05394324520990566</td><td>36.759914186317175</td><td>0.8217034694312548</td><td>27.486563777794004</td><td>0.024002452426466658</td><td>33.4590525753193</td><td>1.007273298718009</td><td>27.588715901645074</td><td>0.03220337636185417</td><td>34.352936437713055</td><td>0.912840857540001</td><td>27.56009033543471</td><td>0.02847398693113529</td><td>31.658008005086796</td><td>1.0140664111276134</td><td>27.648791038562205</td><td>0.0342328125312021</td><td>31.811892751708378</td><td>1.1073440643576584</td><td>27.643526225913767</td><td>0.03715062136419812</td></tr>
<tr><td>319</td><td>7.027176577444122</td><td>891.9727894960166</td><td>53.17813552144662,-27.797960686059632</td><td>29.0</td><td>1.603195468602836</td><td>1.3128724093575075</td><td>0.18109024440939903</td><td>-82.75208405786572</td><td>0.254070174248954</td><td>4.465998147782199</td><td>0.882646107926147</td><td>29.775203653457094</td><td>0.19581293707076908</td><td>3.5314931272294396</td><td>0.5906264916500253</td><td>30.030104086521717</td><td>0.16790556232616383</td><td>5.1074722019128656</td><td>0.7850802429352477</td><td>29.629484970984358</td><td>0.15524361227894562</td><td>4.917640884310548</td><td>0.8043621780644387</td><td>29.67060797308068</td><td>0.16447818783217794</td><td>3.997287152346768</td><td>0.2843667768454504</td><td>29.895586630725628</td><td>0.07461553548507588</td><td>3.8377835048269504</td><td>0.3661371226929502</td><td>29.93979882029562</td><td>0.09893508954511895</td><td>3.412375186414749</td><td>0.30628802811413675</td><td>30.067358061850612</td><td>0.09332518111805055</td><td>3.28526387152336</td><td>0.35498246466009514</td><td>30.10857435571395</td><td>0.111401289304535</td><td>3.979156125410199</td><td>0.40496953684556536</td><td>29.900522551559803</td><td>0.10523003616876628</td></tr>
<tr><td>320</td><td>143.92969676102126</td><td>953.6973600108524</td><td>53.17684577662435,-27.797446433611444</td><td>59.0</td><td>2.6507581110195266</td><td>1.3964068465385502</td><td>0.47320472557133164</td><td>25.19703083525805</td><td>0.2823870637944277</td><td>5.3423393131722845</td><td>1.0819792665125496</td><td>29.580671329181175</td><td>0.20023900246692783</td><td>5.922064358315133</td><td>0.8036616931083888</td><td>29.46881719301301</td><td>0.13816512774989942</td><td>7.212792554437217</td><td>0.999637029980137</td><td>29.254741395699362</td><td>0.1409205427642921</td><td>13.04894576803854</td><td>1.3191055611080584</td><td>28.61106143453415</td><td>0.10455611158757944</td><td>8.378792200159028</td><td>0.41344559288155197</td><td>29.092046450623155</td><td>0.052295014155148895</td><td>6.694537733317119</td><td>0.5044867944031559</td><td>29.335698515562246</td><td>0.07888264867898688</td><td>6.468848669874378</td><td>0.4254486120153371</td><td>29.372932521208615</td><td>0.06915753681006198</td><td>7.525370789524617</td><td>0.5284959208044608</td><td>29.208680241701657</td><td>0.07369133634046583</td><td>6.716742187814203</td><td>0.5392825802265447</td><td>29.332103302827207</td><td>0.08385019406434349</td></tr>
<tr><td>321</td><td>142.746173256619</td><td>959.5389917866399</td><td>53.176856920479636,-27.797397752374</td><td>48.0</td><td>2.1427436610213637</td><td>1.2555061677914512</td><td>0.41406609169806174</td><td>-35.47427950196171</td><td>0.3421221334166607</td><td>6.936236300337239</td><td>1.1392607694993395</td><td>29.29719029986463</td><td>0.16511345958398996</td><td>7.903254879897409</td><td>0.8693971737990356</td><td>29.15548502960466</td><td>0.11331229072011467</td><td>10.187623025402443</td><td>1.1263006235500606</td><td>28.87981783423585</td><td>0.11385094327350063</td><td>12.948029906646463</td><td>1.3061016666971015</td><td>28.619490765397067</td><td>0.10434267352803422</td><td>9.023017764882551</td><td>0.41847771533872685</td><td>29.011620468937362</td><td>0.049222442862693484</td><td>5.447014735335707</td><td>0.45676894530082573</td><td>29.559603624665375</td><td>0.0874297151873417</td><td>6.472893305711534</td><td>0.41968922190657787</td><td>29.37225387876392</td><td>0.0682088157355045</td><td>6.488348644754336</td><td>0.4869395067625267</td><td>29.369664554504258</td><td>0.07856993742528491</td><td>5.76627926777331</td><td>0.5007325407405385</td><td>29.497760820098495</td><td>0.09041210263092743</td></tr>
<tr><td>322</td><td>790.415367777511</td><td>955.3106960545537</td><td>53.17075559998907,-27.797433388936582</td><td>93.0</td><td>2.621691845359079</td><td>1.8772136125476881</td><td>0.28396862664438105</td><td>5.157966396104574</td><td>0.37596577589838664</td><td>20.729595554702005</td><td>1.8703470342379758</td><td>28.108522927842365</td><td>0.0937912675982318</td><td>28.033949382492544</td><td>1.538051849412483</td><td>27.78078928786822</td><td>0.0579910769113244</td><td>25.743535488305984</td><td>1.7358437505234157</td><td>27.873329523763395</td><td>0.07084681814957344</td><td>25.620810723619343</td><td>1.8129005233748652</td><td>27.87851782980156</td><td>0.0742292377178118</td><td>21.15342216887344</td><td>0.6264899234444314</td><td>28.086548407739905</td><td>0.03168871406956517</td><td>18.828253167515435</td><td>0.7475941257205683</td><td>28.212974926843625</td><td>0.04227634815304789</td><td>17.96461067150448</td><td>0.6596358161121416</td><td>28.26395547593533</td><td>0.03915225292374026</td><td>12.790064955174342</td><td>0.6722158462709531</td><td>28.632818124807635</td><td>0.05561473730016507</td><td>13.580929019180171</td><td>0.7400945376355254</td><td>28.567676301555696</td><td>0.05761144934684235</td></tr>
<tr><td>323</td><td>797.3397409211948</td><td>965.5478941851635</td><td>53.17069036467991,-27.797348081794517</td><td>121.0</td><td>3.0304070507432326</td><td>1.7633197784086392</td><td>0.4181244470190332</td><td>79.51657917516623</td><td>0.47716929153411286</td><td>45.619197249141145</td><td>2.6518036744705875</td><td>27.25213090293863</td><td>0.061346663507972285</td><td>50.392274238753124</td><td>2.0188186652038733</td><td>27.144090102966842</td><td>0.042648142807613955</td><td>49.831751964789014</td><td>2.356774844362362</td><td>27.156234609522436</td><td>0.05017220365924456</td><td>48.61650529342564</td><td>2.4430655896970648</td><td>27.183040657043588</td><td>0.05323355846509684</td><td>33.58368869698832</td><td>0.7779020039869248</td><td>27.58467901105726</td><td>0.024862162100306468</td><td>23.755213036076142</td><td>0.8523243778218815</td><td>27.960602676216816</td><td>0.03827306144215809</td><td>23.02386495905596</td><td>0.7592225343641622</td><td>27.99455442662465</td><td>0.03522501052263669</td><td>19.63315929047223</td><td>0.8078373356779335</td><td>28.167524524558377</td><td>0.043779690921258704</td><td>18.68731450154886</td><td>0.8633253572661256</td><td>28.221132763267338</td><td>0.049035202457045374</td></tr>
<tr><td>324</td><td>790.7983558965504</td><td>979.5822296300561</td><td>53.17075198078638,-27.79723112632807</td><td>133.0</td><td>4.506451359665357</td><td>1.493045462994405</td><td>0.6686871012615841</td><td>-44.19824469199431</td><td>0.42319913307021234</td><td>34.20989148182838</td><td>2.353623899073531</td><td>27.56462075862663</td><td>0.07224061886404722</td><td>36.57135462018657</td><td>1.7557906133598953</td><td>27.49214738223006</td><td>0.05091356319336782</td><td>42.68849554096421</td><td>2.206478720252704</td><td>27.324222876621587</td><td>0.05471719389692955</td><td>45.99460251160774</td><td>2.382028845957703</td><td>27.243232824978676</td><td>0.05482188387776275</td><td>34.80004302822041</td><td>0.7822981639992332</td><td>27.54605054768332</td><td>0.02413684700611631</td><td>23.40568188262023</td><td>0.8462317452688508</td><td>27.976696754900892</td><td>0.03856178701393752</td><td>22.76737839931649</td><td>0.7438457514116649</td><td>28.006717435787387</td><td>0.03490554072070799</td><td>20.501256369918995</td><td>0.8205498509872132</td><td>28.120548808604052</td><td>0.0426087886820206</td><td>19.089604206836878</td><td>0.8667809534858215</td><td>28.198007689828906</td><td>0.048212383021397735</td></tr>
<tr><td>325</td><td>307.7502590912509</td><td>989.993370703415</td><td>53.175302486237165,-27.797144093448775</td><td>37.0</td><td>1.707727984108737</td><td>1.1914329585464343</td><td>0.3023286087519126</td><td>-56.82602073196763</td><td>0.35854189153102795</td><td>7.126198163579401</td><td>1.0919973562362062</td><td>29.2678552626553</td><td>0.15479643612317479</td><td>6.598188007454473</td><td>0.7664569787646116</td><td>29.351438284784823</td><td>0.11931782592149333</td><td>6.196539377793785</td><td>0.8658897241714892</td><td>29.41962696525653</td><td>0.1420122179341881</td><td>8.899889611694567</td><td>1.0602604803697635</td><td>29.02653845005323</td><td>0.12220315747396855</td><td>6.033610248611692</td><td>0.341615226376123</td><td>29.44855686812721</td><td>0.05979574121037518</td><td>4.942377643470794</td><td>0.40732286190369604</td><td>29.66516018385374</td><td>0.08598385736288833</td><td>7.336029555914942</td><td>0.41482302005252747</td><td>29.23634731904543</td><td>0.05972101036700092</td><td>4.176814226515838</td><td>0.3922167589581281</td><td>29.84788710139504</td><td>0.0974473596196291</td><td>4.604584237652296</td><td>0.4395488742519671</td><td>29.742023943768242</td><td>0.0989902908814326</td></tr>
<tr><td>326</td><td>306.8506442261885</td><td>997.243644725512</td><td>53.1753109550711,-27.797083673855024</td><td>51.0</td><td>2.5021353669231527</td><td>1.4883885517566502</td><td>0.4051526662256868</td><td>15.388098948641728</td><td>0.24216628412005226</td><td>8.14019232699493</td><td>1.1783072479711838</td><td>29.12341333496192</td><td>0.14677830930960412</td><td>10.621922747541108</td><td>0.9579591476710196</td><td>28.834492153742637</td><td>0.09375247870667036</td><td>10.735153086304802</td><td>1.1138972395145823</td><td>28.822979395055036</td><td>0.1071882551431706</td><td>12.643670520931202</td><td>1.2540115652526385</td><td>28.645317074711215</td><td>0.10267300679924708</td><td>9.553009517952841</td><td>0.41693523286415374</td><td>28.94964947388319</td><td>0.04638135299187599</td><td>9.153235549670372</td><td>0.5151314172293293</td><td>28.99606340336343</td><td>0.05944621805492528</td><td>10.168036276784187</td><td>0.47542516670461316</td><td>28.88190728251713</td><td>0.04961451062251047</td><td>7.872874739121797</td><td>0.5029271829323597</td><td>29.159666645795102</td><td>0.06723264138084344</td><td>7.568902388401964</td><td>0.5444025773994181</td><td>29.202417738905766</td><td>0.07541224065721708</td></tr>
</table></div></div></div>
</div>
</section>
<section id="save-photometry-as-output-catalog">
<h2>Save photometry as output catalog<a class="headerlink" href="#save-photometry-as-output-catalog" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tbl</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;JADESphotometry.ecsv&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>head<span class="w"> </span>-175<span class="w"> </span>JADESphotometry.ecsv<span class="w">  </span>#<span class="w"> </span>show<span class="w"> </span>the<span class="w"> </span>first<span class="w"> </span><span class="m">175</span><span class="w"> </span>lines
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># %ECSV 1.0
# ---
# datatype:
# - {name: label, datatype: int32}
# - {name: xcentroid, datatype: float64}
# - {name: ycentroid, datatype: float64}
# - {name: sky_centroid.ra, unit: deg, datatype: float64}
# - {name: sky_centroid.dec, unit: deg, datatype: float64}
# - {name: area, unit: pix2, datatype: float64}
# - {name: a, unit: pix, datatype: float64}
# - {name: b, unit: pix, datatype: float64}
# - {name: ellipticity, datatype: float64}
# - {name: orientation, unit: deg, datatype: float64}
# - {name: gini, datatype: float64}
# - {name: F090W_flux, unit: nJy, datatype: float64}
# - {name: F090W_fluxerr, unit: nJy, datatype: float64}
# - {name: F090W_mag, datatype: float64}
# - {name: F090W_magerr, datatype: float64}
# - {name: F115W_flux, unit: nJy, datatype: float64}
# - {name: F115W_fluxerr, unit: nJy, datatype: float64}
# - {name: F115W_mag, datatype: float64}
# - {name: F115W_magerr, datatype: float64}
# - {name: F150W_flux, unit: nJy, datatype: float64}
# - {name: F150W_fluxerr, unit: nJy, datatype: float64}
# - {name: F150W_mag, datatype: float64}
# - {name: F150W_magerr, datatype: float64}
# - {name: F200W_flux, unit: nJy, datatype: float64}
# - {name: F200W_fluxerr, unit: nJy, datatype: float64}
# - {name: F200W_mag, datatype: float64}
# - {name: F200W_magerr, datatype: float64}
# - {name: F277W_flux, unit: nJy, datatype: float64}
# - {name: F277W_fluxerr, unit: nJy, datatype: float64}
# - {name: F277W_mag, datatype: float64}
# - {name: F277W_magerr, datatype: float64}
# - {name: F335M_flux, unit: nJy, datatype: float64}
# - {name: F335M_fluxerr, unit: nJy, datatype: float64}
# - {name: F335M_mag, datatype: float64}
# - {name: F335M_magerr, datatype: float64}
# - {name: F356W_flux, unit: nJy, datatype: float64}
# - {name: F356W_fluxerr, unit: nJy, datatype: float64}
# - {name: F356W_mag, datatype: float64}
# - {name: F356W_magerr, datatype: float64}
# - {name: F410M_flux, unit: nJy, datatype: float64}
# - {name: F410M_fluxerr, unit: nJy, datatype: float64}
# - {name: F410M_mag, datatype: float64}
# - {name: F410M_magerr, datatype: float64}
# - {name: F444W_flux, unit: nJy, datatype: float64}
# - {name: F444W_fluxerr, unit: nJy, datatype: float64}
# - {name: F444W_mag, datatype: float64}
# - {name: F444W_magerr, datatype: float64}
# meta: !!omap
# - {date: &#39;2025-07-15 18:19:45 UTC&#39;}
# - version: {Python: 3.11.13, astropy: 7.1.0, bottleneck: null, gwcs: 0.25.1, matplotlib: 3.10.3, numpy: 2.3.1, photutils: 2.2.0, scipy: 1.16.0,
#     skimage: 0.25.2}
# - {localbkg_width: 0}
# - {apermask_method: correct}
# - kron_params: !!python/tuple [2.5, 1.4, 0.0]
# - __serialized_columns__:
#     F090W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: &amp;id001 !astropy.units.Unit {unit: nJy}
#       value: !astropy.table.SerializedColumn {name: F090W_flux}
#     F090W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F090W_fluxerr}
#     F115W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F115W_flux}
#     F115W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F115W_fluxerr}
#     F150W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F150W_flux}
#     F150W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F150W_fluxerr}
#     F200W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F200W_flux}
#     F200W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F200W_fluxerr}
#     F277W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F277W_flux}
#     F277W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F277W_fluxerr}
#     F335M_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F335M_flux}
#     F335M_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F335M_fluxerr}
#     F356W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F356W_flux}
#     F356W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F356W_fluxerr}
#     F410M_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F410M_flux}
#     F410M_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F410M_fluxerr}
#     F444W_flux:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F444W_flux}
#     F444W_fluxerr:
#       __class__: astropy.units.quantity.Quantity
#       unit: *id001
#       value: !astropy.table.SerializedColumn {name: F444W_fluxerr}
#     a:
#       __class__: astropy.units.quantity.Quantity
#       unit: !astropy.units.Unit {unit: pix}
#       value: !astropy.table.SerializedColumn {name: a}
#     area:
#       __class__: astropy.units.quantity.Quantity
#       unit: !astropy.units.Unit {unit: pix2}
#       value: !astropy.table.SerializedColumn {name: area}
#     b:
#       __class__: astropy.units.quantity.Quantity
#       unit: !astropy.units.Unit {unit: pix}
#       value: !astropy.table.SerializedColumn {name: b}
#     ellipticity:
#       __class__: astropy.units.quantity.Quantity
#       unit: !astropy.units.Unit {unit: &#39;&#39;}
#       value: !astropy.table.SerializedColumn {name: ellipticity}
#     orientation:
#       __class__: astropy.units.quantity.Quantity
#       unit: &amp;id002 !astropy.units.Unit {unit: deg}
#       value: !astropy.table.SerializedColumn {name: orientation}
#     sky_centroid:
#       __class__: astropy.coordinates.sky_coordinate.SkyCoord
#       dec: !astropy.table.SerializedColumn
#         __class__: astropy.coordinates.angles.core.Latitude
#         unit: *id002
#         value: !astropy.table.SerializedColumn {name: sky_centroid.dec}
#       frame: icrs
#       ra: !astropy.table.SerializedColumn
#         __class__: astropy.coordinates.angles.core.Longitude
#         unit: *id002
#         value: !astropy.table.SerializedColumn {name: sky_centroid.ra}
#         wrap_angle: !astropy.coordinates.Angle
#           unit: *id002
#           value: 360.0
#       representation_type: spherical
# schema: astropy-2.0
label xcentroid ycentroid sky_centroid.ra sky_centroid.dec area a b ellipticity orientation gini F090W_flux F090W_fluxerr F090W_mag F090W_magerr F115W_flux F115W_fluxerr F115W_mag F115W_magerr F150W_flux F150W_fluxerr F150W_mag F150W_magerr F200W_flux F200W_fluxerr F200W_mag F200W_magerr F277W_flux F277W_fluxerr F277W_mag F277W_magerr F335M_flux F335M_fluxerr F335M_mag F335M_magerr F356W_flux F356W_fluxerr F356W_mag F356W_magerr F410M_flux F410M_fluxerr F410M_mag F410M_magerr F444W_flux F444W_fluxerr F444W_mag F444W_magerr
1 466.24461350033647 8.7975642602371 53.17381009103326 -27.805320830365776 101.0 3.121883592723396 1.687718238373556 0.4593910412587602 -44.478947493786606 0.3750841422808698 9.172811357600109 0.846427300685747 28.9937438445848 0.09583064864551505 15.251750655416094 0.7351865962388724 28.441700758604433 0.05111393452569058 18.35603511311358 0.9076155199954206 28.240552800545306 0.05239928368180803 20.355880166244727 0.9951286984899145 28.128275286137136 0.05182128829099082 15.305414631812216 0.3724290991315014 28.437887251597694 0.02610307984312319 14.02083788279239 0.45364676842729956 28.533065080581018 0.03457285577386587 14.174014574304143 0.399926108118267 28.521267812537104 0.030210306449578152 13.880611681957355 0.46501162852267625 28.543978488116917 0.035777045316298495 13.807578444079855 0.4986392632950047 28.54970620192208 0.038518276199782
2 104.80681791619067 18.082129411035602 53.17721522973072 -27.805243193448323 271.0 4.4330760205526705 2.8904310038200527 0.34798523859744157 -26.54972210581966 0.4292034166747856 66.5796776126402 2.4362560236234203 26.841645780209955 0.03901919877231887 67.80807336882998 1.7819304084598673 26.82179648764812 0.028163637818553414 70.39338414035721 2.1096860156757153 26.781170389302055 0.03206138240515755 77.74109040131492 2.318681567876357 26.6733734305523 0.031909302523638994 72.90069026757769 0.8318824113256227 26.743170898753043 0.012319367708500414 75.27250253951928 1.070603105909879 26.708409112497115 0.015333670289260427 71.48792896636 0.9342131216075652 26.764418211087325 0.01409662645806206 61.42767389099904 0.9993087828855896 26.929089824977595 0.017520685942298192 57.2203760546637 1.051093157627436 27.00612323080047 0.019763151293857934
3 15.04416396551755 13.21870964358083 53.178060898531776 -27.805283643045666 8.0 0.8501945455843772 0.6682678017840504 0.21398248759086114 -38.1612276642421 0.10521135944081007 0.3018945818243589 0.22003285728443536 32.700361703239686 0.5943870269087477 0.7673344664190465 0.20049710017234815 31.68753823530937 0.25203769246273966 0.7185263134982874 0.22413743795870192 31.758893306827684 0.29478532518129674 0.9352163612291753 0.25774023109081057 31.47271975993688 0.26428136354091386 0.34971362332966227 0.06900286982371183 32.54071862281815 0.19551879280610804 0.5607617346802088 0.11336299849737179 32.02805407366013 0.19990472716017532 0.26686576820951446 0.07056536651518255 32.83426782771906 0.2547307087052087 -0.06031654176708369 0.08275804453775322 99.0 34.10547444921151 0.11765422427560634 0.08200758112663485 33.723481188078146 0.5742186726193422
4 710.3242889701858 14.259777138086877 53.17151058505514 -27.805275444028442 25.0 1.2749753643104456 1.117371994707132 0.12361287442487268 -59.26178196559024 0.33737600483155716 2.656683621955139 0.4371488086973456 30.339150403981968 0.16539237291898956 3.818279739887424 0.36055789873066885 29.945330642292358 0.09796938660150925 3.9761821672022384 0.4246249997227718 29.901334316975543 0.11016516500461197 3.5589744431503423 0.42659305165797884 30.02168782658959 0.12291324714108388 1.6962298219026282 0.12672768826931047 30.826288264009904 0.07822962940363362 1.590536535091481 0.16680910589172168 30.896140876425513 0.10828384762060109 1.9912255148410796 0.1511270257305008 30.652198878679833 0.07942622585637474 1.9438353657449134 0.178896842573335 30.67835130168316 0.09558932550457658 1.6253103136417588 0.17102441486844794 30.8726592718879 0.1086274373485027
5 434.5294891713508 22.219091527997158 53.17410887322447 -27.8052089643638 268.0 3.9551276120227397 2.6287674709150584 0.33535204706817323 -8.140060370882344 0.5363680123723463 48.23502206197299 1.7919985963294953 27.191593796249776 0.039605394744160985 54.21551584153409 1.365885151142132 27.064691014279646 0.027014737948708123 58.28722242134141 1.6235799372401896 26.98606659938477 0.02982943923746284 83.01615938264015 2.014897619560197 26.602093406179243 0.026037350500330014 133.10191702875915 1.0561372293002846 26.089539223653347 0.008581100944569356 133.48409670470673 1.2826536715221066 26.086426182655003 0.010383073588802694 144.0530215352144 1.2384723583999508 26.003694069729168 0.009294542790104875 161.5683820059277 1.4303041800759473 25.879109060386504 0.009569320100872941 148.33362636536881 1.5722468769659783 25.971900964480472 0.01144758607362489
6 289.38802515014896 17.281765562153954 53.17547627056455 -27.805250009193262 17.0 1.2913044931147235 1.1978568863866517 0.07236682535090477 68.12270923149859 0.18041073594089005 1.1303554119583668 0.3821670936376741 31.266962455044794 0.31621706870061633 1.501146258557748 0.2867615998533397 30.95894247960155 0.1898053127105452 1.0456239960240308 0.28930296167070935 31.3515611467238 0.2652049050989649 1.955256158588051 0.38221513653203576 30.671990843785842 0.1938565595483074 1.188616449626284 0.1236824441824322 31.212395659255414 0.10747756611504025 1.7708471014756073 0.19746701583101794 30.77954733764033 0.11478335606840087 1.492143834211169 0.15067991684803003 30.965473278295406 0.10445071085101643 1.1433927169620364 0.17563750503987804 31.25451144606716 0.15514831191999282 0.5926553032606401 0.13657056678097335 31.967994562614585 0.2251497308694742
7 640.4863091995317 17.773429154661983 53.17216853452775 -27.805246129692247 21.0 1.5124916692884618 0.8803106550282112 0.41797322067741016 -64.72678377811528 0.257339933672325 1.7318562240696873 0.35449520565926584 30.803720413136418 0.20218907261626817 1.6434298396482203 0.24985582837207415 30.86062207958568 0.1536624479403839 1.6361021041937924 0.2840661438634781 30.865473992028104 0.17382220180983635 2.2295861313548446 0.33214154219160175 30.529439364296703 0.15077176392081712 1.0399598684843063 0.09617790287548726 31.357458548945587 0.09603604488615963 1.6537574517445193 0.1507209599380506 30.853820464729573 0.094699691326289 1.2604572151760263 0.11591912740405148 31.148679728456177 0.0955227266471647 0.40788132175057795 0.11575451167421517 32.37366545505972 0.27123885135203707 0.5688140707837224 0.10865005565010251 32.01257417244966 0.18978993015591245
8 762.762291737285 28.289914155884627 53.171016553902064 -27.805158549648304 200.0 3.160315774736445 2.3536095208280066 0.2552612812799423 37.520056617399476 0.5417393494467531 52.88457336395036 1.7905820052498276 27.091677487207892 0.03615255179943194 55.84480419763607 1.3404039005228823 27.032543068603033 0.025752333237818836 61.65651418808454 1.6299731658033907 26.925052580457162 0.028330058735061472 87.75832428916449 2.0319859659923534 26.54177919509308 0.024852875576127663 85.91084431487936 0.7872047738101092 26.564880031956896 0.009903344287860692 73.69676407989382 0.8932394257702934 26.73137895243849 0.013080521346957403 74.68199206424094 0.8363385018198523 26.716960265540358 0.012091217376307159 70.61910087228084 0.9001197500128227 26.777694540519555 0.013751473288938415 73.9961654528609 1.0387154150809097 26.726976963031056 0.015134956407915642
</pre></div>
</div>
</div>
</div>
</section>
<section id="reformat-output-catalog-for-readability-optional">
<h2>Reformat output catalog for readability (optional)<a class="headerlink" href="#reformat-output-catalog-for-readability-optional" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove units (pixels) from area</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Replace sky_centroid with ra, dec</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;sky_centroid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">degree</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;sky_centroid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">degree</span>

<span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tbl</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="n">tbl</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
    <span class="n">tbl</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;.4f&#39;</span>

<span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;11.7f&#39;</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;11.7f&#39;</span>

<span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span>
<span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tbl</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;JADESphotometry.cat&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.fixed_width_two_line&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>head<span class="w"> </span>-10<span class="w"> </span>JADESphotometry.cat<span class="w">  </span>#<span class="w"> </span>show<span class="w"> </span>the<span class="w"> </span>first<span class="w"> </span><span class="m">10</span><span class="w"> </span>lines
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>label xcentroid ycentroid          ra         dec area       a      b ellipticity orientation   gini F090W_flux F090W_fluxerr F090W_mag F090W_magerr F115W_flux F115W_fluxerr F115W_mag F115W_magerr F150W_flux F150W_fluxerr F150W_mag F150W_magerr F200W_flux F200W_fluxerr F200W_mag F200W_magerr F277W_flux F277W_fluxerr F277W_mag F277W_magerr F335M_flux F335M_fluxerr F335M_mag F335M_magerr F356W_flux F356W_fluxerr F356W_mag F356W_magerr F410M_flux F410M_fluxerr F410M_mag F410M_magerr F444W_flux F444W_fluxerr F444W_mag F444W_magerr
----- --------- --------- ----------- ----------- ---- ------- ------ ----------- ----------- ------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------ ---------- ------------- --------- ------------
    1  466.2446    8.7976  53.1738101 -27.8053208  101  3.1219 1.6877      0.4594    -44.4789 0.3751     9.1728        0.8464   28.9937       0.0958    15.2518        0.7352   28.4417       0.0511    18.3560        0.9076   28.2406       0.0524    20.3559        0.9951   28.1283       0.0518    15.3054        0.3724   28.4379       0.0261    14.0208        0.4536   28.5331       0.0346    14.1740        0.3999   28.5213       0.0302    13.8806        0.4650   28.5440       0.0358    13.8076        0.4986   28.5497       0.0385
    2  104.8068   18.0821  53.1772152 -27.8052432  271  4.4331 2.8904      0.3480    -26.5497 0.4292    66.5797        2.4363   26.8416       0.0390    67.8081        1.7819   26.8218       0.0282    70.3934        2.1097   26.7812       0.0321    77.7411        2.3187   26.6734       0.0319    72.9007        0.8319   26.7432       0.0123    75.2725        1.0706   26.7084       0.0153    71.4879        0.9342   26.7644       0.0141    61.4277        0.9993   26.9291       0.0175    57.2204        1.0511   27.0061       0.0198
    3   15.0442   13.2187  53.1780609 -27.8052836    8  0.8502 0.6683      0.2140    -38.1612 0.1052     0.3019        0.2200   32.7004       0.5944     0.7673        0.2005   31.6875       0.2520     0.7185        0.2241   31.7589       0.2948     0.9352        0.2577   31.4727       0.2643     0.3497        0.0690   32.5407       0.1955     0.5608        0.1134   32.0281       0.1999     0.2669        0.0706   32.8343       0.2547    -0.0603        0.0828   99.0000      34.1055     0.1177        0.0820   33.7235       0.5742
    4  710.3243   14.2598  53.1715106 -27.8052754   25  1.2750 1.1174      0.1236    -59.2618 0.3374     2.6567        0.4371   30.3392       0.1654     3.8183        0.3606   29.9453       0.0980     3.9762        0.4246   29.9013       0.1102     3.5590        0.4266   30.0217       0.1229     1.6962        0.1267   30.8263       0.0782     1.5905        0.1668   30.8961       0.1083     1.9912        0.1511   30.6522       0.0794     1.9438        0.1789   30.6784       0.0956     1.6253        0.1710   30.8727       0.1086
    5  434.5295   22.2191  53.1741089 -27.8052090  268  3.9551 2.6288      0.3354     -8.1401 0.5364    48.2350        1.7920   27.1916       0.0396    54.2155        1.3659   27.0647       0.0270    58.2872        1.6236   26.9861       0.0298    83.0162        2.0149   26.6021       0.0260   133.1019        1.0561   26.0895       0.0086   133.4841        1.2827   26.0864       0.0104   144.0530        1.2385   26.0037       0.0093   161.5684        1.4303   25.8791       0.0096   148.3336        1.5722   25.9719       0.0114
    6  289.3880   17.2818  53.1754763 -27.8052500   17  1.2913 1.1979      0.0724     68.1227 0.1804     1.1304        0.3822   31.2670       0.3162     1.5011        0.2868   30.9589       0.1898     1.0456        0.2893   31.3516       0.2652     1.9553        0.3822   30.6720       0.1939     1.1886        0.1237   31.2124       0.1075     1.7708        0.1975   30.7795       0.1148     1.4921        0.1507   30.9655       0.1045     1.1434        0.1756   31.2545       0.1551     0.5927        0.1366   31.9680       0.2251
    7  640.4863   17.7734  53.1721685 -27.8052461   21  1.5125 0.8803      0.4180    -64.7268 0.2573     1.7319        0.3545   30.8037       0.2022     1.6434        0.2499   30.8606       0.1537     1.6361        0.2841   30.8655       0.1738     2.2296        0.3321   30.5294       0.1508     1.0400        0.0962   31.3575       0.0960     1.6538        0.1507   30.8538       0.0947     1.2605        0.1159   31.1487       0.0955     0.4079        0.1158   32.3737       0.2712     0.5688        0.1087   32.0126       0.1898
    8  762.7623   28.2899  53.1710166 -27.8051585  200  3.1603 2.3536      0.2553     37.5201 0.5417    52.8846        1.7906   27.0917       0.0362    55.8448        1.3404   27.0325       0.0258    61.6565        1.6300   26.9251       0.0283    87.7583        2.0320   26.5418       0.0249    85.9108        0.7872   26.5649       0.0099    73.6968        0.8932   26.7314       0.0131    74.6820        0.8363   26.7170       0.0121    70.6191        0.9001   26.7777       0.0138    73.9962        1.0387   26.7270       0.0151
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="start-new-session-and-analyze-results">
<h1>Start new session and analyze results<a class="headerlink" href="#start-new-session-and-analyze-results" title="Link to this heading">#</a></h1>
<section id="load-catalog-and-segmentation-map">
<h2>Load catalog and segmentation map<a class="headerlink" href="#load-catalog-and-segmentation-map" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Catalog: ecsv format preserves units for loading in Python notebooks</span>
<span class="n">tbl</span> <span class="o">=</span> <span class="n">QTable</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;JADESphotometry.ecsv&#39;</span><span class="p">)</span>

<span class="c1"># Reconstitute filter list</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">tbl</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;_mag&#39;</span><span class="p">:</span>
        <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Segmentation map</span>
<span class="n">segmfile</span> <span class="o">=</span> <span class="s1">&#39;JADES_detections_segm.fits&#39;</span>
<span class="n">segm</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">segmfile</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">segm</span> <span class="o">=</span> <span class="n">SegmentationImage</span><span class="p">(</span><span class="n">segm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-number-counts-vs-magnitude">
<h2>Plot number counts vs. magnitude<a class="headerlink" href="#plot-number-counts-vs-magnitude" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">filt</span> <span class="o">=</span> <span class="s1">&#39;F200W&#39;</span>
<span class="n">mag1</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="n">filt</span> <span class="o">+</span> <span class="s1">&#39;_mag&#39;</span><span class="p">]</span>

<span class="n">mag1</span> <span class="o">=</span> <span class="n">mag1</span><span class="p">[(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">mag1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mag1</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">)]</span>  <span class="c1"># detections only</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mag1</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">filt</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;AB magnitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f0694867190&gt;
</pre></div>
</div>
<img alt="../../../_images/360e078adb5c899dd112fba6a8dd83181e8f302e8c06dadd4885e65221bc9bf8.png" src="../../../_images/360e078adb5c899dd112fba6a8dd83181e8f302e8c06dadd4885e65221bc9bf8.png" />
</div>
</div>
</section>
<section id="plot-f200w-vs-f090w-magnitudes-and-look-for-dropouts">
<h2>Plot F200W vs. F090W magnitudes and look for dropouts<a class="headerlink" href="#plot-f200w-vs-f090w-magnitudes-and-look-for-dropouts" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import mplcursors</span>
<span class="c1"># Would love a better solution here!</span>

<span class="n">mag1</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;F090W_mag&#39;</span><span class="p">]</span>
<span class="n">mag2</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;F200W_mag&#39;</span><span class="p">]</span>

<span class="c1"># Only plot detections in F200W</span>
<span class="n">det2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">mag2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mag2</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">)</span>

<span class="n">mag1</span> <span class="o">=</span> <span class="n">mag1</span><span class="p">[</span><span class="n">det2</span><span class="p">]</span>
<span class="n">mag2</span> <span class="o">=</span> <span class="n">mag2</span><span class="p">[</span><span class="n">det2</span><span class="p">]</span>
<span class="n">ids</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">][</span><span class="n">det2</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mag1</span><span class="p">,</span> <span class="n">mag2</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mag1</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mag1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mag2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ids</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;F090W AB magnitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;F200W AB magnitude&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;F200W AB magnitude&#39;)
</pre></div>
</div>
<img alt="../../../_images/a13f0088a2a950cb8ef9349521ae09a39f5f6261f1a71043408524d6675cc5eb.png" src="../../../_images/a13f0088a2a950cb8ef9349521ae09a39f5f6261f1a71043408524d6675cc5eb.png" />
</div>
</div>
</section>
<section id="look-at-one-object">
<h2>Look at one object<a class="headerlink" href="#look-at-one-object" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Could select object by position</span>
<span class="c1">#x, y = 905, 276</span>
<span class="c1">#id = segm.data[y,x]</span>

<span class="c1"># Select by ID number</span>
<span class="nb">id</span> <span class="o">=</span> <span class="mi">261</span>  <span class="c1"># F090W dropout</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="nb">id</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><i>Row index=260</i>
<table id="table139666270988432">
<thead><tr><th>label</th><th>xcentroid</th><th>ycentroid</th><th>sky_centroid</th><th>area</th><th>a</th><th>b</th><th>ellipticity</th><th>orientation</th><th>gini</th><th>F090W_flux</th><th>F090W_fluxerr</th><th>F090W_mag</th><th>F090W_magerr</th><th>F115W_flux</th><th>F115W_fluxerr</th><th>F115W_mag</th><th>F115W_magerr</th><th>F150W_flux</th><th>F150W_fluxerr</th><th>F150W_mag</th><th>F150W_magerr</th><th>F200W_flux</th><th>F200W_fluxerr</th><th>F200W_mag</th><th>F200W_magerr</th><th>F277W_flux</th><th>F277W_fluxerr</th><th>F277W_mag</th><th>F277W_magerr</th><th>F335M_flux</th><th>F335M_fluxerr</th><th>F335M_mag</th><th>F335M_magerr</th><th>F356W_flux</th><th>F356W_fluxerr</th><th>F356W_mag</th><th>F356W_magerr</th><th>F410M_flux</th><th>F410M_fluxerr</th><th>F410M_mag</th><th>F410M_magerr</th><th>F444W_flux</th><th>F444W_fluxerr</th><th>F444W_mag</th><th>F444W_magerr</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th>deg,deg</th><th>pix2</th><th>pix</th><th>pix</th><th></th><th>deg</th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th><th>nJy</th><th>nJy</th><th></th><th></th></tr></thead>
<thead><tr><th>int32</th><th>float64</th><th>float64</th><th>SkyCoord</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>261</td><td>713.6003231522444</td><td>868.2862731469344</td><td>53.17147927632734,-27.79815855888541</td><td>111.0</td><td>2.1957364237904744</td><td>1.871859861852015</td><td>0.14750247726881305</td><td>-17.338774337937068</td><td>0.546245283985238</td><td>83.210645372822</td><td>3.527254135588318</td><td>26.599552774088977</td><td>0.04507502616775405</td><td>84.18846432688923</td><td>2.587997491179074</td><td>26.586868530823118</td><td>0.032873376920099</td><td>84.42481646179198</td><td>3.054886353923348</td><td>26.583824687102044</td><td>0.038592934581143754</td><td>78.728836865202</td><td>3.131787729879179</td><td>26.659665411873668</td><td>0.04235304682595798</td><td>45.258779395038786</td><td>0.9397610471453727</td><td>27.260742907280413</td><td>0.022313544876442264</td><td>35.277809352747205</td><td>1.0051267218729336</td><td>27.53124597775305</td><td>0.03050203683042903</td><td>32.91303372370136</td><td>0.9126975788091346</td><td>27.60658021307747</td><td>0.02969819980754908</td><td>24.75353531926416</td><td>0.9197377117713978</td><td>27.915906915058187</td><td>0.039610013762955344</td><td>25.401315400116076</td><td>1.0402217740639617</td><td>27.887859482444238</td><td>0.043576230399079735</td></tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;ellipticity&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[0.14750248 \; \mathrm{}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segmobj</span> <span class="o">=</span> <span class="n">segm</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="n">segm</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="nb">id</span><span class="p">)]</span>
<span class="n">segmobj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;photutils.segmentation.core.Segment&gt;
label: 261
slices: (slice(863, 874, None), slice(708, 720, None))
area: 111
</pre></div>
</div>
</div>
</div>
</section>
<section id="show-the-object-in-all-the-images">
<h2>Show the object in all the images<a class="headerlink" href="#show-the-object-in-all-the-images" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="n">segmobj</span><span class="o">.</span><span class="n">slices</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">segmobj</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Color&#39;</span><span class="p">)</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">segm</span><span class="o">.</span><span class="n">make_cmap</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>  <span class="c1"># ERROR</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">segm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">segmobj</span><span class="o">.</span><span class="n">slices</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">segmobj</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
               <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Segment&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">filt</span> <span class="o">=</span> <span class="n">filters</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Show data on top row</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imagefiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">stamp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">segmobj</span><span class="o">.</span><span class="n">slices</span><span class="p">]</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>  <span class="c1"># scale each filter individually</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">segmobj</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">filt</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

    <span class="c1"># Show weights on bottom row</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">weightfiles</span><span class="p">[</span><span class="n">filt</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">stamp</span> <span class="o">=</span> <span class="n">weight</span><span class="p">[</span><span class="n">segmobj</span><span class="o">.</span><span class="n">slices</span><span class="p">]</span>
    <span class="c1"># set black to zero weight (no exposure time / bad pixel)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">segmobj</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Weight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Weight&#39;)
</pre></div>
</div>
<img alt="../../../_images/43751ec122aaaa7d7e7db1fba1e10b836224615a2e24a0c4290ddf123a55ecdb.png" src="../../../_images/43751ec122aaaa7d7e7db1fba1e10b836224615a2e24a0c4290ddf123a55ecdb.png" />
</div>
</div>
</section>
<section id="plot-sed-spectral-energy-distribution">
<h2>Plot SED (Spectral Energy Distribution)<a class="headerlink" href="#plot-sed-spectral-energy-distribution" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">&#39;_flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">&#39;_fluxerr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength ($\mu$m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux (nJy)&#39;</span><span class="p">)</span>

<span class="n">mlim</span> <span class="o">=</span> <span class="mf">31.4</span>
<span class="n">flim</span> <span class="o">=</span> <span class="n">mlim</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>
<span class="n">flim</span> <span class="o">=</span> <span class="n">flim</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">nJy</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="c1"># Add AB magnitudes as secondary x-axis at right</span>
<span class="c1"># https://matplotlib.org/gallery/subplots_axes_and_figures/secondary_axis.html#sphx-glr-gallery-subplots-axes-and-figures-secondary-axis-py</span>
<span class="k">def</span><span class="w"> </span><span class="nf">AB2nJy</span><span class="p">(</span><span class="n">mAB</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">mAB</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">nJy</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">value</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">f</span> <span class="o">&gt;</span> <span class="n">flim</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">flim</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>

<span class="k">def</span><span class="w"> </span><span class="nf">nJy2AB</span><span class="p">(</span><span class="n">F_nJy</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">F_nJy</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">nJy</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">value</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">m</span> <span class="o">&lt;</span> <span class="n">mlim</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">mlim</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">flim</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">secax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">secondary_yaxis</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">functions</span><span class="o">=</span><span class="p">(</span><span class="n">nJy2AB</span><span class="p">,</span> <span class="n">AB2nJy</span><span class="p">))</span>
<span class="n">secax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;magnitude (AB)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;magnitude (AB)&#39;)
</pre></div>
</div>
<img alt="../../../_images/7b26b69d7a50aad067b496c1631a7f94a4f8c3cc3c4475ba8fdc4fbd01f3474a.png" src="../../../_images/7b26b69d7a50aad067b496c1631a7f94a4f8c3cc3c4475ba8fdc4fbd01f3474a.png" />
</div>
</div>
</section>
<section id="magnitude-conversion-fails-for-flux-0">
<h2>Magnitude conversion fails for flux &lt;= 0<a class="headerlink" href="#magnitude-conversion-fails-for-flux-0" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">filt</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">&#39;_flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="n">filt</span><span class="o">+</span><span class="s1">&#39;_fluxerr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength ($\mu$m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux (nJy)&#39;</span><span class="p">)</span>

<span class="n">f0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.4</span> <span class="o">*</span> <span class="mf">31.4</span><span class="p">)</span>  <span class="c1"># flux [nJy] at zero magnitude</span>
<span class="n">b0</span> <span class="o">=</span> <span class="mf">1.e-12</span>  <span class="c1"># this should be filter dependent</span>

<span class="c1"># Add AB magnitudes as secondary x-axis at right</span>
<span class="c1"># https://matplotlib.org/gallery/subplots_axes_and_figures/secondary_axis.html#sphx-glr-gallery-subplots-axes-and-figures-secondary-axis-py</span>
<span class="k">def</span><span class="w"> </span><span class="nf">AB2nJy</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">b0</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">f0</span>
    <span class="k">return</span> <span class="n">f</span>

<span class="c1"># Luptitudes</span>
<span class="c1"># https://www.sdss.org/dr12/algorithms/magnitudes/</span>
<span class="k">def</span><span class="w"> </span><span class="nf">nJy2AB</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">((</span><span class="n">f</span> <span class="o">/</span> <span class="n">f0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b0</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">b0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="c1">#plt.ylim(flim, plt.ylim()[1])</span>

<span class="n">secax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">secondary_yaxis</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">functions</span><span class="o">=</span><span class="p">(</span><span class="n">nJy2AB</span><span class="p">,</span> <span class="n">AB2nJy</span><span class="p">))</span>
<span class="n">secax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;asinh magnitude (AB)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;asinh magnitude (AB)&#39;)
</pre></div>
</div>
<img alt="../../../_images/7db31f947d7d98fb261303b5024fa5fc2156c82a36a02a5310c8d940977d647c.png" src="../../../_images/7db31f947d7d98fb261303b5024fa5fc2156c82a36a02a5310c8d940977d647c.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/NIRCam/NIRCam_photometry"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../aperture_photometry/NIRCam_Aperture_Photometry_Example.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Point Source Aperture Photometry</p>
      </div>
    </a>
    <a class="right-next"
       href="../NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cross-Filter PSF Matching</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Extended Aperture Photometry</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#to-do">To Do</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-webbpsf-data">Download WEBBPSF Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matplotlib-setup-for-plotting">Matplotlib setup for plotting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-list-of-images-to-be-loaded-and-analyzed">Create list of images to be loaded and analyzed</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-detection-image-f200w">Load detection image: F200W</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#report-image-size-and-field-of-view">Report image size and field of view</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-color-image-optional">Create color image (optional)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detect-sources-and-deblend-using-photutils">Detect Sources and Deblend using <code class="docutils literal notranslate"><span class="pre">photutils</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measure-photometry-and-more-in-detection-image">Measure photometry (and more) in detection image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#show-detections-alongside-images-optional">Show detections alongside images (optional)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-all-measured-quantities-in-detection-image-optional">View all measured quantities in detection image (optional)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#only-keep-some-quantities">Only keep some quantities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-measured-fluxes-data-units-to-magnitudes">Convert measured fluxes (data units) to magnitudes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiband-photometry-using-isophotal-apertures-defined-in-detection-image">Multiband photometry using isophotal apertures defined in detection image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-complete-results-optional">View complete results (optional)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-photometry-as-output-catalog">Save photometry as output catalog</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reformat-output-catalog-for-readability-optional">Reformat output catalog for readability (optional)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#start-new-session-and-analyze-results">Start new session and analyze results</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-catalog-and-segmentation-map">Load catalog and segmentation map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-number-counts-vs-magnitude">Plot number counts vs. magnitude</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-f200w-vs-f090w-magnitudes-and-look-for-dropouts">Plot F200W vs. F090W magnitudes and look for dropouts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#look-at-one-object">Look at one object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#show-the-object-in-all-the-images">Show the object in all the images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-sed-spectral-energy-distribution">Plot SED (Spectral Energy Distribution)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#magnitude-conversion-fails-for-flux-0">Magnitude conversion fails for flux &lt;= 0</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>