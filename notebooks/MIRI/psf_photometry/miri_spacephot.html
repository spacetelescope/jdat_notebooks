

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>MIRI PSF Photometry With Space_Phot &#8212; STScI JDAT Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D46G4HKJY3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D46G4HKJY3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/MIRI/psf_photometry/miri_spacephot';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="STScI JDAT Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="STScI JDAT Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">General</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebook_development_workflow.html">Notebook Development Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/submitting_notebooks.html">Submitting Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/requirements.html">Requirements file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/data_files.html">Data Files</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GitHub Guidelines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_setup.html">GitHub Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_workflow.html">GitHub Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_pr.html">GitHub PR</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cross-Instrument</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/asdf_example/asdf_example.html">ASDF Example</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/background_estimation_imaging/Imaging_Sky_Background_Estimation.html">Complex 2D Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/composite_model_fitting/specfit_demo_3.html">Composite Model Spectral Fitting</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/NIRSpec_MAST_Query/NIRSpec_MAST_Query.html">MAST Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/rgb_imviz/imviz_rgb_carina.html">RGB images with Imviz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/specviz_notebookGUI_interaction/specviz_notebook_gui_interaction_redshift.html">Specviz Simple Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/update_pure_parallel_wcs/NIRISS_correct_pure_parallel_WCS.html">Improving Accuracy of WCS of Pure Parallel Dataset</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MIRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html">MRS Mstar - Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI_IFU_YSOs_in_the_LMC/isha_nayak_ysos_in_the_lmc.html">IFU of YSOs in LMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI_LRS_spectral_extraction/miri_lrs_advanced_extraction_part1.html">LRS Optimal Spectral Extraction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRCam</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/aperture_photometry/NIRCam_Aperture_Photometry_Example.html">Point Source Aperture Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_photometry/NIRCam_multiband_photometry.html">Extended Aperture Photometry</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html">Cross-Filter PSF Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/psf_photometry/NIRCam_PSF_Photometry_Example.html">PSF Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_wisp_subtraction/nircam_wisp_subtraction.html">NIRCam Wisp Removal</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRISS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/00_Optimal_extraction.html">WFSS Spectra - Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/01_Combine_and_normalize_1D_spectra.html">WFSS Spectra - Combine and Normalize 1D Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/02_Cross_correlation_template.html">WFSS Spectra - Cross-Correlation Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/03_Spatially_resolved_emission_line_map.html">WFSS Spectra - Emission Line Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/00_niriss_mast_query_data_setup.html">NIRISS MAST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/01_niriss_wfss_image2_image3.html">Direct imaging for WFSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/02_niriss_wfss_spec2.html">Spec2 pipeline for WFSS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRSpec</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/IFU_cube_continuum_fit/NGC4151_FeII_ContinuumFit.html">IFU Cube Fitting</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/cube_fitting/cube_fitting.html">IFU Cube Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/ifu_optimal/ifu_optimal.html">IFU Optimal Spectral Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/optimal_extraction/Spectral_Extraction-static.html">MOS Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/mos_spectroscopy_advanced/MOSspec_advanced.html">MOS Spectroscopy of Extragalactic Field</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/transit_spectroscopy_notebook/Exoplanet_Transmission_Spectra_JWST.html">BOTS Time Series Observations</a></li>








<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/galaxy_redshift/redshift_fitting.html">Redshift and Template Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/FS_NSClean_example.html">FS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/IFU_NSClean_example.html">IFU Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/MOS_NSClean_example.html">MOS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/BOTS_NSClean_example.html">BOTS Products with NSClean</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/MIRI/psf_photometry/miri_spacephot.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/MIRI/psf_photometry/miri_spacephot.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MIRI PSF Photometry With Space_Phot</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-introduction-a-class-anchor-id-intro-a">1.<font color="white">-</font>Introduction <a class="anchor" id="intro"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a">1.1<font color="white">-</font>Setup WebbPSF and Synphot Directories<a class="anchor" id="webbpsf"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-python-imports-a-class-anchor-id-py-imports-a">1.2<font color="white">-</font>Python Imports<a class="anchor" id="py_imports"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-download-data-a-class-anchor-id-data-a">2.<font color="white">-</font>Download Data<a class="anchor" id="data"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-bright-single-object-a-class-anchor-id-bso-a">3.<font color="white">-</font>Bright, Single Object<a class="anchor" id="bso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a">3.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="bso2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-the-psf-fitting-in-space-phot-br">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a">3.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="bso3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#good-agreement-between-level2-and-level3-results">Good agreement between Level2 and level3 results!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a">4.<font color="white">-</font>Faint/Upper Limit, Single Object<a class="anchor" id="fso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a">4.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="fso2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a">4.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="fso3"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-you-can-go-significantly-deeper-with-the-level3-combined-data-product">Note you can go significantly deeper with the Level3 combined data product</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a">5.<font color="white">-</font>Stellar Field (LMC)<a class="anchor" id="lmc"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired">In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using space_phot on a large number of stars. We suggest that space_phot may be less optimal for large numbers of bright stars. Other programs, such as DOLPHOT or Photutils, may be better suited for this use case. The primary advantage to space_phot is on faint, single sources. But it can be extended to a larger number if desired.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a">5.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="lmc2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed">Now do the same thing for a larger group of stars and test for speed</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a">5.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="lmc3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars">Readers should refer to all diagnostics discussed above. In general, this loop shows the difficulty in doing PSF photometry on a wide variety of stars (brightness, distribution on the detector, etc) without visual inspection. Especially when dealing with low SNR sources.This is true for all photometry packages. Users should inspect the associated metrics and consider optimizing the parameters for specific stars of interest. Nonetheless, the success of the fits can always be quantified in with the associated error bars.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="miri-psf-photometry-with-space-phot">
<h1>MIRI PSF Photometry With Space_Phot<a class="headerlink" href="#miri-psf-photometry-with-space-phot" title="Permalink to this heading">#</a></h1>
<p><strong>Author</strong>: Ori Fox<br></p>
<p><strong>Submitted</strong>: August, 2023<br>
<strong>Updated</strong>: November, 2023<br></p>
<p><strong>Use case</strong>: PSF Photometry on Level3 data using dedicated package Space_Phot (https://github.com/jpierel14/space_phot). Space_phot is built on Astropy’s Photutils package. Unlike photutils, space_phot can be used on Level3 data. This is because has built in functionality that can generate a resampled Level3 PSF at a given detector position. Such use cases are particularly useful for faint, point source targets or deep upper limits where observers need to take advantage of the combined image stack. For a large number of bright sources, users may find space_phot to be too slow and should consider other packages, such as DOLPHOT and/or Photutils. <strong>NOTE:</strong> A companion notebook exists that illustrates how to use Photutils for the same Level2 data set.<br>
<strong>Important Note</strong>: When not to use. Due to the sensitivity of the space_phot parameters, this tool is not meant to be used for a large sample of stars (i.e., Section 5 below). If a user would like to use space_phot on more than one source, they should carefully construct a table of parameters that are carefully refined for each source.
<strong>Data</strong>: MIRI Data PID 1028 (Calibration Program; Single Star Visit 006 A5V dwarf 2MASSJ17430448+6655015) and MIRI Data PID 1171 (LMC; Multiple Stars).<br>
<strong>Tools</strong>: photutils, space_phot drizzlepac, jupyter <br>
<strong>Cross-Instrument</strong>: NIRCam, MIRI.<br>
<strong>Documentation</strong>: This notebook is part of a STScI’s larger post-pipeline Data Analysis Tools Ecosystem and can be downloaded directly from the JDAT Notebook Github directory.<br>
<strong>Pipeline Version</strong>: JWST Pipeline<br></p>
<section id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><span class="xref myst">Introduction</span><br>
1.1 <span class="xref myst">Setup</span><br>
1.2 <span class="xref myst">Python imports</span><br></p></li>
<li><p><span class="xref myst">Download Data</span><br></p></li>
<li><p><span class="xref myst">Bright, Single Object</span><br>
3.1 <span class="xref myst">Multiple, Level2 Files</span><br>
3.2 <span class="xref myst">Single, Level3 Mosaicked File</span><br></p></li>
<li><p><span class="xref myst">Faint/Upper Limit, Single Object</span><br>
4.1 <span class="xref myst">Multiple, Level2 Files</span><br>
4.2 <span class="xref myst">Single, Level3 Mosaicked File</span><br></p></li>
<li><p><span class="xref myst">Stellar Field (LMC)</span><br>
5.1 <span class="xref myst">Multiple, Level2 Files</span><br>
5.2 <span class="xref myst">Single, Level3 Mosaicked File</span><br></p></li>
</ol>
</section>
<section id="font-color-white-font-introduction-a-class-anchor-id-intro-a">
<h2>1.<font color='white'>-</font>Introduction <a class="anchor" id="intro"></a><a class="headerlink" href="#font-color-white-font-introduction-a-class-anchor-id-intro-a" title="Permalink to this heading">#</a></h2>
<p>GOALS:<br></p>
<p>PSF Photometry can be obtained using:<br></p>
<ul class="simple">
<li><p>grid of PSF models from WebbPSF<br></p></li>
<li><p>single effective PSF (ePSF) NOT YET AVAILABLE<br></p></li>
<li><p>grid of effective PSF NOT YET AVAILABLE<br></p></li>
</ul>
<p>The notebook shows:<br></p>
<ul class="simple">
<li><p>how to obtain the PSF model from WebbPSF (or build an ePSF)<br></p></li>
<li><p>how to perform PSF photometry on the image<br></p></li>
</ul>
<p><strong>Data</strong>:<br></p>
<p>MIRI Data PID 1028 (Calibration Program), F770W <br>
MIRI Data PID 1171 (LMC), F560W/F770W</p>
<section id="font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a">
<h3>1.1<font color='white'>-</font>Setup WebbPSF and Synphot Directories<a class="anchor" id="webbpsf"></a><a class="headerlink" href="#font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">space_phot</span>
<span class="kn">from</span> <span class="nn">importlib.metadata</span> <span class="kn">import</span> <span class="n">version</span>
<span class="n">version</span><span class="p">(</span><span class="s1">&#39;space_phot&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following task in the stsci.skypac package can be run with TEAL:
                                    skymatch                                    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following tasks in the drizzlepac package can be run with TEAL:
    astrodrizzle       config_testbed      imagefindpars           mapreg       
       photeq            pixreplace           pixtopix            pixtosky      
  refimagefindpars       resetbits          runastrodriz          skytopix      
     tweakback            tweakreg           updatenpol
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0.2.5&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>

<span class="c1"># Set environmental variables</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;WEBBPSF_PATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./webbpsf-data/webbpsf-data&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PYSYN_CDBS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./grp/redcat/trds/&quot;</span>

<span class="c1"># WEBBPSF Data</span>
<span class="n">boxlink</span> <span class="o">=</span> <span class="s1">&#39;https://stsci.box.com/shared/static/qxpiaxsjwo15ml6m4pkhtk36c9jgj70k.gz&#39;</span>                                                           
<span class="n">boxfile</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data/webbpsf-data-1.0.0.tar.gz&#39;</span>
<span class="n">synphot_url</span> <span class="o">=</span> <span class="s1">&#39;http://ssb.stsci.edu/trds/tarfiles/synphot5.tar.gz&#39;</span>
<span class="n">synphot_file</span> <span class="o">=</span> <span class="s1">&#39;./synphot5.tar.gz&#39;</span>

<span class="n">webbpsf_folder</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data&#39;</span>
<span class="n">synphot_folder</span> <span class="o">=</span> <span class="s1">&#39;./grp&#39;</span>


<span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s2">&quot;https&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported URL scheme: </span><span class="si">{</span><span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dest_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>


<span class="c1"># Gather webbpsf files</span>
<span class="n">psfExist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">psfExist</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
    <span class="n">download_file</span><span class="p">(</span><span class="n">boxlink</span><span class="p">,</span> <span class="n">boxfile</span><span class="p">)</span>
    <span class="n">gzf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">boxfile</span><span class="p">)</span>
    <span class="n">gzf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>

<span class="c1"># Gather synphot files</span>
<span class="n">synExist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">synphot_folder</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">synExist</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">synphot_folder</span><span class="p">)</span>
    <span class="n">download_file</span><span class="p">(</span><span class="n">synphot_url</span><span class="p">,</span> <span class="n">synphot_file</span><span class="p">)</span>
    <span class="n">gzf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">synphot_file</span><span class="p">)</span>
    <span class="n">gzf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-white-font-python-imports-a-class-anchor-id-py-imports-a">
<h3>1.2<font color='white'>-</font>Python Imports<a class="anchor" id="py_imports"></a><a class="headerlink" href="#font-color-white-font-python-imports-a-class-anchor-id-py-imports-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">QTable</span>
<span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="kn">import</span> <span class="n">extract_array</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">wcs</span>
<span class="kn">from</span> <span class="nn">astropy.wcs.utils</span> <span class="kn">import</span> <span class="n">skycoord_to_pixel</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">simple_norm</span>
<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span> <span class="nn">importlib.metadata</span> <span class="kn">import</span> <span class="n">version</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># JWST models</span>
<span class="kn">from</span> <span class="nn">jwst.datamodels</span> <span class="kn">import</span> <span class="n">ImageModel</span>

<span class="c1"># Background and PSF Functions</span>
<span class="kn">from</span> <span class="nn">photutils.background</span> <span class="kn">import</span> <span class="n">MMMBackground</span><span class="p">,</span> <span class="n">MADStdBackgroundRMS</span><span class="p">,</span> <span class="n">LocalBackground</span>

<span class="c1"># Photutils library and tools</span>
<span class="kn">from</span> <span class="nn">photutils.aperture</span> <span class="kn">import</span> <span class="n">CircularAperture</span>
<span class="kn">from</span> <span class="nn">photutils.detection</span> <span class="kn">import</span> <span class="n">DAOStarFinder</span>

<span class="c1"># set up crds if necessary</span>
<span class="kn">from</span> <span class="nn">crds</span> <span class="kn">import</span> <span class="n">client</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CRDS_PATH&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set_crds_server</span><span class="p">(</span><span class="s1">&#39;https://jwst-crds.stsci.edu&#39;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CRDS_SERVER_URL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://jwst-crds.stsci.edu&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CRDS_PATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="font-color-white-font-download-data-a-class-anchor-id-data-a">
<h2>2.<font color='white'>-</font>Download Data<a class="anchor" id="data"></a><a class="headerlink" href="#font-color-white-font-download-data-a-class-anchor-id-data-a" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query the MAST (Mikulski Archive for Space Telescopes) database for observations</span>
<span class="c1"># with proposal ID 1028 and a specific filter &#39;F770W&#39;</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">proposal_id</span><span class="o">=</span><span class="mi">1028</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F770W&#39;</span><span class="p">])</span>

<span class="c1"># Get a list of products associated with the located observation</span>
<span class="n">plist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="c1"># Filter the product list to include only specific product subgroups: &#39;RATE&#39;, &#39;CAL&#39;, &#39;I2D&#39;, and &#39;ASN&#39;</span>
<span class="n">fplist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CAL&#39;</span><span class="p">,</span> <span class="s1">&#39;I2D&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">])</span>

<span class="c1"># Download the selected products from the MAST database (UNCOMMENT TO DOWNLOAD)</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">fplist</span><span class="p">)</span>

<span class="c1"># Define source and destination directories</span>
<span class="n">source_dir</span> <span class="o">=</span> <span class="s1">&#39;mastDownload/JWST/&#39;</span>
<span class="n">destination_dir</span> <span class="o">=</span> <span class="s1">&#39;mast/01028/&#39;</span>

<span class="c1"># Create the destination directory if it doesn&#39;t exist</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>

<span class="c1"># Use glob to find all files matching the pattern &#39;mastDownload/JWST/j*/jw01537*cal.fits&#39;</span>
<span class="n">files_to_copy</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span> <span class="s1">&#39;j*/jw01028*&#39;</span><span class="p">))</span>

<span class="c1"># Copy the matching files to the destination directory</span>
<span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">files_to_copy</span><span class="p">:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00013_asn.json to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028-o006_20241028t203024_image2_00013_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00014_asn.json to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028-o006_20241028t203024_image2_00014_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00015_asn.json to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028-o006_20241028t203024_image2_00015_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00016_asn.json to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028-o006_20241028t203024_image2_00016_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image3_00004_asn.json to ./mastDownload/JWST/jw01028-o006_t001_miri_f770w/jw01028-o006_20241028t203024_image3_00004_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01028-o006_t001_miri_f770w/jw01028-o006_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028006001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028006001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028006001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028006001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028006001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028006001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028006001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028006001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query the MAST (Mikulski Archive for Space Telescopes) database for observations</span>
<span class="c1"># with proposal ID 1171 and a specific filters &#39;F550W&#39; and &#39;F770W&#39;</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">proposal_id</span><span class="o">=</span><span class="mi">1171</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F560W&#39;</span><span class="p">,</span> <span class="s1">&#39;F770W&#39;</span><span class="p">])</span>

<span class="c1"># Get a list of products associated with the located observation</span>
<span class="n">plist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="c1"># Filter the product list to include only specific product subgroups: &#39;RATE&#39;, &#39;CAL&#39;, &#39;I2D&#39;, and &#39;ASN&#39;</span>
<span class="n">fplist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CAL&#39;</span><span class="p">,</span> <span class="s1">&#39;I2D&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">])</span>

<span class="c1"># Download the selected products from the MAST database (UNCOMMENT TO DOWNLOAD)</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">fplist</span><span class="p">)</span>

<span class="c1"># Define source and destination directories</span>
<span class="n">source_dir</span> <span class="o">=</span> <span class="s1">&#39;mastDownload/JWST/&#39;</span>
<span class="n">destination_dir</span> <span class="o">=</span> <span class="s1">&#39;mast/01171/&#39;</span>

<span class="c1"># Create the destination directory if it doesn&#39;t exist</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>

<span class="c1"># Use glob to find all files matching the pattern &#39;mastDownload/JWST/j*/jw01537*cal.fits&#39;</span>
<span class="n">files_to_copy</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span> <span class="s1">&#39;j*/jw01171*&#39;</span><span class="p">))</span>

<span class="c1"># Copy the matching files to the destination directory</span>
<span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">files_to_copy</span><span class="p">:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171-o001_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171-o001_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171-o001_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171-o001_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o001_t001_miri_f770w/jw01171-o001_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o001_t001_miri_f770w/jw01171-o001_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171-o002_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171-o002_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171-o002_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171-o002_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o002_t001_miri_f770w/jw01171-o002_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o002_t001_miri_f770w/jw01171-o002_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171-o003_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171-o003_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171-o003_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171-o003_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o003_t001_miri_f770w/jw01171-o003_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o003_t001_miri_f770w/jw01171-o003_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171-o004_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171-o004_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171-o004_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171-o004_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o004_t001_miri_f560w/jw01171-o004_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_t001_miri_f560w_i2d.fits to ./mastDownload/JWST/jw01171-o004_t001_miri_f560w/jw01171-o004_t001_miri_f560w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171-o005_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171-o005_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171-o005_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171-o005_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o005_t001_miri_f770w/jw01171-o005_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o005_t001_miri_f770w/jw01171-o005_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171001001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171001001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171001001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171001001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171001001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171001001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171001001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171001001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171002001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171002001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171002001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171002001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171002001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171002001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171002001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171002001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171003001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171003001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171003001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171003001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171003001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171003001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171003001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171003001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171004001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171004001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171004001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171004001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171004001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171004001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171004001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171004001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171005001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171005001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171005001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171005001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171005001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171005001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171005001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171005001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-white-font-bright-single-object-a-class-anchor-id-bso-a">
<h2>3.<font color='white'>-</font>Bright, Single Object<a class="anchor" id="bso"></a><a class="headerlink" href="#font-color-white-font-bright-single-object-a-class-anchor-id-bso-a" title="Permalink to this heading">#</a></h2>
<p>The purpose of this section is to illustrate how to perform PSF photometry on a single, bright object. While aperture photometry is feasible in isolated cases, the user may find PSF photometry preferable in crowded fields or complicated backgrounds.</p>
<section id="font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a">
<h3>3.1<font color='white'>-</font>Multiple, Level2 Files<a class="anchor" id="bso2"></a><a class="headerlink" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a" title="Permalink to this heading">#</a></h3>
<p>Generally, PSF photometry for data from a space telescope is most accurately performed on pre-mosaiced data. In the case of HST, that corresponds to FLT files rather than DRZ. And in the case of JWST, this corresponds to Level2 files rather than Level3. The reason is that a mosaiced PSF changes the inherent PSF as a function of position on the detector so that there is no adequate model (theoretical or empirical) to use.<br></p>
<p>In this example, we aim to fit a source simultaneously across multiple Level 2 images. A more basic approach would be to fit each Level 2 file individually and then average together the measured fluxes. However, this approach more easily corrects for bad pixels or cosmic rays that are only in one image and allows for a more accurate photometric solution by reducing the number of free parameters per source.<br></p>
<p>Useful references:<br>
HST Documentation on PSF Photometry: https://www.stsci.edu/hst/instrumentation/wfc3/data-analysis/psf<br>
WFPC2 Stellar Photometry with HSTPHOT: https://ui.adsabs.harvard.edu/abs/2000PASP..112.1383D/abstract<br>
Space-Phot Documentation on Level2 Fitting: https://space-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define Level 3 File</span>
<span class="n">lvl3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;./mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;</span><span class="p">]</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Level 2 Data List from ASN files</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;./mast/01028/&quot;</span>
<span class="n">asn</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="s1">&#39;jw01028-o006_*_image3_00004_asn.json&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">lvl2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fi</span><span class="p">:</span>
        <span class="c1">#print(ln)</span>
        <span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;                    &quot;expname&quot;:&#39;</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="n">lvl2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00002_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00003_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00004_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (Before DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/368b4b737afd5a0f55e8c25417614dc057422f83d396edd444ba3c6415148441.png" src="../../../_images/368b4b737afd5a0f55e8c25417614dc057422f83d396edd444ba3c6415148441.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (Before DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/ca2644ed3879d57db6111717be13803ff3ce980fe74c68b502399602c429386c.png" src="../../../_images/ca2644ed3879d57db6111717be13803ff3ce980fe74c68b502399602c429386c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>

<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">dq</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>

<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;update&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="s1">&#39;DQ&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">hdul</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">hdul</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (After DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/05cb68d53fb0dc1e298e6f4ecc620f5b1c19791836f86889f98c9b4e4668924c.png" src="../../../_images/05cb68d53fb0dc1e298e6f4ecc620f5b1c19791836f86889f98c9b4e4668924c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zoom in to see the source. In this case, our source is from MIRI Program ID #1028, a Calibration Program.</span>
<span class="c1"># We are using Visit 006, which targets the A5V dwarf 2MASSJ17430448+6655015</span>
<span class="c1"># Reference Link: http://simbad.cds.unistra.fr/simbad/sim-basic?Ident=2MASSJ17430448%2B6655015&amp;submit=SIMBAD+search</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.3</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/98bbdd9f55f9fe00e7f552ae3145b9e4ccb0838aad7969c9d66d68dd6a2bc8da.png" src="../../../_images/98bbdd9f55f9fe00e7f552ae3145b9e4ccb0838aad7969c9d66d68dd6a2bc8da.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (After DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/c08981e7c6a553b3d064b2702b0813959818a9b2b42c4ad1576c640bba11b543.png" src="../../../_images/c08981e7c6a553b3d064b2702b0813959818a9b2b42c4ad1576c640bba11b543.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zoom in to see the source</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">ref_fits</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ref_fits</span><span class="p">))</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/bad7a1fad8cd841c95f7ccc15c8404c71c0980d4f99006924829b00e2d5d9ea6.png" src="../../../_images/bad7a1fad8cd841c95f7ccc15c8404c71c0980d4f99006924829b00e2d5d9ea6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the PSF from WebbPSF using defaults.</span>
<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">psfs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/O2022052501-NRCA3_FP1-59.fits to ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.58446788), array(691.01192923)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51240355224516, 121.46005973914637)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.0823346), array(703.49975178)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51086191643049, 121.4622239877099)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(507.07857065), array(701.00356235)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51028045414718, 121.46207330662133)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(502.58093657), array(694.50845109)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51039393601155, 121.46118840344465)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="mi">122</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fa010e81ef861735f8f58e9167898311822752338a2103f1ab0be02680db56af.png" src="../../../_images/fa010e81ef861735f8f58e9167898311822752338a2103f1ab0be02680db56af.png" />
</div>
</div>
<section id="notes-on-the-psf-fitting-in-space-phot-br">
<h4>Notes on the PSF Fitting in Space_Phot: <br><a class="headerlink" href="#notes-on-the-psf-fitting-in-space-phot-br" title="Permalink to this heading">#</a></h4>
<p>https://st-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images
As noted above, improved documentation will be coming. For now, here are some important points to consider.</p>
<p>All fitting is performed with Astropy’s Photutils. As with any photometry program, the printed statistical errors are good indicators of your success.</p>
<p>There are different fitting techniques, but when the fit_flux parameter is set to ‘single’, the source is fit simultaneously in all Level2 images. There is good reason for this outlined in a paper for PSF fitting in Hubble: https://iopscience.iop.org/article/10.1086/316630/pdf</p>
<p>As a result, the flux and corresponding error take into account a single overall fit. As part of this, the fitting therefore assumes a constant zero point across all images. While this is not exactly true, it is typically true to within 1% and good enough for our purposes. Users can alternatively fit with the fit_flux parameter set to ‘multi’, which treats each image independently. The final flux must therefore be averaged.</p>
<p>When you run space_phot, you will see some additional diagnositics displayed in the cell. At the top, the % value printed is the fraction of flux remaining in the residual and can be considered a good indicator of a successful model and subtraction. Next are three columns displaying the original, the model, and the residual, respectively, for each Level2 image. Finally, there are corner plots suggesting the success of the fits (more documentation and explanation of these plots is coming).</p>
<p>In this case, you will notice a systematic trend in the residuals. The PSF is oversubtracted in the centermost pixel and undersubtracted in the wings. The cause is unknown. It may be due to a poor PSF model. The user should consider generating more complex PSF models, but that is beyond the scope of this notebook. Nonetheless, the residual value is pretty good so the overall statistical error is relatively small.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do PSF Photometry using space_phot (details of fitting are in documentation)</span>
<span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psfs</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">],</span>
        <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;pixel&#39;</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span>
<span class="p">)</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.51%
</pre></div>
</div>
<img alt="../../../_images/ad8b66652987af6a790e2c0ea7d0be8dcd723d8789550c8d29c6a8cc2c398336.png" src="../../../_images/ad8b66652987af6a790e2c0ea7d0be8dcd723d8789550c8d29c6a8cc2c398336.png" />
<img alt="../../../_images/2f9c2a3b480a5ea01f062209b71e66dd2076e748aa9b218abe26d09684dda932.png" src="../../../_images/2f9c2a3b480a5ea01f062209b71e66dd2076e748aa9b218abe26d09684dda932.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        ra         ...                     exp                    
------------------ ... -------------------------------------------
 265.7686991527498 ... jw01028006001_02101_00001_mirimage_cal.fits
 265.7686999566884 ... jw01028006001_02101_00002_mirimage_cal.fits
265.76869903605876 ... jw01028006001_02101_00003_mirimage_cal.fits
 265.7686993057716 ... jw01028006001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=4</i>
<table id="table139897390201424" class="table-striped table-bordered table-condensed">
<thead><tr><th>ra</th><th>ra_err</th><th>dec</th><th>dec_err</th><th>x</th><th>x_err</th><th>y</th><th>y_err</th><th>mjd</th><th>flux</th><th>fluxerr</th><th>filter</th><th>zp</th><th>mag</th><th>magerr</th><th>zpsys</th><th>exp</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str5</th><th>float64</th><th>float64</th><th>float64</th><th>str2</th><th>str43</th></tr></thead>
<tr><td>265.7686991527498</td><td>3.099540890616481e-08</td><td>66.91716542956232</td><td>4.048719404181611e-08</td><td>512.9192521779092</td><td>0.0009912539572151388</td><td>691.1789323524354</td><td>0.0009563241719186291</td><td>59724.05148232454</td><td>4.5371420228399123e-10</td><td>2.852756244950574e-13</td><td>F770W</td><td>-6.100000000000001</td><td>17.258044065296325</td><td>0.0006824488620271102</td><td>ab</td><td>jw01028006001_02101_00001_mirimage_cal.fits</td></tr>
<tr><td>265.7686999566884</td><td>3.352016619828646e-08</td><td>66.91716487104617</td><td>4.394696873077919e-08</td><td>512.4286880677503</td><td>0.001076894112232071</td><td>703.6842835829042</td><td>0.0010368242317971</td><td>59724.05578601667</td><td>4.5371420166173293e-10</td><td>2.852756241038086e-13</td><td>F770W</td><td>-6.100000000000005</td><td>17.258044066785384</td><td>0.0006824488620271102</td><td>ab</td><td>jw01028006001_02101_00002_mirimage_cal.fits</td></tr>
<tr><td>265.76869903605876</td><td>3.1266381483874284e-08</td><td>66.91716518069518</td><td>4.4621714323511696e-08</td><td>507.4212362399611</td><td>0.0011091861404591997</td><td>701.1729884581454</td><td>0.0010211801064166273</td><td>59724.06012231296</td><td>4.537142017433026e-10</td><td>2.85275624155096e-13</td><td>F770W</td><td>-6.100000000000005</td><td>17.258044066590188</td><td>0.0006824488620271102</td><td>ab</td><td>jw01028006001_02101_00003_mirimage_cal.fits</td></tr>
<tr><td>265.7686993057716</td><td>3.2071170608105604e-08</td><td>66.9171648958011</td><td>4.1145000295728096e-08</td><td>502.930257671631</td><td>0.0010041131008088537</td><td>694.6851429757894</td><td>0.0009782351171748044</td><td>59724.064394164816</td><td>4.5371420201722124e-10</td><td>2.8527562432732406e-13</td><td>F770W</td><td>-6.100000000000005</td><td>17.2580440659347</td><td>0.0006824488620271102</td><td>ab</td><td>jw01028006001_02101_00004_mirimage_cal.fits</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As noted above, As a result, the flux and corresponding error take into account a single overall fit. </span>
<span class="c1"># Therefore, there is no need to average the resulting magnitudes or errors. They should all be the same to within their individual zero-point differences (typically &lt;1%).</span>
<span class="n">mag_lvl2_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span>
<span class="n">magerr_lvl2_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">]</span>

<span class="c1"># Print Magnitude from Table</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mag_lvl2_arr</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">magerr_lvl2_arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       mag        
------------------
17.258044065296325
17.258044066785384
17.258044066590188
  17.2580440659347 

         magerr       
---------------------
0.0006824488620271102
0.0006824488620271102
0.0006824488620271102
0.0006824488620271102
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jwst_obs_fast</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centers</span> <span class="o">=</span> <span class="p">[</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">]</span>
<span class="n">jwst_obs_fast</span><span class="o">.</span><span class="n">fast_psf</span><span class="p">(</span><span class="n">psfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=1</i>
<table id="table139895842972496" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>group_id</th><th>local_bkg</th><th>x_init</th><th>y_init</th><th>flux_init</th><th>x_fit</th><th>y_fit</th><th>flux_fit</th><th>x_err</th><th>y_err</th><th>flux_err</th><th>npixfit</th><th>group_size</th><th>qfit</th><th>cfit</th><th>flags</th><th>flux</th><th>fluxerr</th><th>mag</th><th>magerr</th><th>zp</th></tr></thead>
<thead><tr><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1</td><td>1</td><td>0.0</td><td>691.0119292269616</td><td>512.5844678797273</td><td>1668.262907461838</td><td>691.1736423963373</td><td>512.9081319598845</td><td>1861.7546481805002</td><td>0.0008250237966256669</td><td>0.0008332862486822065</td><td>1.735206001748099</td><td>25</td><td>1</td><td>0.4383646707471202</td><td>-0.02855987894871027</td><td>0</td><td>5.34290715540476e-10</td><td>4.97973488176964e-13</td><td>17.08055593139924</td><td>0.0010114644093132223</td><td>-6.100000000000001</td></tr>
</table></div></div></div>
</div>
</section>
</section>
<section id="font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a">
<h3>3.2<font color='white'>-</font>Single, Level3 Mosaicked File<a class="anchor" id="bso3"></a><a class="headerlink" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a" title="Permalink to this heading">#</a></h3>
<p>Despite the above discussion on performing PSF photometry on the pre-mosaiced data products, space_phot has the functionality to create a mosaiced Level3 PSF at a given single position on the detector based on the Level2 images. The advantage to this is the ability to perform PSF photometry on the deep, stacked data in cases where faint sources are expected to have prohibitively low signal-to-noise in Level2 data. The disadvantage is the amount of time required to make mosaiced Level3 PSF, so that this method is most useful when dealing with a small number of low signal-to-noise sources.<br></p>
<p>Useful references:<br>
Space-Phot Documentation on Level3 Fitting: https://space-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#level-3-psf<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level3 data file the same as above</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0682dfee3f4a69d6377038436b23444d15f52575154f92f04c25ea6998025344.png" src="../../../_images/0682dfee3f4a69d6377038436b23444d15f52575154f92f04c25ea6998025344.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>

<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/1f65ce47e653f7ecee916ec0c62a06b49be554b2cbce3d37c77435fa0e315f04.png" src="../../../_images/1f65ce47e653f7ecee916ec0c62a06b49be554b2cbce3d37c77435fa0e315f04.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/3ce77a7f972eb99795461e5873563f60f8f61b2478b14dcff770f73809e28b0a.png" src="../../../_images/3ce77a7f972eb99795461e5873563f60f8f61b2478b14dcff770f73809e28b0a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function get_jwst_psf is a space_phot wrapper for the WebbPSF calc_psf function and uses a lot of the same keywords.</span>
<span class="c1"># There are more advanced methods for generating your WebbPSF, but those are beyond the scope of this notebook.</span>
<span class="c1"># The defaults used by get_jwst_psf in this notebook are:</span>
<span class="c1"># oversample=4</span>
<span class="c1"># normalize=&#39;last&#39;</span>
<span class="c1"># Non-distorted PSF</span>
<span class="c1"># Useful reference: https://webbpsf.readthedocs.io/en/latest/api/webbpsf.JWInstrument.html#webbpsf.JWInstrument.calc_psf</span>

<span class="c1"># Get PSF from WebbPSF</span>
<span class="n">jwst3_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation3</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">psf3</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst3_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">jwst3_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
iterating query, tdelta=3.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.58446788), array(691.01192923)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.5124035522455, 201.4600597391466)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.0823346), array(703.49975178)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51086191643108, 201.4622239877097)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(507.07857065), array(701.00356235)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51028045414768, 201.46207330662145)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(502.58093657), array(694.50845109)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.5103939360115, 201.46118840344508)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,517 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,519 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,521 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,523 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,525 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,526 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,528 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,922 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,937 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.2
      sharphi: 1.0
      roundlo: -1.0
      roundhi: 1.0
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: INDEF
      nlow: 0
      nhigh: 0
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      allowed_memory: None
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        pt2dQvpkvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      allowed_memory: None
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:18,937 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:19,407 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c62d33210&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:19,408 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,254 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c62d33210&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,254 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,437 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c62d33210&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,438 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,618 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c62d33210&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,620 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,620 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,621 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,621 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,623 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,624 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,624 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,625 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,626 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,627 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,627 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,628 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,629 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,630 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,630 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,631 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,633 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,633 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,634 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,634 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,634 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11091579557784445 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:20,728 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:21,316 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:22,080 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:22,884 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:23,646 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,321 - stpipe.Image3Pipeline.resample - INFO - Resampling variance components
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,323 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,324 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,324 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,325 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,326 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,326 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,327 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,328 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,328 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,329 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,330 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,330 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,351 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  265.737936402 66.941000865 265.701076764 66.912745077 265.773940411 66.898123015 265.810862277 66.926361876
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,798 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,798 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,974 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1030, 1042) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,975 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,981 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:16:24,981 - stpipe - INFO - Results used jwst version: 1.16.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psf3</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model (Mosaiced)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ae6f9ab3643a31bec461516175cf7cce742892c06fa20c6a73d53e198588ddb0.png" src="../../../_images/ae6f9ab3643a31bec461516175cf7cce742892c06fa20c6a73d53e198588ddb0.png" />
</div>
</div>
<section id="id1">
<h4>Notes on the PSF Fitting in Space_Phot: <br><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<p>https://st-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images
As noted above, improved documentation will be coming. For now, here are some important points to consider.
See detailed notes in Section 3.1 above about the fitting process and diagnostics</p>
<p>In addition, consider here that jwst3_obs is generating a Level3 PSF by using the JWST pipeline to resample and combine multiple Level2 PSFs. The Level2 PSFs are generated at the precise location of the source in each Level2 file to account for detector level effects. The resampling uses default resampling paramters. However, users should be aware that if they performed customized resampling for their Level2 data products, they should use similar resampling steps for their PSF below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do PSF Photometry using space_phot (details of fitting are in documentation)</span>
<span class="c1"># See detailed notes in Section 3.1 above about the fitting process and diagnostics</span>
<span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psf3</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">],</span>
        <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.60%
</pre></div>
</div>
<img alt="../../../_images/ad8b66652987af6a790e2c0ea7d0be8dcd723d8789550c8d29c6a8cc2c398336.png" src="../../../_images/ad8b66652987af6a790e2c0ea7d0be8dcd723d8789550c8d29c6a8cc2c398336.png" />
<img alt="../../../_images/2f9c2a3b480a5ea01f062209b71e66dd2076e748aa9b218abe26d09684dda932.png" src="../../../_images/2f9c2a3b480a5ea01f062209b71e66dd2076e748aa9b218abe26d09684dda932.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mag_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">magerr_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mag_lvl2_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">magerr_lvl2_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mag_lvl3psf</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">magerr_lvl3psf</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17.258 0.0007
17.28632 0.0007
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="good-agreement-between-level2-and-level3-results">
<h2>Good agreement between Level2 and level3 results!<a class="headerlink" href="#good-agreement-between-level2-and-level3-results" title="Permalink to this heading">#</a></h2>
</section>
<section id="font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a">
<h2>4.<font color='white'>-</font>Faint/Upper Limit, Single Object<a class="anchor" id="fso"></a><a class="headerlink" href="#font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a" title="Permalink to this heading">#</a></h2>
<p>The purpose of this section is to illustrate how to calculate an upper limit using PSF photometry a blank part of the sky.</p>
<section id="font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a">
<h3>4.1<font color='white'>-</font>Multiple, Level2 Files<a class="anchor" id="fso2"></a><a class="headerlink" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level 3 Files</span>
<span class="n">lvl3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;</span><span class="p">]</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Level 2 Data List from ASN files</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;./mast/01028/&quot;</span>
<span class="n">asn</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="s1">&#39;jw01028-o006_*_image3_00004_asn.json&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">lvl2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fi</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;                    &quot;expname&quot;:&#39;</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="n">lvl2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00002_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00003_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00004_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>

<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">dq</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (After DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/05cb68d53fb0dc1e298e6f4ecc620f5b1c19791836f86889f98c9b4e4668924c.png" src="../../../_images/05cb68d53fb0dc1e298e6f4ecc620f5b1c19791836f86889f98c9b4e4668924c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/232a66029d8e463386afa87e5f0ce65fe2f61d2ccb69b8549f95e4643765babf.png" src="../../../_images/232a66029d8e463386afa87e5f0ce65fe2f61d2ccb69b8549f95e4643765babf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/c08981e7c6a553b3d064b2702b0813959818a9b2b42c4ad1576c640bba11b543.png" src="../../../_images/c08981e7c6a553b3d064b2702b0813959818a9b2b42c4ad1576c640bba11b543.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">ref_fits</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ref_fits</span><span class="p">))</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0732bff10f1db4cb428af031b42c0d8493bdbc2a8f6d82b73ced445b827e595e.png" src="../../../_images/0732bff10f1db4cb428af031b42c0d8493bdbc2a8f6d82b73ced445b827e595e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function get_jwst_psf is a space_phot wrapper for the WebbPSF calc_psf function and uses a lot of the same keywords.</span>
<span class="c1"># There are more advanced methods for generating your WebbPSF, but those are beyond the scope of this notebook.</span>
<span class="c1"># The defaults used by get_jwst_psf in this notebook are:</span>
<span class="c1"># oversample=4</span>
<span class="c1"># normalize=&#39;last&#39;</span>
<span class="c1"># Non-distorted PSF</span>
<span class="c1"># Useful reference: https://webbpsf.readthedocs.io/en/latest/api/webbpsf.JWInstrument.html#webbpsf.JWInstrument.calc_psf</span>

<span class="c1"># Get PSF from WebbPSF</span>
<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">psfs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
iterating query, tdelta=3.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.86069511), array(559.08387297)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51420939304742, 121.52381573784315)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.32944238), array(571.63330681)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.5174643701714, 121.52330511426992)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(767.30763827), array(569.1357543)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51685314039858, 121.52145590349731)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(762.80321923), array(562.61868067)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51503596024747, 121.51983614651763)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psf3</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/89b5e0463abeae820b8cc56d57858766e04be3c0d055553dd41ac2b5e61ea2b9.png" src="../../../_images/89b5e0463abeae820b8cc56d57858766e04be3c0d055553dd41ac2b5e61ea2b9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do PSF Photometry using space_phot (details of fitting are in documentation)</span>
<span class="c1"># https://st-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images</span>
<span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psfs</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span>
<span class="p">)</span>
<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 138.25%
</pre></div>
</div>
<img alt="../../../_images/60fe1d9e15b032223368160ebaeb33132adac653121b31d8b54c20d1765fe5bd.png" src="../../../_images/60fe1d9e15b032223368160ebaeb33132adac653121b31d8b54c20d1765fe5bd.png" />
<img alt="../../../_images/b3853465192240621bf9ce525190bda1e0dd608ac7e61dcdb901980da6c71200.png" src="../../../_images/b3853465192240621bf9ce525190bda1e0dd608ac7e61dcdb901980da6c71200.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        ra         ...                     exp                    
------------------ ... -------------------------------------------
 265.7501383333533 ... jw01028006001_02101_00001_mirimage_cal.fits
 265.7501383333496 ... jw01028006001_02101_00002_mirimage_cal.fits
265.75013833334884 ... jw01028006001_02101_00003_mirimage_cal.fits
 265.7501383333493 ... jw01028006001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As noted above, As a result, the flux and corresponding error take into account a single overall fit. </span>
<span class="c1"># Therefore, there is no need to average the resulting magnitudes or errors. They should all be the same to within their individual zero-point differences (typically &lt;1%).</span>

<span class="c1"># Print Upper Limits</span>
<span class="n">magupper_lvl2psf</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">upper_limit</span><span class="p">(</span><span class="n">nsigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">magupper_lvl2psf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([25.61655762, 25.61655763, 25.61655763, 25.61655762])
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a">
<h3>4.2<font color='white'>-</font>Single, Level3 Mosaicked File<a class="anchor" id="fso3"></a><a class="headerlink" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level3 data file the same as above.</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0682dfee3f4a69d6377038436b23444d15f52575154f92f04c25ea6998025344.png" src="../../../_images/0682dfee3f4a69d6377038436b23444d15f52575154f92f04c25ea6998025344.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/889d7b619fa6b9c7a7cb27ac5c902ecb4815f4b9b1cfea845cf5864725c7cf66.png" src="../../../_images/889d7b619fa6b9c7a7cb27ac5c902ecb4815f4b9b1cfea845cf5864725c7cf66.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/3ce77a7f972eb99795461e5873563f60f8f61b2478b14dcff770f73809e28b0a.png" src="../../../_images/3ce77a7f972eb99795461e5873563f60f8f61b2478b14dcff770f73809e28b0a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>

<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">ref_fits</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ref_fits</span><span class="p">))</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006 (level 3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/8fc66a747c05d587f35bcce934c976e3bc1cc4c6c2bedb4785c0814e8b3d7c84.png" src="../../../_images/8fc66a747c05d587f35bcce934c976e3bc1cc4c6c2bedb4785c0814e8b3d7c84.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function get_jwst_psf is a space_phot wrapper for the WebbPSF calc_psf function and uses a lot of the same keywords.</span>
<span class="c1"># There are more advanced methods for generating your WebbPSF, but those are beyond the scope of this notebook.</span>
<span class="c1"># The defaults used by get_jwst_psf in this notebook are:</span>
<span class="c1"># oversample=4</span>
<span class="c1"># normalize=&#39;last&#39;</span>
<span class="c1"># Non-distorted PSF</span>
<span class="c1"># Useful reference: https://webbpsf.readthedocs.io/en/latest/api/webbpsf.JWInstrument.html#webbpsf.JWInstrument.calc_psf</span>

<span class="c1"># Get PSF from WebbPSF</span>
<span class="n">jwst3_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation3</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">psf3</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst3_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">jwst3_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.86069511), array(559.08387297)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51420939304728, 201.52381573784302)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.32944238), array(571.63330681)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.5174643701711, 201.52330511426985)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(767.30763827), array(569.1357543)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51685314039872, 201.5214559034972)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(762.80321923), array(562.61868067)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51503596024762, 201.51983614651743)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,426 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,428 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,430 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,432 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,434 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,435 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,436 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,633 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,647 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.2
      sharphi: 1.0
      roundlo: -1.0
      roundhi: 1.0
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: INDEF
      nlow: 0
      nhigh: 0
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      allowed_memory: None
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        pt2dQvpkvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      allowed_memory: None
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:18,647 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:19,119 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c66aae650&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:19,120 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:19,976 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c66aae650&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:19,977 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,275 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c66aae650&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,276 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,622 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c66aae650&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,624 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,624 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,625 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,625 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,627 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,628 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,629 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,629 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,631 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,631 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,632 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,632 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,634 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,634 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,635 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,635 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,637 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,637 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,638 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,638 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,639 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11091579557784445 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:20,730 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:21,256 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:22,042 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:22,814 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:23,600 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,264 - stpipe.Image3Pipeline.resample - INFO - Resampling variance components
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,266 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,267 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,268 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,268 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,269 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,269 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,270 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,271 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,271 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,272 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,273 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,273 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,293 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  265.737936402 66.941000865 265.701076764 66.912745077 265.773940411 66.898123015 265.810862277 66.926361876
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,736 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,736 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,928 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1030, 1042) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,929 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,934 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:17:24,934 - stpipe - INFO - Results used jwst version: 1.16.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psf3</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/c2e074dc4c8d00088f4bc7a87709cbf80eb1505d09d3e2d18975401a63058665.png" src="../../../_images/c2e074dc4c8d00088f4bc7a87709cbf80eb1505d09d3e2d18975401a63058665.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psf3</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_centroid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">jwst3_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst3_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of -11.44%
</pre></div>
</div>
<img alt="../../../_images/c2f725316256a61328eac407933b74334671f9b49690bf8ebd5f72dfcb5cce96.png" src="../../../_images/c2f725316256a61328eac407933b74334671f9b49690bf8ebd5f72dfcb5cce96.png" />
<img alt="../../../_images/afa8234860506d5a6104755c5cbb4a16bb044cd14e919f6222ce3001b9d4c9b6.png" src="../../../_images/afa8234860506d5a6104755c5cbb4a16bb044cd14e919f6222ce3001b9d4c9b6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">magupper_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">upper_limit</span><span class="p">(</span><span class="n">nsigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">magupper_lvl2psf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">magupper_lvl3psf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.6166
25.88997
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="note-you-can-go-significantly-deeper-with-the-level3-combined-data-product">
<h2>Note you can go significantly deeper with the Level3 combined data product<a class="headerlink" href="#note-you-can-go-significantly-deeper-with-the-level3-combined-data-product" title="Permalink to this heading">#</a></h2>
</section>
<section id="font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a">
<h2>5.<font color='white'>-</font>Stellar Field (LMC)<a class="anchor" id="lmc"></a><a class="headerlink" href="#font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a" title="Permalink to this heading">#</a></h2>
<section id="in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired">
<h3>In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using space_phot on a large number of stars. We suggest that space_phot may be less optimal for large numbers of bright stars. Other programs, such as DOLPHOT or Photutils, may be better suited for this use case. The primary advantage to space_phot is on faint, single sources. But it can be extended to a larger number if desired.<a class="headerlink" href="#in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired" title="Permalink to this heading">#</a></h3>
</section>
<section id="font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a">
<h3>5.1<font color='white'>-</font>Multiple, Level2 Files<a class="anchor" id="lmc2"></a><a class="headerlink" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a" title="Permalink to this heading">#</a></h3>
<section id="now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed">
<h4>Now do the same thing for a larger group of stars and test for speed<a class="headerlink" href="#now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level 3 Files</span>
<span class="n">lvl3</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&quot;</span><span class="p">]</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level 2 Files</span>
<span class="n">lvl2</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;./mast/01171/jw01171004*cal.fits&#39;</span><span class="p">)</span>
<span class="n">lvl2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00003_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00002_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00001_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find Stars in Level 3 File</span>

<span class="c1"># Get rough estimate of background (There are Better Ways to Do Background Subtraction)</span>
<span class="n">bkgrms</span> <span class="o">=</span> <span class="n">MADStdBackgroundRMS</span><span class="p">()</span>
<span class="n">mmm_bkg</span> <span class="o">=</span> <span class="n">MMMBackground</span><span class="p">()</span>

<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>

<span class="n">std</span> <span class="o">=</span> <span class="n">bkgrms</span><span class="p">(</span><span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">bkg</span> <span class="o">=</span> <span class="n">mmm_bkg</span><span class="p">(</span><span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">data_bkgsub</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_bkgsub</span> <span class="o">-=</span> <span class="n">bkg</span>        
<span class="n">fwhm_psf</span> <span class="o">=</span> <span class="mf">1.882</span> <span class="c1"># pixels for F560W</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">5.</span>

<span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="n">fwhm_psf</span><span class="p">,</span> <span class="n">exclude_border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_separation</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">found_stars</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">found_stars</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">(</span><span class="n">max_lines</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> id     xcentroid          ycentroid          sharpness       roundness1      roundness2      npix sky         peak               flux                mag         
--- ------------------ ------------------ ------------------ ----------- -------------------- ---- --- ------------------- ------------------ --------------------
  1  546.2615248590856   5.40090706700177 0.7041937380599614  0.46773428  0.04273256330788055   25 0.0 -0.8653272390365601 1.6463868618011475  -0.5413297293846483
  2  789.0983970730795  6.312157835017226 0.6691237944354219 -0.17942303  -0.8079555096758742   25 0.0 -0.5761210918426514 1.1000438928604126 -0.10352503572911273
  3  845.9799634503643 3.6757970986043205 0.6829976607805458 0.043498766 -0.42254093349077776   25 0.0  -1.171976923942566 1.1794757843017578 -0.17922257214246215
...                ...                ...                ...         ...                  ...  ... ...                 ...                ...                  ...
788 1005.1187213604594 1062.3368573824348 0.6862059219157299  -0.4493568  -0.8216906677208772   25 0.0 -0.6988779306411743 1.0355932712554932 -0.03797304988288973
789  399.3766175963356 1064.9409739772366 0.3060837128458461  -0.1559235 -0.21203561885367334   25 0.0 -0.7487165927886963 1.0224626064300537 -0.02411858480836388
790  566.9700693080139  1065.048267845045 0.5650444893283237  -0.3703813  -0.5505482861764637   25 0.0  0.5157880783081055  1.638227939605713  -0.5359358211339778
Length = 790 rows
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the found stars</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

<span class="n">xypos</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>
<span class="n">aper</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">xypos</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">aper</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.patches.Circle at 0x7f3c09dcf2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab1c2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62928090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b66390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62a852d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6281a450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6281a9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5812a7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c629cf210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66631390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c660b62d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c660b52d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c660b7e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fc6490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5807b110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6e4050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6e6e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03d216d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c628d1210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0abced10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a57a150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62830b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ac79590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a7460d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a747990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a744050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a744890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a744b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62c86b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62c86b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f6fd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c582fd350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c582fd390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65faf810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65faf850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65fada90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65fafe50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65faf1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ac83f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ac80610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62334650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c628c6790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62d0d7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65e32890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a0a1d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c583a2fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66186350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5827f010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5827f8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5827e550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5827f510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5827d750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5827d710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5827fb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c080a1390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c080a3950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c080a0350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c080a3190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c080a04d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c080a0410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a7bdc10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c582d5750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c582d4cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c582d5ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c582d4e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c582d6090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626f450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626ca10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626d0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626ded0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626d710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626d4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626fdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626d210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626d290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626d3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6626d090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62992850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62990650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62993e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62990f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62992c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62990cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c629929d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6619ed50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6619f8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6619e110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6619c6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6619e950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6cd550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6cec10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6cfb90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6ce110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6cce90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6cda50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6cda90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667ddd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f93010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f92090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f93590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f90090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f92fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62926d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62924a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c629273d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62c7d350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa3790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa2fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa18d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa33d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa1690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa1a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa2350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa2810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa1710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa0d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa3690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa0250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa3150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baa0c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62a1ca90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62a1cb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62a1c310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62a1fbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62a1ee10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62a1d490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c627fe650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c627fc990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c627fdbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c627fc5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0aae24d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0aae12d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0aae0510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0aae1a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0aae1f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57ebc290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f42d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f414d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f43f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f40850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f43a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f41f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f42590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f428d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f43450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f43710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f41a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09f40b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fdf110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fde3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fdd9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fdc550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fdd750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66275a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66275e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66275f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66277c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8befd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8bca10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8bfa10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8bcb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8bef10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8be410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8bd010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8bd7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8bfcd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8be3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a8bf190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c666af610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c666adf90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c666affd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c666ae850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c666ac1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c666ac210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c666adbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6664e390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6664c150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6664f550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf0f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf1910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf1050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf09d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf2710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf2dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf2d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf20d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf3d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf1110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf0750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf0810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf1190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbf1350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e39890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e3a950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e38750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e384d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e3ad50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e380d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e38810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e39cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e3b690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e38390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e386d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e39a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e3b290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a697f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6948d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a694d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a694c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a697e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c622b85d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c622b92d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c622b8b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c622ba210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c622b9590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c622b9910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a717510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a717f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a714710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a715290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a716390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a717450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a717e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a717390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57de9010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57debbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57dea0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57de8650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57deb950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57deb5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57deb1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57de8590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57de98d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57deb490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57de9e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57de9a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57de84d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6647a250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6647a850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6647a990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6647acd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66478410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6647b510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6647bfd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66479210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66479510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66478e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66478990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66479f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66479950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6647ab90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc20e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc23790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc22850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc23e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc237d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc230d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc224d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc21a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc23750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc22790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06fd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06f650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06e510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06d550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06e790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06ee90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06fe50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06da10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06cfd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06e150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06e850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06c5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a06c290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667f4710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667f6450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d1310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d1250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d38d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d1c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d0050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d2410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d1750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d0c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d21d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c663d2e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba82a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba801d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba82d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba80ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba83450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba807d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba82b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba802d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba83e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba82390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba83810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba80590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba826d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba82c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba813d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7ba82e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f4a250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f49490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f496d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f48910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f4b4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f4b050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09ea4e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09ea6310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09ea54d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09ea47d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09ea4d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c09ea66d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a329410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a32a590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c662082d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66208e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66209390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66208b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66209710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66033cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c660306d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66032390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c660307d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66030410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66033450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66031cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66031f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66031210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66033410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66033dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66033d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f9a750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f9b890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f98c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57f0f190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57f0e5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e1bc10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e1a390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e1a790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e18710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e19650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e1a950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e1b9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e1a550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e18390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57e19150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b94350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b959d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b96690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b97a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b95310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b96ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b94250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b94f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b95e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b97150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b94a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b96410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b97b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b97590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f101d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f13110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f10a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f125d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f111d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f12510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f10190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f12ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f12fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f10ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b2b810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b2b2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62b28c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c627f1550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f51650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f51c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f519d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f53590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f522d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f53f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f53810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f53ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f527d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f53cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03f51190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66157050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6603d250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6603c410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6603c550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6603c950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58209fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c5820b8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65de2290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65de38d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65de2f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c65de3650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6624b550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6624add0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb2abd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb29fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb29190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb2b610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb2b150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb2af90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb2ab90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb29750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb28e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb29a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb28dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb29410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb2bb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb28a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb2ae10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb2a1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baaf410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baae110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baae310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baaccd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baae2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7baae610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd69d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd5490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd7610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd7290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd5b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd7bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd41d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd5a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd4f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd4910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd5890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd5ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd7550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c03fd5b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58077a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58074d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58077090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58074390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58075cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58074450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58077590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58074f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58077450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58075650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c580744d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c58076b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c580751d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c580768d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669fcfd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669ffc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669fdc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669fe950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669fee90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669fe490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669ffa50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669fda10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669fea50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669fd410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669fc5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c669ffd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd6f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd5710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd6d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd7b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd6b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd7d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd7f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd4410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd5810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd64d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd7810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd54d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbd5cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62d7a3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62d7ae10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62d79310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62d7aa10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62d79690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c62d79f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c661447d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c661459d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66146190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66145d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66147ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4a1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4be90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4bb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4a110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc49450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4ac90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc49550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc49ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4b2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc49990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc48f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4abd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc48590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4b190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc49b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc48a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4a450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc48690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc4ad10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc49bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc49c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57dc9210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57dca150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57dc8550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57dcba10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57dcb2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c57dc91d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb88d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8bf10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb89c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8ba10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb88e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8bb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb89c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8bd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb89590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8a710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8a590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8a310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb89fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8b350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb88050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb88110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8add0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8aed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb88950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb8b150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb88990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8f0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8d510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8f810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8c690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8fbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8fc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8fc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8f7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8cc10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8ddd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8f190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8e250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8d090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8ffd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0ab8d450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66495e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66494b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66496790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66496f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66494050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66496e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66496a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66496990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66497a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66497050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66496b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66497d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66497ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66496510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66496310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c664974d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66495810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c664952d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66496190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c664969d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66aeddd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66aeeb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66aec990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c67421ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c674225d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c67421950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c67423d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c67420c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c674235d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66f5bd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66f5a810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66f5add0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66f58350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0f010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0e750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0dd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0f410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0d510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0f550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0f8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0e3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0da90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0c450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bb0f590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667be210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667be490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bdd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667befd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bdb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bec90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667be350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bc190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bf1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bd390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bc450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bf050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bc9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bc810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bcb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bf110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bfb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bdf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c667bc910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c0a6912d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc40450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc42f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc425d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc40310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc41490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc41b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc42a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc42550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc43510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc413d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc43fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc43050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc432d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc40bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc408d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc43e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc416d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc41d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc42590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc40b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6656a510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6656b510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6656ae10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66569650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66569110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66569c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66569f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6656af10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6656a950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66569b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66589410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66588ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6658b590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66588090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6658b4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6658a490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66589b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdcf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdf7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbde790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdc190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdf650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdf310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdc350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdd1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbddad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdcc10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdf190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbddf90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdc650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdc750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbde650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdde90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdecd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdc410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbde250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbdccd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3ef10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3c9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3d210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3f210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3f2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3e190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3e610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3d010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3ee10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3ca50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3fe50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3de90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3d990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3d5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3ff50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3d390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3f910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3edd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3dbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3e650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc3fb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698f390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698fb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698da90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698d750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698f950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698dc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698c750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698ee50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698cdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698e610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698e110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698c450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698cf10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698e890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698d650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698fe50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698cfd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698f410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698f8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698ea90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6698cf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc26f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc27690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc27710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc26fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc25550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc24e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc274d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc27750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc25990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc25450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc26090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc25f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc24a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc26690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc25950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc27cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc278d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc26a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc27ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbafed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbae650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbaef90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbaf9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbafb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbad450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbaf350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbafc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbaf590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbafad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbacf90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbafa90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbaf090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbacdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbaf290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbae810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbaf6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbae690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbacf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bbae710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc01f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc02990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc03350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc03890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc00a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc00e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc00f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc02290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc01650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc01f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc02910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc02150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc008d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc033d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc01190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc024d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc037d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc03490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc03990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c7bc03290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66264a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66266cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66266690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66266990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66264c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66266950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66266dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66264e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66264c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66267e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66267310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66264790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66266910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c66265cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6663ca90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6663e090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6663d890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6663e410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3c6663e7d0&gt;]
</pre></div>
</div>
<img alt="../../../_images/6d3a3b9b4990e31f7254cfd16b0ed731357d21673d34428069c535dbc6520c1c.png" src="../../../_images/6d3a3b9b4990e31f7254cfd16b0ed731357d21673d34428069c535dbc6520c1c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter out only stars you want</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;sharpness&#39;</span><span class="p">)</span>

<span class="n">xlim0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.25</span>
<span class="n">xlim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.25</span>
<span class="n">ylim0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.15</span>
<span class="n">ylim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.15</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">sh_inf</span> <span class="o">=</span> <span class="mf">0.40</span>
<span class="n">sh_sup</span> <span class="o">=</span> <span class="mf">0.82</span>
<span class="c1">#mag_lim = -5.0</span>
<span class="n">lmag_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span>
<span class="n">umag_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">sh_sup</span><span class="p">,</span> <span class="n">sh_sup</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">sh_inf</span><span class="p">,</span> <span class="n">sh_inf</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lmag_lim</span><span class="p">,</span> <span class="n">lmag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">umag_lim</span><span class="p">,</span> <span class="n">umag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;roundness&#39;</span><span class="p">)</span>

<span class="n">ylim0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.25</span>
<span class="n">ylim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.25</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">)</span>

<span class="n">round_inf</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.40</span>
<span class="n">round_sup</span> <span class="o">=</span> <span class="mf">0.40</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">round_sup</span><span class="p">,</span> <span class="n">round_sup</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">round_inf</span><span class="p">,</span> <span class="n">round_inf</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lmag_lim</span><span class="p">,</span> <span class="n">lmag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">umag_lim</span><span class="p">,</span> <span class="n">umag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/7f1d332dead5cf6c0cd0f89d14414aefcdd4361a5249ae62a1bdc3d743e9d6b4.png" src="../../../_images/7f1d332dead5cf6c0cd0f89d14414aefcdd4361a5249ae62a1bdc3d743e9d6b4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lmag_lim</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">umag_lim</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">round_inf</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">round_sup</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sh_inf</span><span class="p">)</span> 
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">sh_sup</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">))</span>

<span class="n">found_stars_sel</span> <span class="o">=</span> <span class="n">found_stars</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stars found originally:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_stars</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stars in final selection:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_stars_sel</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of stars found originally: 790
Number of stars in final selection: 13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">found_stars_sel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=13</i>
<table id="table139897150221840" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>xcentroid</th><th>ycentroid</th><th>sharpness</th><th>roundness1</th><th>roundness2</th><th>npix</th><th>sky</th><th>peak</th><th>flux</th><th>mag</th></tr></thead>
<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float32</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>86</td><td>378.7558816433192</td><td>106.99517231293703</td><td>0.7364077918416378</td><td>-0.059391562</td><td>-0.06704534345138508</td><td>25</td><td>0.0</td><td>51.20432662963867</td><td>46.88838195800781</td><td>-4.177663115498585</td></tr>
<tr><td>93</td><td>699.4285739316663</td><td>121.30618337045195</td><td>0.6621937635659819</td><td>-0.45228603</td><td>-0.16121600597523705</td><td>25</td><td>0.0</td><td>21.92721176147461</td><td>19.500816345214844</td><td>-3.2251319805603025</td></tr>
<tr><td>138</td><td>502.6449423284217</td><td>185.07660708931144</td><td>0.6351195098960691</td><td>-0.36937103</td><td>-0.37435640137051696</td><td>25</td><td>0.0</td><td>30.200824737548828</td><td>24.987716674804688</td><td>-3.4943164325492058</td></tr>
<tr><td>141</td><td>520.4512004466732</td><td>190.2476066884721</td><td>0.8012885262482311</td><td>0.30771914</td><td>-0.08561803159241342</td><td>25</td><td>0.0</td><td>23.034168243408203</td><td>17.149253845214844</td><td>-3.085613072177968</td></tr>
<tr><td>144</td><td>591.9599066066671</td><td>194.8718750798144</td><td>0.7334114841843143</td><td>-0.36179662</td><td>-0.19144805342168533</td><td>25</td><td>0.0</td><td>21.18755340576172</td><td>16.44730567932129</td><td>-3.0402369100553313</td></tr>
<tr><td>169</td><td>388.990541620123</td><td>248.15789451654376</td><td>0.7118823356707229</td><td>0.16915432</td><td>0.21323040806731455</td><td>25</td><td>0.0</td><td>19.440757751464844</td><td>18.429296493530273</td><td>-3.1637718927398666</td></tr>
<tr><td>183</td><td>532.3925923035418</td><td>267.74287686139763</td><td>0.7174778066738734</td><td>-0.2787835</td><td>-0.16201501039505897</td><td>25</td><td>0.0</td><td>43.17793273925781</td><td>35.05239486694336</td><td>-3.8617942384933013</td></tr>
<tr><td>249</td><td>671.5101306788192</td><td>370.56221568412315</td><td>0.6690541020715319</td><td>0.22694585</td><td>-0.2501719039312765</td><td>25</td><td>0.0</td><td>21.814945220947266</td><td>17.284053802490234</td><td>-3.09411402382609</td></tr>
<tr><td>314</td><td>635.9221063124252</td><td>494.5522379657613</td><td>0.8149770327504342</td><td>-0.12416268</td><td>0.22344203180037933</td><td>25</td><td>0.0</td><td>29.927074432373047</td><td>23.478647232055664</td><td>-3.426682676437008</td></tr>
<tr><td>373</td><td>584.9812269385081</td><td>576.5389571037796</td><td>0.7775545307534784</td><td>-0.21396631</td><td>0.009246422308793646</td><td>25</td><td>0.0</td><td>76.73455047607422</td><td>59.45756530761719</td><td>-4.435517803918195</td></tr>
<tr><td>386</td><td>492.6253255819231</td><td>596.8690332212642</td><td>0.7193021689332798</td><td>-0.23190862</td><td>-0.09178475176652573</td><td>25</td><td>0.0</td><td>78.58627319335938</td><td>64.5720443725586</td><td>-4.525111341330769</td></tr>
<tr><td>413</td><td>619.8610744135557</td><td>636.7050695267906</td><td>0.764199844647154</td><td>0.013973999</td><td>-0.007752396414213482</td><td>25</td><td>0.0</td><td>56.14342498779297</td><td>47.85715866088867</td><td>-4.19986727609639</td></tr>
<tr><td>436</td><td>664.5588392056713</td><td>666.5506376499176</td><td>0.6773962981916116</td><td>0.5580665</td><td>0.022133349895936842</td><td>25</td><td>0.0</td><td>80.94784545898438</td><td>67.48514556884766</td><td>-4.573020472543158</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert pixel to wcs coords</span>
<span class="n">skycoords</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">pixel_to_world</span><span class="p">(</span><span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">skycoords</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">dq</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a grid for fast lookup using WebbPSF. The larger the number of grid points, the better the photometric precision.</span>
<span class="c1"># Developer note. Would be great to have a fast/approximate look up table. </span>
<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_jwst_psf_grid</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">num_psfs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-04-13T03:08:10.578
                        MJD: 59682.13067798611

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/R2022041201-NRCA3_FP1-2.fits
	Date (MJD):	 59681.7791
	Delta time:	 -0.3516 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022041301-NRCA3_FP1-1.fits
	Date (MJD):	 59682.8401
	Delta time:	 0.7094 days
User requested choosing OPD time closest in time to 2022-04-13T03:08:10.578, which is R2022041201-NRCA3_FP1-2.fits, delta time -0.352 days
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/R2022041201-NRCA3_FP1-2.fits to ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F560W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/16: (0, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/16 centroid: (201.39896123096594, 201.57462168473992)
    Position 2/16: (0, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 2/16 centroid: (201.27298326538994, 201.8122962916395)
    Position 3/16: (0, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 3/16 centroid: (201.26092649151903, 201.8273016561088)
    Position 4/16: (0, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 4/16 centroid: (201.30665784716913, 201.41346936543644)
    Position 5/16: (341, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 5/16 centroid: (201.38945973576688, 201.62934762823934)
    Position 6/16: (341, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 6/16 centroid: (201.48863769451324, 201.63972936419177)
    Position 7/16: (341, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 7/16 centroid: (201.48210765199016, 201.6080741598635)
    Position 8/16: (341, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 8/16 centroid: (201.42818621943198, 201.61327684523178)
    Position 9/16: (682, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 9/16 centroid: (201.405459701244, 201.64424228029097)
    Position 10/16: (682, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 10/16 centroid: (201.52251762658082, 201.5881287591983)
    Position 11/16: (682, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 11/16 centroid: (201.57423502982945, 201.5553583383486)
    Position 12/16: (682, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 12/16 centroid: (201.584920185908, 201.6735683999315)
    Position 13/16: (1023, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 13/16 centroid: (201.44216164335302, 201.69986266797625)
    Position 14/16: (1023, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 14/16 centroid: (201.51032408676687, 201.68044889871803)
    Position 15/16: (1023, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 15/16 centroid: (201.62018700397059, 201.66506320800642)
    Position 16/16: (1023, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 16/16 centroid: (201.77312450805107, 201.60334597442935)
  Saving file: miri_mirim_f560w_fovp101_samp4_npsf16.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">QTable</span><span class="p">([</span><span class="n">skycoords</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;skycoord&quot;</span><span class="p">])</span>
<span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;skycoord.ecsv&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now Loop Through All Stars and Build Photometry Table</span>
<span class="c1"># Readers should refer to all diagnostics discussed above. </span>
<span class="c1"># It should be noted that empty plots correspond to LVL2 files with dither positions that do not cover that particular coordinate.</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">badindex</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">localbkg_estimator</span> <span class="o">=</span> <span class="n">LocalBackground</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">MMMBackground</span><span class="p">())</span>

<span class="k">for</span> <span class="n">source_location</span> <span class="ow">in</span> <span class="n">skycoords</span><span class="p">:</span>
    <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting&#39;</span><span class="p">,</span> <span class="n">counter</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39; of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">skycoords</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
    <span class="n">psfs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_jwst_psf_from_grid</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">,</span> <span class="n">grid</span><span class="p">)</span>
    <span class="n">xys</span> <span class="o">=</span> <span class="p">[</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">wcs_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">n_exposures</span><span class="p">)]</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="p">[</span><span class="n">localbkg_estimator</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">data_arr_pam</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">n_exposures</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bkg</span><span class="p">)</span>
    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psfs</span><span class="p">,</span>
        <span class="n">source_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;wcs&#39;</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span>
        <span class="n">maxiter</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    
    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">fit_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
     
    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psfs</span><span class="p">,</span>
        <span class="n">fit_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span>
        <span class="n">maxiter</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>

    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mag_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span>
    <span class="n">magerr_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">]</span>
    <span class="n">mag_lvl2psf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mag_arr</span><span class="p">)</span>
    <span class="n">magerr_lvl2psf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">magerr_arr</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl2psf</span><span class="p">,</span> <span class="n">magerr_lvl2psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl2psf</span><span class="p">,</span> <span class="n">magerr_lvl2psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mf">1.</span>
    
    <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time for Photometry:&quot;</span><span class="p">,</span> <span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting 1.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.68751895, -69.44522201)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.869825303554535, nan, 1.875230292270058, nan]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.76%
</pre></div>
</div>
<img alt="../../../_images/cc19f76a7f4b009cfdefdd015fdabeeef66d3d24e89deea0f173838dfe6232ce.png" src="../../../_images/cc19f76a7f4b009cfdefdd015fdabeeef66d3d24e89deea0f173838dfe6232ce.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.70%
</pre></div>
</div>
<img alt="../../../_images/187214fc385e9ac1409bcc9f3ba154d99f302c1300952e5ce4be1cea3a40542f.png" src="../../../_images/187214fc385e9ac1409bcc9f3ba154d99f302c1300952e5ce4be1cea3a40542f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 29.459651388999987
Starting 2.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70519786, -69.43753355)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7614484293419017, 1.8134855595066321, 1.7480259496590187, 1.943224255991454]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.74%
</pre></div>
</div>
<img alt="../../../_images/b751c2a6ecfdfa85b97ab7627986a0070b3f66f2f98a311c07850edc99b34045.png" src="../../../_images/b751c2a6ecfdfa85b97ab7627986a0070b3f66f2f98a311c07850edc99b34045.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.71%
</pre></div>
</div>
<img alt="../../../_images/69aaea465dc17a6abbeb73953a9d91142cc97b512e85c75f8529b22d2ac5f4b0.png" src="../../../_images/69aaea465dc17a6abbeb73953a9d91142cc97b512e85c75f8529b22d2ac5f4b0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 30.274453890000018
Starting 3.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.69947281, -69.44357619)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7704960215245196, 1.8189359360103365, 1.8464110786631958, 1.8683478434880576]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.12%
</pre></div>
</div>
<img alt="../../../_images/bda6e899676eb617afb6224507cf4332f2dc68e2370fcd159020a9ce350cf9b7.png" src="../../../_images/bda6e899676eb617afb6224507cf4332f2dc68e2370fcd159020a9ce350cf9b7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.12%
</pre></div>
</div>
<img alt="../../../_images/f1099ed842a952c4ecd99c6230992465b712dbfb86eab61d6316c1fca55d7274.png" src="../../../_images/f1099ed842a952c4ecd99c6230992465b712dbfb86eab61d6316c1fca55d7274.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 32.74837323199995
Starting 4.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70076349, -69.44322912)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7729037974078583, 1.7539834316196359, 1.8693315009785514, 1.8635000334623966]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.77%
</pre></div>
</div>
<img alt="../../../_images/086a5b89778222e93a4612a42b738e2c0bf3fd5fe8757c50711fdca079200fa7.png" src="../../../_images/086a5b89778222e93a4612a42b738e2c0bf3fd5fe8757c50711fdca079200fa7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.79%
</pre></div>
</div>
<img alt="../../../_images/dff54f3e1bad21f41cc73a701cd527232921e707146be167b095b1d276e0aeba.png" src="../../../_images/dff54f3e1bad21f41cc73a701cd527232921e707146be167b095b1d276e0aeba.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 32.48154919800004
Starting 5.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70480666, -69.44154063)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.829211658608597, 1.7340520685369318, 1.8180533992616752, 1.8822986582914987]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.44%
</pre></div>
</div>
<img alt="../../../_images/43189c16673ae2ae08a5207f0d2ffa60c3e140f4b23a0a7e930b961e205a84e5.png" src="../../../_images/43189c16673ae2ae08a5207f0d2ffa60c3e140f4b23a0a7e930b961e205a84e5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.42%
</pre></div>
</div>
<img alt="../../../_images/b062368b0fdb21d06cdf716285f543ccbae2f209d6bb69ec62fa9d7da16969df.png" src="../../../_images/b062368b0fdb21d06cdf716285f543ccbae2f209d6bb69ec62fa9d7da16969df.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 36.17453582300004
Starting 6.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.69801844, -69.44754524)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.8947609114092452, nan, 1.8804607170599477, nan]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of -0.27%
</pre></div>
</div>
<img alt="../../../_images/96b3ef522b76151c414a967c25dedf5f4768c8b2da1eab8a0c4343f5ef973a8a.png" src="../../../_images/96b3ef522b76151c414a967c25dedf5f4768c8b2da1eab8a0c4343f5ef973a8a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of -0.27%
</pre></div>
</div>
<img alt="../../../_images/6dc88d6c3716a8a0f2fac4b32048d270e1b9b51c29829ead4d26ddac7bf4173d.png" src="../../../_images/6dc88d6c3716a8a0f2fac4b32048d270e1b9b51c29829ead4d26ddac7bf4173d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 27.087839794000047
Starting 7.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70685609, -69.4443474)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7949211474651943, 1.8149203216207437, 1.7996749530022749, 1.9178177507027336]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.72%
</pre></div>
</div>
<img alt="../../../_images/6c727ad8ebfabeaa27d3963b9ee9b7fbc230fa5c70b699583df4a0ad563fa4e0.png" src="../../../_images/6c727ad8ebfabeaa27d3963b9ee9b7fbc230fa5c70b699583df4a0ad563fa4e0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.71%
</pre></div>
</div>
<img alt="../../../_images/389e81ade796ff78b3a66a8272d87410097eeb601b0e01ba70f2588875ca8c4a.png" src="../../../_images/389e81ade796ff78b3a66a8272d87410097eeb601b0e01ba70f2588875ca8c4a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 37.69532649600001
Starting 8.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.72134618, -69.44277393)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.9285976984921622, 1.8641873090163523, 1.9269168845723184, 1.8905765748860541]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.41%
</pre></div>
</div>
<img alt="../../../_images/d8f094fbe11e50e41fe4c7f16c4dcb5491c16d7b35f4f20fc57b0a5420bd1bd2.png" src="../../../_images/d8f094fbe11e50e41fe4c7f16c4dcb5491c16d7b35f4f20fc57b0a5420bd1bd2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.41%
</pre></div>
</div>
<img alt="../../../_images/0a5cc8fb460d0349ddf73c8a94b4abb5ede43adadec914cc6db1e297f55bb80c.png" src="../../../_images/0a5cc8fb460d0349ddf73c8a94b4abb5ede43adadec914cc6db1e297f55bb80c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 30.684884652999926
Starting 9.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.72825455, -69.44591833)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.84141688927626, 1.7936298903695782, 1.8419053048023337, 1.898898235350981]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.13%
</pre></div>
</div>
<img alt="../../../_images/b7ca7c468270d5fa7bf431ed7d1c4fb7c84751f593b4a9d5b066479698e8fd72.png" src="../../../_images/b7ca7c468270d5fa7bf431ed7d1c4fb7c84751f593b4a9d5b066479698e8fd72.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.55%
</pre></div>
</div>
<img alt="../../../_images/48675114539712ba677b606539606bf4eb7b5991c3ec3b74457dc40893d13088.png" src="../../../_images/48675114539712ba677b606539606bf4eb7b5991c3ec3b74457dc40893d13088.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 29.807825353999988
Starting 10.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.73139968, -69.44867714)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.8579865136454181, 1.8863315108780547, 1.9026257471384738, 1.9372216368143538]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.64%
</pre></div>
</div>
<img alt="../../../_images/cc941c353ca84b763c7aa9d8079cf1e8457a426846a12d6bec97bfcc6a82d1c4.png" src="../../../_images/cc941c353ca84b763c7aa9d8079cf1e8457a426846a12d6bec97bfcc6a82d1c4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.52%
</pre></div>
</div>
<img alt="../../../_images/7ada4ee7c5ca5e9dbd01d9fa239a903ec1a76bb381991fc0cea0e66015f0eac8.png" src="../../../_images/7ada4ee7c5ca5e9dbd01d9fa239a903ec1a76bb381991fc0cea0e66015f0eac8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 34.846156638000025
Starting 11.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.72803699, -69.45133844)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7678997491160011, 1.7850290745363107, 1.7748173095028976, 1.8868650197982788]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.11%
</pre></div>
</div>
<img alt="../../../_images/899d6ee6b89d1b666ad3bc91357218f5ff3c6c9611fb178ddc53f0e93799f74b.png" src="../../../_images/899d6ee6b89d1b666ad3bc91357218f5ff3c6c9611fb178ddc53f0e93799f74b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.32%
</pre></div>
</div>
<img alt="../../../_images/cde7c7dfddd4fc9590fd503638a71cad381c5674304629fce58617b17e256da8.png" src="../../../_images/cde7c7dfddd4fc9590fd503638a71cad381c5674304629fce58617b17e256da8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 34.89746904799995
Starting 12.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.7374627, -69.44890937)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.8077051193817804, 1.816236440996522, 1.8916719631336663, 1.9208566810361187]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.53%
</pre></div>
</div>
<img alt="../../../_images/33b2466d04edda28fb5d74a1d61e474c99f4081662c5a90b8bb4d1d77b0dfb11.png" src="../../../_images/33b2466d04edda28fb5d74a1d61e474c99f4081662c5a90b8bb4d1d77b0dfb11.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.53%
</pre></div>
</div>
<img alt="../../../_images/6b3211f0892057566a8ec5310e197e4ad3c54ee9ce26197aa6524babbe750cf3.png" src="../../../_images/6b3211f0892057566a8ec5310e197e4ad3c54ee9ce26197aa6524babbe750cf3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 30.545299899999918
Starting 13.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.74189341, -69.44834497)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.9374462342956695, 1.8818280295113832, 2.02440093926021, 1.8681333922051095]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.80%
</pre></div>
</div>
<img alt="../../../_images/844230feae5630acb5653ec9ad9c0dcfd9ab7fcd2083b17a280d6d1775ff49e8.png" src="../../../_images/844230feae5630acb5653ec9ad9c0dcfd9ab7fcd2083b17a280d6d1775ff49e8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.82%
</pre></div>
</div>
<img alt="../../../_images/818074d7538c0f8966ae2eecae8c10b985ac498be32798d7e757348aa4561252.png" src="../../../_images/818074d7538c0f8966ae2eecae8c10b985ac498be32798d7e757348aa4561252.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 30.445656781000025
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xys</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(array(665.76055802), array(668.62800217)),
 (array(627.68124922), array(622.10846201)),
 (array(664.87310868), array(665.57020268)),
 (array(626.71526424), array(619.17865679))]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ra</th>
      <th>dec</th>
      <th>mag</th>
      <th>magerr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80.687509</td>
      <td>-69.445224</td>
      <td>18.898150</td>
      <td>0.006949</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80.705194</td>
      <td>-69.437533</td>
      <td>19.404382</td>
      <td>0.006111</td>
    </tr>
    <tr>
      <th>2</th>
      <td>80.699469</td>
      <td>-69.443578</td>
      <td>18.680336</td>
      <td>0.004366</td>
    </tr>
    <tr>
      <th>3</th>
      <td>80.700771</td>
      <td>-69.443234</td>
      <td>18.924007</td>
      <td>0.005539</td>
    </tr>
    <tr>
      <th>4</th>
      <td>80.704797</td>
      <td>-69.441542</td>
      <td>19.128008</td>
      <td>0.004758</td>
    </tr>
    <tr>
      <th>5</th>
      <td>80.698003</td>
      <td>-69.447549</td>
      <td>19.901387</td>
      <td>0.010868</td>
    </tr>
    <tr>
      <th>6</th>
      <td>80.706848</td>
      <td>-69.444346</td>
      <td>18.445790</td>
      <td>0.004019</td>
    </tr>
    <tr>
      <th>7</th>
      <td>80.721346</td>
      <td>-69.442773</td>
      <td>19.008238</td>
      <td>0.005646</td>
    </tr>
    <tr>
      <th>8</th>
      <td>80.728236</td>
      <td>-69.445924</td>
      <td>18.900170</td>
      <td>0.004508</td>
    </tr>
    <tr>
      <th>9</th>
      <td>80.731416</td>
      <td>-69.448676</td>
      <td>17.868632</td>
      <td>0.003254</td>
    </tr>
    <tr>
      <th>10</th>
      <td>80.728022</td>
      <td>-69.451342</td>
      <td>17.957905</td>
      <td>0.003338</td>
    </tr>
    <tr>
      <th>11</th>
      <td>80.737476</td>
      <td>-69.448909</td>
      <td>18.579211</td>
      <td>0.003969</td>
    </tr>
    <tr>
      <th>12</th>
      <td>80.741885</td>
      <td>-69.448347</td>
      <td>17.952330</td>
      <td>0.003356</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write to File</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;miri_photometry_space_phot_lvl2.txt&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a">
<h3>5.2<font color='white'>-</font>Single, Level3 Mosaicked File<a class="anchor" id="lmc3"></a><a class="headerlink" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/65489b524dbbca5734617b96426483246367a7fd88ed410e7067187bbf60d8b6.png" src="../../../_images/65489b524dbbca5734617b96426483246367a7fd88ed410e7067187bbf60d8b6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get PSF from WebbPSF and drizzle it to the source location</span>
<span class="n">jwst3_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation3</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">skycoords</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    [(80.68751895, -69.44522201), (80.70519786, -69.43753355),
     (80.69947281, -69.44357619), (80.70076349, -69.44322912),
     (80.70480666, -69.44154063), (80.69801844, -69.44754524),
     (80.70685609, -69.4443474 ), (80.72134618, -69.44277393),
     (80.72825455, -69.44591833), (80.73139968, -69.44867714),
     (80.72803699, -69.45133844), (80.7374627 , -69.44890937),
     (80.74189341, -69.44834497)]&gt;
</pre></div>
</div>
</div>
</div>
<section id="readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars">
<h4>Readers should refer to all diagnostics discussed above. In general, this loop shows the difficulty in doing PSF photometry on a wide variety of stars (brightness, distribution on the detector, etc) without visual inspection. Especially when dealing with low SNR sources.This is true for all photometry packages. Users should inspect the associated metrics and consider optimizing the parameters for specific stars of interest. Nonetheless, the success of the fits can always be quantified in with the associated error bars.<a class="headerlink" href="#readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now Loop Through All Stars and Build Photometry Table</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">badindex</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">source_location</span> <span class="ow">in</span> <span class="n">skycoords</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting&#39;</span><span class="p">,</span> <span class="n">counter</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39; of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">skycoords</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
    <span class="n">psf3</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst3_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">jwst3_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">,</span> <span class="n">num_psfs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">xys</span> <span class="o">=</span> <span class="p">[</span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">)]</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="p">[</span><span class="n">localbkg_estimator</span><span class="p">(</span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">xys</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xys</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bkg</span><span class="p">)</span>
    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psf3</span><span class="p">,</span>
        <span class="n">source_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fit_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">aperture_photometry</span><span class="p">(</span><span class="n">fit_location</span><span class="p">,</span> <span class="n">encircled_energy</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">aperture_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">])</span>
    
    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psf3</span><span class="p">,</span>
        <span class="n">fit_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fit_centroid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mag_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">magerr_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl3psf</span><span class="p">,</span> <span class="n">magerr_lvl3psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl3psf</span><span class="p">,</span> <span class="n">magerr_lvl3psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mf">1.</span>
    <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time for Photometry:&quot;</span><span class="p">,</span> <span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting 1.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70519786, -69.43753355)&gt;
Setting up sim to match ./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-04-13T03:08:10.578
                        MJD: 59682.13067798611

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/R2022041201-NRCA3_FP1-2.fits
	Date (MJD):	 59681.7791
	Delta time:	 -0.3516 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022041301-NRCA3_FP1-1.fits
	Date (MJD):	 59682.8401
	Delta time:	 0.7094 days
User requested choosing OPD time closest in time to 2022-04-13T03:08:10.578, which is R2022041201-NRCA3_FP1-2.fits, delta time -0.352 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F560W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(123.53744224), array(699.5595544)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.34368596613945, 201.7628797397261)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(76.29823152), array(661.82205941)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.32154273036554, 201.80099578112635)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(120.43679282), array(698.68358418)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.34212605742846, 201.76493480669592)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(73.31069299), array(660.86952362)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.31952743828327, 201.80291255054078)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:57,919 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:57,920 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:57,923 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:57,925 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:57,926 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:57,928 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:57,929 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:58,175 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:58,189 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.2
      sharphi: 1.0
      roundlo: -1.0
      roundhi: 1.0
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: INDEF
      nlow: 0
      nhigh: 0
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      allowed_memory: None
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        S8+wK09fvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      allowed_memory: None
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:58,189 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:58,691 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c5831c710&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:58,692 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:59,612 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c5831c710&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:59,613 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:59,923 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c5831c710&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:25:59,923 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,254 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c5831c710&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,256 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,257 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,257 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,257 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,261 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,261 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,261 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,262 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,264 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,265 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,265 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,266 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,268 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,268 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,268 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,269 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,271 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,271 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,271 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,272 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,272 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11082930390039995 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,365 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:00,923 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:01,697 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:02,510 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,280 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,946 - stpipe.Image3Pipeline.resample - INFO - Resampling variance components
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,949 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,951 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,952 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,952 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,953 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,954 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,954 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,955 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,955 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,956 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,957 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,957 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:03,984 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  80.660247821 -69.452654203 80.735784316 -69.472169218 80.791372770 -69.445623664 80.715879065 -69.426132741
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:04,426 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:04,427 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:04,651 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1069, 1070) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:04,652 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:04,657 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:04,658 - stpipe - INFO - Results used jwst version: 1.16.1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.1097325677365326]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:06,117 - stpipe.SourceCatalogStep - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 4.34%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:06,885 - CRDS - INFO -  Calibration SW Found: jwst 1.16.1 (/opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages/jwst-1.16.1.dist-info)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,092 - CRDS - INFO -  Fetching  mappings/jwst/jwst_system_datalvl_0002.rmap                  694 bytes  (1 / 200 files) (0 / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,155 - CRDS - INFO -  Fetching  mappings/jwst/jwst_system_calver_0044.rmap                 5.0 K bytes  (2 / 200 files) (694 / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,227 - CRDS - INFO -  Fetching  mappings/jwst/jwst_system_0043.imap                          385 bytes  (3 / 200 files) (5.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,289 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_wavelengthrange_0024.rmap       1.4 K bytes  (4 / 200 files) (6.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,363 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_wavecorr_0005.rmap                884 bytes  (5 / 200 files) (7.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,414 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_superbias_0074.rmap            33.8 K bytes  (6 / 200 files) (8.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,504 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_sflat_0026.rmap                20.6 K bytes  (7 / 200 files) (42.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,568 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_saturation_0018.rmap            2.0 K bytes  (8 / 200 files) (62.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,646 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_refpix_0015.rmap                1.6 K bytes  (9 / 200 files) (64.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,714 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_readnoise_0025.rmap             2.6 K bytes  (10 / 200 files) (66.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,780 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_photom_0013.rmap                  958 bytes  (11 / 200 files) (68.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,845 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pathloss_0007.rmap              1.1 K bytes  (12 / 200 files) (69.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,895 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-whitelightstep_0001.rmap      777 bytes  (13 / 200 files) (70.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:07,949 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-spec2pipeline_0013.rmap    2.1 K bytes  (14 / 200 files) (71.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,010 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-resamplespecstep_0002.rmap      709 bytes  (15 / 200 files) (73.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,073 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-outlierdetectionstep_0003.rmap    1.1 K bytes  (16 / 200 files) (74.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,125 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-jumpstep_0005.rmap           810 bytes  (17 / 200 files) (75.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,176 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-image2pipeline_0008.rmap    1.0 K bytes  (18 / 200 files) (76.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,249 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-detector1pipeline_0003.rmap    1.1 K bytes  (19 / 200 files) (77.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,335 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-darkpipeline_0003.rmap       872 bytes  (20 / 200 files) (78.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,400 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-darkcurrentstep_0001.rmap      622 bytes  (21 / 200 files) (79.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,500 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ote_0030.rmap                   1.3 K bytes  (22 / 200 files) (80.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,572 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_msaoper_0014.rmap               1.4 K bytes  (23 / 200 files) (81.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,646 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_msa_0027.rmap                   1.3 K bytes  (24 / 200 files) (82.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,710 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_mask_0039.rmap                  2.7 K bytes  (25 / 200 files) (84.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,820 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_linearity_0017.rmap             1.6 K bytes  (26 / 200 files) (86.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,913 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ipc_0006.rmap                     876 bytes  (27 / 200 files) (88.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:08,989 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ifuslicer_0017.rmap             1.5 K bytes  (28 / 200 files) (89.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,055 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ifupost_0019.rmap               1.5 K bytes  (29 / 200 files) (90.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,153 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ifufore_0017.rmap               1.5 K bytes  (30 / 200 files) (92.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,232 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_gain_0023.rmap                  1.8 K bytes  (31 / 200 files) (93.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,404 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_fpa_0028.rmap                   1.3 K bytes  (32 / 200 files) (95.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,484 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_fore_0026.rmap                  5.0 K bytes  (33 / 200 files) (96.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,573 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_flat_0015.rmap                  3.8 K bytes  (34 / 200 files) (101.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,647 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_fflat_0026.rmap                 7.2 K bytes  (35 / 200 files) (105.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,726 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_extract1d_0018.rmap             2.3 K bytes  (36 / 200 files) (112.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,780 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_disperser_0028.rmap             5.7 K bytes  (37 / 200 files) (115.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,837 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_dflat_0007.rmap                 1.1 K bytes  (38 / 200 files) (120.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,905 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_dark_0069.rmap                 32.6 K bytes  (39 / 200 files) (121.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:09,984 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_cubepar_0015.rmap                 966 bytes  (40 / 200 files) (154.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,042 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_collimator_0026.rmap            1.3 K bytes  (41 / 200 files) (155.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,110 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_camera_0026.rmap                1.3 K bytes  (42 / 200 files) (156.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,163 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_barshadow_0007.rmap             1.8 K bytes  (43 / 200 files) (158.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,219 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_area_0018.rmap                  6.3 K bytes  (44 / 200 files) (159.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,287 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_apcorr_0009.rmap                5.6 K bytes  (45 / 200 files) (166.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,340 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_0383.imap                       5.6 K bytes  (46 / 200 files) (171.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,435 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_wfssbkg_0007.rmap                3.1 K bytes  (47 / 200 files) (177.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,513 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_wavemap_0008.rmap                2.2 K bytes  (48 / 200 files) (180.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,579 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_wavelengthrange_0006.rmap          862 bytes  (49 / 200 files) (182.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,630 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_trappars_0004.rmap                 753 bytes  (50 / 200 files) (183.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,690 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_trapdensity_0005.rmap              705 bytes  (51 / 200 files) (184.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,767 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_throughput_0005.rmap             1.3 K bytes  (52 / 200 files) (184.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,886 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_superbias_0028.rmap              6.5 K bytes  (53 / 200 files) (186.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,941 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_specwcs_0014.rmap                3.1 K bytes  (54 / 200 files) (192.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:10,994 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_spectrace_0008.rmap              2.3 K bytes  (55 / 200 files) (195.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,069 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_specprofile_0008.rmap            2.4 K bytes  (56 / 200 files) (198.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,182 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_speckernel_0006.rmap             1.0 K bytes  (57 / 200 files) (200.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,281 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_saturation_0015.rmap               829 bytes  (58 / 200 files) (201.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,338 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_readnoise_0011.rmap                987 bytes  (59 / 200 files) (202.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,393 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_photom_0035.rmap                 1.3 K bytes  (60 / 200 files) (203.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,468 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_persat_0007.rmap                   674 bytes  (61 / 200 files) (204.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,545 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pathloss_0003.rmap                 758 bytes  (62 / 200 files) (205.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,597 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pastasoss_0004.rmap                818 bytes  (63 / 200 files) (206.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,662 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-undersamplecorrectionstep_0001.rmap      904 bytes  (64 / 200 files) (206.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,721 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-tweakregstep_0012.rmap      3.1 K bytes  (65 / 200 files) (207.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,786 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-spec2pipeline_0008.rmap       984 bytes  (66 / 200 files) (210.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,839 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-sourcecatalogstep_0002.rmap    2.3 K bytes  (67 / 200 files) (211.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,896 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-resamplestep_0002.rmap        687 bytes  (68 / 200 files) (214.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,947 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-outlierdetectionstep_0004.rmap    2.7 K bytes  (69 / 200 files) (214.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:11,998 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-jumpstep_0007.rmap          6.4 K bytes  (70 / 200 files) (217.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,062 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-image2pipeline_0005.rmap    1.0 K bytes  (71 / 200 files) (223.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,122 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-detector1pipeline_0002.rmap    1.0 K bytes  (72 / 200 files) (224.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,183 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-darkpipeline_0002.rmap        868 bytes  (73 / 200 files) (225.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,233 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-darkcurrentstep_0001.rmap      591 bytes  (74 / 200 files) (226.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,285 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-chargemigrationstep_0004.rmap    5.7 K bytes  (75 / 200 files) (227.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,340 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_nrm_0002.rmap                      663 bytes  (76 / 200 files) (233.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,391 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_mask_0020.rmap                     859 bytes  (77 / 200 files) (233.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,443 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_linearity_0022.rmap                961 bytes  (78 / 200 files) (234.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,493 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_ipc_0007.rmap                      651 bytes  (79 / 200 files) (235.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,544 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_gain_0011.rmap                     797 bytes  (80 / 200 files) (236.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,596 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_flat_0023.rmap                   5.9 K bytes  (81 / 200 files) (236.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,648 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_filteroffset_0010.rmap             853 bytes  (82 / 200 files) (242.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,698 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_extract1d_0007.rmap                905 bytes  (83 / 200 files) (243.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,748 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_drizpars_0004.rmap                 519 bytes  (84 / 200 files) (244.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,802 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_distortion_0025.rmap             3.4 K bytes  (85 / 200 files) (245.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,854 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_dark_0031.rmap                   6.8 K bytes  (86 / 200 files) (248.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,906 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_area_0014.rmap                   2.7 K bytes  (87 / 200 files) (255.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:12,956 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_apcorr_0010.rmap                 4.3 K bytes  (88 / 200 files) (258.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,006 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_abvegaoffset_0004.rmap           1.4 K bytes  (89 / 200 files) (262.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,060 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_0261.imap                        5.7 K bytes  (90 / 200 files) (263.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,126 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_wfssbkg_0004.rmap                7.2 K bytes  (91 / 200 files) (269.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,177 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_wavelengthrange_0010.rmap          996 bytes  (92 / 200 files) (276.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,227 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_tsophot_0003.rmap                  896 bytes  (93 / 200 files) (277.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,277 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_trappars_0003.rmap               1.6 K bytes  (94 / 200 files) (278.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,329 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_trapdensity_0003.rmap            1.6 K bytes  (95 / 200 files) (280.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,388 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_superbias_0018.rmap             16.2 K bytes  (96 / 200 files) (281.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,446 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_specwcs_0022.rmap                7.1 K bytes  (97 / 200 files) (297.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,503 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_saturation_0010.rmap             2.2 K bytes  (98 / 200 files) (305.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,554 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_readnoise_0025.rmap             23.2 K bytes  (99 / 200 files) (307.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,616 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_psfmask_0008.rmap               28.4 K bytes  (100 / 200 files) (330.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,681 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_photom_0028.rmap                 3.4 K bytes  (101 / 200 files) (358.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,731 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_persat_0005.rmap                 1.6 K bytes  (102 / 200 files) (362.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,794 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-whitelightstep_0003.rmap    1.5 K bytes  (103 / 200 files) (363.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,845 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-tweakregstep_0003.rmap      4.5 K bytes  (104 / 200 files) (365.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,898 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-spec2pipeline_0008.rmap       984 bytes  (105 / 200 files) (369.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:13,950 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-sourcecatalogstep_0002.rmap    4.6 K bytes  (106 / 200 files) (370.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,005 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-resamplestep_0002.rmap        687 bytes  (107 / 200 files) (375.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,056 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-outlierdetectionstep_0003.rmap      940 bytes  (108 / 200 files) (375.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,105 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-jumpstep_0005.rmap            806 bytes  (109 / 200 files) (376.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,159 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-image2pipeline_0003.rmap    1.0 K bytes  (110 / 200 files) (377.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,209 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-detector1pipeline_0003.rmap    1.0 K bytes  (111 / 200 files) (378.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,260 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-darkpipeline_0002.rmap        868 bytes  (112 / 200 files) (379.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,312 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-darkcurrentstep_0001.rmap      618 bytes  (113 / 200 files) (380.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,363 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_mask_0011.rmap                   3.5 K bytes  (114 / 200 files) (381.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,415 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_linearity_0011.rmap              2.4 K bytes  (115 / 200 files) (384.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,465 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_ipc_0003.rmap                    2.0 K bytes  (116 / 200 files) (387.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,517 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_gain_0016.rmap                   2.1 K bytes  (117 / 200 files) (389.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,580 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_flat_0027.rmap                  51.7 K bytes  (118 / 200 files) (391.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,656 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_filteroffset_0004.rmap           1.4 K bytes  (119 / 200 files) (442.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,706 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_extract1d_0004.rmap                842 bytes  (120 / 200 files) (444.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,756 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_drizpars_0001.rmap                 519 bytes  (121 / 200 files) (445.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,808 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_distortion_0033.rmap            53.4 K bytes  (122 / 200 files) (445.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,882 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_dark_0045.rmap                  26.3 K bytes  (123 / 200 files) (499.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:14,949 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_area_0012.rmap                  33.5 K bytes  (124 / 200 files) (525.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,014 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_apcorr_0008.rmap                 4.3 K bytes  (125 / 200 files) (558.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,065 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_abvegaoffset_0003.rmap           1.3 K bytes  (126 / 200 files) (563.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,115 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_0297.imap                        5.5 K bytes  (127 / 200 files) (564.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,167 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_wavelengthrange_0027.rmap            929 bytes  (128 / 200 files) (569.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,217 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_tsophot_0004.rmap                    882 bytes  (129 / 200 files) (570.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,268 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_straymask_0009.rmap                  987 bytes  (130 / 200 files) (571.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,316 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_specwcs_0042.rmap                  5.8 K bytes  (131 / 200 files) (572.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,366 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_saturation_0015.rmap               1.2 K bytes  (132 / 200 files) (578.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,415 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_rscd_0008.rmap                     1.0 K bytes  (133 / 200 files) (579.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,464 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_resol_0006.rmap                      790 bytes  (134 / 200 files) (580.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,517 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_reset_0026.rmap                    3.9 K bytes  (135 / 200 files) (581.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,569 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_regions_0033.rmap                  5.2 K bytes  (136 / 200 files) (585.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,620 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_readnoise_0023.rmap                1.6 K bytes  (137 / 200 files) (590.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,671 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_psfmask_0009.rmap                  2.1 K bytes  (138 / 200 files) (592.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,722 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_photom_0056.rmap                   3.7 K bytes  (139 / 200 files) (594.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,778 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pathloss_0005.rmap                   866 bytes  (140 / 200 files) (598.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,828 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-whitelightstep_0003.rmap        912 bytes  (141 / 200 files) (598.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,878 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-tweakregstep_0003.rmap        1.8 K bytes  (142 / 200 files) (599.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,929 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-spec3pipeline_0008.rmap         816 bytes  (143 / 200 files) (601.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:15,979 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-spec2pipeline_0012.rmap       1.3 K bytes  (144 / 200 files) (602.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,034 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-sourcecatalogstep_0003.rmap    1.9 K bytes  (145 / 200 files) (603.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,084 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-resamplestep_0002.rmap          677 bytes  (146 / 200 files) (605.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,134 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-resamplespecstep_0002.rmap      706 bytes  (147 / 200 files) (606.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,188 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-outlierdetectionstep_0017.rmap    3.4 K bytes  (148 / 200 files) (607.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,245 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-jumpstep_0009.rmap            1.4 K bytes  (149 / 200 files) (610.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,295 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-image2pipeline_0007.rmap        983 bytes  (150 / 200 files) (611.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,346 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-extract1dstep_0002.rmap         728 bytes  (151 / 200 files) (612.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,395 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-emicorrstep_0002.rmap           796 bytes  (152 / 200 files) (613.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,445 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-detector1pipeline_0009.rmap    1.4 K bytes  (153 / 200 files) (614.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,496 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-darkpipeline_0002.rmap          860 bytes  (154 / 200 files) (615.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,546 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-darkcurrentstep_0002.rmap       683 bytes  (155 / 200 files) (616.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,604 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_mrsxartcorr_0002.rmap              2.2 K bytes  (156 / 200 files) (617.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,657 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_mrsptcorr_0005.rmap                2.0 K bytes  (157 / 200 files) (619.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,707 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_mask_0023.rmap                     3.5 K bytes  (158 / 200 files) (621.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,757 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_linearity_0018.rmap                2.8 K bytes  (159 / 200 files) (624.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,809 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_ipc_0008.rmap                        700 bytes  (160 / 200 files) (627.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,869 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_gain_0013.rmap                     3.9 K bytes  (161 / 200 files) (628.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,922 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_fringefreq_0003.rmap               1.4 K bytes  (162 / 200 files) (632.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:16,972 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_fringe_0019.rmap                   3.9 K bytes  (163 / 200 files) (633.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,021 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_flat_0065.rmap                    15.5 K bytes  (164 / 200 files) (637.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,079 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_filteroffset_0025.rmap             2.5 K bytes  (165 / 200 files) (653.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,130 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_extract1d_0020.rmap                1.4 K bytes  (166 / 200 files) (655.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,182 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_emicorr_0003.rmap                    663 bytes  (167 / 200 files) (657.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,234 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_drizpars_0002.rmap                   511 bytes  (168 / 200 files) (657.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,285 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_distortion_0040.rmap               4.9 K bytes  (169 / 200 files) (658.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,336 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_dark_0036.rmap                     4.4 K bytes  (170 / 200 files) (663.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,387 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_cubepar_0017.rmap                    800 bytes  (171 / 200 files) (667.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,436 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_area_0015.rmap                       866 bytes  (172 / 200 files) (668.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,487 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_apcorr_0019.rmap                   5.0 K bytes  (173 / 200 files) (669.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,540 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_abvegaoffset_0002.rmap             1.3 K bytes  (174 / 200 files) (674.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,590 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_0416.imap                          5.7 K bytes  (175 / 200 files) (675.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,642 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_trappars_0004.rmap                    903 bytes  (176 / 200 files) (681.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,692 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_trapdensity_0006.rmap                 930 bytes  (177 / 200 files) (682.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,743 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_superbias_0017.rmap                 3.8 K bytes  (178 / 200 files) (682.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,793 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_saturation_0009.rmap                  779 bytes  (179 / 200 files) (686.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,846 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_readnoise_0011.rmap                 1.3 K bytes  (180 / 200 files) (687.5 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,895 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_photom_0014.rmap                    1.1 K bytes  (181 / 200 files) (688.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,947 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_persat_0006.rmap                      884 bytes  (182 / 200 files) (689.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:17,998 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-tweakregstep_0002.rmap           850 bytes  (183 / 200 files) (690.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,049 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-sourcecatalogstep_0001.rmap      636 bytes  (184 / 200 files) (691.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,098 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-outlierdetectionstep_0001.rmap      654 bytes  (185 / 200 files) (692.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,148 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-image2pipeline_0005.rmap         974 bytes  (186 / 200 files) (692.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,197 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-detector1pipeline_0002.rmap    1.0 K bytes  (187 / 200 files) (693.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,246 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-darkpipeline_0002.rmap           856 bytes  (188 / 200 files) (694.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,297 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_mask_0023.rmap                      1.1 K bytes  (189 / 200 files) (695.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,347 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_linearity_0015.rmap                   925 bytes  (190 / 200 files) (696.8 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,398 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_ipc_0003.rmap                         614 bytes  (191 / 200 files) (697.7 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,448 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_gain_0010.rmap                        890 bytes  (192 / 200 files) (698.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,502 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_flat_0009.rmap                      1.1 K bytes  (193 / 200 files) (699.2 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,551 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_distortion_0011.rmap                1.2 K bytes  (194 / 200 files) (700.4 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,602 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_dark_0017.rmap                      4.3 K bytes  (195 / 200 files) (701.6 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,653 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_area_0010.rmap                      1.2 K bytes  (196 / 200 files) (705.9 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,704 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_apcorr_0004.rmap                    4.0 K bytes  (197 / 200 files) (707.1 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,754 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_abvegaoffset_0002.rmap              1.3 K bytes  (198 / 200 files) (711.0 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,807 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_0117.imap                           5.0 K bytes  (199 / 200 files) (712.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:18,859 - CRDS - INFO -  Fetching  mappings/jwst/jwst_1303.pmap                                 580 bytes  (200 / 200 files) (717.3 K / 717.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:19,059 - CRDS - INFO -  Fetching  references/jwst/miri/jwst_miri_apcorr_0014.fits           25.9 K bytes  (1 / 1 files) (0 / 25.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:19,125 - stpipe.SourceCatalogStep - INFO - Using APCORR reference file: references/jwst/miri/jwst_miri_apcorr_0014.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:19,134 - CRDS - INFO -  Fetching  references/jwst/miri/jwst_miri_abvegaoffset_0001.asdf      1.7 K bytes  (1 / 1 files) (0 / 1.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:19,188 - stpipe.SourceCatalogStep - INFO - Using ABVEGAOFFSET reference file: references/jwst/miri/jwst_miri_abvegaoffset_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:19,188 - stpipe - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:19,189 - stpipe - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:19,189 - stpipe - INFO - Filter: F560W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:19,190 - stpipe - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       mag        
------------------
19.311847986449415
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 5.19%
</pre></div>
</div>
<img alt="../../../_images/ac0906d6cb18deb923cd208f9d759be2af09d486ff51bbdb4dc354e30f79012d.png" src="../../../_images/ac0906d6cb18deb923cd208f9d759be2af09d486ff51bbdb4dc354e30f79012d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 42.25848327899985
Starting 2.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.69947281, -69.44357619)&gt;
Setting up sim to match ./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits

MAST OPD query around UTC: 2022-04-13T03:08:10.578
                        MJD: 59682.13067798611

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/R2022041201-NRCA3_FP1-2.fits
	Date (MJD):	 59681.7791
	Delta time:	 -0.3516 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022041301-NRCA3_FP1-1.fits
	Date (MJD):	 59682.8401
	Delta time:	 0.7094 days
User requested choosing OPD time closest in time to 2022-04-13T03:08:10.578, which is R2022041201-NRCA3_FP1-2.fits, delta time -0.352 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F560W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(187.37414158), array(502.80262111)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.43616932953458, 201.73577860812014)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(140.42082679), array(465.07722232)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.40301794781075, 201.76236638868846)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(184.2927142), array(501.92870851)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.4341768144819, 201.7376011650385)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(137.45242516), array(464.12546009)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.4006941341772, 201.76403586364324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,213 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,214 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,217 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,218 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,220 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,221 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,223 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,491 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,505 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.2
      sharphi: 1.0
      roundlo: -1.0
      roundhi: 1.0
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: INDEF
      nlow: 0
      nhigh: 0
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      allowed_memory: None
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        S8+wK09fvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      allowed_memory: None
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:40,505 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:41,031 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c66d1b990&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:41,031 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,047 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c66d1b990&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,048 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,290 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c66d1b990&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,291 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,512 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3c66d1b990&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,513 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,513 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,514 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,514 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,516 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,516 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,517 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,518 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,519 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,520 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,520 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,520 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,522 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,523 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,523 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,524 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,525 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,526 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,526 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,526 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,527 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11082930390039995 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:42,613 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:43,140 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:43,943 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:44,707 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:45,494 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,147 - stpipe.Image3Pipeline.resample - INFO - Resampling variance components
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,149 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,150 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,151 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,151 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,152 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,153 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,153 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,154 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,155 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,155 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,156 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,156 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,176 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  80.660247821 -69.452654203 80.735784316 -69.472169218 80.791372770 -69.445623664 80.715879065 -69.426132741
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,614 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,614 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,838 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1069, 1070) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,839 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,843 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:46,843 - stpipe - INFO - Results used jwst version: 1.16.1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.99883175423715]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:48,594 - stpipe.SourceCatalogStep - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 16.21%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:48,901 - stpipe.SourceCatalogStep - INFO - Using APCORR reference file: references/jwst/miri/jwst_miri_apcorr_0014.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:48,910 - stpipe.SourceCatalogStep - INFO - Using ABVEGAOFFSET reference file: references/jwst/miri/jwst_miri_abvegaoffset_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:48,911 - stpipe - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:48,911 - stpipe - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:48,911 - stpipe - INFO - Filter: F560W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-10 20:26:48,912 - stpipe - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       mag        
------------------
18.768115389182704
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 16.23%
</pre></div>
</div>
<img alt="../../../_images/cb6d554d4e4acc52e1566f9dc53219bf7ba3b128866f1fb2c0b273a93aecdecc.png" src="../../../_images/cb6d554d4e4acc52e1566f9dc53219bf7ba3b128866f1fb2c0b273a93aecdecc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 29.722019793999834
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lvl2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00003_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00002_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00001_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<p><strong>Important Note</strong>: When not to use. Due to the sensitivity of the space_phot parameters, this tool is not meant to be used for a large sample of stars (i.e., Section 5 below). If a user would like to use space_phot on more than one source, they should carefully construct a table of parameters that are carefully refined for each source.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ra</th>
      <th>dec</th>
      <th>mag</th>
      <th>magerr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80.705198</td>
      <td>-69.437526</td>
      <td>19.515115</td>
      <td>0.00304</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80.699469</td>
      <td>-69.443574</td>
      <td>19.133434</td>
      <td>0.00251</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr style="border:1px solid gray"> </hr><a class="reference internal image-reference" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/MIRI/psf_photometry"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-introduction-a-class-anchor-id-intro-a">1.<font color="white">-</font>Introduction <a class="anchor" id="intro"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a">1.1<font color="white">-</font>Setup WebbPSF and Synphot Directories<a class="anchor" id="webbpsf"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-python-imports-a-class-anchor-id-py-imports-a">1.2<font color="white">-</font>Python Imports<a class="anchor" id="py_imports"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-download-data-a-class-anchor-id-data-a">2.<font color="white">-</font>Download Data<a class="anchor" id="data"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-bright-single-object-a-class-anchor-id-bso-a">3.<font color="white">-</font>Bright, Single Object<a class="anchor" id="bso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a">3.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="bso2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-the-psf-fitting-in-space-phot-br">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a">3.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="bso3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#good-agreement-between-level2-and-level3-results">Good agreement between Level2 and level3 results!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a">4.<font color="white">-</font>Faint/Upper Limit, Single Object<a class="anchor" id="fso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a">4.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="fso2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a">4.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="fso3"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-you-can-go-significantly-deeper-with-the-level3-combined-data-product">Note you can go significantly deeper with the Level3 combined data product</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a">5.<font color="white">-</font>Stellar Field (LMC)<a class="anchor" id="lmc"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired">In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using space_phot on a large number of stars. We suggest that space_phot may be less optimal for large numbers of bright stars. Other programs, such as DOLPHOT or Photutils, may be better suited for this use case. The primary advantage to space_phot is on faint, single sources. But it can be extended to a larger number if desired.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a">5.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="lmc2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed">Now do the same thing for a larger group of stars and test for speed</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a">5.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="lmc3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars">Readers should refer to all diagnostics discussed above. In general, this loop shows the difficulty in doing PSF photometry on a wide variety of stars (brightness, distribution on the detector, etc) without visual inspection. Especially when dealing with low SNR sources.This is true for all photometry packages. Users should inspect the associated metrics and consider optimizing the parameters for specific stars of interest. Nonetheless, the success of the fits can always be quantified in with the associated error bars.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>