

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>MIRI PSF Photometry With Space_Phot &#8212; STScI JDAT Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D46G4HKJY3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D46G4HKJY3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/MIRI/psf_photometry/miri_spacephot';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="STScI JDAT Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="STScI JDAT Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">General</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebook_development_workflow.html">Notebook Development Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/submitting_notebooks.html">Submitting Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/requirements.html">Requirements file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/data_files.html">Data Files</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GitHub Guidelines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_setup.html">GitHub Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_workflow.html">GitHub Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_pr.html">GitHub PR</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cross-Instrument</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/asdf_example/asdf_example.html">ASDF Example</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/background_estimation_imaging/Imaging_Sky_Background_Estimation.html">Complex 2D Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/composite_model_fitting/specfit_demo_3.html">Composite Model Spectral Fitting</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/NIRSpec_MAST_Query/NIRSpec_MAST_Query.html">MAST Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/rgb_imviz/imviz_rgb_carina.html">RGB images with Imviz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/specviz_notebookGUI_interaction/specviz_notebook_gui_interaction_redshift.html">Specviz Simple Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/update_pure_parallel_wcs/NIRISS_correct_pure_parallel_WCS.html">Improving Accuracy of WCS of Pure Parallel Dataset</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MIRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html">MRS Mstar - Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI_IFU_YSOs_in_the_LMC/isha_nayak_ysos_in_the_lmc.html">IFU of YSOs in LMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI_LRS_spectral_extraction/miri_lrs_advanced_extraction_part1.html">LRS Optimal Spectral Extraction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRCam</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/aperture_photometry/NIRCam_Aperture_Photometry_Example.html">Point Source Aperture Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_photometry/NIRCam_multiband_photometry.html">Extended Aperture Photometry</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html">Cross-Filter PSF Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/psf_photometry/NIRCam_PSF_Photometry_Example.html">PSF Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_wisp_subtraction/nircam_wisp_subtraction.html">NIRCam Wisp Removal</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRISS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/00_Optimal_extraction.html">WFSS Spectra - Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/01_Combine_and_normalize_1D_spectra.html">WFSS Spectra - Combine and Normalize 1D Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/02_Cross_correlation_template.html">WFSS Spectra - Cross-Correlation Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/03_Spatially_resolved_emission_line_map.html">WFSS Spectra - Emission Line Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/niriss_imaging/niriss-imaging-tutorial.html">NIRISS Imaging Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/00_niriss_mast_query_data_setup.html">NIRISS MAST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/01_niriss_wfss_image2_image3.html">Direct imaging for WFSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/02_niriss_wfss_spec2.html">Spec2 pipeline for WFSS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRSpec</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/IFU_cube_continuum_fit/NGC4151_FeII_ContinuumFit.html">IFU Cube Fitting</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/cube_fitting/cube_fitting.html">IFU Cube Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/ifu_optimal/ifu_optimal.html">IFU Optimal Spectral Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/optimal_extraction/Spectral_Extraction-static.html">MOS Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/mos_spectroscopy_advanced/MOSspec_advanced.html">MOS Spectroscopy of Extragalactic Field</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/transit_spectroscopy_notebook/Exoplanet_Transmission_Spectra_JWST.html">BOTS Time Series Observations</a></li>








<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/galaxy_redshift/redshift_fitting.html">Redshift and Template Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/FS_NSClean_example.html">FS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/IFU_NSClean_example.html">IFU Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/MOS_NSClean_example.html">MOS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/BOTS_NSClean_example.html">BOTS Products with NSClean</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/MIRI/psf_photometry/miri_spacephot.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/MIRI/psf_photometry/miri_spacephot.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MIRI PSF Photometry With Space_Phot</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-introduction-a-class-anchor-id-intro-a">1.<font color="white">-</font>Introduction <a class="anchor" id="intro"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a">1.1<font color="white">-</font>Setup WebbPSF and Synphot Directories<a class="anchor" id="webbpsf"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-python-imports-a-class-anchor-id-py-imports-a">1.2<font color="white">-</font>Python Imports<a class="anchor" id="py_imports"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-download-data-a-class-anchor-id-data-a">2.<font color="white">-</font>Download Data<a class="anchor" id="data"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-bright-single-object-a-class-anchor-id-bso-a">3.<font color="white">-</font>Bright, Single Object<a class="anchor" id="bso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a">3.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="bso2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-the-psf-fitting-in-space-phot-br">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a">3.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="bso3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#good-agreement-between-level2-and-level3-results">Good agreement between Level2 and level3 results!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a">4.<font color="white">-</font>Faint/Upper Limit, Single Object<a class="anchor" id="fso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a">4.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="fso2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a">4.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="fso3"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-you-can-go-significantly-deeper-with-the-level3-combined-data-product">Note you can go significantly deeper with the Level3 combined data product</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a">5.<font color="white">-</font>Stellar Field (LMC)<a class="anchor" id="lmc"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired">In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using space_phot on a large number of stars. We suggest that space_phot may be less optimal for large numbers of bright stars. Other programs, such as DOLPHOT or Photutils, may be better suited for this use case. The primary advantage to space_phot is on faint, single sources. But it can be extended to a larger number if desired.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a">5.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="lmc2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed">Now do the same thing for a larger group of stars and test for speed</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a">5.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="lmc3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars">Readers should refer to all diagnostics discussed above. In general, this loop shows the difficulty in doing PSF photometry on a wide variety of stars (brightness, distribution on the detector, etc) without visual inspection. Especially when dealing with low SNR sources.This is true for all photometry packages. Users should inspect the associated metrics and consider optimizing the parameters for specific stars of interest. Nonetheless, the success of the fits can always be quantified in with the associated error bars.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="miri-psf-photometry-with-space-phot">
<h1>MIRI PSF Photometry With Space_Phot<a class="headerlink" href="#miri-psf-photometry-with-space-phot" title="Permalink to this heading">#</a></h1>
<p><strong>Author</strong>: Ori Fox<br></p>
<p><strong>Submitted</strong>: August, 2023<br>
<strong>Updated</strong>: November, 2023<br></p>
<p><strong>Use case</strong>: PSF Photometry on Level3 data using dedicated package Space_Phot (https://github.com/jpierel14/space_phot). Space_phot is built on Astropy’s Photutils package. Unlike photutils, space_phot can be used on Level3 data. This is because has built in functionality that can generate a resampled Level3 PSF at a given detector position. Such use cases are particularly useful for faint, point source targets or deep upper limits where observers need to take advantage of the combined image stack. For a large number of bright sources, users may find space_phot to be too slow and should consider other packages, such as DOLPHOT and/or Photutils. <strong>NOTE:</strong> A companion notebook exists that illustrates how to use Photutils for the same Level2 data set.<br>
<strong>Important Note</strong>: When not to use. Due to the sensitivity of the space_phot parameters, this tool is not meant to be used for a large sample of stars (i.e., Section 5 below). If a user would like to use space_phot on more than one source, they should carefully construct a table of parameters that are carefully refined for each source.
<strong>Data</strong>: MIRI Data PID 1028 (Calibration Program; Single Star Visit 006 A5V dwarf 2MASSJ17430448+6655015) and MIRI Data PID 1171 (LMC; Multiple Stars).<br>
<strong>Tools</strong>: photutils, space_phot drizzlepac, jupyter <br>
<strong>Cross-Instrument</strong>: NIRCam, MIRI.<br>
<strong>Documentation</strong>: This notebook is part of a STScI’s larger post-pipeline Data Analysis Tools Ecosystem and can be downloaded directly from the JDAT Notebook Github directory.<br>
<strong>Pipeline Version</strong>: JWST Pipeline<br></p>
<section id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><span class="xref myst">Introduction</span><br>
1.1 <span class="xref myst">Setup</span><br>
1.2 <span class="xref myst">Python imports</span><br></p></li>
<li><p><span class="xref myst">Download Data</span><br></p></li>
<li><p><span class="xref myst">Bright, Single Object</span><br>
3.1 <span class="xref myst">Multiple, Level2 Files</span><br>
3.2 <span class="xref myst">Single, Level3 Mosaicked File</span><br></p></li>
<li><p><span class="xref myst">Faint/Upper Limit, Single Object</span><br>
4.1 <span class="xref myst">Multiple, Level2 Files</span><br>
4.2 <span class="xref myst">Single, Level3 Mosaicked File</span><br></p></li>
<li><p><span class="xref myst">Stellar Field (LMC)</span><br>
5.1 <span class="xref myst">Multiple, Level2 Files</span><br>
5.2 <span class="xref myst">Single, Level3 Mosaicked File</span><br></p></li>
</ol>
</section>
<section id="font-color-white-font-introduction-a-class-anchor-id-intro-a">
<h2>1.<font color='white'>-</font>Introduction <a class="anchor" id="intro"></a><a class="headerlink" href="#font-color-white-font-introduction-a-class-anchor-id-intro-a" title="Permalink to this heading">#</a></h2>
<p>GOALS:<br></p>
<p>PSF Photometry can be obtained using:<br></p>
<ul class="simple">
<li><p>grid of PSF models from WebbPSF<br></p></li>
<li><p>single effective PSF (ePSF) NOT YET AVAILABLE<br></p></li>
<li><p>grid of effective PSF NOT YET AVAILABLE<br></p></li>
</ul>
<p>The notebook shows:<br></p>
<ul class="simple">
<li><p>how to obtain the PSF model from WebbPSF (or build an ePSF)<br></p></li>
<li><p>how to perform PSF photometry on the image<br></p></li>
</ul>
<p><strong>Data</strong>:<br></p>
<p>MIRI Data PID 1028 (Calibration Program), F770W <br>
MIRI Data PID 1171 (LMC), F560W/F770W</p>
<section id="font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a">
<h3>1.1<font color='white'>-</font>Setup WebbPSF and Synphot Directories<a class="anchor" id="webbpsf"></a><a class="headerlink" href="#font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">space_phot</span>
<span class="kn">from</span> <span class="nn">importlib.metadata</span> <span class="kn">import</span> <span class="n">version</span>
<span class="n">version</span><span class="p">(</span><span class="s1">&#39;space_phot&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following task in the stsci.skypac package can be run with TEAL:
                                    skymatch                                    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following tasks in the drizzlepac package can be run with TEAL:
    astrodrizzle       config_testbed      imagefindpars           mapreg       
       photeq            pixreplace           pixtopix            pixtosky      
  refimagefindpars       resetbits          runastrodriz          skytopix      
     tweakback            tweakreg           updatenpol
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0.2.5&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>

<span class="c1"># Set environmental variables</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;WEBBPSF_PATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./webbpsf-data/webbpsf-data&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PYSYN_CDBS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./grp/redcat/trds/&quot;</span>

<span class="c1"># WEBBPSF Data</span>
<span class="n">boxlink</span> <span class="o">=</span> <span class="s1">&#39;https://stsci.box.com/shared/static/qxpiaxsjwo15ml6m4pkhtk36c9jgj70k.gz&#39;</span>                                                           
<span class="n">boxfile</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data/webbpsf-data-1.0.0.tar.gz&#39;</span>
<span class="n">synphot_url</span> <span class="o">=</span> <span class="s1">&#39;http://ssb.stsci.edu/trds/tarfiles/synphot5.tar.gz&#39;</span>
<span class="n">synphot_file</span> <span class="o">=</span> <span class="s1">&#39;./synphot5.tar.gz&#39;</span>

<span class="n">webbpsf_folder</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data&#39;</span>
<span class="n">synphot_folder</span> <span class="o">=</span> <span class="s1">&#39;./grp&#39;</span>


<span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s2">&quot;https&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported URL scheme: </span><span class="si">{</span><span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dest_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>


<span class="c1"># Gather webbpsf files</span>
<span class="n">psfExist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">psfExist</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
    <span class="n">download_file</span><span class="p">(</span><span class="n">boxlink</span><span class="p">,</span> <span class="n">boxfile</span><span class="p">)</span>
    <span class="n">gzf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">boxfile</span><span class="p">)</span>
    <span class="n">gzf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>

<span class="c1"># Gather synphot files</span>
<span class="n">synExist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">synphot_folder</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">synExist</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">synphot_folder</span><span class="p">)</span>
    <span class="n">download_file</span><span class="p">(</span><span class="n">synphot_url</span><span class="p">,</span> <span class="n">synphot_file</span><span class="p">)</span>
    <span class="n">gzf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">synphot_file</span><span class="p">)</span>
    <span class="n">gzf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-white-font-python-imports-a-class-anchor-id-py-imports-a">
<h3>1.2<font color='white'>-</font>Python Imports<a class="anchor" id="py_imports"></a><a class="headerlink" href="#font-color-white-font-python-imports-a-class-anchor-id-py-imports-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">QTable</span>
<span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="kn">import</span> <span class="n">extract_array</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">wcs</span>
<span class="kn">from</span> <span class="nn">astropy.wcs.utils</span> <span class="kn">import</span> <span class="n">skycoord_to_pixel</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">simple_norm</span>
<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span> <span class="nn">importlib.metadata</span> <span class="kn">import</span> <span class="n">version</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># JWST models</span>
<span class="kn">from</span> <span class="nn">jwst.datamodels</span> <span class="kn">import</span> <span class="n">ImageModel</span>

<span class="c1"># Background and PSF Functions</span>
<span class="kn">from</span> <span class="nn">photutils.background</span> <span class="kn">import</span> <span class="n">MMMBackground</span><span class="p">,</span> <span class="n">MADStdBackgroundRMS</span><span class="p">,</span> <span class="n">LocalBackground</span>

<span class="c1"># Photutils library and tools</span>
<span class="kn">from</span> <span class="nn">photutils.aperture</span> <span class="kn">import</span> <span class="n">CircularAperture</span>
<span class="kn">from</span> <span class="nn">photutils.detection</span> <span class="kn">import</span> <span class="n">DAOStarFinder</span>

<span class="c1"># set up crds if necessary</span>
<span class="kn">from</span> <span class="nn">crds</span> <span class="kn">import</span> <span class="n">client</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CRDS_PATH&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set_crds_server</span><span class="p">(</span><span class="s1">&#39;https://jwst-crds.stsci.edu&#39;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CRDS_SERVER_URL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://jwst-crds.stsci.edu&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CRDS_PATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="font-color-white-font-download-data-a-class-anchor-id-data-a">
<h2>2.<font color='white'>-</font>Download Data<a class="anchor" id="data"></a><a class="headerlink" href="#font-color-white-font-download-data-a-class-anchor-id-data-a" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query the MAST (Mikulski Archive for Space Telescopes) database for observations</span>
<span class="c1"># with proposal ID 1028 and a specific filter &#39;F770W&#39;</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">proposal_id</span><span class="o">=</span><span class="mi">1028</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F770W&#39;</span><span class="p">])</span>

<span class="c1"># Get a list of products associated with the located observation</span>
<span class="n">plist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="c1"># Filter the product list to include only specific product subgroups: &#39;RATE&#39;, &#39;CAL&#39;, &#39;I2D&#39;, and &#39;ASN&#39;</span>
<span class="n">fplist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CAL&#39;</span><span class="p">,</span> <span class="s1">&#39;I2D&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">])</span>

<span class="c1"># Download the selected products from the MAST database (UNCOMMENT TO DOWNLOAD)</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">fplist</span><span class="p">)</span>

<span class="c1"># Define source and destination directories</span>
<span class="n">source_dir</span> <span class="o">=</span> <span class="s1">&#39;mastDownload/JWST/&#39;</span>
<span class="n">destination_dir</span> <span class="o">=</span> <span class="s1">&#39;mast/01028/&#39;</span>

<span class="c1"># Create the destination directory if it doesn&#39;t exist</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>

<span class="c1"># Use glob to find all files matching the pattern &#39;mastDownload/JWST/j*/jw01537*cal.fits&#39;</span>
<span class="n">files_to_copy</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span> <span class="s1">&#39;j*/jw01028*&#39;</span><span class="p">))</span>

<span class="c1"># Copy the matching files to the destination directory</span>
<span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">files_to_copy</span><span class="p">:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00013_asn.json to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028-o006_20241028t203024_image2_00013_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00014_asn.json to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028-o006_20241028t203024_image2_00014_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00015_asn.json to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028-o006_20241028t203024_image2_00015_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00016_asn.json to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028-o006_20241028t203024_image2_00016_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image3_00004_asn.json to ./mastDownload/JWST/jw01028-o006_t001_miri_f770w/jw01028-o006_20241028t203024_image3_00004_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01028-o006_t001_miri_f770w/jw01028-o006_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028006001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028006001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028006001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028006001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028006001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028006001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028006001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028006001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query the MAST (Mikulski Archive for Space Telescopes) database for observations</span>
<span class="c1"># with proposal ID 1171 and a specific filters &#39;F550W&#39; and &#39;F770W&#39;</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">proposal_id</span><span class="o">=</span><span class="mi">1171</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F560W&#39;</span><span class="p">,</span> <span class="s1">&#39;F770W&#39;</span><span class="p">])</span>

<span class="c1"># Get a list of products associated with the located observation</span>
<span class="n">plist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="c1"># Filter the product list to include only specific product subgroups: &#39;RATE&#39;, &#39;CAL&#39;, &#39;I2D&#39;, and &#39;ASN&#39;</span>
<span class="n">fplist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CAL&#39;</span><span class="p">,</span> <span class="s1">&#39;I2D&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">])</span>

<span class="c1"># Download the selected products from the MAST database (UNCOMMENT TO DOWNLOAD)</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">fplist</span><span class="p">)</span>

<span class="c1"># Define source and destination directories</span>
<span class="n">source_dir</span> <span class="o">=</span> <span class="s1">&#39;mastDownload/JWST/&#39;</span>
<span class="n">destination_dir</span> <span class="o">=</span> <span class="s1">&#39;mast/01171/&#39;</span>

<span class="c1"># Create the destination directory if it doesn&#39;t exist</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>

<span class="c1"># Use glob to find all files matching the pattern &#39;mastDownload/JWST/j*/jw01537*cal.fits&#39;</span>
<span class="n">files_to_copy</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span> <span class="s1">&#39;j*/jw01171*&#39;</span><span class="p">))</span>

<span class="c1"># Copy the matching files to the destination directory</span>
<span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">files_to_copy</span><span class="p">:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171-o001_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171-o001_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171-o001_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171-o001_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o001_t001_miri_f770w/jw01171-o001_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o001_t001_miri_f770w/jw01171-o001_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171-o002_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171-o002_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171-o002_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171-o002_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o002_t001_miri_f770w/jw01171-o002_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o002_t001_miri_f770w/jw01171-o002_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171-o003_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171-o003_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171-o003_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171-o003_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o003_t001_miri_f770w/jw01171-o003_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o003_t001_miri_f770w/jw01171-o003_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171-o004_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171-o004_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171-o004_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171-o004_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o004_t001_miri_f560w/jw01171-o004_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_t001_miri_f560w_i2d.fits to ./mastDownload/JWST/jw01171-o004_t001_miri_f560w/jw01171-o004_t001_miri_f560w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171-o005_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171-o005_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171-o005_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171-o005_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o005_t001_miri_f770w/jw01171-o005_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o005_t001_miri_f770w/jw01171-o005_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171001001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171001001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171001001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171001001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171001001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171001001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171001001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171001001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171002001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171002001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171002001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171002001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171002001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171002001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171002001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171002001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171003001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171003001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171003001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171003001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171003001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171003001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171003001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171003001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171004001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171004001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171004001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171004001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171004001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171004001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171004001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171004001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171005001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171005001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171005001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171005001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171005001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171005001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171005001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171005001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-white-font-bright-single-object-a-class-anchor-id-bso-a">
<h2>3.<font color='white'>-</font>Bright, Single Object<a class="anchor" id="bso"></a><a class="headerlink" href="#font-color-white-font-bright-single-object-a-class-anchor-id-bso-a" title="Permalink to this heading">#</a></h2>
<p>The purpose of this section is to illustrate how to perform PSF photometry on a single, bright object. While aperture photometry is feasible in isolated cases, the user may find PSF photometry preferable in crowded fields or complicated backgrounds.</p>
<section id="font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a">
<h3>3.1<font color='white'>-</font>Multiple, Level2 Files<a class="anchor" id="bso2"></a><a class="headerlink" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a" title="Permalink to this heading">#</a></h3>
<p>Generally, PSF photometry for data from a space telescope is most accurately performed on pre-mosaiced data. In the case of HST, that corresponds to FLT files rather than DRZ. And in the case of JWST, this corresponds to Level2 files rather than Level3. The reason is that a mosaiced PSF changes the inherent PSF as a function of position on the detector so that there is no adequate model (theoretical or empirical) to use.<br></p>
<p>In this example, we aim to fit a source simultaneously across multiple Level 2 images. A more basic approach would be to fit each Level 2 file individually and then average together the measured fluxes. However, this approach more easily corrects for bad pixels or cosmic rays that are only in one image and allows for a more accurate photometric solution by reducing the number of free parameters per source.<br></p>
<p>Useful references:<br>
HST Documentation on PSF Photometry: https://www.stsci.edu/hst/instrumentation/wfc3/data-analysis/psf<br>
WFPC2 Stellar Photometry with HSTPHOT: https://ui.adsabs.harvard.edu/abs/2000PASP..112.1383D/abstract<br>
Space-Phot Documentation on Level2 Fitting: https://space-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define Level 3 File</span>
<span class="n">lvl3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;./mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;</span><span class="p">]</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Level 2 Data List from ASN files</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;./mast/01028/&quot;</span>
<span class="n">asn</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="s1">&#39;jw01028-o006_*_image3_00004_asn.json&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">lvl2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fi</span><span class="p">:</span>
        <span class="c1">#print(ln)</span>
        <span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;                    &quot;expname&quot;:&#39;</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="n">lvl2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00002_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00003_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00004_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (Before DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/37f85f68248f05d5646b5628c480e956d580e73c3b9ac383722a3f7827f36a28.png" src="../../../_images/37f85f68248f05d5646b5628c480e956d580e73c3b9ac383722a3f7827f36a28.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (Before DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/98490f6b27b457c7b03ee94098147dde13ef3949a909718c62b339d0202dd5e8.png" src="../../../_images/98490f6b27b457c7b03ee94098147dde13ef3949a909718c62b339d0202dd5e8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>

<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">dq</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>

<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;update&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="s1">&#39;DQ&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">hdul</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">hdul</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (After DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/ca4c2949ad2f6f5195b5fac6cfdbd7919a1f1d4b0f732baea95c18995f4c1d91.png" src="../../../_images/ca4c2949ad2f6f5195b5fac6cfdbd7919a1f1d4b0f732baea95c18995f4c1d91.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zoom in to see the source. In this case, our source is from MIRI Program ID #1028, a Calibration Program.</span>
<span class="c1"># We are using Visit 006, which targets the A5V dwarf 2MASSJ17430448+6655015</span>
<span class="c1"># Reference Link: http://simbad.cds.unistra.fr/simbad/sim-basic?Ident=2MASSJ17430448%2B6655015&amp;submit=SIMBAD+search</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.3</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/bcfefc2c062e41a7a5c41cfddd292f03d340b7eb75ab4e3fcde21794182b6569.png" src="../../../_images/bcfefc2c062e41a7a5c41cfddd292f03d340b7eb75ab4e3fcde21794182b6569.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (After DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/584629bc6f9be171fd731ad922df39d1fa21758d2e4166c2f3ff96288a300229.png" src="../../../_images/584629bc6f9be171fd731ad922df39d1fa21758d2e4166c2f3ff96288a300229.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zoom in to see the source</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">ref_fits</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ref_fits</span><span class="p">))</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/999aa3771161bd6186e3241849a069bc93439ef03e91e597d05ef62c58257a99.png" src="../../../_images/999aa3771161bd6186e3241849a069bc93439ef03e91e597d05ef62c58257a99.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the PSF from WebbPSF using defaults.</span>
<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">psfs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/O2022052501-NRCA3_FP1-59.fits to ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.58446788), array(691.01192923)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51240355224516, 121.46005973914637)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.0823346), array(703.49975178)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51086191643049, 121.4622239877099)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(507.07857065), array(701.00356235)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51028045414718, 121.46207330662133)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(502.58093657), array(694.50845109)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51039393601155, 121.46118840344465)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="mi">122</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/29fcbff78469318d6c73539fbf0ee3007db3fcb92eb35673cc0ce196876090eb.png" src="../../../_images/29fcbff78469318d6c73539fbf0ee3007db3fcb92eb35673cc0ce196876090eb.png" />
</div>
</div>
<section id="notes-on-the-psf-fitting-in-space-phot-br">
<h4>Notes on the PSF Fitting in Space_Phot: <br><a class="headerlink" href="#notes-on-the-psf-fitting-in-space-phot-br" title="Permalink to this heading">#</a></h4>
<p>https://st-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images
As noted above, improved documentation will be coming. For now, here are some important points to consider.</p>
<p>All fitting is performed with Astropy’s Photutils. As with any photometry program, the printed statistical errors are good indicators of your success.</p>
<p>There are different fitting techniques, but when the fit_flux parameter is set to ‘single’, the source is fit simultaneously in all Level2 images. There is good reason for this outlined in a paper for PSF fitting in Hubble: https://iopscience.iop.org/article/10.1086/316630/pdf</p>
<p>As a result, the flux and corresponding error take into account a single overall fit. As part of this, the fitting therefore assumes a constant zero point across all images. While this is not exactly true, it is typically true to within 1% and good enough for our purposes. Users can alternatively fit with the fit_flux parameter set to ‘multi’, which treats each image independently. The final flux must therefore be averaged.</p>
<p>When you run space_phot, you will see some additional diagnositics displayed in the cell. At the top, the % value printed is the fraction of flux remaining in the residual and can be considered a good indicator of a successful model and subtraction. Next are three columns displaying the original, the model, and the residual, respectively, for each Level2 image. Finally, there are corner plots suggesting the success of the fits (more documentation and explanation of these plots is coming).</p>
<p>In this case, you will notice a systematic trend in the residuals. The PSF is oversubtracted in the centermost pixel and undersubtracted in the wings. The cause is unknown. It may be due to a poor PSF model. The user should consider generating more complex PSF models, but that is beyond the scope of this notebook. Nonetheless, the residual value is pretty good so the overall statistical error is relatively small.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do PSF Photometry using space_phot (details of fitting are in documentation)</span>
<span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psfs</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">],</span>
        <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;pixel&#39;</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span>
<span class="p">)</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.51%
</pre></div>
</div>
<img alt="../../../_images/6ddc71ccc6e27510115576f13441d925df549b3bee4efc65ed8183184c4ba480.png" src="../../../_images/6ddc71ccc6e27510115576f13441d925df549b3bee4efc65ed8183184c4ba480.png" />
<img alt="../../../_images/e4b6e98c2515aa97a5ca21bea6c960b70552de97828798db5ed03cf57e85772f.png" src="../../../_images/e4b6e98c2515aa97a5ca21bea6c960b70552de97828798db5ed03cf57e85772f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        ra         ...                     exp                    
------------------ ... -------------------------------------------
265.76869915020865 ... jw01028006001_02101_00001_mirimage_cal.fits
  265.768699955589 ... jw01028006001_02101_00002_mirimage_cal.fits
 265.7686990328735 ... jw01028006001_02101_00003_mirimage_cal.fits
265.76869931365496 ... jw01028006001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=4</i>
<table id="table139901703060048" class="table-striped table-bordered table-condensed">
<thead><tr><th>ra</th><th>ra_err</th><th>dec</th><th>dec_err</th><th>x</th><th>x_err</th><th>y</th><th>y_err</th><th>mjd</th><th>flux</th><th>fluxerr</th><th>filter</th><th>zp</th><th>mag</th><th>magerr</th><th>zpsys</th><th>exp</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str5</th><th>float64</th><th>float64</th><th>float64</th><th>str2</th><th>str43</th></tr></thead>
<tr><td>265.76869915020865</td><td>3.060364406337612e-08</td><td>66.91716543017748</td><td>3.976659002091765e-08</td><td>512.9192489538221</td><td>0.0009726959443567043</td><td>691.1788943162932</td><td>0.0009411183775082806</td><td>59724.05148232454</td><td>4.537242826095776e-10</td><td>3.02094516345668e-13</td><td>F770W</td><td>-6.100000000000005</td><td>17.25801994338695</td><td>0.0007226543153593987</td><td>ab</td><td>jw01028006001_02101_00001_mirimage_cal.fits</td></tr>
<tr><td>265.768699955589</td><td>2.773589358184836e-08</td><td>66.91716487282123</td><td>4.339959502885904e-08</td><td>512.4286431162802</td><td>0.0010941555607137281</td><td>703.6842445947473</td><td>0.0009629796038598898</td><td>59724.05578601667</td><td>4.5372428198730545e-10</td><td>3.020945159313525e-13</td><td>F770W</td><td>-6.100000000000001</td><td>17.258019944876015</td><td>0.0007226543153593987</td><td>ab</td><td>jw01028006001_02101_00002_mirimage_cal.fits</td></tr>
<tr><td>265.7686990328735</td><td>3.0627802516391966e-08</td><td>66.91716518113053</td><td>4.295237943097163e-08</td><td>507.4212418833895</td><td>0.0010646537369178915</td><td>701.172945796866</td><td>0.000989006985944907</td><td>59724.06012231296</td><td>4.537242820688769e-10</td><td>3.0209451598566363e-13</td><td>F770W</td><td>-6.099999999999998</td><td>17.25801994468082</td><td>0.0007226543153593987</td><td>ab</td><td>jw01028006001_02101_00003_mirimage_cal.fits</td></tr>
<tr><td>265.76869931365496</td><td>3.664575842776685e-08</td><td>66.91716489626567</td><td>4.025984878808231e-08</td><td>502.9301991902294</td><td>0.0009524119927528607</td><td>694.6852255366507</td><td>0.0010169560085232627</td><td>59724.064394164816</td><td>4.537242823428017e-10</td><td>3.020945161680457e-13</td><td>F770W</td><td>-6.100000000000001</td><td>17.258019944025335</td><td>0.0007226543153593987</td><td>ab</td><td>jw01028006001_02101_00004_mirimage_cal.fits</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As noted above, As a result, the flux and corresponding error take into account a single overall fit. </span>
<span class="c1"># Therefore, there is no need to average the resulting magnitudes or errors. They should all be the same to within their individual zero-point differences (typically &lt;1%).</span>
<span class="n">mag_lvl2_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span>
<span class="n">magerr_lvl2_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">]</span>

<span class="c1"># Print Magnitude from Table</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mag_lvl2_arr</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">magerr_lvl2_arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       mag        
------------------
 17.25801994338695
17.258019944876015
 17.25801994468082
17.258019944025335 

         magerr       
---------------------
0.0007226543153593987
0.0007226543153593987
0.0007226543153593987
0.0007226543153593987
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jwst_obs_fast</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centers</span> <span class="o">=</span> <span class="p">[</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">]</span>
<span class="n">jwst_obs_fast</span><span class="o">.</span><span class="n">fast_psf</span><span class="p">(</span><span class="n">psfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=1</i>
<table id="table139899722563216" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>group_id</th><th>local_bkg</th><th>x_init</th><th>y_init</th><th>flux_init</th><th>x_fit</th><th>y_fit</th><th>flux_fit</th><th>x_err</th><th>y_err</th><th>flux_err</th><th>npixfit</th><th>group_size</th><th>qfit</th><th>cfit</th><th>flags</th><th>flux</th><th>fluxerr</th><th>mag</th><th>magerr</th><th>zp</th></tr></thead>
<thead><tr><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1</td><td>1</td><td>0.0</td><td>691.0119292269616</td><td>512.5844678797273</td><td>1668.262907461838</td><td>691.1736423963373</td><td>512.9081319598845</td><td>1861.7546481804875</td><td>0.0008250237966256739</td><td>0.0008332862486822068</td><td>1.7352060017477255</td><td>25</td><td>1</td><td>0.4383646707471224</td><td>-0.02855987894870948</td><td>0</td><td>5.342907155404723e-10</td><td>4.979734881768568e-13</td><td>17.080555931399246</td><td>0.0010114644093129814</td><td>-6.100000000000001</td></tr>
</table></div></div></div>
</div>
</section>
</section>
<section id="font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a">
<h3>3.2<font color='white'>-</font>Single, Level3 Mosaicked File<a class="anchor" id="bso3"></a><a class="headerlink" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a" title="Permalink to this heading">#</a></h3>
<p>Despite the above discussion on performing PSF photometry on the pre-mosaiced data products, space_phot has the functionality to create a mosaiced Level3 PSF at a given single position on the detector based on the Level2 images. The advantage to this is the ability to perform PSF photometry on the deep, stacked data in cases where faint sources are expected to have prohibitively low signal-to-noise in Level2 data. The disadvantage is the amount of time required to make mosaiced Level3 PSF, so that this method is most useful when dealing with a small number of low signal-to-noise sources.<br></p>
<p>Useful references:<br>
Space-Phot Documentation on Level3 Fitting: https://space-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#level-3-psf<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level3 data file the same as above</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/4e275a126cfed51d09a37a871b2580e5d25be9e6db62bed911396a4d0b35abd9.png" src="../../../_images/4e275a126cfed51d09a37a871b2580e5d25be9e6db62bed911396a4d0b35abd9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>

<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/753583868b9d6a66787afd1cc15d22d35d35fd02a7f979c0cf7fc7f6bc6f0573.png" src="../../../_images/753583868b9d6a66787afd1cc15d22d35d35fd02a7f979c0cf7fc7f6bc6f0573.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/20b5463a5b35adf430e72dee7f388358834c51a8e3eb62d7fca316389daab443.png" src="../../../_images/20b5463a5b35adf430e72dee7f388358834c51a8e3eb62d7fca316389daab443.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function get_jwst_psf is a space_phot wrapper for the WebbPSF calc_psf function and uses a lot of the same keywords.</span>
<span class="c1"># There are more advanced methods for generating your WebbPSF, but those are beyond the scope of this notebook.</span>
<span class="c1"># The defaults used by get_jwst_psf in this notebook are:</span>
<span class="c1"># oversample=4</span>
<span class="c1"># normalize=&#39;last&#39;</span>
<span class="c1"># Non-distorted PSF</span>
<span class="c1"># Useful reference: https://webbpsf.readthedocs.io/en/latest/api/webbpsf.JWInstrument.html#webbpsf.JWInstrument.calc_psf</span>

<span class="c1"># Get PSF from WebbPSF</span>
<span class="n">jwst3_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation3</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">psf3</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst3_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">jwst3_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.58446788), array(691.01192923)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.5124035522455, 201.4600597391466)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.0823346), array(703.49975178)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51086191643108, 201.4622239877097)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(507.07857065), array(701.00356235)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51028045414768, 201.46207330662145)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(502.58093657), array(694.50845109)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.5103939360115, 201.46118840344508)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,324 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,325 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,328 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,329 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,331 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,332 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,334 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,659 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,674 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.2
      sharphi: 1.0
      roundlo: -1.0
      roundhi: 1.0
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: INDEF
      nlow: 0
      nhigh: 0
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      allowed_memory: None
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        pt2dQvpkvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      allowed_memory: None
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:09,674 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:10,112 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3cf105df90&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:10,113 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:10,923 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3cf105df90&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:10,924 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,080 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3cf105df90&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,080 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,246 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3cf105df90&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,247 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,248 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,248 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,248 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,250 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,251 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,251 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,251 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,253 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,253 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,254 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,254 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,256 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,256 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,256 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,257 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,259 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,259 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,259 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,260 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,260 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11091579557784445 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,354 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:11,861 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:12,600 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:13,341 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,082 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,736 - stpipe.Image3Pipeline.resample - INFO - Resampling variance components
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,738 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,739 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,739 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,740 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,741 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,741 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,742 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,743 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,743 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,744 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,745 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,745 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:14,763 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  265.737936402 66.941000865 265.701076764 66.912745077 265.773940411 66.898123015 265.810862277 66.926361876
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:15,203 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:15,204 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:15,361 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1030, 1042) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:15,362 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:15,366 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:05:15,367 - stpipe - INFO - Results used jwst version: 1.16.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psf3</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model (Mosaiced)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/d67002fe4363fd2c996bd9d994906eb353e5637ac74ff8afeea69f65bf48591b.png" src="../../../_images/d67002fe4363fd2c996bd9d994906eb353e5637ac74ff8afeea69f65bf48591b.png" />
</div>
</div>
<section id="id1">
<h4>Notes on the PSF Fitting in Space_Phot: <br><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<p>https://st-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images
As noted above, improved documentation will be coming. For now, here are some important points to consider.
See detailed notes in Section 3.1 above about the fitting process and diagnostics</p>
<p>In addition, consider here that jwst3_obs is generating a Level3 PSF by using the JWST pipeline to resample and combine multiple Level2 PSFs. The Level2 PSFs are generated at the precise location of the source in each Level2 file to account for detector level effects. The resampling uses default resampling paramters. However, users should be aware that if they performed customized resampling for their Level2 data products, they should use similar resampling steps for their PSF below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do PSF Photometry using space_phot (details of fitting are in documentation)</span>
<span class="c1"># See detailed notes in Section 3.1 above about the fitting process and diagnostics</span>
<span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psf3</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">],</span>
        <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.60%
</pre></div>
</div>
<img alt="../../../_images/6ddc71ccc6e27510115576f13441d925df549b3bee4efc65ed8183184c4ba480.png" src="../../../_images/6ddc71ccc6e27510115576f13441d925df549b3bee4efc65ed8183184c4ba480.png" />
<img alt="../../../_images/e4b6e98c2515aa97a5ca21bea6c960b70552de97828798db5ed03cf57e85772f.png" src="../../../_images/e4b6e98c2515aa97a5ca21bea6c960b70552de97828798db5ed03cf57e85772f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mag_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">magerr_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mag_lvl2_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">magerr_lvl2_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mag_lvl3psf</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">magerr_lvl3psf</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17.258 0.0007
17.28631 0.00069
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="good-agreement-between-level2-and-level3-results">
<h2>Good agreement between Level2 and level3 results!<a class="headerlink" href="#good-agreement-between-level2-and-level3-results" title="Permalink to this heading">#</a></h2>
</section>
<section id="font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a">
<h2>4.<font color='white'>-</font>Faint/Upper Limit, Single Object<a class="anchor" id="fso"></a><a class="headerlink" href="#font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a" title="Permalink to this heading">#</a></h2>
<p>The purpose of this section is to illustrate how to calculate an upper limit using PSF photometry a blank part of the sky.</p>
<section id="font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a">
<h3>4.1<font color='white'>-</font>Multiple, Level2 Files<a class="anchor" id="fso2"></a><a class="headerlink" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level 3 Files</span>
<span class="n">lvl3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;</span><span class="p">]</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Level 2 Data List from ASN files</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;./mast/01028/&quot;</span>
<span class="n">asn</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="s1">&#39;jw01028-o006_*_image3_00004_asn.json&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">lvl2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fi</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;                    &quot;expname&quot;:&#39;</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="n">lvl2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00002_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00003_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00004_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>

<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">dq</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (After DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/ca4c2949ad2f6f5195b5fac6cfdbd7919a1f1d4b0f732baea95c18995f4c1d91.png" src="../../../_images/ca4c2949ad2f6f5195b5fac6cfdbd7919a1f1d4b0f732baea95c18995f4c1d91.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/45f55a3a6b0d417fd625362826283c0bf8f577df308cb3e9798221e7b3bcdfcf.png" src="../../../_images/45f55a3a6b0d417fd625362826283c0bf8f577df308cb3e9798221e7b3bcdfcf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/584629bc6f9be171fd731ad922df39d1fa21758d2e4166c2f3ff96288a300229.png" src="../../../_images/584629bc6f9be171fd731ad922df39d1fa21758d2e4166c2f3ff96288a300229.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">ref_fits</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ref_fits</span><span class="p">))</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e7f9e74fae3d442447b2b59cb0c443313c8aa449cf901557e74ac845dec4ba7b.png" src="../../../_images/e7f9e74fae3d442447b2b59cb0c443313c8aa449cf901557e74ac845dec4ba7b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function get_jwst_psf is a space_phot wrapper for the WebbPSF calc_psf function and uses a lot of the same keywords.</span>
<span class="c1"># There are more advanced methods for generating your WebbPSF, but those are beyond the scope of this notebook.</span>
<span class="c1"># The defaults used by get_jwst_psf in this notebook are:</span>
<span class="c1"># oversample=4</span>
<span class="c1"># normalize=&#39;last&#39;</span>
<span class="c1"># Non-distorted PSF</span>
<span class="c1"># Useful reference: https://webbpsf.readthedocs.io/en/latest/api/webbpsf.JWInstrument.html#webbpsf.JWInstrument.calc_psf</span>

<span class="c1"># Get PSF from WebbPSF</span>
<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">psfs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.86069511), array(559.08387297)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51420939304742, 121.52381573784315)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.32944238), array(571.63330681)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.5174643701714, 121.52330511426992)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(767.30763827), array(569.1357543)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51685314039858, 121.52145590349731)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(762.80321923), array(562.61868067)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51503596024747, 121.51983614651763)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psf3</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/19883dda3a74783639254d240905569f24be29bd2abbef7964756924dbebb172.png" src="../../../_images/19883dda3a74783639254d240905569f24be29bd2abbef7964756924dbebb172.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do PSF Photometry using space_phot (details of fitting are in documentation)</span>
<span class="c1"># https://st-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images</span>
<span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psfs</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span>
<span class="p">)</span>
<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 138.43%
</pre></div>
</div>
<img alt="../../../_images/1b0edcb5c0c24cde1f2e2eae908afba26f2561975c38453a6a028a23c6c4c18b.png" src="../../../_images/1b0edcb5c0c24cde1f2e2eae908afba26f2561975c38453a6a028a23c6c4c18b.png" />
<img alt="../../../_images/b2031d22b02a1e54165bf70f6d58a6a6879c6aa16d902623872676222d6fb806.png" src="../../../_images/b2031d22b02a1e54165bf70f6d58a6a6879c6aa16d902623872676222d6fb806.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        ra         ...                     exp                    
------------------ ... -------------------------------------------
 265.7501383333533 ... jw01028006001_02101_00001_mirimage_cal.fits
 265.7501383333496 ... jw01028006001_02101_00002_mirimage_cal.fits
265.75013833334884 ... jw01028006001_02101_00003_mirimage_cal.fits
 265.7501383333493 ... jw01028006001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As noted above, As a result, the flux and corresponding error take into account a single overall fit. </span>
<span class="c1"># Therefore, there is no need to average the resulting magnitudes or errors. They should all be the same to within their individual zero-point differences (typically &lt;1%).</span>

<span class="c1"># Print Upper Limits</span>
<span class="n">magupper_lvl2psf</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">upper_limit</span><span class="p">(</span><span class="n">nsigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">magupper_lvl2psf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([25.62235305, 25.62235305, 25.62235305, 25.62235305])
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a">
<h3>4.2<font color='white'>-</font>Single, Level3 Mosaicked File<a class="anchor" id="fso3"></a><a class="headerlink" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level3 data file the same as above.</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/4e275a126cfed51d09a37a871b2580e5d25be9e6db62bed911396a4d0b35abd9.png" src="../../../_images/4e275a126cfed51d09a37a871b2580e5d25be9e6db62bed911396a4d0b35abd9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/66263c97b540199251a5839680378a590f1e5c8f8632b4def81f07d301046690.png" src="../../../_images/66263c97b540199251a5839680378a590f1e5c8f8632b4def81f07d301046690.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/20b5463a5b35adf430e72dee7f388358834c51a8e3eb62d7fca316389daab443.png" src="../../../_images/20b5463a5b35adf430e72dee7f388358834c51a8e3eb62d7fca316389daab443.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>

<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">ref_fits</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ref_fits</span><span class="p">))</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006 (level 3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fd992b9368117ef6d58d3ce48efa90f83c14acdcaad66cdab61b8d0610675d79.png" src="../../../_images/fd992b9368117ef6d58d3ce48efa90f83c14acdcaad66cdab61b8d0610675d79.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function get_jwst_psf is a space_phot wrapper for the WebbPSF calc_psf function and uses a lot of the same keywords.</span>
<span class="c1"># There are more advanced methods for generating your WebbPSF, but those are beyond the scope of this notebook.</span>
<span class="c1"># The defaults used by get_jwst_psf in this notebook are:</span>
<span class="c1"># oversample=4</span>
<span class="c1"># normalize=&#39;last&#39;</span>
<span class="c1"># Non-distorted PSF</span>
<span class="c1"># Useful reference: https://webbpsf.readthedocs.io/en/latest/api/webbpsf.JWInstrument.html#webbpsf.JWInstrument.calc_psf</span>

<span class="c1"># Get PSF from WebbPSF</span>
<span class="n">jwst3_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation3</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">psf3</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst3_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">jwst3_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.86069511), array(559.08387297)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51420939304728, 201.52381573784302)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.32944238), array(571.63330681)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.5174643701711, 201.52330511426985)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(767.30763827), array(569.1357543)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51685314039872, 201.5214559034972)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(762.80321923), array(562.61868067)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51503596024762, 201.51983614651743)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,791 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,792 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,795 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,796 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,798 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,799 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,801 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,974 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,987 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.2
      sharphi: 1.0
      roundlo: -1.0
      roundhi: 1.0
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: INDEF
      nlow: 0
      nhigh: 0
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      allowed_memory: None
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        pt2dQvpkvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      allowed_memory: None
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:06,988 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:07,429 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4e5fb3d0&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:07,430 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,271 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4e5fb3d0&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,272 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,441 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4e5fb3d0&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,442 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,622 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4e5fb3d0&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,623 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,623 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,624 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,625 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,626 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,627 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,627 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,628 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,629 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,630 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,630 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,631 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,632 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,633 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,633 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,634 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,636 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,636 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,636 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,637 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,637 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11091579557784445 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:08,723 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:09,267 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:10,018 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:10,776 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:11,532 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1030, 1042)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,186 - stpipe.Image3Pipeline.resample - INFO - Resampling variance components
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,188 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,189 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,189 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,189 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,190 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,191 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,191 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,192 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,193 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,193 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,194 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,194 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,212 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  265.737936402 66.941000865 265.701076764 66.912745077 265.773940411 66.898123015 265.810862277 66.926361876
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,650 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,651 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,820 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1030, 1042) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,821 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,825 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:06:12,826 - stpipe - INFO - Results used jwst version: 1.16.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psf3</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/d4431c3924800c96ba3c2ad1acccff08ec3a2bd6b005cf9682cdc57db2749a90.png" src="../../../_images/d4431c3924800c96ba3c2ad1acccff08ec3a2bd6b005cf9682cdc57db2749a90.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psf3</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_centroid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">jwst3_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst3_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of -1.83%
</pre></div>
</div>
<img alt="../../../_images/6d01fb03ab217bed2bb2439c1dbd2f6070be57c8e20a4830d679fe2263f9ea8f.png" src="../../../_images/6d01fb03ab217bed2bb2439c1dbd2f6070be57c8e20a4830d679fe2263f9ea8f.png" />
<img alt="../../../_images/cd1af60e3ee7bcc80b1acc47526e6201881bf438810756eb46ad237d52d6bc1f.png" src="../../../_images/cd1af60e3ee7bcc80b1acc47526e6201881bf438810756eb46ad237d52d6bc1f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">magupper_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">upper_limit</span><span class="p">(</span><span class="n">nsigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">magupper_lvl2psf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">magupper_lvl3psf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.6224
25.8801
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="note-you-can-go-significantly-deeper-with-the-level3-combined-data-product">
<h2>Note you can go significantly deeper with the Level3 combined data product<a class="headerlink" href="#note-you-can-go-significantly-deeper-with-the-level3-combined-data-product" title="Permalink to this heading">#</a></h2>
</section>
<section id="font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a">
<h2>5.<font color='white'>-</font>Stellar Field (LMC)<a class="anchor" id="lmc"></a><a class="headerlink" href="#font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a" title="Permalink to this heading">#</a></h2>
<section id="in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired">
<h3>In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using space_phot on a large number of stars. We suggest that space_phot may be less optimal for large numbers of bright stars. Other programs, such as DOLPHOT or Photutils, may be better suited for this use case. The primary advantage to space_phot is on faint, single sources. But it can be extended to a larger number if desired.<a class="headerlink" href="#in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired" title="Permalink to this heading">#</a></h3>
</section>
<section id="font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a">
<h3>5.1<font color='white'>-</font>Multiple, Level2 Files<a class="anchor" id="lmc2"></a><a class="headerlink" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a" title="Permalink to this heading">#</a></h3>
<section id="now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed">
<h4>Now do the same thing for a larger group of stars and test for speed<a class="headerlink" href="#now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level 3 Files</span>
<span class="n">lvl3</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&quot;</span><span class="p">]</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level 2 Files</span>
<span class="n">lvl2</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;./mast/01171/jw01171004*cal.fits&#39;</span><span class="p">)</span>
<span class="n">lvl2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00002_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00003_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00001_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find Stars in Level 3 File</span>

<span class="c1"># Get rough estimate of background (There are Better Ways to Do Background Subtraction)</span>
<span class="n">bkgrms</span> <span class="o">=</span> <span class="n">MADStdBackgroundRMS</span><span class="p">()</span>
<span class="n">mmm_bkg</span> <span class="o">=</span> <span class="n">MMMBackground</span><span class="p">()</span>

<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>

<span class="n">std</span> <span class="o">=</span> <span class="n">bkgrms</span><span class="p">(</span><span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">bkg</span> <span class="o">=</span> <span class="n">mmm_bkg</span><span class="p">(</span><span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">data_bkgsub</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_bkgsub</span> <span class="o">-=</span> <span class="n">bkg</span>        
<span class="n">fwhm_psf</span> <span class="o">=</span> <span class="mf">1.882</span> <span class="c1"># pixels for F560W</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">5.</span>

<span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="n">fwhm_psf</span><span class="p">,</span> <span class="n">exclude_border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_separation</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">found_stars</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">found_stars</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">(</span><span class="n">max_lines</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> id     xcentroid          ycentroid          sharpness       roundness1      roundness2      npix sky         peak               flux                mag         
--- ------------------ ------------------ ------------------ ----------- -------------------- ---- --- ------------------- ------------------ --------------------
  1  546.2615248590856   5.40090706700177 0.7041937380599614  0.46773428  0.04273256330788055   25 0.0 -0.8653272390365601 1.6463868618011475  -0.5413297293846483
  2  789.0983970730795  6.312157835017226 0.6691237944354219 -0.17942303  -0.8079555096758742   25 0.0 -0.5761210918426514 1.1000438928604126 -0.10352503572911273
  3  845.9799634503643 3.6757970986043205 0.6829976607805458 0.043498766 -0.42254093349077776   25 0.0  -1.171976923942566 1.1794757843017578 -0.17922257214246215
...                ...                ...                ...         ...                  ...  ... ...                 ...                ...                  ...
788 1005.1187213604594 1062.3368573824348 0.6862059219157299  -0.4493568  -0.8216906677208772   25 0.0 -0.6988779306411743 1.0355932712554932 -0.03797304988288973
789  399.3766175963356 1064.9409739772366 0.3060837128458461  -0.1559235 -0.21203561885367334   25 0.0 -0.7487165927886963 1.0224626064300537 -0.02411858480836388
790  566.9700693080139  1065.048267845045 0.5650444893283237  -0.3703813  -0.5505482861764637   25 0.0  0.5157880783081055  1.638227939605713  -0.5359358211339778
Length = 790 rows
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the found stars</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

<span class="n">xypos</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>
<span class="n">aper</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">xypos</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">aper</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.patches.Circle at 0x7f3d4d7d8950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49be4810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dc57490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dddcd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a391290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44dedb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44ded390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e01e490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e01f6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d7e1790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e01fbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49bd5390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df0dc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3eeace50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b3e250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b3e9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e2dff10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f07ba50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f07a850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f07af10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df3b4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df3a650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df39d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df3b010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df381d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df3a2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df3a850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3cb0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3c91d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b55d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b57a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d980f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d981350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0a3210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0a1290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0a2650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e28b490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d48945590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d48947910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d48944450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d489470d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d411ded10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf103d7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf103ff10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d96b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d95850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d972d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2d8ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2d9a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2d87d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a29ff50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d767210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d7670d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d7665d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d7649d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d764410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d766190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d765510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d767110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d766450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d766bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e2519d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d6751ea90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f2b4f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f2b7450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2d2750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0c5bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0c6890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e6221d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e621210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d86a550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2c9410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2ca4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2ca350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d916d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d92450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d90d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d90c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfb7550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfb6290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfb67d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df48f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4df4b790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a349690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d674e8fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d674e80d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d674eab90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b4e150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b4d450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b4ef10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b4d510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b4cdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b4cc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d46b4ec90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a417a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e21f150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea58190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea591d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea59e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea5abd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea5ab90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea58a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea5a590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea58ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a381c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a383390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49b72850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a5fd610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a5feb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49b4c610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49b4fa90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49bc1550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49bc3950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42fc0250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2fff90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2ff4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d19590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e12e910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e12d650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e12c2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e12c8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e12c7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e032dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e031b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e031f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e032bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e030a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0308d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e033450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e032150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d6744a090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4db4e410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a420090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a422dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a420c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a422110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a420e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d6747f8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d6747f510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d6747da50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d6747c890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d6747e3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3ee0a750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49ca6a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49ca6810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49ca4a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49ca5290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49ca7810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49ca7d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e24c410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e24e9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e24de90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e24e890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e24d550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e24d390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2e1310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2e21d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2e1c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2e2c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2e2a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2e0890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4a2e2710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf13f7290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf13f5ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf13f6590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf13f4050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf13f5990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf13f5890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf13f6350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf13f79d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a8cb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a8db50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a8ff50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a8ed90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a8eb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a8e710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d1dc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d1f750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d1cc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d1e050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d1ecd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d1d090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f3735d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f370e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f371d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f373cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f370fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f371610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f371550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f370b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f370590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f373810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f3703d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f371fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f372750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f373290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f371a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f372d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a29350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a28350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a29d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a2ab50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a2a5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a2a590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1a280d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e34d7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e34cf10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e34d010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e34e510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da77610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da777d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da76a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da75650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da77390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da75c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da76f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da74810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da77dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4da77250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d96e790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d96e890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab0190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab0fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab0610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab1790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab2cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab1390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab0150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab2c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab1010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab1950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab2d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab1810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab17d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab1250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab3810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e370290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3732d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e371410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e373110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3716d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3701d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e371550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e372e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e370810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e373b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d851d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d853750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d853f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d850290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d853290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d853b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d853c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d853890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d852210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d853c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d851510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8527d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8524d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d673c5350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d673c7010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d673c7390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75f790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75c690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75c1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75c490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75f850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75f9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75cc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75c6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75ea10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d75d810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e02c0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e02d050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e02dd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d738290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d73a150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d73b410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d738d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d738b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d739910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d73ab50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d738e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d73b5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4edff250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4edfd8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d41107b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d41107c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab4910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab4b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab5710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab4b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab7dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab6e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab5c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab7910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab4290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab5d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab54d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab6450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab6e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab7a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab5d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab6190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1ab46d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f7750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f58d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f7890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f7110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f54d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f6990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f5550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f6410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f77d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8f65d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111ee90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111f710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111e690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111c290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111f050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111f6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111e290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111dfd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111c590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111ed50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111e890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111cb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111ddd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4111e110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4117c050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3ed3ad50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d79cdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d79fb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d79c290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d79fc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d79ec90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d79e090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d79ec10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dec1010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d9ab90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d990d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d99990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d98050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d99ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d99110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d9b250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d99ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49d9bfd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d3b510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d3ac10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d38fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d3b890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d3a010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d44d3a5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1af8a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1af8050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1af90d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1afb550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1af9f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1afbd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1afa510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1af9910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1af8550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1afb090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1af8990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1afa190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3cf1afab10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee7fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee69d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee5150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee6fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee4fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee74d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee54d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee4bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee7a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee5a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee6750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee7750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee57d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dee4710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e090150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42fbf550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42fbc7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42fbe950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f57fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f54790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f545d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f57250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f57310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f56e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f57b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f55ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f56950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d42f55410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0f0390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c35210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c377d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c34190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c35690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c36e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c36090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c36cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c34890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c35ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c354d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d49c36ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e523890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e520e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e520bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e521450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e522f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e522390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e523210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ddd37d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ddd1110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ddd3bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ddd2810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ddd2f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ddd2990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e2eeb90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3f8150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3f9490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3fa190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3fb2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e2b2490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0e5fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0e6150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0e4d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0e5010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0e4a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0e6cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0e6890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a3110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a0350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a3c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a03d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a2e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a2350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a1f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a1d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a2f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a39d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a1250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a1050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a0850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d8a0c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0dc2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0df910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0dfb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0dec10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0defd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0dfb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0dea50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0de210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0dda10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f307e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f305490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f305b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f307bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f306810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f305c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f306f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f3040d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f304cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f307110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f3073d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f307f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f304690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f307a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d3f306110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e10ba90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e10bad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e109110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e10a850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e10a110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e10a9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e10b190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e109e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6e5e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6e7890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6e4590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6e5750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6e7cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6e4990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6e5bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6e6290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6e5810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0086d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e00bed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e009190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e00b8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0091d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e009e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e008910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dff8410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dffa810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dff9b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dffb250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dff8f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c4110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c65d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c4e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c63d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c62d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c4690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c7050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c4cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c7610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c4f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c6d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c5e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c69d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c5950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d6c7790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4c5650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4c4090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4c7e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4c6650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4c6c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dace7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacea90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacca10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacd6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacd290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacc1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacf150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacd190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacdf10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacf6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacced0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dace390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacca90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dace990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dacc490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e028450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e028750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e028e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e028910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e32a450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e329450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e32bf10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e32bc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4a61d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4a4150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4a5010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4a4450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4a7010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4a5b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4a6e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e69a0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e699350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e698250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e69b990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e69a4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e69ad90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e69bf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e699810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e69ba10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e698d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e698d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e323b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e323dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e323290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e323e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e321cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e321210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e323f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3205d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e320d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e323950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83f3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83d0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83ded0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83cd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83e2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83f710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83d250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83c150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83c510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83c210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83dd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83ecd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83c190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83d290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83cb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83e3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e83e850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e027290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e027510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e026090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e025ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e025e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e026a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfcb8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfc9590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfca5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfcb210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfc8c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfcb7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfca890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfca590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfcaad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfcbc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfc9090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfc8e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfca1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfcb9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfcb350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfc9a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfc9bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfc8210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dfc8950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0ba750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0baa50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0b9cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0b8c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0b9190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0b9ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0b80d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0b9790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e2cf310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e2cfc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e2cce90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4d80b590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9f250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9c250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9d910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9da50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9dd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9ef50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9ed10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9f5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9c590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9fcd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9fb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9fd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9d4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9d610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9e010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9cd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9c9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9de10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9df50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4de9f350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ec31650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ec33790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d5c707750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea83690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea80910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea83850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea81810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea83810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea83910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ea81490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dff5910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dff5690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dff5a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dff5b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dff7850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dff7010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf56d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf6690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf4950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf5410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf7bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf7890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf5250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf75d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf7790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf7a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf5f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf58d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf5d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf7b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf78d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf5c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf5390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf6150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf4350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4eeb0ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed75190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed770d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed77090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed76390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed74050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed74f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed75590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed749d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed746d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed768d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4ed75010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e303490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e303c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e303890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e3016d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e301910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e303990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e302c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e303e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc0910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc28d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc2b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc08d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc0d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc2190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc01d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc1210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc1690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc1750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc2050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc06d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc18d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc23d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc0610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc0fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc3bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc2150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc15d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcc3150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4f5250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4f53d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e4f5190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e038e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e0391d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e039cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e039950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e039e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20c7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20fed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20e790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20d690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20d310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20f450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20ddd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20e490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20cc10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20f290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20ec90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20e210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20f3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20e350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20f5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20f910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20cbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20d5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20f490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e20c4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e849910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e849e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e8482d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e849590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e84b9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e848ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e84ae50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e849b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e84bcd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4e84ba50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4eabd650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4eabfbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4eabfa90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4eabd690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4eabf610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca23d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca13d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca1d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca1090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca1390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca0b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca0150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca0e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca0190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca3050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca3290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca2850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca0a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca3f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca22d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca3990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca0d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dca3090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf8990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf9590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf8ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf8e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf9550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcfbd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcfa9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf8d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f3d4dcf8a90&gt;]
</pre></div>
</div>
<img alt="../../../_images/6ce350cae3d154bb7f7d5e837ae0a6e1fe31638385b3e9f3d43ed17cd4617f6b.png" src="../../../_images/6ce350cae3d154bb7f7d5e837ae0a6e1fe31638385b3e9f3d43ed17cd4617f6b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter out only stars you want</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;sharpness&#39;</span><span class="p">)</span>

<span class="n">xlim0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.25</span>
<span class="n">xlim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.25</span>
<span class="n">ylim0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.15</span>
<span class="n">ylim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.15</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">sh_inf</span> <span class="o">=</span> <span class="mf">0.40</span>
<span class="n">sh_sup</span> <span class="o">=</span> <span class="mf">0.82</span>
<span class="c1">#mag_lim = -5.0</span>
<span class="n">lmag_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span>
<span class="n">umag_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">sh_sup</span><span class="p">,</span> <span class="n">sh_sup</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">sh_inf</span><span class="p">,</span> <span class="n">sh_inf</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lmag_lim</span><span class="p">,</span> <span class="n">lmag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">umag_lim</span><span class="p">,</span> <span class="n">umag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;roundness&#39;</span><span class="p">)</span>

<span class="n">ylim0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.25</span>
<span class="n">ylim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.25</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">)</span>

<span class="n">round_inf</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.40</span>
<span class="n">round_sup</span> <span class="o">=</span> <span class="mf">0.40</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">round_sup</span><span class="p">,</span> <span class="n">round_sup</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">round_inf</span><span class="p">,</span> <span class="n">round_inf</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lmag_lim</span><span class="p">,</span> <span class="n">lmag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">umag_lim</span><span class="p">,</span> <span class="n">umag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/425c70a3d52102d5fe6adb6154dd880fe459af8490ff331907912e767335e162.png" src="../../../_images/425c70a3d52102d5fe6adb6154dd880fe459af8490ff331907912e767335e162.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lmag_lim</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">umag_lim</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">round_inf</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">round_sup</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sh_inf</span><span class="p">)</span> 
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">sh_sup</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">))</span>

<span class="n">found_stars_sel</span> <span class="o">=</span> <span class="n">found_stars</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stars found originally:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_stars</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stars in final selection:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_stars_sel</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of stars found originally: 790
Number of stars in final selection: 13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">found_stars_sel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=13</i>
<table id="table139901700186192" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>xcentroid</th><th>ycentroid</th><th>sharpness</th><th>roundness1</th><th>roundness2</th><th>npix</th><th>sky</th><th>peak</th><th>flux</th><th>mag</th></tr></thead>
<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float32</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>86</td><td>378.7558816433192</td><td>106.99517231293703</td><td>0.7364077918416378</td><td>-0.059391562</td><td>-0.06704534345138508</td><td>25</td><td>0.0</td><td>51.20432662963867</td><td>46.88838195800781</td><td>-4.177663115498585</td></tr>
<tr><td>93</td><td>699.4285739316663</td><td>121.30618337045195</td><td>0.6621937635659819</td><td>-0.45228603</td><td>-0.16121600597523705</td><td>25</td><td>0.0</td><td>21.92721176147461</td><td>19.500816345214844</td><td>-3.2251319805603025</td></tr>
<tr><td>138</td><td>502.6449423284217</td><td>185.07660708931144</td><td>0.6351195098960691</td><td>-0.36937103</td><td>-0.37435640137051696</td><td>25</td><td>0.0</td><td>30.200824737548828</td><td>24.987716674804688</td><td>-3.4943164325492058</td></tr>
<tr><td>141</td><td>520.4512004466732</td><td>190.2476066884721</td><td>0.8012885262482311</td><td>0.30771914</td><td>-0.08561803159241342</td><td>25</td><td>0.0</td><td>23.034168243408203</td><td>17.149253845214844</td><td>-3.085613072177968</td></tr>
<tr><td>144</td><td>591.9599066066671</td><td>194.8718750798144</td><td>0.7334114841843143</td><td>-0.36179662</td><td>-0.19144805342168533</td><td>25</td><td>0.0</td><td>21.18755340576172</td><td>16.44730567932129</td><td>-3.0402369100553313</td></tr>
<tr><td>169</td><td>388.990541620123</td><td>248.15789451654376</td><td>0.7118823356707229</td><td>0.16915432</td><td>0.21323040806731455</td><td>25</td><td>0.0</td><td>19.440757751464844</td><td>18.429296493530273</td><td>-3.1637718927398666</td></tr>
<tr><td>183</td><td>532.3925923035418</td><td>267.74287686139763</td><td>0.7174778066738734</td><td>-0.2787835</td><td>-0.16201501039505897</td><td>25</td><td>0.0</td><td>43.17793273925781</td><td>35.05239486694336</td><td>-3.8617942384933013</td></tr>
<tr><td>249</td><td>671.5101306788192</td><td>370.56221568412315</td><td>0.6690541020715319</td><td>0.22694585</td><td>-0.2501719039312765</td><td>25</td><td>0.0</td><td>21.814945220947266</td><td>17.284053802490234</td><td>-3.09411402382609</td></tr>
<tr><td>314</td><td>635.9221063124252</td><td>494.5522379657613</td><td>0.8149770327504342</td><td>-0.12416268</td><td>0.22344203180037933</td><td>25</td><td>0.0</td><td>29.927074432373047</td><td>23.478647232055664</td><td>-3.426682676437008</td></tr>
<tr><td>373</td><td>584.9812269385081</td><td>576.5389571037796</td><td>0.7775545307534784</td><td>-0.21396631</td><td>0.009246422308793646</td><td>25</td><td>0.0</td><td>76.73455047607422</td><td>59.45756530761719</td><td>-4.435517803918195</td></tr>
<tr><td>386</td><td>492.6253255819231</td><td>596.8690332212642</td><td>0.7193021689332798</td><td>-0.23190862</td><td>-0.09178475176652573</td><td>25</td><td>0.0</td><td>78.58627319335938</td><td>64.5720443725586</td><td>-4.525111341330769</td></tr>
<tr><td>413</td><td>619.8610744135557</td><td>636.7050695267906</td><td>0.764199844647154</td><td>0.013973999</td><td>-0.007752396414213482</td><td>25</td><td>0.0</td><td>56.14342498779297</td><td>47.85715866088867</td><td>-4.19986727609639</td></tr>
<tr><td>436</td><td>664.5588392056713</td><td>666.5506376499176</td><td>0.6773962981916116</td><td>0.5580665</td><td>0.022133349895936842</td><td>25</td><td>0.0</td><td>80.94784545898438</td><td>67.48514556884766</td><td>-4.573020472543158</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert pixel to wcs coords</span>
<span class="n">skycoords</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">pixel_to_world</span><span class="p">(</span><span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">skycoords</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">dq</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a grid for fast lookup using WebbPSF. The larger the number of grid points, the better the photometric precision.</span>
<span class="c1"># Developer note. Would be great to have a fast/approximate look up table. </span>
<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_jwst_psf_grid</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">num_psfs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-04-13T03:08:10.578
                        MJD: 59682.13067798611

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/R2022041201-NRCA3_FP1-2.fits
	Date (MJD):	 59681.7791
	Delta time:	 -0.3516 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022041301-NRCA3_FP1-1.fits
	Date (MJD):	 59682.8401
	Delta time:	 0.7094 days
User requested choosing OPD time closest in time to 2022-04-13T03:08:10.578, which is R2022041201-NRCA3_FP1-2.fits, delta time -0.352 days
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/R2022041201-NRCA3_FP1-2.fits to ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F560W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/16: (0, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/16 centroid: (201.39896123096594, 201.57462168473992)
    Position 2/16: (0, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 2/16 centroid: (201.27298326538994, 201.8122962916395)
    Position 3/16: (0, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 3/16 centroid: (201.26092649151903, 201.8273016561088)
    Position 4/16: (0, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 4/16 centroid: (201.30665784716913, 201.41346936543644)
    Position 5/16: (341, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 5/16 centroid: (201.38945973576688, 201.62934762823934)
    Position 6/16: (341, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 6/16 centroid: (201.48863769451324, 201.63972936419177)
    Position 7/16: (341, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 7/16 centroid: (201.48210765199016, 201.6080741598635)
    Position 8/16: (341, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 8/16 centroid: (201.42818621943198, 201.61327684523178)
    Position 9/16: (682, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 9/16 centroid: (201.405459701244, 201.64424228029097)
    Position 10/16: (682, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 10/16 centroid: (201.52251762658082, 201.5881287591983)
    Position 11/16: (682, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 11/16 centroid: (201.57423502982945, 201.5553583383486)
    Position 12/16: (682, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 12/16 centroid: (201.584920185908, 201.6735683999315)
    Position 13/16: (1023, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 13/16 centroid: (201.44216164335302, 201.69986266797625)
    Position 14/16: (1023, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 14/16 centroid: (201.51032408676687, 201.68044889871803)
    Position 15/16: (1023, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 15/16 centroid: (201.62018700397059, 201.66506320800642)
    Position 16/16: (1023, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 16/16 centroid: (201.77312450805107, 201.60334597442935)
  Saving file: miri_mirim_f560w_fovp101_samp4_npsf16.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">QTable</span><span class="p">([</span><span class="n">skycoords</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;skycoord&quot;</span><span class="p">])</span>
<span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;skycoord.ecsv&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now Loop Through All Stars and Build Photometry Table</span>
<span class="c1"># Readers should refer to all diagnostics discussed above. </span>
<span class="c1"># It should be noted that empty plots correspond to LVL2 files with dither positions that do not cover that particular coordinate.</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">badindex</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">localbkg_estimator</span> <span class="o">=</span> <span class="n">LocalBackground</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">MMMBackground</span><span class="p">())</span>

<span class="k">for</span> <span class="n">source_location</span> <span class="ow">in</span> <span class="n">skycoords</span><span class="p">:</span>
    <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting&#39;</span><span class="p">,</span> <span class="n">counter</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39; of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">skycoords</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
    <span class="n">psfs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_jwst_psf_from_grid</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">,</span> <span class="n">grid</span><span class="p">)</span>
    <span class="n">xys</span> <span class="o">=</span> <span class="p">[</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">wcs_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">n_exposures</span><span class="p">)]</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="p">[</span><span class="n">localbkg_estimator</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">data_arr_pam</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">n_exposures</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bkg</span><span class="p">)</span>
    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psfs</span><span class="p">,</span>
        <span class="n">source_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;wcs&#39;</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span>
        <span class="n">maxiter</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    
    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">fit_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
     
    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psfs</span><span class="p">,</span>
        <span class="n">fit_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span>
        <span class="n">maxiter</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>

    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mag_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span>
    <span class="n">magerr_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">]</span>
    <span class="n">mag_lvl2psf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mag_arr</span><span class="p">)</span>
    <span class="n">magerr_lvl2psf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">magerr_arr</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl2psf</span><span class="p">,</span> <span class="n">magerr_lvl2psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl2psf</span><span class="p">,</span> <span class="n">magerr_lvl2psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mf">1.</span>
    
    <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time for Photometry:&quot;</span><span class="p">,</span> <span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting 1.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.68751895, -69.44522201)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.869825303554535, 1.875230292270058, nan, nan]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.77%
</pre></div>
</div>
<img alt="../../../_images/c387c29deac24010840d73b15294f820566e58294fd09c3fac6615e66015fa72.png" src="../../../_images/c387c29deac24010840d73b15294f820566e58294fd09c3fac6615e66015fa72.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.73%
</pre></div>
</div>
<img alt="../../../_images/c52f7416122b1f04aff17463ca88eeee17bb99556903e9c92d58934f02b582da.png" src="../../../_images/c52f7416122b1f04aff17463ca88eeee17bb99556903e9c92d58934f02b582da.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 31.591261426000074
Starting 2.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70519786, -69.43753355)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7614484293419017, 1.7480259496590187, 1.8134855595066321, 1.943224255991454]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.75%
</pre></div>
</div>
<img alt="../../../_images/d1bc691fc3db46d197ed81252bb3b648301f516b0aec64c51a282d1d318da744.png" src="../../../_images/d1bc691fc3db46d197ed81252bb3b648301f516b0aec64c51a282d1d318da744.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.72%
</pre></div>
</div>
<img alt="../../../_images/b58a4e4a7ec614f3db2f980b71b8e26476387d2179425b1fe1902c911e0adb9b.png" src="../../../_images/b58a4e4a7ec614f3db2f980b71b8e26476387d2179425b1fe1902c911e0adb9b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 29.438504402000035
Starting 3.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.69947281, -69.44357619)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7704960215245196, 1.8464110786631958, 1.8189359360103365, 1.8683478434880576]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.11%
</pre></div>
</div>
<img alt="../../../_images/f06c12d7d49c498e5daa2530f5334784d3c09ab2e5a70b38d50e327fec40e8e4.png" src="../../../_images/f06c12d7d49c498e5daa2530f5334784d3c09ab2e5a70b38d50e327fec40e8e4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.09%
</pre></div>
</div>
<img alt="../../../_images/b7baebb974f9b5cef6f1a94a1a6e7f6fe6b04eea384fd691cc52939dc9792f98.png" src="../../../_images/b7baebb974f9b5cef6f1a94a1a6e7f6fe6b04eea384fd691cc52939dc9792f98.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 29.49079233100008
Starting 4.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70076349, -69.44322912)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7729037974078583, 1.8693315009785514, 1.7539834316196359, 1.8635000334623966]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.80%
</pre></div>
</div>
<img alt="../../../_images/935dcb4ee579e3a682b4855e7fc838afaaece30ec9f5b3fc75dcfb53d4f1282b.png" src="../../../_images/935dcb4ee579e3a682b4855e7fc838afaaece30ec9f5b3fc75dcfb53d4f1282b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.78%
</pre></div>
</div>
<img alt="../../../_images/a9e5d1738c0b6b545a715a58afe57ac53df23b01ec23b6d3a439d82d4db2523a.png" src="../../../_images/a9e5d1738c0b6b545a715a58afe57ac53df23b01ec23b6d3a439d82d4db2523a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 34.130336288999956
Starting 5.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70480666, -69.44154063)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.829211658608597, 1.8180533992616752, 1.7340520685369318, 1.8822986582914987]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.45%
</pre></div>
</div>
<img alt="../../../_images/fcdc82388de64e11631f720335293f9bb523ee62cb838e759512f05ef73fd812.png" src="../../../_images/fcdc82388de64e11631f720335293f9bb523ee62cb838e759512f05ef73fd812.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.43%
</pre></div>
</div>
<img alt="../../../_images/107a5523b424588c65022f012fbe3100fcfbb05465f9024434455a54ef0a83c3.png" src="../../../_images/107a5523b424588c65022f012fbe3100fcfbb05465f9024434455a54ef0a83c3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 32.94416685300007
Starting 6.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.69801844, -69.44754524)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.8947609114092452, 1.8804607170599477, nan, nan]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of -0.31%
</pre></div>
</div>
<img alt="../../../_images/92bd5c823be8d7d93c03b998ee7ad8ccd571e42b61388db09824febc9bdeabc4.png" src="../../../_images/92bd5c823be8d7d93c03b998ee7ad8ccd571e42b61388db09824febc9bdeabc4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of -0.30%
</pre></div>
</div>
<img alt="../../../_images/6d12165563014f7bd3b72b5f1639e64b09f6c6a2fea57613bb0e94419a72fe88.png" src="../../../_images/6d12165563014f7bd3b72b5f1639e64b09f6c6a2fea57613bb0e94419a72fe88.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 27.845807989999912
Starting 7.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70685609, -69.4443474)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7949211474651943, 1.7996749530022749, 1.8149203216207437, 1.9178177507027336]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.73%
</pre></div>
</div>
<img alt="../../../_images/fa9e491ad0da9d235e452bd0a955c6368c18655f3913e7471b0882b89c1977ee.png" src="../../../_images/fa9e491ad0da9d235e452bd0a955c6368c18655f3913e7471b0882b89c1977ee.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.72%
</pre></div>
</div>
<img alt="../../../_images/001afb3d8b9b9a9949dd8e2460072e42aeacb9effacf40ab3c2b48a0891562f5.png" src="../../../_images/001afb3d8b9b9a9949dd8e2460072e42aeacb9effacf40ab3c2b48a0891562f5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 34.22297877699998
Starting 8.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.72134618, -69.44277393)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.9285976984921622, 1.9269168845723184, 1.8641873090163523, 1.8905765748860541]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.39%
</pre></div>
</div>
<img alt="../../../_images/b5f478f08211531133c49508842b134d3f0b07d7e7bc18fadb9071329a7efb5b.png" src="../../../_images/b5f478f08211531133c49508842b134d3f0b07d7e7bc18fadb9071329a7efb5b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.41%
</pre></div>
</div>
<img alt="../../../_images/f17b3c66c80f3f25df80151f4fad752c587fc1979722537c410d20f5a06f2a7c.png" src="../../../_images/f17b3c66c80f3f25df80151f4fad752c587fc1979722537c410d20f5a06f2a7c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 27.5729398819999
Starting 9.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.72825455, -69.44591833)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.84141688927626, 1.8419053048023337, 1.7936298903695782, 1.898898235350981]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.14%
</pre></div>
</div>
<img alt="../../../_images/e89b8888dd420d4eb5f9e58e71bd041973ce86d46a81ac0e9f55adcfbbcb2537.png" src="../../../_images/e89b8888dd420d4eb5f9e58e71bd041973ce86d46a81ac0e9f55adcfbbcb2537.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.54%
</pre></div>
</div>
<img alt="../../../_images/a99db176fd4a6b5cf768df68bd9ea0939a323e5e01cd33af66d4ee9ae53f9d41.png" src="../../../_images/a99db176fd4a6b5cf768df68bd9ea0939a323e5e01cd33af66d4ee9ae53f9d41.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 28.88730069500002
Starting 10.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.73139968, -69.44867714)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.8579865136454181, 1.9026257471384738, 1.8863315108780547, 1.9372216368143538]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.65%
</pre></div>
</div>
<img alt="../../../_images/89d75c67a9d37b6dbfc388c924d94d3deda84bed1bdcaa19650d6ee44d96de31.png" src="../../../_images/89d75c67a9d37b6dbfc388c924d94d3deda84bed1bdcaa19650d6ee44d96de31.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.53%
</pre></div>
</div>
<img alt="../../../_images/41c4121eb1bb2f3b0aeae260e82ea94fb2cb2c2568053d6110804ea504a93b00.png" src="../../../_images/41c4121eb1bb2f3b0aeae260e82ea94fb2cb2c2568053d6110804ea504a93b00.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 29.172374559000218
Starting 11.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.72803699, -69.45133844)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7678997491160011, 1.7748173095028976, 1.7850290745363107, 1.8868650197982788]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.11%
</pre></div>
</div>
<img alt="../../../_images/3d50fabaac9f739cbf82ffaaf4b5a35f887a56f8a924abeeb26b5259b32c8a71.png" src="../../../_images/3d50fabaac9f739cbf82ffaaf4b5a35f887a56f8a924abeeb26b5259b32c8a71.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.33%
</pre></div>
</div>
<img alt="../../../_images/f69e768652897f7835a9ab7bf8e9e0bbce593da89b3cead2b8e967ca6b5060df.png" src="../../../_images/f69e768652897f7835a9ab7bf8e9e0bbce593da89b3cead2b8e967ca6b5060df.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 31.674609960999987
Starting 12.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.7374627, -69.44890937)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.8077051193817804, 1.8916719631336663, 1.816236440996522, 1.9208566810361187]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.54%
</pre></div>
</div>
<img alt="../../../_images/d46a712fa9b80173a04bb0e7e4455e2c9daaed23bc540d788bed9d99428cefcf.png" src="../../../_images/d46a712fa9b80173a04bb0e7e4455e2c9daaed23bc540d788bed9d99428cefcf.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.54%
</pre></div>
</div>
<img alt="../../../_images/2027edce389c90f3bf1f0a14347c7ee0a36049ce5cf42ad5465bbe63d3ab61ea.png" src="../../../_images/2027edce389c90f3bf1f0a14347c7ee0a36049ce5cf42ad5465bbe63d3ab61ea.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 34.27481810199993
Starting 13.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.74189341, -69.44834497)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.9374462342956695, 2.02440093926021, 1.8818280295113832, 1.8681333922051095]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.81%
</pre></div>
</div>
<img alt="../../../_images/7265cb2a2dc14c8738a343634e53c98c6f813f61f4342ea26f385d483ec08743.png" src="../../../_images/7265cb2a2dc14c8738a343634e53c98c6f813f61f4342ea26f385d483ec08743.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.80%
</pre></div>
</div>
<img alt="../../../_images/8ad1abd7edb03e1f95316b86754b19bc5cc272b6bbd32e35dfb92b27770eed16.png" src="../../../_images/8ad1abd7edb03e1f95316b86754b19bc5cc272b6bbd32e35dfb92b27770eed16.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 30.09956781300002
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xys</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(array(665.76055802), array(668.62800217)),
 (array(664.87310868), array(665.57020268)),
 (array(627.68124922), array(622.10846201)),
 (array(626.71526424), array(619.17865679))]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ra</th>
      <th>dec</th>
      <th>mag</th>
      <th>magerr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80.687509</td>
      <td>-69.445224</td>
      <td>18.898482</td>
      <td>0.007492</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80.705194</td>
      <td>-69.437533</td>
      <td>19.404488</td>
      <td>0.006140</td>
    </tr>
    <tr>
      <th>2</th>
      <td>80.699469</td>
      <td>-69.443578</td>
      <td>18.680054</td>
      <td>0.004546</td>
    </tr>
    <tr>
      <th>3</th>
      <td>80.700771</td>
      <td>-69.443234</td>
      <td>18.923926</td>
      <td>0.004872</td>
    </tr>
    <tr>
      <th>4</th>
      <td>80.704797</td>
      <td>-69.441542</td>
      <td>19.128078</td>
      <td>0.005524</td>
    </tr>
    <tr>
      <th>5</th>
      <td>80.698003</td>
      <td>-69.447549</td>
      <td>19.901086</td>
      <td>0.010917</td>
    </tr>
    <tr>
      <th>6</th>
      <td>80.706848</td>
      <td>-69.444346</td>
      <td>18.445868</td>
      <td>0.004491</td>
    </tr>
    <tr>
      <th>7</th>
      <td>80.721346</td>
      <td>-69.442773</td>
      <td>19.008161</td>
      <td>0.004693</td>
    </tr>
    <tr>
      <th>8</th>
      <td>80.728236</td>
      <td>-69.445924</td>
      <td>18.900039</td>
      <td>0.004639</td>
    </tr>
    <tr>
      <th>9</th>
      <td>80.731416</td>
      <td>-69.448676</td>
      <td>17.868741</td>
      <td>0.003172</td>
    </tr>
    <tr>
      <th>10</th>
      <td>80.728022</td>
      <td>-69.451342</td>
      <td>17.958008</td>
      <td>0.003216</td>
    </tr>
    <tr>
      <th>11</th>
      <td>80.737476</td>
      <td>-69.448909</td>
      <td>18.579381</td>
      <td>0.004065</td>
    </tr>
    <tr>
      <th>12</th>
      <td>80.741885</td>
      <td>-69.448347</td>
      <td>17.952180</td>
      <td>0.003274</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write to File</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;miri_photometry_space_phot_lvl2.txt&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a">
<h3>5.2<font color='white'>-</font>Single, Level3 Mosaicked File<a class="anchor" id="lmc3"></a><a class="headerlink" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/b5d5e51cfa08a4c3858c787db453390d6a2d7b6259ddfe94fe83e0ecf5a7acaa.png" src="../../../_images/b5d5e51cfa08a4c3858c787db453390d6a2d7b6259ddfe94fe83e0ecf5a7acaa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get PSF from WebbPSF and drizzle it to the source location</span>
<span class="n">jwst3_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation3</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">skycoords</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    [(80.68751895, -69.44522201), (80.70519786, -69.43753355),
     (80.69947281, -69.44357619), (80.70076349, -69.44322912),
     (80.70480666, -69.44154063), (80.69801844, -69.44754524),
     (80.70685609, -69.4443474 ), (80.72134618, -69.44277393),
     (80.72825455, -69.44591833), (80.73139968, -69.44867714),
     (80.72803699, -69.45133844), (80.7374627 , -69.44890937),
     (80.74189341, -69.44834497)]&gt;
</pre></div>
</div>
</div>
</div>
<section id="readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars">
<h4>Readers should refer to all diagnostics discussed above. In general, this loop shows the difficulty in doing PSF photometry on a wide variety of stars (brightness, distribution on the detector, etc) without visual inspection. Especially when dealing with low SNR sources.This is true for all photometry packages. Users should inspect the associated metrics and consider optimizing the parameters for specific stars of interest. Nonetheless, the success of the fits can always be quantified in with the associated error bars.<a class="headerlink" href="#readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now Loop Through All Stars and Build Photometry Table</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">badindex</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">source_location</span> <span class="ow">in</span> <span class="n">skycoords</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting&#39;</span><span class="p">,</span> <span class="n">counter</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39; of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">skycoords</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
    <span class="n">psf3</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst3_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">jwst3_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">,</span> <span class="n">num_psfs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">xys</span> <span class="o">=</span> <span class="p">[</span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">)]</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="p">[</span><span class="n">localbkg_estimator</span><span class="p">(</span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">xys</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xys</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bkg</span><span class="p">)</span>
    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psf3</span><span class="p">,</span>
        <span class="n">source_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fit_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">aperture_photometry</span><span class="p">(</span><span class="n">fit_location</span><span class="p">,</span> <span class="n">encircled_energy</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">aperture_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">])</span>
    
    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psf3</span><span class="p">,</span>
        <span class="n">fit_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fit_centroid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mag_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">magerr_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl3psf</span><span class="p">,</span> <span class="n">magerr_lvl3psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl3psf</span><span class="p">,</span> <span class="n">magerr_lvl3psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mf">1.</span>
    <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time for Photometry:&quot;</span><span class="p">,</span> <span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting 1.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70519786, -69.43753355)&gt;
Setting up sim to match ./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-04-13T03:08:10.578
                        MJD: 59682.13067798611

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/R2022041201-NRCA3_FP1-2.fits
	Date (MJD):	 59681.7791
	Delta time:	 -0.3516 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022041301-NRCA3_FP1-1.fits
	Date (MJD):	 59682.8401
	Delta time:	 0.7094 days
User requested choosing OPD time closest in time to 2022-04-13T03:08:10.578, which is R2022041201-NRCA3_FP1-2.fits, delta time -0.352 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F560W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(123.53744224), array(699.5595544)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.34368596613945, 201.7628797397261)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(120.43679282), array(698.68358418)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.34212605742846, 201.76493480669592)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(76.29823152), array(661.82205941)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.32154273036554, 201.80099578112635)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(73.31069299), array(660.86952362)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.31952743828327, 201.80291255054078)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,432 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,433 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,436 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,437 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,439 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,440 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,442 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,639 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,654 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.2
      sharphi: 1.0
      roundlo: -1.0
      roundhi: 1.0
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: INDEF
      nlow: 0
      nhigh: 0
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      allowed_memory: None
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        S8+wK09fvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      allowed_memory: None
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:29,655 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:30,156 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4e5c0890&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:30,157 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,113 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4e5c0890&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,113 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,324 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4e5c0890&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,325 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,530 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4e5c0890&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,532 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,532 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,533 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,533 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,535 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,535 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,536 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,536 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,538 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,538 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,539 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,539 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,541 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,541 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,542 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,542 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,544 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,544 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,545 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,545 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,546 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11082930390039995 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:31,633 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:32,168 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:32,954 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:33,724 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:34,501 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,155 - stpipe.Image3Pipeline.resample - INFO - Resampling variance components
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,157 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,159 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,159 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,160 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,161 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,161 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,162 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,163 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,163 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,163 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,164 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,165 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,195 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  80.660247821 -69.452654203 80.735784316 -69.472169218 80.791372770 -69.445623664 80.715879065 -69.426132741
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,636 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,637 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,841 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1069, 1070) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,842 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,846 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:35,846 - stpipe - INFO - Results used jwst version: 1.16.1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.1097325677365326]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:37,510 - stpipe.SourceCatalogStep - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 4.34%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:38,548 - CRDS - INFO -  Calibration SW Found: jwst 1.16.1 (/opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/jwst-1.16.1.dist-info)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:39,207 - CRDS - INFO -  Fetching  mappings/jwst/jwst_system_datalvl_0002.rmap                  694 bytes  (1 / 200 files) (0 / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:39,547 - CRDS - INFO -  Fetching  mappings/jwst/jwst_system_calver_0043.rmap                 4.9 K bytes  (2 / 200 files) (694 / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:39,801 - CRDS - INFO -  Fetching  mappings/jwst/jwst_system_0042.imap                          385 bytes  (3 / 200 files) (5.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:40,051 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_wavelengthrange_0024.rmap       1.4 K bytes  (4 / 200 files) (6.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:40,312 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_wavecorr_0005.rmap                884 bytes  (5 / 200 files) (7.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:40,575 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_superbias_0074.rmap            33.8 K bytes  (6 / 200 files) (8.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:40,888 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_sflat_0026.rmap                20.6 K bytes  (7 / 200 files) (42.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:41,202 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_saturation_0018.rmap            2.0 K bytes  (8 / 200 files) (62.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:41,521 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_refpix_0015.rmap                1.6 K bytes  (9 / 200 files) (64.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:41,836 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_readnoise_0025.rmap             2.6 K bytes  (10 / 200 files) (66.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:42,073 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_photom_0013.rmap                  958 bytes  (11 / 200 files) (68.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:42,309 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pathloss_0007.rmap              1.1 K bytes  (12 / 200 files) (69.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:42,611 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-whitelightstep_0001.rmap      777 bytes  (13 / 200 files) (70.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:42,850 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-spec2pipeline_0013.rmap    2.1 K bytes  (14 / 200 files) (71.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:43,092 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-resamplespecstep_0002.rmap      709 bytes  (15 / 200 files) (73.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:43,332 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-outlierdetectionstep_0003.rmap    1.1 K bytes  (16 / 200 files) (74.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:43,648 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-jumpstep_0005.rmap           810 bytes  (17 / 200 files) (75.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:43,884 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-image2pipeline_0008.rmap    1.0 K bytes  (18 / 200 files) (76.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:44,125 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-detector1pipeline_0003.rmap    1.1 K bytes  (19 / 200 files) (77.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:44,447 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-darkpipeline_0003.rmap       872 bytes  (20 / 200 files) (78.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:44,681 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-darkcurrentstep_0001.rmap      622 bytes  (21 / 200 files) (79.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:44,915 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ote_0030.rmap                   1.3 K bytes  (22 / 200 files) (80.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:45,233 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_msaoper_0014.rmap               1.4 K bytes  (23 / 200 files) (81.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:45,468 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_msa_0027.rmap                   1.3 K bytes  (24 / 200 files) (82.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:45,703 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_mask_0039.rmap                  2.7 K bytes  (25 / 200 files) (83.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:45,952 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_linearity_0017.rmap             1.6 K bytes  (26 / 200 files) (86.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:46,193 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ipc_0006.rmap                     876 bytes  (27 / 200 files) (88.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:46,435 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ifuslicer_0017.rmap             1.5 K bytes  (28 / 200 files) (89.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:46,754 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ifupost_0019.rmap               1.5 K bytes  (29 / 200 files) (90.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:46,996 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ifufore_0017.rmap               1.5 K bytes  (30 / 200 files) (92.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:47,243 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_gain_0023.rmap                  1.8 K bytes  (31 / 200 files) (93.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:47,480 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_fpa_0028.rmap                   1.3 K bytes  (32 / 200 files) (95.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:47,715 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_fore_0026.rmap                  5.0 K bytes  (33 / 200 files) (96.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:47,954 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_flat_0015.rmap                  3.8 K bytes  (34 / 200 files) (101.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:48,272 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_fflat_0026.rmap                 7.2 K bytes  (35 / 200 files) (105.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:48,510 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_extract1d_0018.rmap             2.3 K bytes  (36 / 200 files) (112.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:48,760 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_disperser_0028.rmap             5.7 K bytes  (37 / 200 files) (114.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:49,022 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_dflat_0007.rmap                 1.1 K bytes  (38 / 200 files) (120.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:49,347 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_dark_0069.rmap                 32.6 K bytes  (39 / 200 files) (121.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:49,748 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_cubepar_0015.rmap                 966 bytes  (40 / 200 files) (154.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:49,987 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_collimator_0026.rmap            1.3 K bytes  (41 / 200 files) (155.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:50,228 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_camera_0026.rmap                1.3 K bytes  (42 / 200 files) (156.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:50,469 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_barshadow_0007.rmap             1.8 K bytes  (43 / 200 files) (157.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:50,708 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_area_0018.rmap                  6.3 K bytes  (44 / 200 files) (159.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:51,024 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_apcorr_0009.rmap                5.6 K bytes  (45 / 200 files) (165.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:51,266 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_0383.imap                       5.6 K bytes  (46 / 200 files) (171.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:51,504 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_wfssbkg_0007.rmap                3.1 K bytes  (47 / 200 files) (177.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:51,749 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_wavemap_0008.rmap                2.2 K bytes  (48 / 200 files) (180.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:51,991 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_wavelengthrange_0006.rmap          862 bytes  (49 / 200 files) (182.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:52,310 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_trappars_0004.rmap                 753 bytes  (50 / 200 files) (183.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:52,632 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_trapdensity_0005.rmap              705 bytes  (51 / 200 files) (184.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:52,875 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_throughput_0005.rmap             1.3 K bytes  (52 / 200 files) (184.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:53,128 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_superbias_0028.rmap              6.5 K bytes  (53 / 200 files) (186.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:53,442 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_specwcs_0014.rmap                3.1 K bytes  (54 / 200 files) (192.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:53,682 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_spectrace_0008.rmap              2.3 K bytes  (55 / 200 files) (195.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:53,997 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_specprofile_0008.rmap            2.4 K bytes  (56 / 200 files) (198.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:54,237 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_speckernel_0006.rmap             1.0 K bytes  (57 / 200 files) (200.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:54,550 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_saturation_0015.rmap               829 bytes  (58 / 200 files) (201.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:54,793 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_readnoise_0011.rmap                987 bytes  (59 / 200 files) (202.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:55,034 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_photom_0035.rmap                 1.3 K bytes  (60 / 200 files) (203.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:55,360 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_persat_0007.rmap                   674 bytes  (61 / 200 files) (204.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:55,609 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pathloss_0003.rmap                 758 bytes  (62 / 200 files) (205.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:55,848 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pastasoss_0004.rmap                818 bytes  (63 / 200 files) (205.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:56,090 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-undersamplecorrectionstep_0001.rmap      904 bytes  (64 / 200 files) (206.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:56,329 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-tweakregstep_0012.rmap      3.1 K bytes  (65 / 200 files) (207.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:56,571 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-spec2pipeline_0008.rmap       984 bytes  (66 / 200 files) (210.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:56,817 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-sourcecatalogstep_0002.rmap    2.3 K bytes  (67 / 200 files) (211.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:57,062 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-resamplestep_0002.rmap        687 bytes  (68 / 200 files) (214.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:57,300 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-outlierdetectionstep_0004.rmap    2.7 K bytes  (69 / 200 files) (214.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:57,615 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-jumpstep_0007.rmap          6.4 K bytes  (70 / 200 files) (217.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:57,852 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-image2pipeline_0005.rmap    1.0 K bytes  (71 / 200 files) (223.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:58,089 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-detector1pipeline_0002.rmap    1.0 K bytes  (72 / 200 files) (224.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:58,337 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-darkpipeline_0002.rmap        868 bytes  (73 / 200 files) (225.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:58,578 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-darkcurrentstep_0001.rmap      591 bytes  (74 / 200 files) (226.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:58,819 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-chargemigrationstep_0004.rmap    5.7 K bytes  (75 / 200 files) (227.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:59,063 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_nrm_0002.rmap                      663 bytes  (76 / 200 files) (232.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:59,377 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_mask_0020.rmap                     859 bytes  (77 / 200 files) (233.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:59,618 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_linearity_0022.rmap                961 bytes  (78 / 200 files) (234.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:14:59,867 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_ipc_0007.rmap                      651 bytes  (79 / 200 files) (235.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:00,110 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_gain_0011.rmap                     797 bytes  (80 / 200 files) (236.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:00,371 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_flat_0023.rmap                   5.9 K bytes  (81 / 200 files) (236.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:00,712 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_filteroffset_0010.rmap             853 bytes  (82 / 200 files) (242.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:01,032 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_extract1d_0007.rmap                905 bytes  (83 / 200 files) (243.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:01,275 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_drizpars_0004.rmap                 519 bytes  (84 / 200 files) (244.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:01,520 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_distortion_0025.rmap             3.4 K bytes  (85 / 200 files) (245.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:01,772 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_dark_0031.rmap                   6.8 K bytes  (86 / 200 files) (248.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:02,017 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_area_0014.rmap                   2.7 K bytes  (87 / 200 files) (255.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:02,257 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_apcorr_0010.rmap                 4.3 K bytes  (88 / 200 files) (257.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:02,507 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_abvegaoffset_0004.rmap           1.4 K bytes  (89 / 200 files) (262.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:02,752 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_0261.imap                        5.7 K bytes  (90 / 200 files) (263.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:03,003 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_wfssbkg_0004.rmap                7.2 K bytes  (91 / 200 files) (269.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:03,241 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_wavelengthrange_0010.rmap          996 bytes  (92 / 200 files) (276.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:03,490 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_tsophot_0003.rmap                  896 bytes  (93 / 200 files) (277.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:03,740 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_trappars_0003.rmap               1.6 K bytes  (94 / 200 files) (278.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:03,987 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_trapdensity_0003.rmap            1.6 K bytes  (95 / 200 files) (279.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:04,232 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_superbias_0017.rmap             16.1 K bytes  (96 / 200 files) (281.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:04,705 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_specwcs_0022.rmap                7.1 K bytes  (97 / 200 files) (297.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:04,964 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_saturation_0010.rmap             2.2 K bytes  (98 / 200 files) (304.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:05,325 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_readnoise_0024.rmap             23.1 K bytes  (99 / 200 files) (306.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:05,722 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_psfmask_0008.rmap               28.4 K bytes  (100 / 200 files) (330.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:06,031 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_photom_0028.rmap                 3.4 K bytes  (101 / 200 files) (358.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:06,272 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_persat_0005.rmap                 1.6 K bytes  (102 / 200 files) (361.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:06,590 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-whitelightstep_0003.rmap    1.5 K bytes  (103 / 200 files) (363.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:06,906 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-tweakregstep_0003.rmap      4.5 K bytes  (104 / 200 files) (364.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:07,154 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-spec2pipeline_0008.rmap       984 bytes  (105 / 200 files) (369.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:07,393 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-sourcecatalogstep_0002.rmap    4.6 K bytes  (106 / 200 files) (370.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:07,630 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-resamplestep_0002.rmap        687 bytes  (107 / 200 files) (374.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:07,947 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-outlierdetectionstep_0003.rmap      940 bytes  (108 / 200 files) (375.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:08,196 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-jumpstep_0005.rmap            806 bytes  (109 / 200 files) (376.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:08,456 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-image2pipeline_0003.rmap    1.0 K bytes  (110 / 200 files) (377.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:08,691 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-detector1pipeline_0003.rmap    1.0 K bytes  (111 / 200 files) (378.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:08,933 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-darkpipeline_0002.rmap        868 bytes  (112 / 200 files) (379.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:09,167 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-darkcurrentstep_0001.rmap      618 bytes  (113 / 200 files) (380.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:09,487 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_mask_0011.rmap                   3.5 K bytes  (114 / 200 files) (380.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:09,728 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_linearity_0011.rmap              2.4 K bytes  (115 / 200 files) (384.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:09,969 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_ipc_0003.rmap                    2.0 K bytes  (116 / 200 files) (386.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:10,209 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_gain_0016.rmap                   2.1 K bytes  (117 / 200 files) (388.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:10,450 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_flat_0027.rmap                  51.7 K bytes  (118 / 200 files) (390.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:10,821 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_filteroffset_0004.rmap           1.4 K bytes  (119 / 200 files) (442.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:11,136 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_extract1d_0004.rmap                842 bytes  (120 / 200 files) (443.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:11,377 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_drizpars_0001.rmap                 519 bytes  (121 / 200 files) (444.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:11,615 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_distortion_0033.rmap            53.4 K bytes  (122 / 200 files) (445.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:12,089 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_dark_0044.rmap                  26.3 K bytes  (123 / 200 files) (498.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:12,402 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_area_0012.rmap                  33.5 K bytes  (124 / 200 files) (524.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:12,818 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_apcorr_0008.rmap                 4.3 K bytes  (125 / 200 files) (558.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:13,055 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_abvegaoffset_0003.rmap           1.3 K bytes  (126 / 200 files) (562.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:13,299 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_0295.imap                        5.5 K bytes  (127 / 200 files) (564.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:13,537 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_wavelengthrange_0027.rmap            929 bytes  (128 / 200 files) (569.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:13,785 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_tsophot_0004.rmap                    882 bytes  (129 / 200 files) (570.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:14,026 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_straymask_0009.rmap                  987 bytes  (130 / 200 files) (571.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:14,271 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_specwcs_0042.rmap                  5.8 K bytes  (131 / 200 files) (572.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:14,529 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_saturation_0015.rmap               1.2 K bytes  (132 / 200 files) (578.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:14,772 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_rscd_0008.rmap                     1.0 K bytes  (133 / 200 files) (579.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:15,014 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_resol_0006.rmap                      790 bytes  (134 / 200 files) (580.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:15,256 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_reset_0026.rmap                    3.9 K bytes  (135 / 200 files) (581.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:15,499 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_regions_0033.rmap                  5.2 K bytes  (136 / 200 files) (584.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:15,743 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_readnoise_0023.rmap                1.6 K bytes  (137 / 200 files) (590.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:15,987 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_psfmask_0009.rmap                  2.1 K bytes  (138 / 200 files) (591.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:16,230 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_photom_0056.rmap                   3.7 K bytes  (139 / 200 files) (593.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:16,472 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pathloss_0005.rmap                   866 bytes  (140 / 200 files) (597.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:16,712 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-whitelightstep_0003.rmap        912 bytes  (141 / 200 files) (598.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:16,958 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-tweakregstep_0003.rmap        1.8 K bytes  (142 / 200 files) (599.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:17,275 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-spec3pipeline_0008.rmap         816 bytes  (143 / 200 files) (601.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:17,509 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-spec2pipeline_0012.rmap       1.3 K bytes  (144 / 200 files) (602.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:17,819 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-sourcecatalogstep_0003.rmap    1.9 K bytes  (145 / 200 files) (603.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:18,066 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-resamplestep_0002.rmap          677 bytes  (146 / 200 files) (605.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:18,369 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-resamplespecstep_0002.rmap      706 bytes  (147 / 200 files) (606.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:18,629 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-outlierdetectionstep_0017.rmap    3.4 K bytes  (148 / 200 files) (606.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:18,914 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-jumpstep_0009.rmap            1.4 K bytes  (149 / 200 files) (610.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:19,146 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-image2pipeline_0007.rmap        983 bytes  (150 / 200 files) (611.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:19,386 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-extract1dstep_0002.rmap         728 bytes  (151 / 200 files) (612.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:19,626 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-emicorrstep_0002.rmap           796 bytes  (152 / 200 files) (613.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:19,864 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-detector1pipeline_0009.rmap    1.4 K bytes  (153 / 200 files) (614.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:20,109 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-darkpipeline_0002.rmap          860 bytes  (154 / 200 files) (615.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:20,346 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-darkcurrentstep_0002.rmap       683 bytes  (155 / 200 files) (616.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:20,586 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_mrsxartcorr_0002.rmap              2.2 K bytes  (156 / 200 files) (616.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:20,822 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_mrsptcorr_0005.rmap                2.0 K bytes  (157 / 200 files) (619.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:21,145 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_mask_0023.rmap                     3.5 K bytes  (158 / 200 files) (621.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:21,465 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_linearity_0018.rmap                2.8 K bytes  (159 / 200 files) (624.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:21,784 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_ipc_0008.rmap                        700 bytes  (160 / 200 files) (627.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:22,020 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_gain_0013.rmap                     3.9 K bytes  (161 / 200 files) (628.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:22,312 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_fringefreq_0003.rmap               1.4 K bytes  (162 / 200 files) (632.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:22,550 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_fringe_0019.rmap                   3.9 K bytes  (163 / 200 files) (633.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:22,797 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_flat_0065.rmap                    15.5 K bytes  (164 / 200 files) (637.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:23,113 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_filteroffset_0025.rmap             2.5 K bytes  (165 / 200 files) (652.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:23,351 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_extract1d_0020.rmap                1.4 K bytes  (166 / 200 files) (655.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:23,662 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_emicorr_0003.rmap                    663 bytes  (167 / 200 files) (656.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:23,900 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_drizpars_0002.rmap                   511 bytes  (168 / 200 files) (657.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:24,136 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_distortion_0040.rmap               4.9 K bytes  (169 / 200 files) (657.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:24,376 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_dark_0036.rmap                     4.4 K bytes  (170 / 200 files) (662.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:24,620 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_cubepar_0017.rmap                    800 bytes  (171 / 200 files) (667.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:24,857 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_area_0015.rmap                       866 bytes  (172 / 200 files) (667.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:25,100 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_apcorr_0019.rmap                   5.0 K bytes  (173 / 200 files) (668.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:25,335 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_abvegaoffset_0002.rmap             1.3 K bytes  (174 / 200 files) (673.8 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:25,630 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_0416.imap                          5.7 K bytes  (175 / 200 files) (675.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:25,867 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_trappars_0004.rmap                    903 bytes  (176 / 200 files) (680.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:26,109 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_trapdensity_0006.rmap                 930 bytes  (177 / 200 files) (681.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:26,346 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_superbias_0017.rmap                 3.8 K bytes  (178 / 200 files) (682.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:26,589 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_saturation_0009.rmap                  779 bytes  (179 / 200 files) (686.3 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:26,908 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_readnoise_0011.rmap                 1.3 K bytes  (180 / 200 files) (687.1 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:27,242 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_photom_0014.rmap                    1.1 K bytes  (181 / 200 files) (688.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:27,486 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_persat_0006.rmap                      884 bytes  (182 / 200 files) (689.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:27,730 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-tweakregstep_0002.rmap           850 bytes  (183 / 200 files) (690.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:27,994 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-sourcecatalogstep_0001.rmap      636 bytes  (184 / 200 files) (691.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:28,243 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-outlierdetectionstep_0001.rmap      654 bytes  (185 / 200 files) (691.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:28,487 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-image2pipeline_0005.rmap         974 bytes  (186 / 200 files) (692.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:28,735 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-detector1pipeline_0002.rmap    1.0 K bytes  (187 / 200 files) (693.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:28,974 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-darkpipeline_0002.rmap           856 bytes  (188 / 200 files) (694.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:29,254 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_mask_0023.rmap                      1.1 K bytes  (189 / 200 files) (695.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:29,496 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_linearity_0015.rmap                   925 bytes  (190 / 200 files) (696.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:29,808 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_ipc_0003.rmap                         614 bytes  (191 / 200 files) (697.4 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:30,048 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_gain_0010.rmap                        890 bytes  (192 / 200 files) (698.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:30,289 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_flat_0009.rmap                      1.1 K bytes  (193 / 200 files) (698.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:30,525 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_distortion_0011.rmap                1.2 K bytes  (194 / 200 files) (700.0 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:30,761 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_dark_0017.rmap                      4.3 K bytes  (195 / 200 files) (701.2 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:31,090 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_area_0010.rmap                      1.2 K bytes  (196 / 200 files) (705.5 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:31,372 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_apcorr_0004.rmap                    4.0 K bytes  (197 / 200 files) (706.7 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:31,612 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_abvegaoffset_0002.rmap              1.3 K bytes  (198 / 200 files) (710.6 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:31,854 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_0117.imap                           5.0 K bytes  (199 / 200 files) (711.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:32,101 - CRDS - INFO -  Fetching  mappings/jwst/jwst_1298.pmap                                 580 bytes  (200 / 200 files) (716.9 K / 717.5 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:32,502 - CRDS - INFO -  Fetching  references/jwst/miri/jwst_miri_apcorr_0014.fits           25.9 K bytes  (1 / 1 files) (0 / 25.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:32,890 - stpipe.SourceCatalogStep - INFO - Using APCORR reference file: references/jwst/miri/jwst_miri_apcorr_0014.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:32,899 - CRDS - INFO -  Fetching  references/jwst/miri/jwst_miri_abvegaoffset_0001.asdf      1.7 K bytes  (1 / 1 files) (0 / 1.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:33,140 - stpipe.SourceCatalogStep - INFO - Using ABVEGAOFFSET reference file: references/jwst/miri/jwst_miri_abvegaoffset_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:33,141 - stpipe - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:33,141 - stpipe - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:33,142 - stpipe - INFO - Filter: F560W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:33,142 - stpipe - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       mag        
------------------
19.311847279563832
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 5.20%
</pre></div>
</div>
<img alt="../../../_images/1afc9086d2a5ba18ce26cb5e71786c9a346ca6b2444bbfa802f8b15d1f6395b0.png" src="../../../_images/1afc9086d2a5ba18ce26cb5e71786c9a346ca6b2444bbfa802f8b15d1f6395b0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 84.75482689900014
Starting 2.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.69947281, -69.44357619)&gt;
Setting up sim to match ./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-04-13T03:08:10.578
                        MJD: 59682.13067798611

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/R2022041201-NRCA3_FP1-2.fits
	Date (MJD):	 59681.7791
	Delta time:	 -0.3516 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022041301-NRCA3_FP1-1.fits
	Date (MJD):	 59682.8401
	Delta time:	 0.7094 days
User requested choosing OPD time closest in time to 2022-04-13T03:08:10.578, which is R2022041201-NRCA3_FP1-2.fits, delta time -0.352 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F560W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(187.37414158), array(502.80262111)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.43616932953458, 201.73577860812014)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(184.2927142), array(501.92870851)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.4341768144819, 201.7376011650385)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(140.42082679), array(465.07722232)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.40301794781075, 201.76236638868846)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(137.45242516), array(464.12546009)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.4006941341772, 201.76403586364324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:53,922 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:53,923 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:53,926 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:53,927 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:53,928 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:53,930 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:53,932 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:54,161 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:54,174 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.2
      sharphi: 1.0
      roundlo: -1.0
      roundhi: 1.0
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: INDEF
      nlow: 0
      nhigh: 0
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      allowed_memory: None
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        S8+wK09fvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      allowed_memory: None
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:54,174 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:54,680 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4d958f90&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:54,681 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:55,628 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4d958f90&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:55,629 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:55,838 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4d958f90&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:55,839 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,042 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f3d4d958f90&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,043 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,044 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,044 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,045 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,047 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,047 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,047 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,048 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,050 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,050 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,050 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,051 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,053 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,053 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,053 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,054 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,056 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,056 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,057 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,057 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,058 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11082930390039995 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,150 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:56,675 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:57,440 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:58,207 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:58,971 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1069, 1070)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,624 - stpipe.Image3Pipeline.resample - INFO - Resampling variance components
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,627 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,628 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,628 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,629 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,630 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,630 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,631 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,631 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,632 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,632 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,633 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,634 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:15:59,655 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  80.660247821 -69.452654203 80.735784316 -69.472169218 80.791372770 -69.445623664 80.715879065 -69.426132741
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:00,094 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:00,095 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:00,310 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1069, 1070) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:00,311 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:00,316 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:00,316 - stpipe - INFO - Results used jwst version: 1.16.1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.99883175423715]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:01,720 - stpipe.SourceCatalogStep - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 16.22%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:02,018 - stpipe.SourceCatalogStep - INFO - Using APCORR reference file: references/jwst/miri/jwst_miri_apcorr_0014.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:02,027 - stpipe.SourceCatalogStep - INFO - Using ABVEGAOFFSET reference file: references/jwst/miri/jwst_miri_abvegaoffset_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:02,028 - stpipe - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:02,028 - stpipe - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:02,028 - stpipe - INFO - Filter: F560W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:16:02,029 - stpipe - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       mag        
------------------
18.768115471835262
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 16.22%
</pre></div>
</div>
<img alt="../../../_images/3b2a4580d5a0a2b0b101507f370076bacaa48c7fcc387137ef1139f07f32b022.png" src="../../../_images/3b2a4580d5a0a2b0b101507f370076bacaa48c7fcc387137ef1139f07f32b022.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 28.876734036000016
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lvl2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00002_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00003_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00001_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<p><strong>Important Note</strong>: When not to use. Due to the sensitivity of the space_phot parameters, this tool is not meant to be used for a large sample of stars (i.e., Section 5 below). If a user would like to use space_phot on more than one source, they should carefully construct a table of parameters that are carefully refined for each source.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ra</th>
      <th>dec</th>
      <th>mag</th>
      <th>magerr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80.705198</td>
      <td>-69.437526</td>
      <td>19.515274</td>
      <td>0.003001</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80.699469</td>
      <td>-69.443574</td>
      <td>19.133340</td>
      <td>0.002468</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr style="border:1px solid gray"> </hr><a class="reference internal image-reference" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/MIRI/psf_photometry"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-introduction-a-class-anchor-id-intro-a">1.<font color="white">-</font>Introduction <a class="anchor" id="intro"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a">1.1<font color="white">-</font>Setup WebbPSF and Synphot Directories<a class="anchor" id="webbpsf"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-python-imports-a-class-anchor-id-py-imports-a">1.2<font color="white">-</font>Python Imports<a class="anchor" id="py_imports"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-download-data-a-class-anchor-id-data-a">2.<font color="white">-</font>Download Data<a class="anchor" id="data"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-bright-single-object-a-class-anchor-id-bso-a">3.<font color="white">-</font>Bright, Single Object<a class="anchor" id="bso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a">3.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="bso2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-the-psf-fitting-in-space-phot-br">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a">3.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="bso3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#good-agreement-between-level2-and-level3-results">Good agreement between Level2 and level3 results!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a">4.<font color="white">-</font>Faint/Upper Limit, Single Object<a class="anchor" id="fso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a">4.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="fso2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a">4.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="fso3"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-you-can-go-significantly-deeper-with-the-level3-combined-data-product">Note you can go significantly deeper with the Level3 combined data product</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a">5.<font color="white">-</font>Stellar Field (LMC)<a class="anchor" id="lmc"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired">In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using space_phot on a large number of stars. We suggest that space_phot may be less optimal for large numbers of bright stars. Other programs, such as DOLPHOT or Photutils, may be better suited for this use case. The primary advantage to space_phot is on faint, single sources. But it can be extended to a larger number if desired.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a">5.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="lmc2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed">Now do the same thing for a larger group of stars and test for speed</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a">5.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="lmc3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars">Readers should refer to all diagnostics discussed above. In general, this loop shows the difficulty in doing PSF photometry on a wide variety of stars (brightness, distribution on the detector, etc) without visual inspection. Especially when dealing with low SNR sources.This is true for all photometry packages. Users should inspect the associated metrics and consider optimizing the parameters for specific stars of interest. Nonetheless, the success of the fits can always be quantified in with the associated error bars.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>