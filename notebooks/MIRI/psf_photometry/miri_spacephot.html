

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>MIRI PSF Photometry With Space_Phot &#8212; STScI JDAT Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D46G4HKJY3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D46G4HKJY3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/MIRI/psf_photometry/miri_spacephot';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="STScI JDAT Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="STScI JDAT Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">General</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebook_development_workflow.html">Notebook Development Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/submitting_notebooks.html">Submitting Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/requirements.html">Requirements file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/data_files.html">Data Files</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GitHub Guidelines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_setup.html">GitHub Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_workflow.html">GitHub Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_pr.html">GitHub PR</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cross-Instrument</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/asdf_example/asdf_example.html">ASDF Example</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/background_estimation_imaging/Imaging_Sky_Background_Estimation.html">Complex 2D Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/composite_model_fitting/specfit_demo_3.html">Composite Model Spectral Fitting</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/NIRSpec_MAST_Query/NIRSpec_MAST_Query.html">MAST Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/rgb_imviz/imviz_rgb_carina.html">RGB images with Imviz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/specviz_notebookGUI_interaction/specviz_notebook_gui_interaction_redshift.html">Specviz Simple Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/update_pure_parallel_wcs/NIRISS_correct_pure_parallel_WCS.html">Improving Accuracy of WCS of Pure Parallel Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/stpsf_examples/stpsf_examples.html">STPSF Examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MIRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html">MRS Mstar - Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI_IFU_YSOs_in_the_LMC/isha_nayak_ysos_in_the_lmc.html">IFU of YSOs in LMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI_LRS_spectral_extraction/miri_lrs_advanced_extraction_part1.html">LRS Optimal Spectral Extraction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRCam</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/aperture_photometry/NIRCam_Aperture_Photometry_Example.html">Point Source Aperture Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_photometry/NIRCam_multiband_photometry.html">Extended Aperture Photometry</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html">Cross-Filter PSF Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/psf_photometry/NIRCam_PSF_Photometry_Example.html">PSF Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_wisp_subtraction/nircam_wisp_subtraction.html">NIRCam Wisp Removal</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRISS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/00_Optimal_extraction.html">WFSS Spectra - Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/01_Combine_and_normalize_1D_spectra.html">WFSS Spectra - Combine and Normalize 1D Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/02_Cross_correlation_template.html">WFSS Spectra - Cross-Correlation Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/03_Spatially_resolved_emission_line_map.html">WFSS Spectra - Emission Line Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/00_niriss_mast_query_data_setup.html">NIRISS MAST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/01_niriss_wfss_image2_image3.html">Direct imaging for WFSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/02_niriss_wfss_spec2.html">Spec2 pipeline for WFSS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRSpec</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/IFU_cube_continuum_fit/NGC4151_FeII_ContinuumFit.html">IFU Cube Fitting</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/cube_fitting/cube_fitting.html">IFU Cube Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/ifu_optimal/ifu_optimal.html">IFU Optimal Spectral Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/optimal_extraction/Spectral_Extraction-static.html">MOS Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/mos_spectroscopy_advanced/MOSspec_advanced.html">MOS Spectroscopy of Extragalactic Field</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/transit_spectroscopy_notebook/Exoplanet_Transmission_Spectra_JWST.html">BOTS Time Series Observations</a></li>








<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/galaxy_redshift/redshift_fitting.html">Redshift and Template Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/FS_NSClean_example.html">FS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/IFU_NSClean_example.html">IFU Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/MOS_NSClean_example.html">MOS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/BOTS_NSClean_example.html">BOTS Products with NSClean</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/MIRI/psf_photometry/miri_spacephot.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/MIRI/psf_photometry/miri_spacephot.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MIRI PSF Photometry With Space_Phot</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-introduction-a-class-anchor-id-intro-a">1.<font color="white">-</font>Introduction <a class="anchor" id="intro"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a">1.1<font color="white">-</font>Setup WebbPSF and Synphot Directories<a class="anchor" id="webbpsf"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-python-imports-a-class-anchor-id-py-imports-a">1.2<font color="white">-</font>Python Imports<a class="anchor" id="py_imports"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-download-data-a-class-anchor-id-data-a">2.<font color="white">-</font>Download Data<a class="anchor" id="data"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-bright-single-object-a-class-anchor-id-bso-a">3.<font color="white">-</font>Bright, Single Object<a class="anchor" id="bso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a">3.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="bso2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-the-psf-fitting-in-space-phot-br">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a">3.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="bso3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#good-agreement-between-level2-and-level3-results">Good agreement between Level2 and level3 results!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a">4.<font color="white">-</font>Faint/Upper Limit, Single Object<a class="anchor" id="fso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a">4.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="fso2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a">4.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="fso3"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-you-can-go-significantly-deeper-with-the-level3-combined-data-product">Note you can go significantly deeper with the Level3 combined data product</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a">5.<font color="white">-</font>Stellar Field (LMC)<a class="anchor" id="lmc"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired">In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using space_phot on a large number of stars. We suggest that space_phot may be less optimal for large numbers of bright stars. Other programs, such as DOLPHOT or Photutils, may be better suited for this use case. The primary advantage to space_phot is on faint, single sources. But it can be extended to a larger number if desired.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a">5.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="lmc2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed">Now do the same thing for a larger group of stars and test for speed</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a">5.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="lmc3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars">Readers should refer to all diagnostics discussed above. In general, this loop shows the difficulty in doing PSF photometry on a wide variety of stars (brightness, distribution on the detector, etc) without visual inspection. Especially when dealing with low SNR sources.This is true for all photometry packages. Users should inspect the associated metrics and consider optimizing the parameters for specific stars of interest. Nonetheless, the success of the fits can always be quantified in with the associated error bars.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="miri-psf-photometry-with-space-phot">
<h1>MIRI PSF Photometry With Space_Phot<a class="headerlink" href="#miri-psf-photometry-with-space-phot" title="Permalink to this heading">#</a></h1>
<p><strong>Author</strong>: Ori Fox<br></p>
<p><strong>Submitted</strong>: August, 2023<br>
<strong>Updated</strong>: November, 2023<br></p>
<p><strong>Use case</strong>: PSF Photometry on Level3 data using dedicated package Space_Phot (https://github.com/jpierel14/space_phot). Space_phot is built on Astropy’s Photutils package. Unlike photutils, space_phot can be used on Level3 data. This is because has built in functionality that can generate a resampled Level3 PSF at a given detector position. Such use cases are particularly useful for faint, point source targets or deep upper limits where observers need to take advantage of the combined image stack. For a large number of bright sources, users may find space_phot to be too slow and should consider other packages, such as DOLPHOT and/or Photutils. <strong>NOTE:</strong> A companion notebook exists that illustrates how to use Photutils for the same Level2 data set.<br>
<strong>Important Note</strong>: When not to use. Due to the sensitivity of the space_phot parameters, this tool is not meant to be used for a large sample of stars (i.e., Section 5 below). If a user would like to use space_phot on more than one source, they should carefully construct a table of parameters that are carefully refined for each source.
<strong>Data</strong>: MIRI Data PID 1028 (Calibration Program; Single Star Visit 006 A5V dwarf 2MASSJ17430448+6655015) and MIRI Data PID 1171 (LMC; Multiple Stars).<br>
<strong>Tools</strong>: photutils, space_phot drizzlepac, jupyter <br>
<strong>Cross-Instrument</strong>: NIRCam, MIRI.<br>
<strong>Documentation</strong>: This notebook is part of a STScI’s larger post-pipeline Data Analysis Tools Ecosystem and can be downloaded directly from the JDAT Notebook Github directory.<br>
<strong>Pipeline Version</strong>: JWST Pipeline<br></p>
<section id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><span class="xref myst">Introduction</span><br>
1.1 <span class="xref myst">Setup</span><br>
1.2 <span class="xref myst">Python imports</span><br></p></li>
<li><p><span class="xref myst">Download Data</span><br></p></li>
<li><p><span class="xref myst">Bright, Single Object</span><br>
3.1 <span class="xref myst">Multiple, Level2 Files</span><br>
3.2 <span class="xref myst">Single, Level3 Mosaicked File</span><br></p></li>
<li><p><span class="xref myst">Faint/Upper Limit, Single Object</span><br>
4.1 <span class="xref myst">Multiple, Level2 Files</span><br>
4.2 <span class="xref myst">Single, Level3 Mosaicked File</span><br></p></li>
<li><p><span class="xref myst">Stellar Field (LMC)</span><br>
5.1 <span class="xref myst">Multiple, Level2 Files</span><br>
5.2 <span class="xref myst">Single, Level3 Mosaicked File</span><br></p></li>
</ol>
</section>
<section id="font-color-white-font-introduction-a-class-anchor-id-intro-a">
<h2>1.<font color='white'>-</font>Introduction <a class="anchor" id="intro"></a><a class="headerlink" href="#font-color-white-font-introduction-a-class-anchor-id-intro-a" title="Permalink to this heading">#</a></h2>
<p>GOALS:<br></p>
<p>PSF Photometry can be obtained using:<br></p>
<ul class="simple">
<li><p>grid of PSF models from WebbPSF<br></p></li>
<li><p>single effective PSF (ePSF) NOT YET AVAILABLE<br></p></li>
<li><p>grid of effective PSF NOT YET AVAILABLE<br></p></li>
</ul>
<p>The notebook shows:<br></p>
<ul class="simple">
<li><p>how to obtain the PSF model from WebbPSF (or build an ePSF)<br></p></li>
<li><p>how to perform PSF photometry on the image<br></p></li>
</ul>
<p><strong>Data</strong>:<br></p>
<p>MIRI Data PID 1028 (Calibration Program), F770W <br>
MIRI Data PID 1171 (LMC), F560W/F770W</p>
<section id="font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a">
<h3>1.1<font color='white'>-</font>Setup WebbPSF and Synphot Directories<a class="anchor" id="webbpsf"></a><a class="headerlink" href="#font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">space_phot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">importlib.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">version</span>
<span class="n">version</span><span class="p">(</span><span class="s1">&#39;space_phot&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following task in the stsci.skypac package can be run with TEAL:
                                    skymatch                                    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following tasks in the drizzlepac package can be run with TEAL:
    astrodrizzle       config_testbed      imagefindpars           mapreg       
       photeq            pixreplace           pixtopix            pixtosky      
  refimagefindpars       resetbits          runastrodriz          skytopix      
     tweakback            tweakreg           updatenpol
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Important:  Gaia archive will be intermittently unavailable due to scheduled maintenance on 13-01-2025 from 08:00 to 18:00 (CET)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0.2.5&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tarfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">urlparse</span>

<span class="c1"># Set environmental variables</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;WEBBPSF_PATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./webbpsf-data/webbpsf-data&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PYSYN_CDBS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./grp/redcat/trds/&quot;</span>

<span class="c1"># WEBBPSF Data</span>
<span class="n">boxlink</span> <span class="o">=</span> <span class="s1">&#39;https://stsci.box.com/shared/static/qxpiaxsjwo15ml6m4pkhtk36c9jgj70k.gz&#39;</span>                                                           
<span class="n">boxfile</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data/webbpsf-data-1.0.0.tar.gz&#39;</span>
<span class="n">synphot_url</span> <span class="o">=</span> <span class="s1">&#39;http://ssb.stsci.edu/trds/tarfiles/synphot5.tar.gz&#39;</span>
<span class="n">synphot_file</span> <span class="o">=</span> <span class="s1">&#39;./synphot5.tar.gz&#39;</span>

<span class="n">webbpsf_folder</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data&#39;</span>
<span class="n">synphot_folder</span> <span class="o">=</span> <span class="s1">&#39;./grp&#39;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s2">&quot;https&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported URL scheme: </span><span class="si">{</span><span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dest_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>


<span class="c1"># Gather webbpsf files</span>
<span class="n">psfExist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">psfExist</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
    <span class="n">download_file</span><span class="p">(</span><span class="n">boxlink</span><span class="p">,</span> <span class="n">boxfile</span><span class="p">)</span>
    <span class="n">gzf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">boxfile</span><span class="p">)</span>
    <span class="n">gzf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>

<span class="c1"># Gather synphot files</span>
<span class="n">synExist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">synphot_folder</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">synExist</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">synphot_folder</span><span class="p">)</span>
    <span class="n">download_file</span><span class="p">(</span><span class="n">synphot_url</span><span class="p">,</span> <span class="n">synphot_file</span><span class="p">)</span>
    <span class="n">gzf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">synphot_file</span><span class="p">)</span>
    <span class="n">gzf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-white-font-python-imports-a-class-anchor-id-py-imports-a">
<h3>1.2<font color='white'>-</font>Python Imports<a class="anchor" id="py_imports"></a><a class="headerlink" href="#font-color-white-font-python-imports-a-class-anchor-id-py-imports-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">QTable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.nddata</span><span class="w"> </span><span class="kn">import</span> <span class="n">extract_array</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy</span><span class="w"> </span><span class="kn">import</span> <span class="n">wcs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.wcs.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">skycoord_to_pixel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy</span><span class="w"> </span><span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">simple_norm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">importlib.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">version</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># JWST models</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.datamodels</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageModel</span>

<span class="c1"># Background and PSF Functions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">photutils.background</span><span class="w"> </span><span class="kn">import</span> <span class="n">MMMBackground</span><span class="p">,</span> <span class="n">MADStdBackgroundRMS</span><span class="p">,</span> <span class="n">LocalBackground</span>

<span class="c1"># Photutils library and tools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">photutils.aperture</span><span class="w"> </span><span class="kn">import</span> <span class="n">CircularAperture</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">photutils.detection</span><span class="w"> </span><span class="kn">import</span> <span class="n">DAOStarFinder</span>

<span class="c1"># set up crds if necessary</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">crds</span><span class="w"> </span><span class="kn">import</span> <span class="n">client</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CRDS_PATH&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">set_crds_server</span><span class="p">(</span><span class="s1">&#39;https://jwst-crds.stsci.edu&#39;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CRDS_SERVER_URL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://jwst-crds.stsci.edu&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CRDS_PATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="font-color-white-font-download-data-a-class-anchor-id-data-a">
<h2>2.<font color='white'>-</font>Download Data<a class="anchor" id="data"></a><a class="headerlink" href="#font-color-white-font-download-data-a-class-anchor-id-data-a" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query the MAST (Mikulski Archive for Space Telescopes) database for observations</span>
<span class="c1"># with proposal ID 1028 and a specific filter &#39;F770W&#39;</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">proposal_id</span><span class="o">=</span><span class="mi">1028</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F770W&#39;</span><span class="p">])</span>

<span class="c1"># Get a list of products associated with the located observation</span>
<span class="n">plist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="c1"># Filter the product list to include only specific product subgroups: &#39;RATE&#39;, &#39;CAL&#39;, &#39;I2D&#39;, and &#39;ASN&#39;</span>
<span class="n">fplist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CAL&#39;</span><span class="p">,</span> <span class="s1">&#39;I2D&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">])</span>

<span class="c1"># Download the selected products from the MAST database (UNCOMMENT TO DOWNLOAD)</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">fplist</span><span class="p">)</span>

<span class="c1"># Define source and destination directories</span>
<span class="n">source_dir</span> <span class="o">=</span> <span class="s1">&#39;mastDownload/JWST/&#39;</span>
<span class="n">destination_dir</span> <span class="o">=</span> <span class="s1">&#39;mast/01028/&#39;</span>

<span class="c1"># Create the destination directory if it doesn&#39;t exist</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>

<span class="c1"># Use glob to find all files matching the pattern &#39;mastDownload/JWST/j*/jw01537*cal.fits&#39;</span>
<span class="n">files_to_copy</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span> <span class="s1">&#39;j*/jw01028*&#39;</span><span class="p">))</span>

<span class="c1"># Copy the matching files to the destination directory</span>
<span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">files_to_copy</span><span class="p">:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241218t003622_image2_00013_asn.json to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028-o006_20241218t003622_image2_00013_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241218t003622_image2_00014_asn.json to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028-o006_20241218t003622_image2_00014_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241218t003622_image2_00015_asn.json to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028-o006_20241218t003622_image2_00015_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241218t003622_image2_00016_asn.json to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028-o006_20241218t003622_image2_00016_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241218t003622_image3_00004_asn.json to ./mastDownload/JWST/jw01028-o006_t001_miri_f770w/jw01028-o006_20241218t003622_image3_00004_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01028-o006_t001_miri_f770w/jw01028-o006_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028006001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028006001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028006001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028006001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028006001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028006001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028006001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028006001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Query the MAST (Mikulski Archive for Space Telescopes) database for observations</span>
<span class="c1"># with proposal ID 1171 and a specific filters &#39;F550W&#39; and &#39;F770W&#39;</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">proposal_id</span><span class="o">=</span><span class="mi">1171</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F560W&#39;</span><span class="p">,</span> <span class="s1">&#39;F770W&#39;</span><span class="p">])</span>

<span class="c1"># Get a list of products associated with the located observation</span>
<span class="n">plist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="c1"># Filter the product list to include only specific product subgroups: &#39;RATE&#39;, &#39;CAL&#39;, &#39;I2D&#39;, and &#39;ASN&#39;</span>
<span class="n">fplist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CAL&#39;</span><span class="p">,</span> <span class="s1">&#39;I2D&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">])</span>

<span class="c1"># Download the selected products from the MAST database (UNCOMMENT TO DOWNLOAD)</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">fplist</span><span class="p">)</span>

<span class="c1"># Define source and destination directories</span>
<span class="n">source_dir</span> <span class="o">=</span> <span class="s1">&#39;mastDownload/JWST/&#39;</span>
<span class="n">destination_dir</span> <span class="o">=</span> <span class="s1">&#39;mast/01171/&#39;</span>

<span class="c1"># Create the destination directory if it doesn&#39;t exist</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>

<span class="c1"># Use glob to find all files matching the pattern &#39;mastDownload/JWST/j*/jw01537*cal.fits&#39;</span>
<span class="n">files_to_copy</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span> <span class="s1">&#39;j*/jw01171*&#39;</span><span class="p">))</span>

<span class="c1"># Copy the matching files to the destination directory</span>
<span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">files_to_copy</span><span class="p">:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171-o001_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171-o001_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171-o001_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171-o001_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o001_t001_miri_f770w/jw01171-o001_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o001_t001_miri_f770w/jw01171-o001_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171-o002_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171-o002_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171-o002_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171-o002_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o002_t001_miri_f770w/jw01171-o002_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o002_t001_miri_f770w/jw01171-o002_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171-o003_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171-o003_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171-o003_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171-o003_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o003_t001_miri_f770w/jw01171-o003_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o003_t001_miri_f770w/jw01171-o003_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171-o004_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171-o004_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171-o004_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171-o004_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o004_t001_miri_f560w/jw01171-o004_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_t001_miri_f560w_i2d.fits to ./mastDownload/JWST/jw01171-o004_t001_miri_f560w/jw01171-o004_t001_miri_f560w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171-o005_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171-o005_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171-o005_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171-o005_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o005_t001_miri_f770w/jw01171-o005_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o005_t001_miri_f770w/jw01171-o005_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171001001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171001001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171001001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171001001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171001001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171001001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171001001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171001001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171002001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171002001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171002001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171002001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171002001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171002001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171002001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171002001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171003001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171003001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171003001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171003001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171003001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171003001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171003001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171003001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171004001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171004001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171004001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171004001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171004001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171004001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171004001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171004001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171005001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171005001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171005001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171005001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171005001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171005001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171005001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171005001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-white-font-bright-single-object-a-class-anchor-id-bso-a">
<h2>3.<font color='white'>-</font>Bright, Single Object<a class="anchor" id="bso"></a><a class="headerlink" href="#font-color-white-font-bright-single-object-a-class-anchor-id-bso-a" title="Permalink to this heading">#</a></h2>
<p>The purpose of this section is to illustrate how to perform PSF photometry on a single, bright object. While aperture photometry is feasible in isolated cases, the user may find PSF photometry preferable in crowded fields or complicated backgrounds.</p>
<section id="font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a">
<h3>3.1<font color='white'>-</font>Multiple, Level2 Files<a class="anchor" id="bso2"></a><a class="headerlink" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a" title="Permalink to this heading">#</a></h3>
<p>Generally, PSF photometry for data from a space telescope is most accurately performed on pre-mosaiced data. In the case of HST, that corresponds to FLT files rather than DRZ. And in the case of JWST, this corresponds to Level2 files rather than Level3. The reason is that a mosaiced PSF changes the inherent PSF as a function of position on the detector so that there is no adequate model (theoretical or empirical) to use.<br></p>
<p>In this example, we aim to fit a source simultaneously across multiple Level 2 images. A more basic approach would be to fit each Level 2 file individually and then average together the measured fluxes. However, this approach more easily corrects for bad pixels or cosmic rays that are only in one image and allows for a more accurate photometric solution by reducing the number of free parameters per source.<br></p>
<p>Useful references:<br>
HST Documentation on PSF Photometry: https://www.stsci.edu/hst/instrumentation/wfc3/data-analysis/psf<br>
WFPC2 Stellar Photometry with HSTPHOT: https://ui.adsabs.harvard.edu/abs/2000PASP..112.1383D/abstract<br>
Space-Phot Documentation on Level2 Fitting: https://space-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define Level 3 File</span>
<span class="n">lvl3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;./mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;</span><span class="p">]</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Level 2 Data List from ASN files</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;./mast/01028/&quot;</span>
<span class="n">asn</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="s1">&#39;jw01028-o006_*_image3_00004_asn.json&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">lvl2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fi</span><span class="p">:</span>
        <span class="c1">#print(ln)</span>
        <span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;                    &quot;expname&quot;:&#39;</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="n">lvl2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00002_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00003_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00004_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (Before DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/8c929706df395e7b45523f00fa2903e328119e36d5153e238709db259863faa0.png" src="../../../_images/8c929706df395e7b45523f00fa2903e328119e36d5153e238709db259863faa0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (Before DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/35e9aa386705b6df0b32a0c83476bf6af407c14ed0f03075ec74248980bf2135.png" src="../../../_images/35e9aa386705b6df0b32a0c83476bf6af407c14ed0f03075ec74248980bf2135.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>

<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">dq</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>

<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;update&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="s1">&#39;DQ&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">hdul</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">hdul</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (After DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/8c929706df395e7b45523f00fa2903e328119e36d5153e238709db259863faa0.png" src="../../../_images/8c929706df395e7b45523f00fa2903e328119e36d5153e238709db259863faa0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zoom in to see the source. In this case, our source is from MIRI Program ID #1028, a Calibration Program.</span>
<span class="c1"># We are using Visit 006, which targets the A5V dwarf 2MASSJ17430448+6655015</span>
<span class="c1"># Reference Link: http://simbad.cds.unistra.fr/simbad/sim-basic?Ident=2MASSJ17430448%2B6655015&amp;submit=SIMBAD+search</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.3</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a4f63e1bba27f8acbd2b62baddaf0b873cbdd69fd742acad77d3faa1be4fee6a.png" src="../../../_images/a4f63e1bba27f8acbd2b62baddaf0b873cbdd69fd742acad77d3faa1be4fee6a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (After DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/35e9aa386705b6df0b32a0c83476bf6af407c14ed0f03075ec74248980bf2135.png" src="../../../_images/35e9aa386705b6df0b32a0c83476bf6af407c14ed0f03075ec74248980bf2135.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zoom in to see the source</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">ref_fits</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ref_fits</span><span class="p">))</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0d2ef548fdb14702ae10c29f0a3da4e6a3fbbd4da5450c47e794e03d078feb34.png" src="../../../_images/0d2ef548fdb14702ae10c29f0a3da4e6a3fbbd4da5450c47e794e03d078feb34.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the PSF from WebbPSF using defaults.</span>
<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">psfs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/O2022052501-NRCA3_FP1-59.fits to ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.58446788), array(691.01192923)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51240355224516, 121.46005973914637)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.0823346), array(703.49975178)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51086191643049, 121.4622239877099)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(507.07857065), array(701.00356235)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51028045414718, 121.46207330662133)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(502.58093657), array(694.50845109)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51039393601155, 121.46118840344465)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="mi">122</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/f6097ef2a2a175cfd6ac1c8971aa9286ec3eb54dd26221f65a80e2e4867872d8.png" src="../../../_images/f6097ef2a2a175cfd6ac1c8971aa9286ec3eb54dd26221f65a80e2e4867872d8.png" />
</div>
</div>
<section id="notes-on-the-psf-fitting-in-space-phot-br">
<h4>Notes on the PSF Fitting in Space_Phot: <br><a class="headerlink" href="#notes-on-the-psf-fitting-in-space-phot-br" title="Permalink to this heading">#</a></h4>
<p>https://st-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images
As noted above, improved documentation will be coming. For now, here are some important points to consider.</p>
<p>All fitting is performed with Astropy’s Photutils. As with any photometry program, the printed statistical errors are good indicators of your success.</p>
<p>There are different fitting techniques, but when the fit_flux parameter is set to ‘single’, the source is fit simultaneously in all Level2 images. There is good reason for this outlined in a paper for PSF fitting in Hubble: https://iopscience.iop.org/article/10.1086/316630/pdf</p>
<p>As a result, the flux and corresponding error take into account a single overall fit. As part of this, the fitting therefore assumes a constant zero point across all images. While this is not exactly true, it is typically true to within 1% and good enough for our purposes. Users can alternatively fit with the fit_flux parameter set to ‘multi’, which treats each image independently. The final flux must therefore be averaged.</p>
<p>When you run space_phot, you will see some additional diagnositics displayed in the cell. At the top, the % value printed is the fraction of flux remaining in the residual and can be considered a good indicator of a successful model and subtraction. Next are three columns displaying the original, the model, and the residual, respectively, for each Level2 image. Finally, there are corner plots suggesting the success of the fits (more documentation and explanation of these plots is coming).</p>
<p>In this case, you will notice a systematic trend in the residuals. The PSF is oversubtracted in the centermost pixel and undersubtracted in the wings. The cause is unknown. It may be due to a poor PSF model. The user should consider generating more complex PSF models, but that is beyond the scope of this notebook. Nonetheless, the residual value is pretty good so the overall statistical error is relatively small.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do PSF Photometry using space_phot (details of fitting are in documentation)</span>
<span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psfs</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">],</span>
        <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;pixel&#39;</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span>
<span class="p">)</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.51%
</pre></div>
</div>
<img alt="../../../_images/dfb6a4e45c482d5afc6038733db4ae133698450c98df4f7ed0a91c08e7bcbe82.png" src="../../../_images/dfb6a4e45c482d5afc6038733db4ae133698450c98df4f7ed0a91c08e7bcbe82.png" />
<img alt="../../../_images/4857b01eb47eeedf0f9da9f304bcb5b25cab1f550dcce218b06300b6c4d657bc.png" src="../../../_images/4857b01eb47eeedf0f9da9f304bcb5b25cab1f550dcce218b06300b6c4d657bc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        ra         ...                     exp                    
------------------ ... -------------------------------------------
 265.7686991559444 ... jw01028006001_02101_00001_mirimage_cal.fits
 265.7686999588531 ... jw01028006001_02101_00002_mirimage_cal.fits
 265.7686990312867 ... jw01028006001_02101_00003_mirimage_cal.fits
265.76869931148275 ... jw01028006001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=4</i>
<table id="table140062271232528" class="table-striped table-bordered table-condensed">
<thead><tr><th>ra</th><th>ra_err</th><th>dec</th><th>dec_err</th><th>x</th><th>x_err</th><th>y</th><th>y_err</th><th>mjd</th><th>flux</th><th>fluxerr</th><th>filter</th><th>zp</th><th>mag</th><th>magerr</th><th>zpsys</th><th>exp</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str5</th><th>float64</th><th>float64</th><th>float64</th><th>str2</th><th>str43</th></tr></thead>
<tr><td>265.7686991559444</td><td>3.1241143005900085e-08</td><td>66.91716542920074</td><td>4.162468769663974e-08</td><td>512.919244347726</td><td>0.0010226770715574067</td><td>691.1789740231504</td><td>0.0009760946639510447</td><td>59724.05148232454</td><td>4.537271336167723e-10</td><td>2.989424475130163e-13</td><td>F770W</td><td>-6.100000000000001</td><td>17.258013121111567</td><td>0.0007151120958339277</td><td>ab</td><td>jw01028006001_02101_00001_mirimage_cal.fits</td></tr>
<tr><td>265.7686999588531</td><td>3.399617298782687e-08</td><td>66.91716487070961</td><td>4.5034681761535467e-08</td><td>512.4286854087615</td><td>0.0011055690787384429</td><td>703.6843131846852</td><td>0.0010584711910781325</td><td>59724.05578601667</td><td>4.5372713299439054e-10</td><td>2.989424471029542e-13</td><td>F770W</td><td>-6.100000000000001</td><td>17.258013122600882</td><td>0.0007151120958339277</td><td>ab</td><td>jw01028006001_02101_00002_mirimage_cal.fits</td></tr>
<tr><td>265.7686990312867</td><td>2.884814875869779e-08</td><td>66.91716518229684</td><td>4.469873715606809e-08</td><td>507.42121729130383</td><td>0.0011252317151281704</td><td>701.1729103690392</td><td>0.0009948775076990349</td><td>59724.06012231296</td><td>4.5372713307596254e-10</td><td>2.989424471566986e-13</td><td>F770W</td><td>-6.100000000000001</td><td>17.258013122405686</td><td>0.0007151120958339277</td><td>ab</td><td>jw01028006001_02101_00003_mirimage_cal.fits</td></tr>
<tr><td>265.76869931148275</td><td>3.3841274671431165e-08</td><td>66.91716489290384</td><td>4.382710017125646e-08</td><td>502.93030863547654</td><td>0.0010714005564448645</td><td>694.6852510573464</td><td>0.0010383637427291384</td><td>59724.064394164816</td><td>4.53727133349902e-10</td><td>2.989424473371863e-13</td><td>F770W</td><td>-6.100000000000001</td><td>17.258013121750167</td><td>0.0007151120958339277</td><td>ab</td><td>jw01028006001_02101_00004_mirimage_cal.fits</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As noted above, As a result, the flux and corresponding error take into account a single overall fit. </span>
<span class="c1"># Therefore, there is no need to average the resulting magnitudes or errors. They should all be the same to within their individual zero-point differences (typically &lt;1%).</span>
<span class="n">mag_lvl2_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span>
<span class="n">magerr_lvl2_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">]</span>

<span class="c1"># Print Magnitude from Table</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mag_lvl2_arr</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">magerr_lvl2_arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       mag        
------------------
17.258013121111567
17.258013122600882
17.258013122405686
17.258013121750167 

         magerr       
---------------------
0.0007151120958339277
0.0007151120958339277
0.0007151120958339277
0.0007151120958339277
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jwst_obs_fast</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centers</span> <span class="o">=</span> <span class="p">[</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">]</span>
<span class="n">jwst_obs_fast</span><span class="o">.</span><span class="n">fast_psf</span><span class="p">(</span><span class="n">psfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=1</i>
<table id="table140060302217424" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>group_id</th><th>local_bkg</th><th>x_init</th><th>y_init</th><th>flux_init</th><th>x_fit</th><th>y_fit</th><th>flux_fit</th><th>x_err</th><th>y_err</th><th>flux_err</th><th>npixfit</th><th>group_size</th><th>qfit</th><th>cfit</th><th>flags</th><th>flux</th><th>fluxerr</th><th>mag</th><th>magerr</th><th>zp</th></tr></thead>
<thead><tr><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1</td><td>1</td><td>0.0</td><td>691.0119292269617</td><td>512.5844678797273</td><td>1668.2629074618387</td><td>691.1736423963373</td><td>512.9081319598845</td><td>1861.7546481804886</td><td>0.0008250237966256781</td><td>0.0008332862486822053</td><td>1.7352060017478144</td><td>25</td><td>1</td><td>0.4383646707471222</td><td>-0.02855987894870955</td><td>0</td><td>5.342907155405971e-10</td><td>4.979734881769984e-13</td><td>17.080555931398994</td><td>0.0010114644093129814</td><td>-6.100000000000001</td></tr>
</table></div></div></div>
</div>
</section>
</section>
<section id="font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a">
<h3>3.2<font color='white'>-</font>Single, Level3 Mosaicked File<a class="anchor" id="bso3"></a><a class="headerlink" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a" title="Permalink to this heading">#</a></h3>
<p>Despite the above discussion on performing PSF photometry on the pre-mosaiced data products, space_phot has the functionality to create a mosaiced Level3 PSF at a given single position on the detector based on the Level2 images. The advantage to this is the ability to perform PSF photometry on the deep, stacked data in cases where faint sources are expected to have prohibitively low signal-to-noise in Level2 data. The disadvantage is the amount of time required to make mosaiced Level3 PSF, so that this method is most useful when dealing with a small number of low signal-to-noise sources.<br></p>
<p>Useful references:<br>
Space-Phot Documentation on Level3 Fitting: https://space-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#level-3-psf<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level3 data file the same as above</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/238d96cd2e110c16a037d5f424562b8fa01b02f2666c22603a66ac5152c3640f.png" src="../../../_images/238d96cd2e110c16a037d5f424562b8fa01b02f2666c22603a66ac5152c3640f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>

<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/c47c8e0b3fd85fea889e6c5ea689f1ff907922c18046be70c9384638964f258f.png" src="../../../_images/c47c8e0b3fd85fea889e6c5ea689f1ff907922c18046be70c9384638964f258f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/60eb7ff8404f2ffcb806499a759af01afe6a4ec2eece35479ffd1cfaaed63a0b.png" src="../../../_images/60eb7ff8404f2ffcb806499a759af01afe6a4ec2eece35479ffd1cfaaed63a0b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function get_jwst_psf is a space_phot wrapper for the WebbPSF calc_psf function and uses a lot of the same keywords.</span>
<span class="c1"># There are more advanced methods for generating your WebbPSF, but those are beyond the scope of this notebook.</span>
<span class="c1"># The defaults used by get_jwst_psf in this notebook are:</span>
<span class="c1"># oversample=4</span>
<span class="c1"># normalize=&#39;last&#39;</span>
<span class="c1"># Non-distorted PSF</span>
<span class="c1"># Useful reference: https://webbpsf.readthedocs.io/en/latest/api/webbpsf.JWInstrument.html#webbpsf.JWInstrument.calc_psf</span>

<span class="c1"># Get PSF from WebbPSF</span>
<span class="n">jwst3_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation3</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">psf3</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst3_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">jwst3_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.58446788), array(691.01192923)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.5124035522455, 201.4600597391466)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(512.0823346), array(703.49975178)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51086191643108, 201.4622239877097)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(507.07857065), array(701.00356235)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51028045414768, 201.46207330662145)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(502.58093657), array(694.50845109)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.5103939360115, 201.46118840344508)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:32,956 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:32,957 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:32,960 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:32,961 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:32,962 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:32,964 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:32,965 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:33,280 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:33,294 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.5
      sharphi: 2.0
      roundlo: 0.0
      roundhi: 0.2
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        pt2dQvpkvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:33,295 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:33,725 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f625418e310&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:33,726 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,539 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f625418e310&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,540 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,690 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f625418e310&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,690 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,836 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f625418e310&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,837 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,838 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,838 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,839 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,841 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,841 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,842 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,842 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,844 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,844 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,845 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,846 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,847 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,848 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,848 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,848 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,850 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,850 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,851 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,851 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,852 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11091579557784445 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:34,870 - stpipe.Image3Pipeline.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:35,649 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:35,650 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:35,651 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:36,395 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:36,396 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:36,397 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:37,138 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:37,139 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:37,140 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:37,884 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:37,886 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:37,886 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:38,128 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  265.737953477 66.940980694 265.701111178 66.912738191 265.773940695 66.898122976 265.810845165 66.926348568
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:38,427 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:38,428 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:38,580 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1030, 1042) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:38,581 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:38,585 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:33:38,585 - stpipe - INFO - Results used jwst version: 1.17.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psf3</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model (Mosaiced)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/abff0598b13ebe24bc877da7f26fce3b0dd5d92500a148f55f439a3c58d9ea57.png" src="../../../_images/abff0598b13ebe24bc877da7f26fce3b0dd5d92500a148f55f439a3c58d9ea57.png" />
</div>
</div>
<section id="id1">
<h4>Notes on the PSF Fitting in Space_Phot: <br><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<p>https://st-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images
As noted above, improved documentation will be coming. For now, here are some important points to consider.
See detailed notes in Section 3.1 above about the fitting process and diagnostics</p>
<p>In addition, consider here that jwst3_obs is generating a Level3 PSF by using the JWST pipeline to resample and combine multiple Level2 PSFs. The Level2 PSFs are generated at the precise location of the source in each Level2 file to account for detector level effects. The resampling uses default resampling paramters. However, users should be aware that if they performed customized resampling for their Level2 data products, they should use similar resampling steps for their PSF below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do PSF Photometry using space_phot (details of fitting are in documentation)</span>
<span class="c1"># See detailed notes in Section 3.1 above about the fitting process and diagnostics</span>
<span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psf3</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">],</span>
        <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.60%
</pre></div>
</div>
<img alt="../../../_images/dfb6a4e45c482d5afc6038733db4ae133698450c98df4f7ed0a91c08e7bcbe82.png" src="../../../_images/dfb6a4e45c482d5afc6038733db4ae133698450c98df4f7ed0a91c08e7bcbe82.png" />
<img alt="../../../_images/4857b01eb47eeedf0f9da9f304bcb5b25cab1f550dcce218b06300b6c4d657bc.png" src="../../../_images/4857b01eb47eeedf0f9da9f304bcb5b25cab1f550dcce218b06300b6c4d657bc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mag_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">magerr_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mag_lvl2_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">magerr_lvl2_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mag_lvl3psf</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">magerr_lvl3psf</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17.258 0.0007
17.28638 0.00069
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="good-agreement-between-level2-and-level3-results">
<h2>Good agreement between Level2 and level3 results!<a class="headerlink" href="#good-agreement-between-level2-and-level3-results" title="Permalink to this heading">#</a></h2>
</section>
<section id="font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a">
<h2>4.<font color='white'>-</font>Faint/Upper Limit, Single Object<a class="anchor" id="fso"></a><a class="headerlink" href="#font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a" title="Permalink to this heading">#</a></h2>
<p>The purpose of this section is to illustrate how to calculate an upper limit using PSF photometry a blank part of the sky.</p>
<section id="font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a">
<h3>4.1<font color='white'>-</font>Multiple, Level2 Files<a class="anchor" id="fso2"></a><a class="headerlink" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level 3 Files</span>
<span class="n">lvl3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;</span><span class="p">]</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Level 2 Data List from ASN files</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;./mast/01028/&quot;</span>
<span class="n">asn</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="s1">&#39;jw01028-o006_*_image3_00004_asn.json&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">lvl2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">fi</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;                    &quot;expname&quot;:&#39;</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="n">lvl2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00002_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00003_mirimage_cal.fits&#39;, &#39;./mast/01028/jw01028006001_02101_00004_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>

<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">dq</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image (After DQ Flags Set)</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/8c929706df395e7b45523f00fa2903e328119e36d5153e238709db259863faa0.png" src="../../../_images/8c929706df395e7b45523f00fa2903e328119e36d5153e238709db259863faa0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fed1196581356b374786a0bfcfb9d177ec9e9848878830ac6d9cef377651d898.png" src="../../../_images/fed1196581356b374786a0bfcfb9d177ec9e9848878830ac6d9cef377651d898.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the First Image</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<img alt="../../../_images/35e9aa386705b6df0b32a0c83476bf6af407c14ed0f03075ec74248980bf2135.png" src="../../../_images/35e9aa386705b6df0b32a0c83476bf6af407c14ed0f03075ec74248980bf2135.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">ref_fits</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ref_fits</span><span class="p">))</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/1fdc243a3e6725466467246781b148b5c5cbe5825cedfc53c713241432354bad.png" src="../../../_images/1fdc243a3e6725466467246781b148b5c5cbe5825cedfc53c713241432354bad.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function get_jwst_psf is a space_phot wrapper for the WebbPSF calc_psf function and uses a lot of the same keywords.</span>
<span class="c1"># There are more advanced methods for generating your WebbPSF, but those are beyond the scope of this notebook.</span>
<span class="c1"># The defaults used by get_jwst_psf in this notebook are:</span>
<span class="c1"># oversample=4</span>
<span class="c1"># normalize=&#39;last&#39;</span>
<span class="c1"># Non-distorted PSF</span>
<span class="c1"># Useful reference: https://webbpsf.readthedocs.io/en/latest/api/webbpsf.JWInstrument.html#webbpsf.JWInstrument.calc_psf</span>

<span class="c1"># Get PSF from WebbPSF</span>
<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">psfs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.86069511), array(559.08387297)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51420939304742, 121.52381573784315)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.32944238), array(571.63330681)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.5174643701714, 121.52330511426992)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(767.30763827), array(569.1357543)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51685314039858, 121.52145590349731)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(762.80321923), array(562.61868067)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (121.51503596024747, 121.51983614651763)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psf3</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fca40c7e075150f92a3a645c60611ba90e1e16679d93bd6bc69dd48a30f14c7a.png" src="../../../_images/fca40c7e075150f92a3a645c60611ba90e1e16679d93bd6bc69dd48a30f14c7a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do PSF Photometry using space_phot (details of fitting are in documentation)</span>
<span class="c1"># https://st-phot.readthedocs.io/en/latest/examples/plot_a_psf.html#jwst-images</span>
<span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psfs</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span>
<span class="p">)</span>
<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 141.16%
</pre></div>
</div>
<img alt="../../../_images/549a8456074ee4c732772ab2be6554e3f3bf0b8c23745652507137bb4518accf.png" src="../../../_images/549a8456074ee4c732772ab2be6554e3f3bf0b8c23745652507137bb4518accf.png" />
<img alt="../../../_images/e07b787b469b8de5dd125306a3ca37939b91ceac5bff349b590a635eddfbfbc4.png" src="../../../_images/e07b787b469b8de5dd125306a3ca37939b91ceac5bff349b590a635eddfbfbc4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        ra         ...                     exp                    
------------------ ... -------------------------------------------
 265.7501383333533 ... jw01028006001_02101_00001_mirimage_cal.fits
 265.7501383333496 ... jw01028006001_02101_00002_mirimage_cal.fits
265.75013833334884 ... jw01028006001_02101_00003_mirimage_cal.fits
 265.7501383333493 ... jw01028006001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As noted above, As a result, the flux and corresponding error take into account a single overall fit. </span>
<span class="c1"># Therefore, there is no need to average the resulting magnitudes or errors. They should all be the same to within their individual zero-point differences (typically &lt;1%).</span>

<span class="c1"># Print Upper Limits</span>
<span class="n">magupper_lvl2psf</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">upper_limit</span><span class="p">(</span><span class="n">nsigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">magupper_lvl2psf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([25.62155223, 25.62155223, 25.62155223, 25.62155223])
</pre></div>
</div>
</div>
</div>
</section>
<section id="font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a">
<h3>4.2<font color='white'>-</font>Single, Level3 Mosaicked File<a class="anchor" id="fso3"></a><a class="headerlink" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level3 data file the same as above.</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;mast/01028/jw01028-o006_t001_miri_f770w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/238d96cd2e110c16a037d5f424562b8fa01b02f2666c22603a66ac5152c3640f.png" src="../../../_images/238d96cd2e110c16a037d5f424562b8fa01b02f2666c22603a66ac5152c3640f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">ref_wcs</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>
<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">ref_wcs</span><span class="p">)</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>

<span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/234aebc8e3deda35a456b53e8410a53075b77592709e358d2a8dbcac63be318a.png" src="../../../_images/234aebc8e3deda35a456b53e8410a53075b77592709e358d2a8dbcac63be318a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/60eb7ff8404f2ffcb806499a759af01afe6a4ec2eece35479ffd1cfaaed63a0b.png" src="../../../_images/60eb7ff8404f2ffcb806499a759af01afe6a4ec2eece35479ffd1cfaaed63a0b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick a blank part of the sky to calculate the upper limit</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>

<span class="n">ref_y</span><span class="p">,</span> <span class="n">ref_x</span> <span class="o">=</span> <span class="n">skycoord_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">,</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">ref_fits</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ref_fits</span><span class="p">))</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="n">ref_x</span><span class="p">,</span> <span class="n">ref_y</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PID1028,Obs006 (level 3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/88daafab9bc907880758a90255d5ca0881a2ac342e76314123dc630ce5a245a4.png" src="../../../_images/88daafab9bc907880758a90255d5ca0881a2ac342e76314123dc630ce5a245a4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The function get_jwst_psf is a space_phot wrapper for the WebbPSF calc_psf function and uses a lot of the same keywords.</span>
<span class="c1"># There are more advanced methods for generating your WebbPSF, but those are beyond the scope of this notebook.</span>
<span class="c1"># The defaults used by get_jwst_psf in this notebook are:</span>
<span class="c1"># oversample=4</span>
<span class="c1"># normalize=&#39;last&#39;</span>
<span class="c1"># Non-distorted PSF</span>
<span class="c1"># Useful reference: https://webbpsf.readthedocs.io/en/latest/api/webbpsf.JWInstrument.html#webbpsf.JWInstrument.calc_psf</span>

<span class="c1"># Get PSF from WebbPSF</span>
<span class="n">jwst3_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation3</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">psf3</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst3_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">jwst3_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iterating query, tdelta=3.0

MAST OPD query around UTC: 2022-05-25T01:14:08.073
                        MJD: 59724.05148232639

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/O2022052501-NRCA3_FP1-59.fits
	Date (MJD):	 59723.8076
	Delta time:	 -0.2439 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022052701-NRCA3_FP1-0.fits
	Date (MJD):	 59726.0139
	Delta time:	 1.9624 days
User requested choosing OPD time closest in time to 2022-05-25T01:14:08.073, which is O2022052501-NRCA3_FP1-59.fits, delta time -0.244 days
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/O2022052501-NRCA3_FP1-59.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F770W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.86069511), array(559.08387297)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51420939304728, 201.52381573784302)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(772.32944238), array(571.63330681)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.5174643701711, 201.52330511426985)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(767.30763827), array(569.1357543)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51685314039872, 201.5214559034972)

Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/1: (array(762.80321923), array(562.61868067)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.51503596024762, 201.51983614651743)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,142 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,143 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,146 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,147 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,148 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,150 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,151 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,318 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,331 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.5
      sharphi: 2.0
      roundlo: 0.0
      roundhi: 0.2
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        pt2dQvpkvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,331 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,763 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f62b0ec4210&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:30,764 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,588 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f62b0ec4210&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,589 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,740 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f62b0ec4210&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,741 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,894 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f62b0ec4210&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,896 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,896 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,897 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,897 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,899 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,899 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,900 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,900 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,902 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,902 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,903 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,903 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,905 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,905 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,906 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,906 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,908 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,908 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,909 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,909 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,910 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11091579557784445 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:31,928 - stpipe.Image3Pipeline.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:32,718 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:32,719 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:32,719 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:33,465 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:33,466 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:33,467 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:34,216 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:34,217 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:34,218 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:34,960 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:34,962 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:34,962 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01028006001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:35,205 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  265.737953477 66.940980694 265.701111178 66.912738191 265.773940695 66.898122976 265.810845165 66.926348568
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:35,504 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:35,504 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:35,673 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1030, 1042) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:35,674 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:35,677 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:34:35,678 - stpipe - INFO - Results used jwst version: 1.17.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The scale should highlight the background noise so it is possible to see all faint sources.</span>
<span class="n">ref_cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">psf3</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">161</span><span class="p">,</span> <span class="mi">161</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WebbPSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/757120c3c6b13865653ccd3f4b1b714f7b59eeff655a4d49c25a31559dafa592.png" src="../../../_images/757120c3c6b13865653ccd3f4b1b714f7b59eeff655a4d49c25a31559dafa592.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
    <span class="n">psf3</span><span class="p">,</span>
    <span class="n">source_location</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
        <span class="s1">&#39;bkg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">fit_width</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
    <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">fit_centroid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">jwst3_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">jwst3_obs</span><span class="o">.</span><span class="n">plot_psf_posterior</span><span class="p">(</span><span class="n">minweight</span><span class="o">=</span><span class="mf">.0005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of -13.93%
</pre></div>
</div>
<img alt="../../../_images/85120c65ccafdfec6bfe958132ce9a0bed8def739773e3239b94d87f138fb7a1.png" src="../../../_images/85120c65ccafdfec6bfe958132ce9a0bed8def739773e3239b94d87f138fb7a1.png" />
<img alt="../../../_images/8ede9bde9f8b30f0a959bd9a4581c2dc02f718f54f491582677d6d817023b8db.png" src="../../../_images/8ede9bde9f8b30f0a959bd9a4581c2dc02f718f54f491582677d6d817023b8db.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">magupper_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">upper_limit</span><span class="p">(</span><span class="n">nsigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">magupper_lvl2psf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">magupper_lvl3psf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.6216
25.80456
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="note-you-can-go-significantly-deeper-with-the-level3-combined-data-product">
<h2>Note you can go significantly deeper with the Level3 combined data product<a class="headerlink" href="#note-you-can-go-significantly-deeper-with-the-level3-combined-data-product" title="Permalink to this heading">#</a></h2>
</section>
<section id="font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a">
<h2>5.<font color='white'>-</font>Stellar Field (LMC)<a class="anchor" id="lmc"></a><a class="headerlink" href="#font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a" title="Permalink to this heading">#</a></h2>
<section id="in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired">
<h3>In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using space_phot on a large number of stars. We suggest that space_phot may be less optimal for large numbers of bright stars. Other programs, such as DOLPHOT or Photutils, may be better suited for this use case. The primary advantage to space_phot is on faint, single sources. But it can be extended to a larger number if desired.<a class="headerlink" href="#in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired" title="Permalink to this heading">#</a></h3>
</section>
<section id="font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a">
<h3>5.1<font color='white'>-</font>Multiple, Level2 Files<a class="anchor" id="lmc2"></a><a class="headerlink" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a" title="Permalink to this heading">#</a></h3>
<section id="now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed">
<h4>Now do the same thing for a larger group of stars and test for speed<a class="headerlink" href="#now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level 3 Files</span>
<span class="n">lvl3</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&quot;</span><span class="p">]</span>
<span class="n">lvl3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Level 2 Files</span>
<span class="n">lvl2</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;./mast/01171/jw01171004*cal.fits&#39;</span><span class="p">)</span>
<span class="n">lvl2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00003_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00002_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00001_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find Stars in Level 3 File</span>

<span class="c1"># Get rough estimate of background (There are Better Ways to Do Background Subtraction)</span>
<span class="n">bkgrms</span> <span class="o">=</span> <span class="n">MADStdBackgroundRMS</span><span class="p">()</span>
<span class="n">mmm_bkg</span> <span class="o">=</span> <span class="n">MMMBackground</span><span class="p">()</span>

<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">get_fits_wcs</span><span class="p">()</span>

<span class="n">std</span> <span class="o">=</span> <span class="n">bkgrms</span><span class="p">(</span><span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">bkg</span> <span class="o">=</span> <span class="n">mmm_bkg</span><span class="p">(</span><span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">data_bkgsub</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data_bkgsub</span> <span class="o">-=</span> <span class="n">bkg</span>        
<span class="n">fwhm_psf</span> <span class="o">=</span> <span class="mf">1.882</span> <span class="c1"># pixels for F560W</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">5.</span>

<span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="n">fwhm_psf</span><span class="p">,</span> <span class="n">exclude_border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_separation</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">found_stars</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">found_stars</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">(</span><span class="n">max_lines</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> id     xcentroid          ycentroid          sharpness       roundness1      roundness2      npix sky         peak               flux                mag         
--- ------------------ ------------------ ------------------ ----------- -------------------- ---- --- ------------------- ------------------ --------------------
  1  546.2615248590856   5.40090706700177 0.7041937380599614  0.46773428  0.04273256330788055   25 0.0 -0.8653272390365601 1.6463868618011475  -0.5413297293846483
  2  789.0983970730795  6.312157835017226 0.6691237944354219 -0.17942303  -0.8079555096758742   25 0.0 -0.5761210918426514 1.1000438928604126 -0.10352503572911273
  3  845.9799634503643 3.6757970986043205 0.6829976607805458 0.043498766 -0.42254093349077776   25 0.0  -1.171976923942566 1.1794757843017578 -0.17922257214246215
...                ...                ...                ...         ...                  ...  ... ...                 ...                ...                  ...
788 1005.1187213604594 1062.3368573824348 0.6862059219157299  -0.4493568  -0.8216906677208772   25 0.0 -0.6988779306411743 1.0355932712554932 -0.03797304988288973
789  399.3766175963356 1064.9409739772366 0.3060837128458461  -0.1559235 -0.21203561885367334   25 0.0 -0.7487165927886963 1.0224626064300537 -0.02411858480836388
790  566.9700693080139  1065.048267845045 0.5650444893283237  -0.3703813  -0.5505482861764637   25 0.0  0.5157880783081055  1.638227939605713  -0.5359358211339778
Length = 790 rows
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the found stars</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

<span class="n">xypos</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>
<span class="n">aper</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">xypos</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">aper</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.patches.Circle at 0x7f62b03ef490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255048c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254d32cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0d11b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625419c990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0601810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace51f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625495cad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6cd8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0602ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254872a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254872fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25ab950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546474d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9f68310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9f6bd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9f6a190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9f68ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9f69c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace8a010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b11dfbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b01d9110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b01d9710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b01d89d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b01dbad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546b0dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546b2190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b19218d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22d9350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22d92d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22db410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22d9190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22db6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22dbf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22d8f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22d9ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22d9750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22db650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b1274bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a229c0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a229ce10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a229e710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a229c990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a229ed10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b11d6390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0b7f210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0b7c350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b057b690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0216f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e2b250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd36e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd37810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd376d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd35310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0831510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace87690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac813c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03899d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0388e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd24a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace21550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace22250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a26d0650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdf7790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad0b8b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad0b97d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d83210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d82ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acce7390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acce6c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acce45d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac79bad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2648250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2648690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2649a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03c4dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03c5950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03c4190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03c6e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03c5b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace9e3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace9ef50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace9fd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b04cf890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b04cf010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd1fa50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2767ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a27643d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2765610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2764410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdfb450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdf9bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254dee910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254dee010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254dee810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254decad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254dee650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254ded810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254decb90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b04efa50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b04ecb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0499110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0498290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0498f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253e710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253c290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253e0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253c710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253e010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253ca10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253c690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253f2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253dc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253c590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a253cd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255144d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255145250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255144c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255145d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255147ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac82b550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac828090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac82b150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac829dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac82ba10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0a00750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0a02350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254cde750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62accdec10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62accddc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bda250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bdbb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bdbed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bd8350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bdab90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bda6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bd8090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd152d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd16550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd16a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd14d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd17710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd153d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd164d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0507e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b10fec90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b10ff350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b10ff1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b10fded0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22673d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22642d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22667d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2264610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22641d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2264850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2265a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22671d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2267910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2266750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2265750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac815110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac814e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac814e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac816390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac814990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac815250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac8141d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254ffe650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fffa50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254ffdbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fffc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254ffea90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254ffe590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254ffd010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254ffe290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254ffc5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62accc6990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62accc4b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62accc78d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac7b5dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac7b4310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a222a910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22283d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a222a210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2228890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2228490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a222bf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a222ad50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a222b090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a222a250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a222a890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a222b850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2228290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2228250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace33e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace33290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace31050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace316d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace31610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace32a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace30cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace33990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace33c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625465bb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac807950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac8041d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac8078d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac804650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac804d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac805890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac805010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac807710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac804850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac807d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac8053d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac804590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550906d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255091950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255090250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255092550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255090810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255093a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550916d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550904d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255090990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550928d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550920d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255093f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255093750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b09dd850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b09dd9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b09dff90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace4bed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace4bd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace4ab10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace4a650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace4ba50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0a8be10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550263d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255024710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550271d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550247d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255027ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255026250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255025690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255027fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255027950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255025d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255024610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255027250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255027dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd55fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd577d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd564d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd56b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd55090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd55b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd572d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd55050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd55c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e692d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e69650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e6a350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e6a310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e687d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e6a550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e68290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e6b350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e6b110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e6bf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e6a010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e6b290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac7fbf10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2633f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2633c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2631d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2632a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2630150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2633450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2630510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a26311d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2633b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2630550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2630fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2633650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a2632790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e4490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e7990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e6910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e7c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e6350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a26d5050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a26d4510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a26d4210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a26d7f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a26d4dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254909010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62549095d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625490abd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0269490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03f3ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03f0150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac8618d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac8624d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac862150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0341110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03421d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0341a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0342910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0342650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0343490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0343f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0342b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0342050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b03403d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0341ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0343550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac8684d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac868990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac868550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac8690d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac8699d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a24d1090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b052ca90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b052d190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b052e550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b052fed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b052c290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62accef350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62accef6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62accee550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550442d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255044650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255045410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6255044f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac797bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd3a050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd39e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ace8f0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac87b550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac87b290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac87bb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac87bad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac87b750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac87a6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac878a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac879350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac87b790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac87b590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac87b890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfd650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfcc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfcb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfd590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfc250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfe290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfd010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfc0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfc990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dfe850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9dffbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22b9dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bb650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22ba790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22b8490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22b8850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bac50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22b9b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22b8dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bb810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22b95d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bac90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22ba890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22b94d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d65110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d64d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d653d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d64190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d67910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d66210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d65a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d670d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550f8ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550f9b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550fab10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550f9c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550f9f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550f93d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550f8510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550fad10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62550faed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25dc1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25de750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25dc150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25de0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25dd910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25dc890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25de110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25de810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b05a6010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b05a6310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b05a6d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b05a4590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b05a4290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0569210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b056a990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0569d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0569a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0568950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac7bca50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac7bd290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac7bc950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac7bfe50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc3c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc0150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc0b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc2f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc2d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc3fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc2810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc2890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc3a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc3b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acdc10d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254514a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545147d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254514590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254517f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545143d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254516dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254516b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254515510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254514f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254516450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254514190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545150d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254514410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc6950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc7dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc6f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc7a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc4c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc7d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc6c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc4210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc6910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc68d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc6450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254fc6690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c5b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c7c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c4f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c5ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c4150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c4790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c76d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c7490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c79d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c7f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c5d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c48d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c6890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c66d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c5090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c6e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62546c6c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d8f310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d8c410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d8f110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d8e810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62c9d8f490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e94dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e94810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e97e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e979d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e94a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e95910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e948d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e96c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e953d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e96ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e96450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e94310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254e97b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d8150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d8cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d9fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d9a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545dbb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d9f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545dadd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d82d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545db250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d8710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d8e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d8d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545dab90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d8990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d8d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62545d9650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0dfee10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0dffbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0dfe7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0dfe950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0dff710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0dfff10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0dfcdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250e0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250d310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250d910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250d6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250c810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250ddd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250e350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250c8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250df10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250f350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250fe50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250fd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250d0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a250f1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254473510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254471a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254470590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254473fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254472390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62544711d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254472b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254472f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62544735d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254472090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254471c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254470990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62544717d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254471f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254470510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254470790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254470ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254470090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625452d090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625452db90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625452cc10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625452ea90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625452f810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625452cb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625452c790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448c0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448e150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448ecd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448ff10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448ff50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448e990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448c450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448c6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448cad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448e310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448dd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448dad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448dc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448d150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448d050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625448f950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b19bd750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd19950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62acd189d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bd4290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bd5090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bd5390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bd5590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254bd4790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bf990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bce90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bc990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bc510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bc150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bcfd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22beb90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bfed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22be810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bcf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bef10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bc210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bfe90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bc7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22be690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bed10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22bd010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a22be250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254134910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62541347d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62541343d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254134090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254136e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254137410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254137dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62541369d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254137f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e2d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e1190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e0090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e1350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e2850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e2410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e2150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e36d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e3510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e3d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e1c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e3c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e0310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e1010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e0dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e0f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e0cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a25e2710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0f800d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0f80290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0f825d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0f81490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0f83b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0f81410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0f80990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e3ab4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e3a9590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e3a8d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e3ab690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b1009d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b1009210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b1009350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625453a210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625453ba50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625453b110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625453bf90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254538710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625453b150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254539950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254539c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625453a110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625453bdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254538ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254539010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625453b990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625453a410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254302d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62543029d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62543033d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254301450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62543007d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254300fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62543035d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254301790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254303c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254301b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254301f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62543002d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62543019d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439b050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439a590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439a090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439be50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439b4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439ab90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439b790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439ae90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254398f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254399bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439bf10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439b590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439aa90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625439bd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62543986d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254398290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254398190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254398250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481cb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481db50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481e490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481eed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481e110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481cf90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481d450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481cbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481e790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481dd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481d650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481cfd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481c410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f625481de10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a8650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a8c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a9750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a88d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a9a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6ab810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a9150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a9c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a8c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a9910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6aaf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a8610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6a8dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6ab8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6ab450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac6ab750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ac967f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad061290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad062910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad060390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad063b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad062710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad063f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad062c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad061b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad061790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad0622d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad060ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad0615d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad060210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad060490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad062590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad062a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad060e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62ad061650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0865150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0865c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0867050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0865c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0866350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0865e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b08654d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0865f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0864cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0867510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0864790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b08645d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b08670d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0866550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0864e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0867d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0865d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab2c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab2690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab01d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab22d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab0a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab0590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab0ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab2b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab2a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab25d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab2850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab0490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab1510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab2310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab2a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab0b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab0690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62b0ab2590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254195090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254194110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254197850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254194490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254196650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62541973d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254197010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254197210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62541956d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254197610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254197ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62541949d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62541974d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254194550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6254194910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e364f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e364990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e364450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e366550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e366a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e366ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e366450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e366c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e365f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e367f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e365c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e364c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f624e367ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a24a6fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a24a7fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a24a5a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f62a24a6f50&gt;]
</pre></div>
</div>
<img alt="../../../_images/2f863c380baa27a39828ac5d10dc34f49cd0f7888176b2f4b369cb4afcb95fe2.png" src="../../../_images/2f863c380baa27a39828ac5d10dc34f49cd0f7888176b2f4b369cb4afcb95fe2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter out only stars you want</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;sharpness&#39;</span><span class="p">)</span>

<span class="n">xlim0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.25</span>
<span class="n">xlim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.25</span>
<span class="n">ylim0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.15</span>
<span class="n">ylim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.15</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">sh_inf</span> <span class="o">=</span> <span class="mf">0.40</span>
<span class="n">sh_sup</span> <span class="o">=</span> <span class="mf">0.82</span>
<span class="c1">#mag_lim = -5.0</span>
<span class="n">lmag_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span>
<span class="n">umag_lim</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">sh_sup</span><span class="p">,</span> <span class="n">sh_sup</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">sh_inf</span><span class="p">,</span> <span class="n">sh_inf</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lmag_lim</span><span class="p">,</span> <span class="n">lmag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">umag_lim</span><span class="p">,</span> <span class="n">umag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;roundness&#39;</span><span class="p">)</span>

<span class="n">ylim0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.25</span>
<span class="n">ylim1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">0.25</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">)</span>

<span class="n">round_inf</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.40</span>
<span class="n">round_sup</span> <span class="o">=</span> <span class="mf">0.40</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">round_sup</span><span class="p">,</span> <span class="n">round_sup</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim0</span><span class="p">,</span> <span class="n">xlim1</span><span class="p">],</span> <span class="p">[</span><span class="n">round_inf</span><span class="p">,</span> <span class="n">round_inf</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lmag_lim</span><span class="p">,</span> <span class="n">lmag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">umag_lim</span><span class="p">,</span> <span class="n">umag_lim</span><span class="p">],</span> <span class="p">[</span><span class="n">ylim0</span><span class="p">,</span> <span class="n">ylim1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/dca00ef0cacb17ef440e6d307a64e7650a3ce092e07ac7543cfc8cf4bcde9e49.png" src="../../../_images/dca00ef0cacb17ef440e6d307a64e7650a3ce092e07ac7543cfc8cf4bcde9e49.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lmag_lim</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">umag_lim</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">round_inf</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">round_sup</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sh_inf</span><span class="p">)</span> 
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">sh_sup</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">))</span>

<span class="n">found_stars_sel</span> <span class="o">=</span> <span class="n">found_stars</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stars found originally:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_stars</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stars in final selection:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_stars_sel</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of stars found originally: 790
Number of stars in final selection: 13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">found_stars_sel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=13</i>
<table id="table140061782724496" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>xcentroid</th><th>ycentroid</th><th>sharpness</th><th>roundness1</th><th>roundness2</th><th>npix</th><th>sky</th><th>peak</th><th>flux</th><th>mag</th></tr></thead>
<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float32</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>86</td><td>378.7558816433192</td><td>106.99517231293703</td><td>0.7364077918416378</td><td>-0.059391562</td><td>-0.06704534345138508</td><td>25</td><td>0.0</td><td>51.20432662963867</td><td>46.88838195800781</td><td>-4.177663115498585</td></tr>
<tr><td>93</td><td>699.4285739316663</td><td>121.30618337045195</td><td>0.6621937635659819</td><td>-0.45228603</td><td>-0.16121600597523705</td><td>25</td><td>0.0</td><td>21.92721176147461</td><td>19.500816345214844</td><td>-3.2251319805603025</td></tr>
<tr><td>138</td><td>502.6449423284217</td><td>185.07660708931144</td><td>0.6351195098960691</td><td>-0.36937103</td><td>-0.37435640137051696</td><td>25</td><td>0.0</td><td>30.200824737548828</td><td>24.987716674804688</td><td>-3.4943164325492058</td></tr>
<tr><td>141</td><td>520.4512004466732</td><td>190.2476066884721</td><td>0.8012885262482311</td><td>0.30771914</td><td>-0.08561803159241342</td><td>25</td><td>0.0</td><td>23.034168243408203</td><td>17.149253845214844</td><td>-3.085613072177968</td></tr>
<tr><td>144</td><td>591.9599066066671</td><td>194.8718750798144</td><td>0.7334114841843143</td><td>-0.36179662</td><td>-0.19144805342168533</td><td>25</td><td>0.0</td><td>21.18755340576172</td><td>16.44730567932129</td><td>-3.0402369100553313</td></tr>
<tr><td>169</td><td>388.990541620123</td><td>248.15789451654376</td><td>0.7118823356707229</td><td>0.16915432</td><td>0.21323040806731455</td><td>25</td><td>0.0</td><td>19.440757751464844</td><td>18.429296493530273</td><td>-3.1637718927398666</td></tr>
<tr><td>183</td><td>532.3925923035418</td><td>267.74287686139763</td><td>0.7174778066738734</td><td>-0.2787835</td><td>-0.16201501039505897</td><td>25</td><td>0.0</td><td>43.17793273925781</td><td>35.05239486694336</td><td>-3.8617942384933013</td></tr>
<tr><td>249</td><td>671.5101306788192</td><td>370.56221568412315</td><td>0.6690541020715319</td><td>0.22694585</td><td>-0.2501719039312765</td><td>25</td><td>0.0</td><td>21.814945220947266</td><td>17.284053802490234</td><td>-3.09411402382609</td></tr>
<tr><td>314</td><td>635.9221063124252</td><td>494.5522379657613</td><td>0.8149770327504342</td><td>-0.12416268</td><td>0.22344203180037933</td><td>25</td><td>0.0</td><td>29.927074432373047</td><td>23.478647232055664</td><td>-3.426682676437008</td></tr>
<tr><td>373</td><td>584.9812269385081</td><td>576.5389571037796</td><td>0.7775545307534784</td><td>-0.21396631</td><td>0.009246422308793646</td><td>25</td><td>0.0</td><td>76.73455047607422</td><td>59.45756530761719</td><td>-4.435517803918195</td></tr>
<tr><td>386</td><td>492.6253255819231</td><td>596.8690332212642</td><td>0.7193021689332798</td><td>-0.23190862</td><td>-0.09178475176652573</td><td>25</td><td>0.0</td><td>78.58627319335938</td><td>64.5720443725586</td><td>-4.525111341330769</td></tr>
<tr><td>413</td><td>619.8610744135557</td><td>636.7050695267906</td><td>0.764199844647154</td><td>0.013973999</td><td>-0.007752396414213482</td><td>25</td><td>0.0</td><td>56.14342498779297</td><td>47.85715866088867</td><td>-4.19986727609639</td></tr>
<tr><td>436</td><td>664.5588392056713</td><td>666.5506376499176</td><td>0.6773962981916116</td><td>0.5580665</td><td>0.022133349895936842</td><td>25</td><td>0.0</td><td>80.94784545898438</td><td>67.48514556884766</td><td>-4.573020472543158</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert pixel to wcs coords</span>
<span class="n">skycoords</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">pixel_to_world</span><span class="p">(</span><span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">skycoords</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NANs</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">lvl2</span><span class="p">:</span>
    <span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
    <span class="n">dq</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">dq</span>
    <span class="n">data</span><span class="p">[</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ref_fits</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a grid for fast lookup using WebbPSF. The larger the number of grid points, the better the photometric precision.</span>
<span class="c1"># Developer note. Would be great to have a fast/approximate look up table. </span>
<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_jwst_psf_grid</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">num_psfs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up sim to match ./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-04-13T03:08:10.578
                        MJD: 59682.13067798611

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/R2022041201-NRCA3_FP1-2.fits
	Date (MJD):	 59681.7791
	Delta time:	 -0.3516 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022041301-NRCA3_FP1-1.fits
	Date (MJD):	 59682.8401
	Delta time:	 0.7094 days
User requested choosing OPD time closest in time to 2022-04-13T03:08:10.578, which is R2022041201-NRCA3_FP1-2.fits, delta time -0.352 days
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/R2022041201-NRCA3_FP1-2.fits to ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F560W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/16: (0, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/16 centroid: (201.39896123096594, 201.57462168473992)
    Position 2/16: (0, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 2/16 centroid: (201.27298326538994, 201.8122962916395)
    Position 3/16: (0, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 3/16 centroid: (201.26092649151903, 201.8273016561088)
    Position 4/16: (0, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 4/16 centroid: (201.30665784716913, 201.41346936543644)
    Position 5/16: (341, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 5/16 centroid: (201.38945973576688, 201.62934762823934)
    Position 6/16: (341, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 6/16 centroid: (201.48863769451324, 201.63972936419177)
    Position 7/16: (341, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 7/16 centroid: (201.48210765199016, 201.6080741598635)
    Position 8/16: (341, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 8/16 centroid: (201.42818621943198, 201.61327684523178)
    Position 9/16: (682, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 9/16 centroid: (201.405459701244, 201.64424228029097)
    Position 10/16: (682, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 10/16 centroid: (201.52251762658082, 201.5881287591983)
    Position 11/16: (682, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 11/16 centroid: (201.57423502982945, 201.5553583383486)
    Position 12/16: (682, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 12/16 centroid: (201.584920185908, 201.6735683999315)
    Position 13/16: (1023, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 13/16 centroid: (201.44216164335302, 201.69986266797625)
    Position 14/16: (1023, 341) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 14/16 centroid: (201.51032408676687, 201.68044889871803)
    Position 15/16: (1023, 682) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 15/16 centroid: (201.62018700397059, 201.66506320800642)
    Position 16/16: (1023, 1023) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 16/16 centroid: (201.77312450805107, 201.60334597442935)
  Saving file: miri_mirim_f560w_fovp101_samp4_npsf16.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">QTable</span><span class="p">([</span><span class="n">skycoords</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;skycoord&quot;</span><span class="p">])</span>
<span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;skycoord.ecsv&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now Loop Through All Stars and Build Photometry Table</span>
<span class="c1"># Readers should refer to all diagnostics discussed above. </span>
<span class="c1"># It should be noted that empty plots correspond to LVL2 files with dither positions that do not cover that particular coordinate.</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">badindex</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">jwst_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation2</span><span class="p">(</span><span class="n">lvl2</span><span class="p">)</span>
<span class="n">localbkg_estimator</span> <span class="o">=</span> <span class="n">LocalBackground</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">MMMBackground</span><span class="p">())</span>

<span class="k">for</span> <span class="n">source_location</span> <span class="ow">in</span> <span class="n">skycoords</span><span class="p">:</span>
    <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting&#39;</span><span class="p">,</span> <span class="n">counter</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39; of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">skycoords</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
    <span class="n">psfs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_jwst_psf_from_grid</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">,</span> <span class="n">grid</span><span class="p">)</span>
    <span class="n">xys</span> <span class="o">=</span> <span class="p">[</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">wcs_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">n_exposures</span><span class="p">)]</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="p">[</span><span class="n">localbkg_estimator</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">data_arr_pam</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jwst_obs</span><span class="o">.</span><span class="n">n_exposures</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bkg</span><span class="p">)</span>
    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psfs</span><span class="p">,</span>
        <span class="n">source_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;wcs&#39;</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span>
        <span class="n">maxiter</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    
    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">fit_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
     
    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psfs</span><span class="p">,</span>
        <span class="n">fit_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_centroid</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span>
        <span class="n">maxiter</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>

    <span class="n">jwst_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mag_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span>
    <span class="n">magerr_arr</span> <span class="o">=</span> <span class="n">jwst_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">]</span>
    <span class="n">mag_lvl2psf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mag_arr</span><span class="p">)</span>
    <span class="n">magerr_lvl2psf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">magerr_arr</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl2psf</span><span class="p">,</span> <span class="n">magerr_lvl2psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl2psf</span><span class="p">,</span> <span class="n">magerr_lvl2psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mf">1.</span>
    
    <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time for Photometry:&quot;</span><span class="p">,</span> <span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting 1.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.68751895, -69.44522201)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.869825303554535, nan, 1.875230292270058, nan]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.76%
</pre></div>
</div>
<img alt="../../../_images/8bf2213b756a47d23f658bfad8aae3a50b22aec148d680357d4e1c3a002ce120.png" src="../../../_images/8bf2213b756a47d23f658bfad8aae3a50b22aec148d680357d4e1c3a002ce120.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.73%
</pre></div>
</div>
<img alt="../../../_images/0dfbdd0e3ea8e1759b288d178db7441b9fd3201d8165d97333f38bc7a183c5c8.png" src="../../../_images/0dfbdd0e3ea8e1759b288d178db7441b9fd3201d8165d97333f38bc7a183c5c8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 29.67144757699998
Starting 2.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70519786, -69.43753355)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7614484293419017, 1.8134855595066321, 1.7480259496590187, 1.943224255991454]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.74%
</pre></div>
</div>
<img alt="../../../_images/b282a156f78579d345a1c391536afd48a5e332fab50bbef49ace3a5ad3371072.png" src="../../../_images/b282a156f78579d345a1c391536afd48a5e332fab50bbef49ace3a5ad3371072.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.71%
</pre></div>
</div>
<img alt="../../../_images/64dcd24aabb20a647a182dc09bc25f2b6984b67783ad49a641abbe73356934dc.png" src="../../../_images/64dcd24aabb20a647a182dc09bc25f2b6984b67783ad49a641abbe73356934dc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 27.794297778999976
Starting 3.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.69947281, -69.44357619)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7704960215245196, 1.8189359360103365, 1.8464110786631958, 1.8683478434880576]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.12%
</pre></div>
</div>
<img alt="../../../_images/354986072b4a6dbc75faecb10ba513d16979b3c78c87941ec16159a8210b15cd.png" src="../../../_images/354986072b4a6dbc75faecb10ba513d16979b3c78c87941ec16159a8210b15cd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.11%
</pre></div>
</div>
<img alt="../../../_images/04c49d8c6191f51a4d76d5db1bd3b96c4241f58cd704995a7632d4a68319ad31.png" src="../../../_images/04c49d8c6191f51a4d76d5db1bd3b96c4241f58cd704995a7632d4a68319ad31.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 28.08549914999992
Starting 4.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70076349, -69.44322912)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7729037974078583, 1.7539834316196359, 1.8693315009785514, 1.8635000334623966]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.78%
</pre></div>
</div>
<img alt="../../../_images/e1b49dcb5ead462b37b5f45528d6558071140a8a552535e3641ead680aada27c.png" src="../../../_images/e1b49dcb5ead462b37b5f45528d6558071140a8a552535e3641ead680aada27c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.77%
</pre></div>
</div>
<img alt="../../../_images/2e4f4a4bc24b8d6c5ebc41844daf8d4a1791d5d5df4da0b00d2b6dab8cba5227.png" src="../../../_images/2e4f4a4bc24b8d6c5ebc41844daf8d4a1791d5d5df4da0b00d2b6dab8cba5227.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 29.34001569899999
Starting 5.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70480666, -69.44154063)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.829211658608597, 1.7340520685369318, 1.8180533992616752, 1.8822986582914987]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.45%
</pre></div>
</div>
<img alt="../../../_images/a56b73ba2cf49be14a70bcb25033df3093046d5d82a3f257f4356ac2d29fb6cf.png" src="../../../_images/a56b73ba2cf49be14a70bcb25033df3093046d5d82a3f257f4356ac2d29fb6cf.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.45%
</pre></div>
</div>
<img alt="../../../_images/592b5468f216cae515839756ef43b99a2bdaa795c26ba9876e842822ca56a115.png" src="../../../_images/592b5468f216cae515839756ef43b99a2bdaa795c26ba9876e842822ca56a115.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 31.240663552
Starting 6.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.69801844, -69.44754524)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.8947609114092452, nan, 1.8804607170599477, nan]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of -0.31%
</pre></div>
</div>
<img alt="../../../_images/7d592bf08a3b2956ed2e4f437fb978d5459b33d41384e9a9201ad50972b19c14.png" src="../../../_images/7d592bf08a3b2956ed2e4f437fb978d5459b33d41384e9a9201ad50972b19c14.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of -0.29%
</pre></div>
</div>
<img alt="../../../_images/bd7c904a020473c8b09506601e1243e7ca0fe82d8a01b8230137c7a48ebbe042.png" src="../../../_images/bd7c904a020473c8b09506601e1243e7ca0fe82d8a01b8230137c7a48ebbe042.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 28.533946827000022
Starting 7.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70685609, -69.4443474)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7949211474651943, 1.8149203216207437, 1.7996749530022749, 1.9178177507027336]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.73%
</pre></div>
</div>
<img alt="../../../_images/ffef11012607cccae0a3b51b04caf8b4d5f42ea852b9943e5e4984b5ecdc71aa.png" src="../../../_images/ffef11012607cccae0a3b51b04caf8b4d5f42ea852b9943e5e4984b5ecdc71aa.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.72%
</pre></div>
</div>
<img alt="../../../_images/c8b309f278143f963b6f3251c7df83fcd7acd3207c5cc358f7b08d80c35701cd.png" src="../../../_images/c8b309f278143f963b6f3251c7df83fcd7acd3207c5cc358f7b08d80c35701cd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 30.672469019000005
Starting 8.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.72134618, -69.44277393)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.9285976984921622, 1.8641873090163523, 1.9269168845723184, 1.8905765748860541]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.41%
</pre></div>
</div>
<img alt="../../../_images/4006206d2659990736bba1a7f4039311b5ac207a91bb69ae7eba1b0bac91c76a.png" src="../../../_images/4006206d2659990736bba1a7f4039311b5ac207a91bb69ae7eba1b0bac91c76a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 0.39%
</pre></div>
</div>
<img alt="../../../_images/792a17171c890810e4a6d5366ec24592ea7efa71919ba1890461a62c69834459.png" src="../../../_images/792a17171c890810e4a6d5366ec24592ea7efa71919ba1890461a62c69834459.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 32.89122694499997
Starting 9.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.72825455, -69.44591833)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.84141688927626, 1.7936298903695782, 1.8419053048023337, 1.898898235350981]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.14%
</pre></div>
</div>
<img alt="../../../_images/a71229f79b154df59646f66918e8f87fe0434889eb84d25915c0524e32cde3d2.png" src="../../../_images/a71229f79b154df59646f66918e8f87fe0434889eb84d25915c0524e32cde3d2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.53%
</pre></div>
</div>
<img alt="../../../_images/558f74e258db82b97db9a3e7bd7a37f6735b6a8e72cd86af5e4d7c096c566872.png" src="../../../_images/558f74e258db82b97db9a3e7bd7a37f6735b6a8e72cd86af5e4d7c096c566872.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 28.22005484700003
Starting 10.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.73139968, -69.44867714)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.8579865136454181, 1.8863315108780547, 1.9026257471384738, 1.9372216368143538]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.63%
</pre></div>
</div>
<img alt="../../../_images/b367c1f430ce07792749e8c8059ab2099d2f4cfa7a3b6bbc1743c2d722a3dfb4.png" src="../../../_images/b367c1f430ce07792749e8c8059ab2099d2f4cfa7a3b6bbc1743c2d722a3dfb4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 3.51%
</pre></div>
</div>
<img alt="../../../_images/c7820c6b65b2986fbc4b637ae1bc94e10d1f2f7026a8b2560ce8500043bdbd40.png" src="../../../_images/c7820c6b65b2986fbc4b637ae1bc94e10d1f2f7026a8b2560ce8500043bdbd40.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 30.034714416000043
Starting 11.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.72803699, -69.45133844)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7678997491160011, 1.7850290745363107, 1.7748173095028976, 1.8868650197982788]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.11%
</pre></div>
</div>
<img alt="../../../_images/ac017bc64cb046921b6c7bb34d65cf638063f3b89e9c6ed3ebeaa5b4bbdf77a6.png" src="../../../_images/ac017bc64cb046921b6c7bb34d65cf638063f3b89e9c6ed3ebeaa5b4bbdf77a6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 2.31%
</pre></div>
</div>
<img alt="../../../_images/2ecd05054f9803aa81a7968b59aa63f6783c103dc3d323601a8a06785570550e.png" src="../../../_images/2ecd05054f9803aa81a7968b59aa63f6783c103dc3d323601a8a06785570550e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 31.505578950000086
Starting 12.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.7374627, -69.44890937)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.8077051193817804, 1.816236440996522, 1.8916719631336663, 1.9208566810361187]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.53%
</pre></div>
</div>
<img alt="../../../_images/87b343e3bb15a3289311bff78f09274e98c80320d99d27b5adef343a3bc2fcd5.png" src="../../../_images/87b343e3bb15a3289311bff78f09274e98c80320d99d27b5adef343a3bc2fcd5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.56%
</pre></div>
</div>
<img alt="../../../_images/d143990a3241d2ba34d2363f0fb8a67254e1e987e61f6a27bc89b01a1379c478.png" src="../../../_images/d143990a3241d2ba34d2363f0fb8a67254e1e987e61f6a27bc89b01a1379c478.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 28.79769570199994
Starting 13.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.74189341, -69.44834497)&gt;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.9374462342956695, 1.8818280295113832, 2.02440093926021, 1.8681333922051095]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.81%
</pre></div>
</div>
<img alt="../../../_images/1450c31722d1ab345256ebc55c96ce20b0830ef2d0b3f7fe6828298f73b3a34a.png" src="../../../_images/1450c31722d1ab345256ebc55c96ce20b0830ef2d0b3f7fe6828298f73b3a34a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 1.80%
</pre></div>
</div>
<img alt="../../../_images/d31caee2f4e4559b02bd105b9c4481ada9a1df59bd2e8dcca04d4f34a53bc577.png" src="../../../_images/d31caee2f4e4559b02bd105b9c4481ada9a1df59bd2e8dcca04d4f34a53bc577.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 27.68119250799998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xys</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(array(665.76055802), array(668.62800217)),
 (array(627.68124922), array(622.10846201)),
 (array(664.87310868), array(665.57020268)),
 (array(626.71526424), array(619.17865679))]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ra</th>
      <th>dec</th>
      <th>mag</th>
      <th>magerr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80.687509</td>
      <td>-69.445224</td>
      <td>18.898506</td>
      <td>0.007257</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80.705194</td>
      <td>-69.437533</td>
      <td>19.404354</td>
      <td>0.005588</td>
    </tr>
    <tr>
      <th>2</th>
      <td>80.699469</td>
      <td>-69.443578</td>
      <td>18.680304</td>
      <td>0.004091</td>
    </tr>
    <tr>
      <th>3</th>
      <td>80.700771</td>
      <td>-69.443234</td>
      <td>18.923841</td>
      <td>0.004652</td>
    </tr>
    <tr>
      <th>4</th>
      <td>80.704797</td>
      <td>-69.441542</td>
      <td>19.128325</td>
      <td>0.005134</td>
    </tr>
    <tr>
      <th>5</th>
      <td>80.698003</td>
      <td>-69.447549</td>
      <td>19.901205</td>
      <td>0.009896</td>
    </tr>
    <tr>
      <th>6</th>
      <td>80.706848</td>
      <td>-69.444346</td>
      <td>18.445929</td>
      <td>0.004380</td>
    </tr>
    <tr>
      <th>7</th>
      <td>80.721346</td>
      <td>-69.442773</td>
      <td>19.008030</td>
      <td>0.005232</td>
    </tr>
    <tr>
      <th>8</th>
      <td>80.728236</td>
      <td>-69.445924</td>
      <td>18.899982</td>
      <td>0.004374</td>
    </tr>
    <tr>
      <th>9</th>
      <td>80.731416</td>
      <td>-69.448676</td>
      <td>17.868520</td>
      <td>0.003170</td>
    </tr>
    <tr>
      <th>10</th>
      <td>80.728022</td>
      <td>-69.451342</td>
      <td>17.957822</td>
      <td>0.003203</td>
    </tr>
    <tr>
      <th>11</th>
      <td>80.737476</td>
      <td>-69.448909</td>
      <td>18.579556</td>
      <td>0.004171</td>
    </tr>
    <tr>
      <th>12</th>
      <td>80.741885</td>
      <td>-69.448347</td>
      <td>17.952116</td>
      <td>0.003308</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write to File</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;miri_photometry_space_phot_lvl2.txt&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a">
<h3>5.2<font color='white'>-</font>Single, Level3 Mosaicked File<a class="anchor" id="lmc3"></a><a class="headerlink" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now do the same photometry on the Level 3 Data</span>
<span class="n">ref_image</span> <span class="o">=</span> <span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">ref_fits</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">ref_image</span><span class="p">)</span>
<span class="n">ref_data</span> <span class="o">=</span> <span class="n">ref_fits</span><span class="o">.</span><span class="n">data</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">min_cut</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ref_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">clb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;MJy/Str&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/00bf3bb2880419001bc897cd6405a8ef56ca3dedb8c78519363de1589e6c6876.png" src="../../../_images/00bf3bb2880419001bc897cd6405a8ef56ca3dedb8c78519363de1589e6c6876.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get PSF from WebbPSF and drizzle it to the source location</span>
<span class="n">jwst3_obs</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">observation3</span><span class="p">(</span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lvl3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">skycoords</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    [(80.68751895, -69.44522201), (80.70519786, -69.43753355),
     (80.69947281, -69.44357619), (80.70076349, -69.44322912),
     (80.70480666, -69.44154063), (80.69801844, -69.44754524),
     (80.70685609, -69.4443474 ), (80.72134618, -69.44277393),
     (80.72825455, -69.44591833), (80.73139968, -69.44867714),
     (80.72803699, -69.45133844), (80.7374627 , -69.44890937),
     (80.74189341, -69.44834497)]&gt;
</pre></div>
</div>
</div>
</div>
<section id="readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars">
<h4>Readers should refer to all diagnostics discussed above. In general, this loop shows the difficulty in doing PSF photometry on a wide variety of stars (brightness, distribution on the detector, etc) without visual inspection. Especially when dealing with low SNR sources.This is true for all photometry packages. Users should inspect the associated metrics and consider optimizing the parameters for specific stars of interest. Nonetheless, the success of the fits can always be quantified in with the associated error bars.<a class="headerlink" href="#readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now Loop Through All Stars and Build Photometry Table</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">badindex</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">source_location</span> <span class="ow">in</span> <span class="n">skycoords</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting&#39;</span><span class="p">,</span> <span class="n">counter</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39; of&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">skycoords</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">source_location</span><span class="p">)</span>
    <span class="n">psf3</span> <span class="o">=</span> <span class="n">space_phot</span><span class="o">.</span><span class="n">get_jwst3_psf</span><span class="p">(</span><span class="n">jwst_obs</span><span class="p">,</span> <span class="n">jwst3_obs</span><span class="p">,</span> <span class="n">source_location</span><span class="p">,</span> <span class="n">num_psfs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">xys</span> <span class="o">=</span> <span class="p">[</span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">)]</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="p">[</span><span class="n">localbkg_estimator</span><span class="p">(</span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">xys</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xys</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bkg</span><span class="p">)</span>
    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psf3</span><span class="p">,</span>
        <span class="n">source_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fit_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">aperture_photometry</span><span class="p">(</span><span class="n">fit_location</span><span class="p">,</span> <span class="n">encircled_energy</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">jwst3_obs</span><span class="o">.</span><span class="n">aperture_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">])</span>
    
    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_photometry</span><span class="p">(</span>
        <span class="n">psf3</span><span class="p">,</span>
        <span class="n">fit_location</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
            <span class="s1">&#39;centroid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="n">fit_width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">fit_bkg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fit_centroid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">background</span><span class="o">=</span><span class="n">bkg</span><span class="p">,</span>
        <span class="n">fit_flux</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">plot_psf_fit</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">ra</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mag_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">magerr_lvl3psf</span> <span class="o">=</span> <span class="n">jwst3_obs</span><span class="o">.</span><span class="n">psf_result</span><span class="o">.</span><span class="n">phot_cal_table</span><span class="p">[</span><span class="s1">&#39;magerr&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl3psf</span><span class="p">,</span> <span class="n">magerr_lvl3psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">mag_lvl3psf</span><span class="p">,</span> <span class="n">magerr_lvl3psf</span><span class="p">]]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="s1">&#39;magerr&#39;</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mf">1.</span>
    <span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed Time for Photometry:&quot;</span><span class="p">,</span> <span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting 1.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.70519786, -69.43753355)&gt;
Setting up sim to match ./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-04-13T03:08:10.578
                        MJD: 59682.13067798611

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/R2022041201-NRCA3_FP1-2.fits
	Date (MJD):	 59681.7791
	Delta time:	 -0.3516 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022041301-NRCA3_FP1-1.fits
	Date (MJD):	 59682.8401
	Delta time:	 0.7094 days
User requested choosing OPD time closest in time to 2022-04-13T03:08:10.578, which is R2022041201-NRCA3_FP1-2.fits, delta time -0.352 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F560W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(123.53744224), array(699.5595544)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.34368596613945, 201.7628797397261)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(76.29823152), array(661.82205941)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.32154273036554, 201.80099578112635)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(120.43679282), array(698.68358418)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.34212605742846, 201.76493480669592)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(73.31069299), array(660.86952362)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.31952743828327, 201.80291255054078)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:34,854 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:34,855 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:34,858 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:34,859 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:34,860 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:34,862 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:34,863 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:35,069 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:35,082 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.5
      sharphi: 2.0
      roundlo: 0.0
      roundhi: 0.2
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        S8+wK09fvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:35,083 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:35,562 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f62ac6c9010&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:35,562 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,454 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f62ac6c9010&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,455 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,656 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f62ac6c9010&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,657 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,864 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f62ac6c9010&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,866 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,866 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,867 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,867 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,869 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,869 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,870 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,870 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,872 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,873 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,873 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,874 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,875 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,875 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,876 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,876 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,878 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,878 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,879 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,879 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,880 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11082930390039995 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:36,897 - stpipe.Image3Pipeline.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:37,704 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:37,706 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:37,706 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:38,462 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:38,463 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:38,464 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:39,218 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:39,219 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:39,220 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:39,974 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:39,976 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:39,976 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:40,214 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  80.660307842 -69.452650714 80.735816161 -69.472158466 80.791402231 -69.445614065 80.715936684 -69.426130394
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:40,511 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:40,511 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:40,715 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1069, 1070) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:40,716 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:40,720 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:40,720 - stpipe - INFO - Results used jwst version: 1.17.1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.1097325677365326]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:42,252 - stpipe.SourceCatalogStep - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 4.09%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:43,256 - CRDS - INFO -  Calibration SW Found: jwst 1.17.1 (/opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages/jwst-1.17.1.dist-info)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:43,798 - CRDS - INFO -  Fetching  mappings/jwst/jwst_system_datalvl_0002.rmap                  694 bytes  (1 / 202 files) (0 / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:44,038 - CRDS - INFO -  Fetching  mappings/jwst/jwst_system_calver_0045.rmap                 5.1 K bytes  (2 / 202 files) (694 / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:44,279 - CRDS - INFO -  Fetching  mappings/jwst/jwst_system_0044.imap                          385 bytes  (3 / 202 files) (5.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:44,518 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_wavelengthrange_0024.rmap       1.4 K bytes  (4 / 202 files) (6.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:44,757 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_wavecorr_0005.rmap                884 bytes  (5 / 202 files) (7.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:44,998 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_superbias_0074.rmap            33.8 K bytes  (6 / 202 files) (8.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:45,322 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_sflat_0026.rmap                20.6 K bytes  (7 / 202 files) (42.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:45,633 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_saturation_0018.rmap            2.0 K bytes  (8 / 202 files) (62.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:45,875 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_refpix_0015.rmap                1.6 K bytes  (9 / 202 files) (64.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:46,122 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_readnoise_0025.rmap             2.6 K bytes  (10 / 202 files) (66.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:46,368 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_photom_0013.rmap                  958 bytes  (11 / 202 files) (69.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:46,603 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pathloss_0008.rmap              1.2 K bytes  (12 / 202 files) (69.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:46,854 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-whitelightstep_0001.rmap      777 bytes  (13 / 202 files) (71.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:47,097 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-spec2pipeline_0013.rmap    2.1 K bytes  (14 / 202 files) (71.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:47,334 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-resamplespecstep_0002.rmap      709 bytes  (15 / 202 files) (74.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:47,573 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-outlierdetectionstep_0005.rmap    1.1 K bytes  (16 / 202 files) (74.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:47,810 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-jumpstep_0005.rmap           810 bytes  (17 / 202 files) (75.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:48,052 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-image2pipeline_0008.rmap    1.0 K bytes  (18 / 202 files) (76.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:48,293 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-detector1pipeline_0003.rmap    1.1 K bytes  (19 / 202 files) (77.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:48,534 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-darkpipeline_0003.rmap       872 bytes  (20 / 202 files) (78.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:48,772 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_pars-darkcurrentstep_0001.rmap      622 bytes  (21 / 202 files) (79.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:49,009 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ote_0030.rmap                   1.3 K bytes  (22 / 202 files) (80.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:49,252 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_msaoper_0016.rmap               1.5 K bytes  (23 / 202 files) (81.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:49,496 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_msa_0027.rmap                   1.3 K bytes  (24 / 202 files) (83.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:49,735 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_mask_0039.rmap                  2.7 K bytes  (25 / 202 files) (84.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:49,981 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_linearity_0017.rmap             1.6 K bytes  (26 / 202 files) (86.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:50,220 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ipc_0006.rmap                     876 bytes  (27 / 202 files) (88.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:50,456 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ifuslicer_0017.rmap             1.5 K bytes  (28 / 202 files) (89.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:50,695 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ifupost_0019.rmap               1.5 K bytes  (29 / 202 files) (90.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:50,933 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_ifufore_0017.rmap               1.5 K bytes  (30 / 202 files) (92.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:51,169 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_gain_0023.rmap                  1.8 K bytes  (31 / 202 files) (93.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:51,407 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_fpa_0028.rmap                   1.3 K bytes  (32 / 202 files) (95.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:51,653 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_fore_0026.rmap                  5.0 K bytes  (33 / 202 files) (96.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:51,892 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_flat_0015.rmap                  3.8 K bytes  (34 / 202 files) (101.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:52,131 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_fflat_0026.rmap                 7.2 K bytes  (35 / 202 files) (105.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:52,367 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_extract1d_0018.rmap             2.3 K bytes  (36 / 202 files) (112.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:52,603 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_disperser_0028.rmap             5.7 K bytes  (37 / 202 files) (115.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:52,841 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_dflat_0007.rmap                 1.1 K bytes  (38 / 202 files) (120.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:53,086 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_dark_0069.rmap                 32.6 K bytes  (39 / 202 files) (122.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:53,397 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_cubepar_0015.rmap                 966 bytes  (40 / 202 files) (154.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:53,632 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_collimator_0026.rmap            1.3 K bytes  (41 / 202 files) (155.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:53,868 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_camera_0026.rmap                1.3 K bytes  (42 / 202 files) (156.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:54,110 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_barshadow_0007.rmap             1.8 K bytes  (43 / 202 files) (158.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:54,350 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_area_0018.rmap                  6.3 K bytes  (44 / 202 files) (160.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:54,587 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_apcorr_0009.rmap                5.6 K bytes  (45 / 202 files) (166.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:54,827 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nirspec_0387.imap                       5.7 K bytes  (46 / 202 files) (171.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:55,065 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_wfssbkg_0008.rmap                3.1 K bytes  (47 / 202 files) (177.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:55,308 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_wavemap_0008.rmap                2.2 K bytes  (48 / 202 files) (180.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:55,547 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_wavelengthrange_0006.rmap          862 bytes  (49 / 202 files) (182.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:55,784 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_trappars_0004.rmap                 753 bytes  (50 / 202 files) (183.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:56,019 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_trapdensity_0005.rmap              705 bytes  (51 / 202 files) (184.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:56,258 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_throughput_0005.rmap             1.3 K bytes  (52 / 202 files) (185.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:56,494 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_superbias_0030.rmap              7.4 K bytes  (53 / 202 files) (186.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:56,731 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_specwcs_0014.rmap                3.1 K bytes  (54 / 202 files) (193.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:56,971 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_spectrace_0008.rmap              2.3 K bytes  (55 / 202 files) (197.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:57,206 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_specprofile_0008.rmap            2.4 K bytes  (56 / 202 files) (199.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:57,444 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_speckernel_0006.rmap             1.0 K bytes  (57 / 202 files) (201.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:57,682 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_saturation_0015.rmap               829 bytes  (58 / 202 files) (202.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:57,920 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_readnoise_0011.rmap                987 bytes  (59 / 202 files) (203.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:58,159 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_photom_0036.rmap                 1.3 K bytes  (60 / 202 files) (204.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:58,394 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_persat_0007.rmap                   674 bytes  (61 / 202 files) (205.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:58,630 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pathloss_0003.rmap                 758 bytes  (62 / 202 files) (206.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:58,869 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pastasoss_0004.rmap                818 bytes  (63 / 202 files) (207.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:59,112 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-undersamplecorrectionstep_0001.rmap      904 bytes  (64 / 202 files) (208.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:59,353 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-tweakregstep_0012.rmap      3.1 K bytes  (65 / 202 files) (209.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:59,589 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-spec2pipeline_0008.rmap       984 bytes  (66 / 202 files) (212.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:42:59,824 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-sourcecatalogstep_0002.rmap    2.3 K bytes  (67 / 202 files) (213.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:00,062 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-resamplestep_0002.rmap        687 bytes  (68 / 202 files) (215.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:00,304 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-outlierdetectionstep_0004.rmap    2.7 K bytes  (69 / 202 files) (216.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:00,541 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-jumpstep_0007.rmap          6.4 K bytes  (70 / 202 files) (218.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:00,782 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-image2pipeline_0005.rmap    1.0 K bytes  (71 / 202 files) (225.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:01,021 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-detector1pipeline_0002.rmap    1.0 K bytes  (72 / 202 files) (226.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:01,262 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-darkpipeline_0002.rmap        868 bytes  (73 / 202 files) (227.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:01,511 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-darkcurrentstep_0001.rmap      591 bytes  (74 / 202 files) (228.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:01,752 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_pars-chargemigrationstep_0004.rmap    5.7 K bytes  (75 / 202 files) (228.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:01,987 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_nrm_0005.rmap                      663 bytes  (76 / 202 files) (234.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:02,224 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_mask_0022.rmap                   1.3 K bytes  (77 / 202 files) (235.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:02,464 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_linearity_0022.rmap                961 bytes  (78 / 202 files) (236.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:02,713 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_ipc_0007.rmap                      651 bytes  (79 / 202 files) (237.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:02,954 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_gain_0011.rmap                     797 bytes  (80 / 202 files) (237.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:03,193 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_flat_0023.rmap                   5.9 K bytes  (81 / 202 files) (238.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:03,431 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_filteroffset_0010.rmap             853 bytes  (82 / 202 files) (244.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:03,674 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_extract1d_0007.rmap                905 bytes  (83 / 202 files) (245.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:03,913 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_drizpars_0004.rmap                 519 bytes  (84 / 202 files) (246.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:04,152 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_distortion_0025.rmap             3.4 K bytes  (85 / 202 files) (246.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:04,389 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_dark_0034.rmap                   7.5 K bytes  (86 / 202 files) (250.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:04,625 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_area_0014.rmap                   2.7 K bytes  (87 / 202 files) (257.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:04,863 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_apcorr_0010.rmap                 4.3 K bytes  (88 / 202 files) (260.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:05,099 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_abvegaoffset_0004.rmap           1.4 K bytes  (89 / 202 files) (264.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:05,333 - CRDS - INFO -  Fetching  mappings/jwst/jwst_niriss_0267.imap                        5.8 K bytes  (90 / 202 files) (266.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:05,571 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_wfssbkg_0004.rmap                7.2 K bytes  (91 / 202 files) (271.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:05,807 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_wavelengthrange_0010.rmap          996 bytes  (92 / 202 files) (279.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:06,043 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_tsophot_0003.rmap                  896 bytes  (93 / 202 files) (280.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:06,283 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_trappars_0003.rmap               1.6 K bytes  (94 / 202 files) (281.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:06,519 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_trapdensity_0003.rmap            1.6 K bytes  (95 / 202 files) (282.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:06,756 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_superbias_0018.rmap             16.2 K bytes  (96 / 202 files) (284.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:07,065 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_specwcs_0022.rmap                7.1 K bytes  (97 / 202 files) (300.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:07,304 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_sirskernel_0002.rmap               671 bytes  (98 / 202 files) (307.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:07,542 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_saturation_0010.rmap             2.2 K bytes  (99 / 202 files) (308.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:07,779 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_readnoise_0025.rmap             23.2 K bytes  (100 / 202 files) (310.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:08,092 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_psfmask_0008.rmap               28.4 K bytes  (101 / 202 files) (333.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:08,402 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_photom_0028.rmap                 3.4 K bytes  (102 / 202 files) (361.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:08,637 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_persat_0005.rmap                 1.6 K bytes  (103 / 202 files) (365.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:08,879 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-whitelightstep_0003.rmap    1.5 K bytes  (104 / 202 files) (366.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:09,115 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-tweakregstep_0003.rmap      4.5 K bytes  (105 / 202 files) (368.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:09,353 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-spec2pipeline_0008.rmap       984 bytes  (106 / 202 files) (372.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:09,595 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-sourcecatalogstep_0002.rmap    4.6 K bytes  (107 / 202 files) (373.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:09,832 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-resamplestep_0002.rmap        687 bytes  (108 / 202 files) (378.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:10,076 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-outlierdetectionstep_0003.rmap      940 bytes  (109 / 202 files) (379.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:10,315 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-jumpstep_0005.rmap            806 bytes  (110 / 202 files) (380.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:10,555 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-image2pipeline_0003.rmap    1.0 K bytes  (111 / 202 files) (380.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:10,793 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-detector1pipeline_0003.rmap    1.0 K bytes  (112 / 202 files) (381.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:11,038 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-darkpipeline_0002.rmap        868 bytes  (113 / 202 files) (382.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:11,280 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_pars-darkcurrentstep_0001.rmap      618 bytes  (114 / 202 files) (383.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:11,520 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_mask_0011.rmap                   3.5 K bytes  (115 / 202 files) (384.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:11,758 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_linearity_0011.rmap              2.4 K bytes  (116 / 202 files) (387.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:11,996 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_ipc_0003.rmap                    2.0 K bytes  (117 / 202 files) (390.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:12,232 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_gain_0016.rmap                   2.1 K bytes  (118 / 202 files) (392.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:12,472 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_flat_0027.rmap                  51.7 K bytes  (119 / 202 files) (394.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:12,855 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_filteroffset_0004.rmap           1.4 K bytes  (120 / 202 files) (446.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:13,092 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_extract1d_0004.rmap                842 bytes  (121 / 202 files) (447.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:13,333 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_drizpars_0001.rmap                 519 bytes  (122 / 202 files) (448.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:13,571 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_distortion_0033.rmap            53.4 K bytes  (123 / 202 files) (448.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:13,960 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_dark_0046.rmap                  26.4 K bytes  (124 / 202 files) (502.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:14,273 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_area_0012.rmap                  33.5 K bytes  (125 / 202 files) (528.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:14,583 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_apcorr_0008.rmap                 4.3 K bytes  (126 / 202 files) (562.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:14,819 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_abvegaoffset_0003.rmap           1.3 K bytes  (127 / 202 files) (566.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:15,063 - CRDS - INFO -  Fetching  mappings/jwst/jwst_nircam_0301.imap                        5.6 K bytes  (128 / 202 files) (567.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:15,300 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_wavelengthrange_0027.rmap            929 bytes  (129 / 202 files) (573.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:15,538 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_tsophot_0004.rmap                    882 bytes  (130 / 202 files) (574.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:15,776 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_straymask_0009.rmap                  987 bytes  (131 / 202 files) (575.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:16,012 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_specwcs_0042.rmap                  5.8 K bytes  (132 / 202 files) (576.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:16,250 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_saturation_0015.rmap               1.2 K bytes  (133 / 202 files) (581.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:16,488 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_rscd_0008.rmap                     1.0 K bytes  (134 / 202 files) (583.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:16,726 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_resol_0006.rmap                      790 bytes  (135 / 202 files) (584.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:16,963 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_reset_0026.rmap                    3.9 K bytes  (136 / 202 files) (584.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:17,201 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_regions_0033.rmap                  5.2 K bytes  (137 / 202 files) (588.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:17,442 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_readnoise_0023.rmap                1.6 K bytes  (138 / 202 files) (593.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:17,679 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_psfmask_0009.rmap                  2.1 K bytes  (139 / 202 files) (595.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:17,915 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_psf_0002.rmap                        753 bytes  (140 / 202 files) (597.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:18,149 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_photom_0056.rmap                   3.7 K bytes  (141 / 202 files) (598.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:18,383 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pathloss_0005.rmap                   866 bytes  (142 / 202 files) (602.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:18,620 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-whitelightstep_0003.rmap        912 bytes  (143 / 202 files) (603.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:18,860 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-tweakregstep_0003.rmap        1.8 K bytes  (144 / 202 files) (604.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:19,095 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-spec3pipeline_0009.rmap         816 bytes  (145 / 202 files) (605.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:19,334 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-spec2pipeline_0012.rmap       1.3 K bytes  (146 / 202 files) (606.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:19,569 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-sourcecatalogstep_0003.rmap    1.9 K bytes  (147 / 202 files) (607.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:19,804 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-resamplestep_0002.rmap          677 bytes  (148 / 202 files) (609.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:20,040 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-resamplespecstep_0002.rmap      706 bytes  (149 / 202 files) (610.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:20,275 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-outlierdetectionstep_0017.rmap    3.4 K bytes  (150 / 202 files) (611.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:20,519 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-jumpstep_0011.rmap            1.6 K bytes  (151 / 202 files) (614.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:20,759 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-image2pipeline_0007.rmap        983 bytes  (152 / 202 files) (616.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:20,994 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-extract1dstep_0003.rmap         807 bytes  (153 / 202 files) (617.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:21,228 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-emicorrstep_0003.rmap           796 bytes  (154 / 202 files) (618.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:21,472 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-detector1pipeline_0010.rmap    1.6 K bytes  (155 / 202 files) (618.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:21,708 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-darkpipeline_0002.rmap          860 bytes  (156 / 202 files) (620.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:21,944 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_pars-darkcurrentstep_0002.rmap       683 bytes  (157 / 202 files) (621.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:22,181 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_mrsxartcorr_0002.rmap              2.2 K bytes  (158 / 202 files) (621.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:22,418 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_mrsptcorr_0005.rmap                2.0 K bytes  (159 / 202 files) (624.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:22,653 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_mask_0023.rmap                     3.5 K bytes  (160 / 202 files) (626.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:22,891 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_linearity_0018.rmap                2.8 K bytes  (161 / 202 files) (629.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:23,130 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_ipc_0008.rmap                        700 bytes  (162 / 202 files) (632.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:23,365 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_gain_0013.rmap                     3.9 K bytes  (163 / 202 files) (633.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:23,605 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_fringefreq_0003.rmap               1.4 K bytes  (164 / 202 files) (636.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:23,840 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_fringe_0019.rmap                   3.9 K bytes  (165 / 202 files) (638.4 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:24,077 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_flat_0065.rmap                    15.5 K bytes  (166 / 202 files) (642.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:24,382 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_filteroffset_0025.rmap             2.5 K bytes  (167 / 202 files) (657.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:24,617 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_extract1d_0020.rmap                1.4 K bytes  (168 / 202 files) (660.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:24,852 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_emicorr_0003.rmap                    663 bytes  (169 / 202 files) (661.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:25,088 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_drizpars_0002.rmap                   511 bytes  (170 / 202 files) (662.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:25,364 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_distortion_0040.rmap               4.9 K bytes  (171 / 202 files) (662.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:25,599 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_dark_0036.rmap                     4.4 K bytes  (172 / 202 files) (667.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:25,835 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_cubepar_0017.rmap                    800 bytes  (173 / 202 files) (672.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:26,071 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_area_0015.rmap                       866 bytes  (174 / 202 files) (672.9 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:26,307 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_apcorr_0019.rmap                   5.0 K bytes  (175 / 202 files) (673.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:26,541 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_abvegaoffset_0003.rmap             1.3 K bytes  (176 / 202 files) (678.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:26,778 - CRDS - INFO -  Fetching  mappings/jwst/jwst_miri_0423.imap                          5.8 K bytes  (177 / 202 files) (680.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:27,017 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_trappars_0004.rmap                    903 bytes  (178 / 202 files) (685.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:27,254 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_trapdensity_0006.rmap                 930 bytes  (179 / 202 files) (686.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:27,492 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_superbias_0017.rmap                 3.8 K bytes  (180 / 202 files) (687.7 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:27,727 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_saturation_0009.rmap                  779 bytes  (181 / 202 files) (691.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:27,962 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_readnoise_0011.rmap                 1.3 K bytes  (182 / 202 files) (692.2 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:28,197 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_photom_0014.rmap                    1.1 K bytes  (183 / 202 files) (693.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:28,435 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_persat_0006.rmap                      884 bytes  (184 / 202 files) (694.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:28,669 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-tweakregstep_0002.rmap           850 bytes  (185 / 202 files) (695.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:28,904 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-sourcecatalogstep_0001.rmap      636 bytes  (186 / 202 files) (696.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:29,140 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-outlierdetectionstep_0001.rmap      654 bytes  (187 / 202 files) (697.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:29,374 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-image2pipeline_0005.rmap         974 bytes  (188 / 202 files) (697.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:29,614 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-detector1pipeline_0002.rmap    1.0 K bytes  (189 / 202 files) (698.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:29,852 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_pars-darkpipeline_0002.rmap           856 bytes  (190 / 202 files) (699.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:30,089 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_mask_0023.rmap                      1.1 K bytes  (191 / 202 files) (700.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:30,326 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_linearity_0015.rmap                   925 bytes  (192 / 202 files) (701.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:30,561 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_ipc_0003.rmap                         614 bytes  (193 / 202 files) (702.5 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:30,799 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_gain_0010.rmap                        890 bytes  (194 / 202 files) (703.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:31,035 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_flat_0009.rmap                      1.1 K bytes  (195 / 202 files) (704.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:31,272 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_distortion_0011.rmap                1.2 K bytes  (196 / 202 files) (705.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:31,511 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_dark_0017.rmap                      4.3 K bytes  (197 / 202 files) (706.3 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:31,748 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_area_0010.rmap                      1.2 K bytes  (198 / 202 files) (710.6 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:31,986 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_apcorr_0004.rmap                    4.0 K bytes  (199 / 202 files) (711.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:32,222 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_abvegaoffset_0002.rmap              1.3 K bytes  (200 / 202 files) (715.8 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:32,458 - CRDS - INFO -  Fetching  mappings/jwst/jwst_fgs_0118.imap                           5.1 K bytes  (201 / 202 files) (717.0 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:32,694 - CRDS - INFO -  Fetching  mappings/jwst/jwst_1321.pmap                                 580 bytes  (202 / 202 files) (722.1 K / 722.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:33,075 - CRDS - INFO -  Fetching  references/jwst/miri/jwst_miri_apcorr_0014.fits           25.9 K bytes  (1 / 1 files) (0 / 25.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:33,387 - stpipe.SourceCatalogStep - INFO - Using APCORR reference file: references/jwst/miri/jwst_miri_apcorr_0014.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:33,394 - CRDS - INFO -  Fetching  references/jwst/miri/jwst_miri_abvegaoffset_0002.asdf      1.8 K bytes  (1 / 1 files) (0 / 1.8 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:33,649 - stpipe.SourceCatalogStep - INFO - Using ABVEGAOFFSET reference file: references/jwst/miri/jwst_miri_abvegaoffset_0002.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:33,649 - stpipe - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:33,650 - stpipe - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:33,650 - stpipe - INFO - Filter: F560W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:33,650 - stpipe - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       mag       
-----------------
19.31366672281622
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 4.10%
</pre></div>
</div>
<img alt="../../../_images/f045d008104237e34cd1dfd45fa55eb1d151147842f538c3f0ad34501d1c7409.png" src="../../../_images/f045d008104237e34cd1dfd45fa55eb1d151147842f538c3f0ad34501d1c7409.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 79.63166525000008
Starting 2.0  of 13 : &lt;SkyCoord (ICRS): (ra, dec) in deg
    (80.69947281, -69.44357619)&gt;
Setting up sim to match ./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAST OPD query around UTC: 2022-04-13T03:08:10.578
                        MJD: 59682.13067798611

OPD immediately preceding the given datetime:
	URI:	 mast:JWST/product/R2022041201-NRCA3_FP1-2.fits
	Date (MJD):	 59681.7791
	Delta time:	 -0.3516 days

OPD immediately following the given datetime:
	URI:	 mast:JWST/product/R2022041301-NRCA3_FP1-1.fits
	Date (MJD):	 59682.8401
	Delta time:	 0.7094 days
User requested choosing OPD time closest in time to 2022-04-13T03:08:10.578, which is R2022041201-NRCA3_FP1-2.fits, delta time -0.352 days
Importing and format-converting OPD from ./webbpsf-data/webbpsf-data/MAST_JWST_WSS_OPDs/R2022041201-NRCA3_FP1-2.fits
Backing out SI WFE and OTE field dependence at the WF sensing field point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Configured simulation instrument for:
    Instrument: MIRI
    Filter: F560W
    Detector: MIRIM
    Apername: MIRIM_FULL
    Det. Pos.: (693, 512) 
    Image plane mask: None
    Pupil plane mask: None
    

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(187.37414158), array(502.80262111)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.43616932953458, 201.73577860812014)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(140.42082679), array(465.07722232)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.40301794781075, 201.76236638868846)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(184.2927142), array(501.92870851)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.4341768144819, 201.7376011650385)

Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/1: (array(137.45242516), array(464.12546009)) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/1 centroid: (201.4006941341772, 201.76403586364324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,403 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,405 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,407 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,409 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,410 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,412 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,413 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,643 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;./temp_psf_dir/cal_data_asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,656 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./temp_psf_dir
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  in_memory: True
  steps:
    assign_mtwcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: False
      suffix: assign_mtwcs
      search_output_file: True
      input_dir: &#39;&#39;
    tweakreg:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: True
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_catalogs: False
      use_custom_catalogs: False
      catalog_format: ecsv
      catfile: &#39;&#39;
      starfinder: iraf
      snr_threshold: 10.0
      bkg_boxsize: 400
      kernel_fwhm: 2.5
      minsep_fwhm: 0.0
      sigma_radius: 1.5
      sharplo: 0.5
      sharphi: 2.0
      roundlo: 0.0
      roundhi: 0.2
      brightest: 200
      peakmax: None
      npixels: 10
      connectivity: &#39;8&#39;
      nlevels: 32
      contrast: 0.001
      multithresh_mode: exponential
      localbkg_width: 0
      apermask_method: correct
      kron_params: None
      enforce_user_order: False
      expand_refcat: False
      minobj: 15
      fitgeometry: rshift
      nclip: 3
      sigma: 3.0
      searchrad: 2.0
      use2dhist: True
      separation: 1.0
      tolerance: 0.7
      xoffset: 0.0
      yoffset: 0.0
      abs_refcat: &#39;&#39;
      save_abs_catalog: False
      abs_minobj: 15
      abs_fitgeometry: rshift
      abs_nclip: 3
      abs_sigma: 3.0
      abs_searchrad: 6.0
      abs_use2dhist: True
      abs_separation: 1.0
      abs_tolerance: 0.7
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      in_memory: True
    skymatch:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      skymethod: match
      match_down: True
      subtract: False
      stepsize: None
      skystat: mode
      dqbits: ~DO_NOT_USE+NON_SCIENCE
      lower: None
      upper: None
      nclip: 5
      lsigma: 4.0
      usigma: 4.0
      binwidth: 0.1
      in_memory: True
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      in_memory: False
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: ivm
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: !!python/object/apply:numpy.core.multiarray.scalar
      - !!python/object/apply:numpy.dtype
        args:
        - f8
        - False
        - True
        state: !!python/tuple
        - 3
        - &lt;
        - None
        - None
        - None
        - -1
        - -1
        - 0
      - !!binary |
        S8+wK09fvD8=
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
    source_catalog:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: cat
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_boxsize: 1000
      kernel_fwhm: 2.0
      snr_threshold: 3.0
      npixels: 25
      deblend: False
      aperture_ee1: 30
      aperture_ee2: 50
      aperture_ee3: 70
      ci1_star_threshold: 2.0
      ci2_star_threshold: 1.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:54,657 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:55,156 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f6254265650&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:55,157 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,066 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f6254265650&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,067 - stpipe.Image3Pipeline.skymatch - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,282 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f6254265650&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,283 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,493 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7f6254265650&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,495 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,495 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,496 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,496 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,498 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,498 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,499 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,499 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,501 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,501 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,501 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,502 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,503 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;err&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,504 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_rnoise&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,504 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_poisson&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,505 - stpipe.Image3Pipeline.resample - WARNING - Mismatched data shapes; skipping invalid data updates for extension &#39;var_flat&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,506 - stpipe.Image3Pipeline.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,507 - stpipe.Image3Pipeline.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,507 - stpipe.Image3Pipeline.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,508 - stpipe.Image3Pipeline.resample - INFO - Driz parameter weight_type: ivm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,508 - stpipe.Image3Pipeline.resample - INFO - Output pixel scale: 0.11082930390039995 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:56,529 - stpipe.Image3Pipeline.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:57,320 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:57,321 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:57,322 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00004_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:58,073 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:58,074 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:58,074 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00003_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:58,830 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:58,831 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:58,831 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00002_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:59,588 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_rnoise&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:59,590 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_poisson&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:59,590 - stpipe.Image3Pipeline.resample - WARNING - Data shape mismatch for &#39;var_flat&#39; for model &#39;jw01171004001_02101_00001_mirimage_cal.fits&#39;. Skipping ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:43:59,825 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  80.660307842 -69.452650714 80.735816161 -69.472158466 80.791402231 -69.445614065 80.715936684 -69.426130394
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:00,120 - stpipe.Image3Pipeline.resample - INFO - Saved model in ./temp_psf_dir/temp_psf_cals_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:00,121 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:00,344 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1069, 1070) from temp_psf_cals_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:00,345 - stpipe.Image3Pipeline.source_catalog - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:00,349 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:00,349 - stpipe - INFO - Results used jwst version: 1.17.1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.99883175423715]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:01,748 - stpipe.SourceCatalogStep - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 16.18%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:02,044 - stpipe.SourceCatalogStep - INFO - Using APCORR reference file: references/jwst/miri/jwst_miri_apcorr_0014.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:02,051 - stpipe.SourceCatalogStep - INFO - Using ABVEGAOFFSET reference file: references/jwst/miri/jwst_miri_abvegaoffset_0002.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:02,052 - stpipe - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:02,052 - stpipe - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:02,053 - stpipe - INFO - Filter: F560W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-01-10 19:44:02,053 - stpipe - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       mag        
------------------
18.767794854888514
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished PSF psf_photometry with median residuals of 16.17%
</pre></div>
</div>
<img alt="../../../_images/06c6a73ef339729b251e26364129225c61ca1c96725aaf4685122777a8e39286.png" src="../../../_images/06c6a73ef339729b251e26364129225c61ca1c96725aaf4685122777a8e39286.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed Time for Photometry: 28.399515988999838
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lvl2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01171/jw01171004001_02101_00004_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00003_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00002_mirimage_cal.fits&#39;,
 &#39;./mast/01171/jw01171004001_02101_00001_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<p><strong>Important Note</strong>: When not to use. Due to the sensitivity of the space_phot parameters, this tool is not meant to be used for a large sample of stars (i.e., Section 5 below). If a user would like to use space_phot on more than one source, they should carefully construct a table of parameters that are carefully refined for each source.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ra</th>
      <th>dec</th>
      <th>mag</th>
      <th>magerr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80.705200</td>
      <td>-69.437532</td>
      <td>19.514621</td>
      <td>0.003053</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80.699471</td>
      <td>-69.443580</td>
      <td>19.132754</td>
      <td>0.002487</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr style="border:1px solid gray"> </hr><a class="reference internal image-reference" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/MIRI/psf_photometry"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-introduction-a-class-anchor-id-intro-a">1.<font color="white">-</font>Introduction <a class="anchor" id="intro"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-setup-webbpsf-and-synphot-directories-a-class-anchor-id-webbpsf-a">1.1<font color="white">-</font>Setup WebbPSF and Synphot Directories<a class="anchor" id="webbpsf"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-python-imports-a-class-anchor-id-py-imports-a">1.2<font color="white">-</font>Python Imports<a class="anchor" id="py_imports"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-download-data-a-class-anchor-id-data-a">2.<font color="white">-</font>Download Data<a class="anchor" id="data"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-bright-single-object-a-class-anchor-id-bso-a">3.<font color="white">-</font>Bright, Single Object<a class="anchor" id="bso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-bso2-a">3.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="bso2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notes-on-the-psf-fitting-in-space-phot-br">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-bso3-a">3.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="bso3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Notes on the PSF Fitting in Space_Phot: <br/></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#good-agreement-between-level2-and-level3-results">Good agreement between Level2 and level3 results!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-faint-upper-limit-single-object-a-class-anchor-id-fso-a">4.<font color="white">-</font>Faint/Upper Limit, Single Object<a class="anchor" id="fso"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-fso2-a">4.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="fso2"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-fso3-a">4.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="fso3"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-you-can-go-significantly-deeper-with-the-level3-combined-data-product">Note you can go significantly deeper with the Level3 combined data product</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-stellar-field-lmc-a-class-anchor-id-lmc-a">5.<font color="white">-</font>Stellar Field (LMC)<a class="anchor" id="lmc"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-case-we-are-going-to-do-the-same-steps-as-in-section-3-but-for-multiple-stars-the-purpose-is-to-illustrate-the-workflow-and-runtime-for-using-space-phot-on-a-large-number-of-stars-we-suggest-that-space-phot-may-be-less-optimal-for-large-numbers-of-bright-stars-other-programs-such-as-dolphot-or-photutils-may-be-better-suited-for-this-use-case-the-primary-advantage-to-space-phot-is-on-faint-single-sources-but-it-can-be-extended-to-a-larger-number-if-desired">In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using space_phot on a large number of stars. We suggest that space_phot may be less optimal for large numbers of bright stars. Other programs, such as DOLPHOT or Photutils, may be better suited for this use case. The primary advantage to space_phot is on faint, single sources. But it can be extended to a larger number if desired.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-multiple-level2-files-a-class-anchor-id-lmc2-a">5.1<font color="white">-</font>Multiple, Level2 Files<a class="anchor" id="lmc2"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#now-do-the-same-thing-for-a-larger-group-of-stars-and-test-for-speed">Now do the same thing for a larger group of stars and test for speed</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-white-font-single-level3-mosaicked-file-a-class-anchor-id-lmc3-a">5.2<font color="white">-</font>Single, Level3 Mosaicked File<a class="anchor" id="lmc3"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#readers-should-refer-to-all-diagnostics-discussed-above-in-general-this-loop-shows-the-difficulty-in-doing-psf-photometry-on-a-wide-variety-of-stars-brightness-distribution-on-the-detector-etc-without-visual-inspection-especially-when-dealing-with-low-snr-sources-this-is-true-for-all-photometry-packages-users-should-inspect-the-associated-metrics-and-consider-optimizing-the-parameters-for-specific-stars-of-interest-nonetheless-the-success-of-the-fits-can-always-be-quantified-in-with-the-associated-error-bars">Readers should refer to all diagnostics discussed above. In general, this loop shows the difficulty in doing PSF photometry on a wide variety of stars (brightness, distribution on the detector, etc) without visual inspection. Especially when dealing with low SNR sources.This is true for all photometry packages. Users should inspect the associated metrics and consider optimizing the parameters for specific stars of interest. Nonetheless, the success of the fits can always be quantified in with the associated error bars.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>