

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>MIRI PSF Photometry with Photutils &#8212; STScI JDAT Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D46G4HKJY3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D46G4HKJY3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/MIRI/psf_photometry/miri_1028_photutils';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="STScI JDAT Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="STScI JDAT Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">General</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebook_development_workflow.html">Notebook Development Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/submitting_notebooks.html">Submitting Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/requirements.html">Requirements file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/data_files.html">Data Files</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GitHub Guidelines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_setup.html">GitHub Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_workflow.html">GitHub Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/github_pr.html">GitHub PR</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Cross-Instrument</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/asdf_example/asdf_example.html">ASDF Example</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/background_estimation_imaging/Imaging_Sky_Background_Estimation.html">Complex 2D Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/composite_model_fitting/specfit_demo_3.html">Composite Model Spectral Fitting</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/NIRSpec_MAST_Query/NIRSpec_MAST_Query.html">MAST Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/rgb_imviz/imviz_rgb_carina.html">RGB images with Imviz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/specviz_notebookGUI_interaction/specviz_notebook_gui_interaction_redshift.html">Specviz Simple Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cross_instrument/update_pure_parallel_wcs/NIRISS_correct_pure_parallel_WCS.html">Improving Accuracy of WCS of Pure Parallel Dataset</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MIRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html">MRS Mstar - Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI_IFU_YSOs_in_the_LMC/isha_nayak_ysos_in_the_lmc.html">IFU of YSOs in LMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIRI_LRS_spectral_extraction/miri_lrs_advanced_extraction_part1.html">LRS Optimal Spectral Extraction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRCam</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/aperture_photometry/NIRCam_Aperture_Photometry_Example.html">Point Source Aperture Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_photometry/NIRCam_multiband_photometry.html">Extended Aperture Photometry</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html">Cross-Filter PSF Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/psf_photometry/NIRCam_PSF_Photometry_Example.html">PSF Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCam/NIRCam_wisp_subtraction/nircam_wisp_subtraction.html">NIRCam Wisp Removal</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRISS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/00_Optimal_extraction.html">WFSS Spectra - Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/01_Combine_and_normalize_1D_spectra.html">WFSS Spectra - Combine and Normalize 1D Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/02_Cross_correlation_template.html">WFSS Spectra - Cross-Correlation Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_postpipeline/03_Spatially_resolved_emission_line_map.html">WFSS Spectra - Emission Line Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/niriss_imaging/niriss-imaging-tutorial.html">NIRISS Imaging Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/00_niriss_mast_query_data_setup.html">NIRISS MAST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/01_niriss_wfss_image2_image3.html">Direct imaging for WFSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/NIRISS_WFSS_advanced/02_niriss_wfss_spec2.html">Spec2 pipeline for WFSS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRSpec</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/IFU_cube_continuum_fit/NGC4151_FeII_ContinuumFit.html">IFU Cube Fitting</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/cube_fitting/cube_fitting.html">IFU Cube Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/ifu_optimal/ifu_optimal.html">IFU Optimal Spectral Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/optimal_extraction/Spectral_Extraction-static.html">MOS Optimal Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/mos_spectroscopy_advanced/MOSspec_advanced.html">MOS Spectroscopy of Extragalactic Field</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/transit_spectroscopy_notebook/Exoplanet_Transmission_Spectra_JWST.html">BOTS Time Series Observations</a></li>








<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/galaxy_redshift/redshift_fitting.html">Redshift and Template Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/FS_NSClean_example.html">FS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/IFU_NSClean_example.html">IFU Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/MOS_NSClean_example.html">MOS Products with NSClean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSpec/NIRSpec_NSClean/BOTS_NSClean_example.html">BOTS Products with NSClean</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/jdat_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/MIRI/psf_photometry/miri_1028_photutils.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/MIRI/psf_photometry/miri_1028_photutils.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MIRI PSF Photometry with Photutils</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">MIRI PSF Photometry with Photutils</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-a-class-anchor-id-intro-a">1. Introduction <a class="anchor" id="intro"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-imports-a-class-anchor-id-imports-a">1.1 Python Imports <a class="anchor" id="imports"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-set-up-required-data-for-webbpsf-and-synphot-a-class-anchor-id-setup-a">1.2 Download and Set up Required Data for WebbPSF and Synphot <a class="anchor" id="setup"></a></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#download-jwst-miri-data-a-class-anchor-id-data-a">2. Download JWST MIRI Data <a class="anchor" id="data"></a></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#single-bright-star-a-class-anchor-id-bso-a">3. Single Bright Star <a class="anchor" id="bso"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#single-level-2-file-a-class-anchor-id-bso2-a">3.1 Single Level 2 File <a class="anchor" id="bso2"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-empirical-psf-grid-for-miri-f770w-using-webbpsf-a-class-anchor-id-bso3-a">3.2 Generate empirical PSF grid for MIRI F770W using WebbPSF <a class="anchor" id="bso3"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#psf-photometry-a-class-anchor-id-bso4-a">3.3 PSF Photometry <a class="anchor" id="bso4"></a></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#faint-upper-limit-single-object-a-class-anchor-id-fso-a">4. Faint/Upper Limit, Single Object <a class="anchor" id="fso"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-you-can-go-significantly-deeper-with-the-level-3-combined-data-product">Note: you can go significantly deeper with the Level 3 combined data product</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stellar-field-lmc-a-class-anchor-id-lmc-a">5. Stellar Field (LMC) <a class="anchor" id="lmc"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-stars-single-level-2-file-a-class-anchor-id-lmc2-a">5.1 Multiple Stars, Single Level 2 File <a class="anchor" id="lmc2"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-empirical-psf-grid-for-miri-f560w-using-webbpsf-a-class-anchor-id-grid2-a">5.2 Generate empirical PSF grid for MIRI F560W using WebbPSF <a class="anchor" id="grid2"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#psf-photometry-a-class-anchor-id-lmc3-a">5.3 PSF Photometry <a class="anchor" id="lmc3"></a></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="miri-psf-photometry-with-photutils">
<h1>MIRI PSF Photometry with Photutils<a class="headerlink" href="#miri-psf-photometry-with-photutils" title="Permalink to this heading">#</a></h1>
<p><strong>Author</strong>: Ori Fox<br></p>
<p><strong>Submitted</strong>: November, 2023<br>
<strong>Updated</strong>: November, 2023<br></p>
<p><strong>Use case</strong>: PSF Photometry using <a class="reference external" href="https://photutils.readthedocs.io/en/stable/">Photutils</a>. The purpose here is to illustrate the workflow and runtime for using Photutils in a variety of use cases.</p>
<p>Generally, PSF photometry for data from a space telescope is most accurately performed on pre-mosaiced data. The mosaic process changes the inherent PSF, blurring it both due to resampling and mixing PSFs at different detector positions and rotations.  Additionally, accurate theoretical PSF models (e.g., from <a class="reference external" href="https://webbpsf.readthedocs.io/en/latest/">WebbPSF</a>) are not available for mosaiced data. While an empirical PSF could be constructed (e.g., using Photutils <a class="reference external" href="https://photutils.readthedocs.io/en/latest/epsf.html">ePSFBuilder</a>) for mosaiced data, the results will generally not be as accurate as performing PSF photometry on the pre-mosaiced data.</p>
<p><strong>NOTE:</strong> A companion notebook exists that illustrates how to use perform PSF photometry on both Level 2 and Level 3 data using a new software program called space_phot.<br>
<strong>Data</strong>: MIRI Data PID 1028 (Calibration Program; Single Star Visit 006 A5V dwarf 2MASSJ17430448+6655015) and MIRI Data PID 1171 (LMC; Multiple Stars).<br>
<strong>Tools</strong>: photutils, webbpsf, jwst <br>
<strong>Cross-Instrument</strong>: MIRI<br>
<strong>Documentation:</strong> This notebook is part of a STScI’s larger <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-post-pipeline-data-analysis">post-pipeline Data Analysis Tools Ecosystem</a> and can be <a class="reference external" href="https://github.com/spacetelescope/dat_pyinthesky/tree/main/jdat_notebooks/MRS_Mstar_analysis">downloaded</a> directly from the <a class="reference external" href="https://github.com/spacetelescope/jdat_notebooks">JDAT Notebook Github directory</a>.<br></p>
<section id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><span class="xref myst">Introduction</span><br>
1.1 <span class="xref myst">Python Imports</span><br>
1.2 <span class="xref myst">Set up WebbPSF and Synphot</span><br></p></li>
<li><p><span class="xref myst">Download JWST MIRI Data</span><br></p></li>
<li><p><span class="xref myst">Single Bright Object</span><br>
3.1 <span class="xref myst">Single Level 2 File</span><br>
3.2 <span class="xref myst">Generate empirical PSF grid for MIRI F770W using WebbPSF</span><br>
3.3 <span class="xref myst">PSF Photometry</span><br></p></li>
<li><p><span class="xref myst">Faint/Upper Limit, Single Object</span><br>
4.1 <span class="xref myst">Multiple, Level2 Files</span><br></p></li>
<li><p><span class="xref myst">Stellar Field (LMC)</span><br>
5.1 <span class="xref myst">Multiple Stars, Single Level 2 File</span><br>
5.2 <span class="xref myst">Generate empirical PSF grid for MIRI F560W using WebbPSF</span><br>
5.3 <span class="xref myst">PSF Photometry</span><br></p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction-a-class-anchor-id-intro-a">
<h1>1. Introduction <a class="anchor" id="intro"></a><a class="headerlink" href="#introduction-a-class-anchor-id-intro-a" title="Permalink to this heading">#</a></h1>
<p><strong>GOALS</strong>:<br></p>
<p>Perform PSF photometry on JWST MIRI images with the <a class="reference external" href="https://photutils.readthedocs.io/en/latest/psf.html">Photutils PSF Photometry tools</a> using a grid of empirical PSF models from WebbPSF.</p>
<p>The notebook shows how to:<br></p>
<ul class="simple">
<li><p>generate a <a class="reference external" href="https://webbpsf.readthedocs.io/en/latest/psf_grids.html">grid of empirical PSF models</a> from WebbPSF<br></p></li>
<li><p>perform PSF photometry on the image using the <a class="reference external" href="https://photutils.readthedocs.io/en/latest/api/photutils.psf.PSFPhotometry.html#photutils.psf.PSFPhotometry">PSFPhotometry class</a><br></p></li>
</ul>
<p><strong>Data</strong>:<br></p>
<p>MIRI Data PID 1028 (Calibration Program), F770W <br>
MIRI Data PID 1171 (LMC), F560W/F770W</p>
<section id="python-imports-a-class-anchor-id-imports-a">
<h2>1.1 Python Imports <a class="anchor" id="imports"></a><a class="headerlink" href="#python-imports-a-class-anchor-id-imports-a" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">tarfile</span>

<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">webbpsf</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="kn">import</span> <span class="n">extract_array</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">simple_norm</span>
<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span> <span class="nn">jwst.datamodels</span> <span class="kn">import</span> <span class="n">ImageModel</span>
<span class="kn">from</span> <span class="nn">photutils.aperture</span> <span class="kn">import</span> <span class="n">CircularAperture</span>
<span class="kn">from</span> <span class="nn">photutils.background</span> <span class="kn">import</span> <span class="n">LocalBackground</span><span class="p">,</span> <span class="n">MADStdBackgroundRMS</span><span class="p">,</span> <span class="n">MMMBackground</span>
<span class="kn">from</span> <span class="nn">photutils.detection</span> <span class="kn">import</span> <span class="n">DAOStarFinder</span>
<span class="kn">from</span> <span class="nn">photutils.psf</span> <span class="kn">import</span> <span class="n">GriddedPSFModel</span><span class="p">,</span> <span class="n">PSFPhotometry</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-and-set-up-required-data-for-webbpsf-and-synphot-a-class-anchor-id-setup-a">
<h2>1.2 Download and Set up Required Data for WebbPSF and Synphot <a class="anchor" id="setup"></a><a class="headerlink" href="#download-and-set-up-required-data-for-webbpsf-and-synphot-a-class-anchor-id-setup-a" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set environmental variables</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;WEBBPSF_PATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./webbpsf-data/webbpsf-data&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PYSYN_CDBS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./grp/redcat/trds/&quot;</span>

<span class="c1"># required webbpsf data</span>
<span class="n">boxlink</span> <span class="o">=</span> <span class="s1">&#39;https://stsci.box.com/shared/static/qxpiaxsjwo15ml6m4pkhtk36c9jgj70k.gz&#39;</span>                                                          
<span class="n">boxfile</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data/webbpsf-data-LATEST.tar.gz&#39;</span>
<span class="n">synphot_url</span> <span class="o">=</span> <span class="s1">&#39;http://ssb.stsci.edu/trds/tarfiles/synphot5.tar.gz&#39;</span>
<span class="n">synphot_file</span> <span class="o">=</span> <span class="s1">&#39;./synphot5.tar.gz&#39;</span>

<span class="n">webbpsf_folder</span> <span class="o">=</span> <span class="s1">&#39;./webbpsf-data&#39;</span>
<span class="n">synphot_folder</span> <span class="o">=</span> <span class="s1">&#39;./grp&#39;</span>


<span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s2">&quot;https&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported URL scheme: </span><span class="si">{</span><span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dest_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>


<span class="c1"># Gather webbpsf files</span>
<span class="n">psfExist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">psfExist</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">)</span>
    <span class="n">download_file</span><span class="p">(</span><span class="n">boxlink</span><span class="p">,</span> <span class="n">boxfile</span><span class="p">)</span>
    <span class="n">gzf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">boxfile</span><span class="p">)</span>
    <span class="n">gzf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">webbpsf_folder</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>

<span class="c1"># Gather synphot files</span>
<span class="n">synExist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">synphot_folder</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">synExist</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">synphot_folder</span><span class="p">)</span>
    <span class="n">download_file</span><span class="p">(</span><span class="n">synphot_url</span><span class="p">,</span> <span class="n">synphot_file</span><span class="p">)</span>
    <span class="n">gzf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">synphot_file</span><span class="p">)</span>
    <span class="n">gzf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="download-jwst-miri-data-a-class-anchor-id-data-a">
<h1>2. Download JWST MIRI Data <a class="anchor" id="data"></a><a class="headerlink" href="#download-jwst-miri-data-a-class-anchor-id-data-a" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download Proposal ID 1028 F770W data</span>

<span class="c1"># Define source and destination directories</span>
<span class="n">source_dir</span> <span class="o">=</span> <span class="s1">&#39;mastDownload/JWST/&#39;</span>
<span class="n">destination_dir</span> <span class="o">=</span> <span class="s1">&#39;mast/01028/&#39;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Data already downloaded to </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Query the MAST (Mikulski Archive for Space Telescopes) database for observations</span>
    <span class="c1"># with proposal ID 1028 and the F770W filter</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">proposal_id</span><span class="o">=</span><span class="mi">1028</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F770W&#39;</span><span class="p">])</span>
    
    <span class="c1"># Get a list of products associated with the located observation</span>
    <span class="n">plist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
    
    <span class="c1"># Filter the product list to include only specific product subgroups</span>
    <span class="n">fplist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CAL&#39;</span><span class="p">,</span> <span class="s1">&#39;I2D&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">])</span>
    
    <span class="c1"># Download the selected products from the MAST database</span>
    <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">fplist</span><span class="p">)</span>
    
    <span class="c1"># Create the destination directory</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>
    
    <span class="c1"># Use glob to find all files matching the pattern</span>
    <span class="n">files_to_copy</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span> <span class="s1">&#39;j*/jw01028*&#39;</span><span class="p">))</span>

    <span class="c1"># Copy the matching files to the destination directory</span>
    <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">files_to_copy</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00013_asn.json to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028-o006_20241028t203024_image2_00013_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00014_asn.json to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028-o006_20241028t203024_image2_00014_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00015_asn.json to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028-o006_20241028t203024_image2_00015_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image2_00016_asn.json to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028-o006_20241028t203024_image2_00016_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_20241028t203024_image3_00004_asn.json to ./mastDownload/JWST/jw01028-o006_t001_miri_f770w/jw01028-o006_20241028t203024_image3_00004_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028-o006_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01028-o006_t001_miri_f770w/jw01028-o006_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028006001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00001_mirimage/jw01028006001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028006001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00002_mirimage/jw01028006001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028006001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00003_mirimage/jw01028006001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028006001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01028006001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01028006001_02101_00004_mirimage/jw01028006001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download Proposal ID 1171 F560W and F770W data</span>

<span class="c1"># Define source and destination directories</span>
<span class="n">source_dir</span> <span class="o">=</span> <span class="s1">&#39;mastDownload/JWST/&#39;</span>
<span class="n">destination_dir</span> <span class="o">=</span> <span class="s1">&#39;mast/01171/&#39;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Data already downloaded to </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Query the MAST (Mikulski Archive for Space Telescopes) database for observations</span>
    <span class="c1"># with proposal ID 1171 and the F550W and F770W filters</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">proposal_id</span><span class="o">=</span><span class="mi">1171</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F560W&#39;</span><span class="p">,</span> <span class="s1">&#39;F770W&#39;</span><span class="p">])</span>
    
    <span class="c1"># Get a list of products associated with the located observation</span>
    <span class="n">plist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
    
    <span class="c1"># Filter the product list to include only specific product subgroups</span>
    <span class="n">fplist</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CAL&#39;</span><span class="p">,</span> <span class="s1">&#39;I2D&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">])</span>
    
    <span class="c1"># Download the selected products from the MAST database</span>
    <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">fplist</span><span class="p">)</span>
    
    <span class="c1"># Create the destination directory</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span>
    
    <span class="c1"># Use glob to find all files matching the pattern</span>
    <span class="n">files_to_copy</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">source_dir</span><span class="p">,</span> <span class="s1">&#39;j*/jw01171*&#39;</span><span class="p">))</span>
    
    <span class="c1"># Copy the matching files to the destination directory</span>
    <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">files_to_copy</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171-o001_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171-o001_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171-o001_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171-o001_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o001_t001_miri_f770w/jw01171-o001_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o001_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o001_t001_miri_f770w/jw01171-o001_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171-o002_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171-o002_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171-o002_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171-o002_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o002_t001_miri_f770w/jw01171-o002_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o002_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o002_t001_miri_f770w/jw01171-o002_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171-o003_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171-o003_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171-o003_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171-o003_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o003_t001_miri_f770w/jw01171-o003_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o003_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o003_t001_miri_f770w/jw01171-o003_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171-o004_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171-o004_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171-o004_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171-o004_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o004_t001_miri_f560w/jw01171-o004_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o004_t001_miri_f560w_i2d.fits to ./mastDownload/JWST/jw01171-o004_t001_miri_f560w/jw01171-o004_t001_miri_f560w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00005_asn.json to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171-o005_20231102t191130_image2_00005_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00006_asn.json to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171-o005_20231102t191130_image2_00006_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00007_asn.json to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171-o005_20231102t191130_image2_00007_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image2_00008_asn.json to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171-o005_20231102t191130_image2_00008_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_20231102t191130_image3_00002_asn.json to ./mastDownload/JWST/jw01171-o005_t001_miri_f770w/jw01171-o005_20231102t191130_image3_00002_asn.json ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171-o005_t001_miri_f770w_i2d.fits to ./mastDownload/JWST/jw01171-o005_t001_miri_f770w/jw01171-o005_t001_miri_f770w_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171001001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00001_mirimage/jw01171001001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171001001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00002_mirimage/jw01171001001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171001001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00003_mirimage/jw01171001001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171001001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171001001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171001001_02101_00004_mirimage/jw01171001001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171002001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00001_mirimage/jw01171002001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171002001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00002_mirimage/jw01171002001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171002001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00003_mirimage/jw01171002001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171002001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171002001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171002001_02101_00004_mirimage/jw01171002001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171003001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00001_mirimage/jw01171003001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171003001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00002_mirimage/jw01171003001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171003001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00003_mirimage/jw01171003001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171003001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171003001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171003001_02101_00004_mirimage/jw01171003001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171004001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00001_mirimage/jw01171004001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171004001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00002_mirimage/jw01171004001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171004001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00003_mirimage/jw01171004001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171004001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171004001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171004001_02101_00004_mirimage/jw01171004001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00001_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171005001_02101_00001_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00001_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00001_mirimage/jw01171005001_02101_00001_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00002_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171005001_02101_00002_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00002_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00002_mirimage/jw01171005001_02101_00002_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00003_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171005001_02101_00003_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00003_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00003_mirimage/jw01171005001_02101_00003_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00004_mirimage_cal.fits to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171005001_02101_00004_mirimage_cal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01171005001_02101_00004_mirimage_i2d.fits to ./mastDownload/JWST/jw01171005001_02101_00004_mirimage/jw01171005001_02101_00004_mirimage_i2d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="single-bright-star-a-class-anchor-id-bso-a">
<h1>3. Single Bright Star <a class="anchor" id="bso"></a><a class="headerlink" href="#single-bright-star-a-class-anchor-id-bso-a" title="Permalink to this heading">#</a></h1>
<p>The purpose of this section is to illustrate how to perform PSF photometry on a single bright star. While aperture photometry is feasible in isolated cases, the user may find PSF photometry preferable in crowded fields or complicated backgrounds.</p>
<section id="single-level-2-file-a-class-anchor-id-bso2-a">
<h2>3.1 Single Level 2 File <a class="anchor" id="bso2"></a><a class="headerlink" href="#single-level-2-file-a-class-anchor-id-bso2-a" title="Permalink to this heading">#</a></h2>
<p>In this example, we fit a single, bright source in a single Level 2 images. For a collection of Level 2 images, we could fit each Level 2 image individually and then average the measured fluxes.</p>
<p>Useful references:<br>
HST Documentation on PSF Photometry: https://www.stsci.edu/hst/instrumentation/wfc3/data-analysis/psf<br>
WFPC2 Stellar Photometry with HSTPHOT: https://ui.adsabs.harvard.edu/abs/2000PASP..112.1383D/abstract<br>
Photutils PSF Fitting Photometry: https://photutils.readthedocs.io/en/stable/psf.html</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the level 2 filenames</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;./mast/01028/&quot;</span>
<span class="n">level2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;*cal.fits&#39;</span><span class="p">)))</span>
<span class="n">level2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;./mast/01028/jw01028006001_02101_00001_mirimage_cal.fits&#39;,
 &#39;./mast/01028/jw01028006001_02101_00002_mirimage_cal.fits&#39;,
 &#39;./mast/01028/jw01028006001_02101_00003_mirimage_cal.fits&#39;,
 &#39;./mast/01028/jw01028006001_02101_00004_mirimage_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># display the first level-2 image</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">level2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MJy/sr&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Pixels&#39;)
</pre></div>
</div>
<img alt="../../../_images/a122ac59891d4cee23687d593f1818242ebfb48a7299705f9dade6f0adc58cac.png" src="../../../_images/a122ac59891d4cee23687d593f1818242ebfb48a7299705f9dade6f0adc58cac.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change all DQ flagged pixels to NaN.</span>
<span class="c1"># Here, we&#39;ll overwrite the original CAL file.</span>
<span class="c1"># Reference for JWST DQ Flag Definitions: https://jwst-pipeline.readthedocs.io/en/latest/jwst/references_general/references_general.html</span>
<span class="c1"># In this case, we choose all DQ &gt; 10, but users are encouraged to choose their own values accordingly.</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">level2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">with</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Re-display the image</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">level2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MJy/sr&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Pixels&#39;)
</pre></div>
</div>
<img alt="../../../_images/ca10cbc0c46d6a663aae6ab4452ffaa64f43ee5dc70c8b7f3fd2ef829fed6fbe.png" src="../../../_images/ca10cbc0c46d6a663aae6ab4452ffaa64f43ee5dc70c8b7f3fd2ef829fed6fbe.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zoom in to see the source. In this case, our source is from MIRI Program ID #1028, a Calibration Program.</span>
<span class="c1"># We are using Visit 006, which targets the A5V dwarf 2MASSJ17430448+6655015</span>
<span class="c1"># Reference Link: http://simbad.cds.unistra.fr/simbad/sim-basic?Ident=2MASSJ17430448%2B6655015&amp;submit=SIMBAD+search</span>
<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:04.4879&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:55:01.837&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="k">with</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">)</span>

<span class="n">cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">norm2</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">cutout</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MJy/sr&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PID1028, Obs006&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Pixels&#39;)
</pre></div>
</div>
<img alt="../../../_images/f63589d99984b2224d4193014076b802d272d033b60b1acd38168d131e83c88a.png" src="../../../_images/f63589d99984b2224d4193014076b802d272d033b60b1acd38168d131e83c88a.png" />
</div>
</div>
</section>
<section id="generate-empirical-psf-grid-for-miri-f770w-using-webbpsf-a-class-anchor-id-bso3-a">
<h2>3.2 Generate empirical PSF grid for MIRI F770W using WebbPSF <a class="anchor" id="bso3"></a><a class="headerlink" href="#generate-empirical-psf-grid-for-miri-f770w-using-webbpsf-a-class-anchor-id-bso3-a" title="Permalink to this heading">#</a></h2>
<p>Let’s now use WebbPSF to generate an empirical grid of ePSF models for MIRI F770W.
The output will be a Photutils <a class="reference external" href="https://photutils.readthedocs.io/en/latest/api/photutils.psf.GriddedPSFModel.html#photutils.psf.GriddedPSFModel">GriddedPSFModel</a> containing a 2x2 grid of detector-position-dependent empirical PSFs, each oversampled by a factor of 4. Note that we save the PSF grid to a FITS file (via <code class="docutils literal notranslate"><span class="pre">save=True</span></code>) called <code class="docutils literal notranslate"><span class="pre">miri_mirim_f770w_fovp101_samp4_npsf4.fits</span></code>.  To save time in future runs, we load this FITS file directly into a <code class="docutils literal notranslate"><span class="pre">GriddedPSFModel</span></code> object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psfgrid_filename</span> <span class="o">=</span> <span class="s1">&#39;miri_mirim_f770w_fovp101_samp4_npsf4.fits&#39;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">psfgrid_filename</span><span class="p">):</span>
    <span class="n">miri</span> <span class="o">=</span> <span class="n">webbpsf</span><span class="o">.</span><span class="n">MIRI</span><span class="p">()</span>
    <span class="n">miri</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="s1">&#39;F770W&#39;</span>
    <span class="n">psf_model</span> <span class="o">=</span> <span class="n">miri</span><span class="o">.</span><span class="n">psf_grid</span><span class="p">(</span><span class="n">num_psfs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">all_detectors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">psf_model</span> <span class="o">=</span> <span class="n">GriddedPSFModel</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">psfgrid_filename</span><span class="p">)</span>

<span class="n">psf_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running instrument: MIRI, filter: F770W
  Running detector: MIRIM
    Position 1/4: (0, 0) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:00:05,207 - stpipe - WARNING - /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/webbpsf/opds.py:1746: UserWarning: For (V2,V3) = [-6.36389848 -7.26853851] arcmin, Field point -6.3638984816102235 arcmin, -0.5632056 arcmin not within valid region for field dependence model of OTE WFE for MIRI: -8.254199999999999 arcmin--6.21738 arcmin, -2.557224 arcmin--0.5632056 arcmin. Clipping to closest available valid location, 0.031744109903437345 arcmin away from the requested coordinates.
  warnings.warn(f&#39;For (V2,V3) = {v2v3}, Field point {x_field_pt}, {y_field_pt} not within valid region for field dependence model of OTE WFE for {instrument}: {min_x_field}-{max_x_field}, {min_y_field}-{max_y_field}. Clipping to closest available valid location, {clip_dist} away from the requested coordinates.&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/4 centroid: (201.4023624749013, 201.47046390597333)
    Position 2/4: (0, 1023) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:00:13,141 - stpipe - WARNING - /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/webbpsf/opds.py:1746: UserWarning: For (V2,V3) = [-6.21257653 -5.39972458] arcmin, Field point -6.21738 arcmin, -2.4002754231217454 arcmin not within valid region for field dependence model of OTE WFE for MIRI: -8.254199999999999 arcmin--6.21738 arcmin, -2.557224 arcmin--0.5632056 arcmin. Clipping to closest available valid location, 0.00480347054204433 arcmin away from the requested coordinates.
  warnings.warn(f&#39;For (V2,V3) = {v2v3}, Field point {x_field_pt}, {y_field_pt} not within valid region for field dependence model of OTE WFE for {instrument}: {min_x_field}-{max_x_field}, {min_y_field}-{max_y_field}. Clipping to closest available valid location, {clip_dist} away from the requested coordinates.&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 2/4 centroid: (201.30690755776234, 201.33283949933355)
    Position 3/4: (1023, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 3/4 centroid: (201.46001999611343, 201.57406698621335)
    Position 4/4: (1023, 1023) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:00:24,926 - stpipe - WARNING - /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/astropy/io/fits/card.py:1036: VerifyWarning: Card is too long, comment will be truncated.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 4/4 centroid: (201.71435554877664, 201.48197003471253)
  Saving file: miri_mirim_f770w_fovp101_samp4_npsf4.fits
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;GriddedPSFModel(flux=1., x_0=0., y_0=0.)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># display the PSF grid</span>
<span class="n">psf_model</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/9163d588a7b30218b0dafe06426cf3e67fab5a405ff3a3d7a3a3bd91869beb7c.png" src="../../../_images/9163d588a7b30218b0dafe06426cf3e67fab5a405ff3a3d7a3a3bd91869beb7c.png" />
<img alt="../../../_images/9163d588a7b30218b0dafe06426cf3e67fab5a405ff3a3d7a3a3bd91869beb7c.png" src="../../../_images/9163d588a7b30218b0dafe06426cf3e67fab5a405ff3a3d7a3a3bd91869beb7c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># display the PSF grid deltas from the mean ePSF</span>
<span class="n">psf_model</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">deltas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/2a3bf433fc9d56bc761ca0cde071762fbb34efedb82e98b7f0a5413759ca6411.png" src="../../../_images/2a3bf433fc9d56bc761ca0cde071762fbb34efedb82e98b7f0a5413759ca6411.png" />
<img alt="../../../_images/2a3bf433fc9d56bc761ca0cde071762fbb34efedb82e98b7f0a5413759ca6411.png" src="../../../_images/2a3bf433fc9d56bc761ca0cde071762fbb34efedb82e98b7f0a5413759ca6411.png" />
</div>
</div>
</section>
<section id="psf-photometry-a-class-anchor-id-bso4-a">
<h2>3.3 PSF Photometry <a class="anchor" id="bso4"></a><a class="headerlink" href="#psf-photometry-a-class-anchor-id-bso4-a" title="Permalink to this heading">#</a></h2>
<p>Now let’s use our gridded PSF model to perform PSF photometry.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data and convert units from MJy/sr to uJy</span>
<span class="k">with</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">bunit_data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;&lt;</span> <span class="n">unit</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">err</span> <span class="o">&lt;&lt;</span> <span class="n">unit</span>

    <span class="c1"># use pixel area map because of geometric distortion in level-2 data </span>
    <span class="n">pixel_area</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">area</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">photometry</span><span class="o">.</span><span class="n">pixelarea_steradians</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">sr</span>
    <span class="n">data</span> <span class="o">*=</span> <span class="n">pixel_area</span>
    <span class="n">error</span> <span class="o">*=</span> <span class="n">pixel_area</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">uJy</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">uJy</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">error</span><span class="o">.</span><span class="n">unit</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Unit(&quot;uJy&quot;), Unit(&quot;uJy&quot;))
</pre></div>
</div>
</div>
</div>
<p>To perform photometry on a single source we can input a Table containing its (x, y) position.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_params</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span>
<span class="n">init_params</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="n">init_params</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>
<span class="n">init_params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=1</i>
<table id="table140065445659536" class="table-striped table-bordered table-condensed">
<thead><tr><th>x</th><th>y</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th></tr></thead>
<tr><td>691.0126389412841</td><td>512.5838903335235</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we turn off the finder because we input the source position</span>
<span class="n">fit_shape</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">localbkg_estimator</span> <span class="o">=</span> <span class="n">LocalBackground</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">MMMBackground</span><span class="p">())</span>
<span class="n">psfphot</span> <span class="o">=</span> <span class="n">PSFPhotometry</span><span class="p">(</span><span class="n">psf_model</span><span class="p">,</span> <span class="n">fit_shape</span><span class="p">,</span> <span class="n">finder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aperture_radius</span><span class="o">=</span><span class="n">fit_shape</span><span class="p">,</span> 
                        <span class="n">localbkg_estimator</span><span class="o">=</span><span class="n">localbkg_estimator</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">phot</span> <span class="o">=</span> <span class="n">psfphot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="n">init_params</span><span class="p">)</span>
<span class="n">phot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:00:26,053 - stpipe - WARNING - /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/photutils/psf/photometry.py:346: AstropyUserWarning: Input data contains unmasked non-finite values (NaN or inf), which were automatically ignored.
  warnings.warn(&#39;Input data contains unmasked non-finite values &#39;
</pre></div>
</div>
<div class="output text_html"><div><i>QTable length=1</i>
<table id="table140065450297232" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>group_id</th><th>local_bkg</th><th>x_init</th><th>y_init</th><th>flux_init</th><th>x_fit</th><th>y_fit</th><th>flux_fit</th><th>x_err</th><th>y_err</th><th>flux_err</th><th>npixfit</th><th>group_size</th><th>qfit</th><th>cfit</th><th>flags</th></tr></thead>
<thead><tr><th></th><th></th><th>uJy</th><th></th><th></th><th>uJy</th><th></th><th></th><th>uJy</th><th></th><th></th><th>uJy</th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th></tr></thead>
<tr><td>1</td><td>1</td><td>1.4397037772319776</td><td>691.0126389412841</td><td>512.5838903335235</td><td>475.7886379871932</td><td>691.179636780988</td><td>512.9113038644382</td><td>452.42267160624607</td><td>0.0010104372890293119</td><td>0.001023353454768958</td><td>0.4998242671517661</td><td>25</td><td>1</td><td>0.7077179013668499</td><td>-0.01809988847562523</td><td>0</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert fit flux from uJy to ABmag</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">phot</span><span class="p">[</span><span class="s1">&#39;flux_fit&#39;</span><span class="p">]</span>
<span class="n">flux_err</span> <span class="o">=</span> <span class="n">phot</span><span class="p">[</span><span class="s1">&#39;flux_err&#39;</span><span class="p">]</span>
<span class="n">mag</span> <span class="o">=</span> <span class="n">phot</span><span class="p">[</span><span class="s1">&#39;flux_fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">)</span>
<span class="n">magerr</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">flux_err</span> <span class="o">/</span> <span class="n">flux</span><span class="p">))</span>
<span class="n">magerr</span> <span class="o">=</span> <span class="n">magerr</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>
<span class="n">mag</span><span class="p">,</span> <span class="n">magerr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Magnitude [17.2611391] mag(AB)&gt;, &lt;Magnitude [0.00119883] mag(AB)&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">cutout1</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">cutout1</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">98</span><span class="p">)</span>
<span class="n">im1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cutout1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Data ($\mu$Jy)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">psfphot</span><span class="o">.</span><span class="n">make_model_image</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
<span class="n">cutout2</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cutout2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Fit PSF Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">resid</span> <span class="o">=</span> <span class="n">psfphot</span><span class="o">.</span><span class="n">make_residual_image</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
<span class="n">cutout3</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">resid</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="n">norm3</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">cutout3</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="n">im3</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cutout3</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Residual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im3</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7f634453f910&gt;
</pre></div>
</div>
<img alt="../../../_images/f170136b342876f6e23f8478abd4f20ddc666ecea6cdbb7a6951f6385c2e76f9.png" src="../../../_images/f170136b342876f6e23f8478abd4f20ddc666ecea6cdbb7a6951f6385c2e76f9.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="faint-upper-limit-single-object-a-class-anchor-id-fso-a">
<h1>4. Faint/Upper Limit, Single Object <a class="anchor" id="fso"></a><a class="headerlink" href="#faint-upper-limit-single-object-a-class-anchor-id-fso-a" title="Permalink to this heading">#</a></h1>
<p>The purpose of this section is to illustrate how to calculate an upper limit at a fixed (x, y) position using forced PSF photometry a blank part of the sky.</p>
<p>We’ll use the same data as Section 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data and convert units from MJy/sr to uJy</span>
<span class="k">with</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">bunit_data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;&lt;</span> <span class="n">unit</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">err</span> <span class="o">&lt;&lt;</span> <span class="n">unit</span>
    
    <span class="n">pixel_area</span> <span class="o">=</span> <span class="n">pixel_area</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">photometry</span><span class="o">.</span><span class="n">pixelarea_steradians</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">sr</span>
    <span class="n">data</span> <span class="o">*=</span> <span class="n">pixel_area</span>
    <span class="n">error</span> <span class="o">*=</span> <span class="n">pixel_area</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">uJy</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">uJy</span><span class="p">)</span>

<span class="n">source_location</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;17:43:00.0332&#39;</span><span class="p">,</span> <span class="s1">&#39;+66:54:42.677&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="k">with</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">source_location</span><span class="p">)</span>

<span class="n">cutout</span> <span class="o">=</span> <span class="n">extract_array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">cutout</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cutout</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">clb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu$Jy&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PID1028, Obs006&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pixels&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Pixels&#39;)
</pre></div>
</div>
<img alt="../../../_images/485594a550a8addd7cf95f0f58b507f79c8233e5b98a494270e374b3526bf646.png" src="../../../_images/485594a550a8addd7cf95f0f58b507f79c8233e5b98a494270e374b3526bf646.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to perform forced photometry, we set the (x, y) source position</span>
<span class="c1"># AND we fix the PSF model position so that it does not vary in the fit</span>
<span class="c1"># (only flux will be fit)</span>
<span class="n">init_params</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span>
<span class="n">init_params</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="n">init_params</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>

<span class="c1"># This requires photutils 1.11.0</span>
<span class="n">psf_model_forced</span> <span class="o">=</span> <span class="n">psf_model</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">psf_model_forced</span><span class="o">.</span><span class="n">x_0</span><span class="o">.</span><span class="n">fixed</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">psf_model_forced</span><span class="o">.</span><span class="n">y_0</span><span class="o">.</span><span class="n">fixed</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">psf_model_forced</span><span class="o">.</span><span class="n">fixed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;flux&#39;: False, &#39;x_0&#39;: True, &#39;y_0&#39;: True}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_shape</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">localbkg_estimator</span> <span class="o">=</span> <span class="n">LocalBackground</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">MMMBackground</span><span class="p">())</span>
<span class="n">psfphot</span> <span class="o">=</span> <span class="n">PSFPhotometry</span><span class="p">(</span><span class="n">psf_model_forced</span><span class="p">,</span> <span class="n">fit_shape</span><span class="p">,</span> <span class="n">finder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aperture_radius</span><span class="o">=</span><span class="n">fit_shape</span><span class="p">,</span> 
                        <span class="n">localbkg_estimator</span><span class="o">=</span><span class="n">localbkg_estimator</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">phot</span> <span class="o">=</span> <span class="n">psfphot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="n">init_params</span><span class="p">)</span>
<span class="n">phot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:00:27,423 - stpipe - WARNING - /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/photutils/psf/photometry.py:346: AstropyUserWarning: Input data contains unmasked non-finite values (NaN or inf), which were automatically ignored.
  warnings.warn(&#39;Input data contains unmasked non-finite values &#39;
</pre></div>
</div>
<div class="output text_html"><div><i>QTable length=1</i>
<table id="table140065448654416" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>group_id</th><th>local_bkg</th><th>x_init</th><th>y_init</th><th>flux_init</th><th>x_fit</th><th>y_fit</th><th>flux_fit</th><th>x_err</th><th>y_err</th><th>flux_err</th><th>npixfit</th><th>group_size</th><th>qfit</th><th>cfit</th><th>flags</th></tr></thead>
<thead><tr><th></th><th></th><th>uJy</th><th></th><th></th><th>uJy</th><th></th><th></th><th>uJy</th><th></th><th></th><th>uJy</th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th></tr></thead>
<tr><td>1</td><td>1</td><td>1.2926637902219071</td><td>559.0832487866571</td><td>772.8615809732944</td><td>99.6914129363197</td><td>559.0832487866571</td><td>772.8615809732944</td><td>-0.3700018357369572</td><td>nan</td><td>nan</td><td>0.061692716759513114</td><td>25</td><td>1</td><td>-96.08235647948484</td><td>0.4232093213516833</td><td>4</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To calculate upper limit, multiply the flux_err by your desired sigma</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">limit</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">phot</span><span class="p">[</span><span class="s1">&#39;flux_err&#39;</span><span class="p">]</span>
<span class="n">limit</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[[25.731612] \; \mathrm{mag}$$\mathrm{\left( \mathrm{AB} \right)}\]</div>
</div>
</div>
<section id="note-you-can-go-significantly-deeper-with-the-level-3-combined-data-product">
<h2>Note: you can go significantly deeper with the Level 3 combined data product<a class="headerlink" href="#note-you-can-go-significantly-deeper-with-the-level-3-combined-data-product" title="Permalink to this heading">#</a></h2>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="stellar-field-lmc-a-class-anchor-id-lmc-a">
<h1>5. Stellar Field (LMC) <a class="anchor" id="lmc"></a><a class="headerlink" href="#stellar-field-lmc-a-class-anchor-id-lmc-a" title="Permalink to this heading">#</a></h1>
<p>In this case, we are going to do the same steps as in Section 3, but for multiple stars. The purpose is to illustrate the workflow and runtime for using Photutils on a large number of stars.</p>
<section id="multiple-stars-single-level-2-file-a-class-anchor-id-lmc2-a">
<h2>5.1 Multiple Stars, Single Level 2 File <a class="anchor" id="lmc2"></a><a class="headerlink" href="#multiple-stars-single-level-2-file-a-class-anchor-id-lmc2-a" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find stars in Level 3 File</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;./mast/01171/&#39;</span>
<span class="n">level3</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;jw01171-o004_t001_miri_f560w_i2d.fits&#39;</span><span class="p">)</span>
<span class="n">level3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./mast/01171/jw01171-o004_t001_miri_f560w_i2d.fits&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get rough estimate of background (there are better ways to do background subtraction)</span>
<span class="n">bkgrms</span> <span class="o">=</span> <span class="n">MADStdBackgroundRMS</span><span class="p">()</span>
<span class="n">mmm_bkg</span> <span class="o">=</span> <span class="n">MMMBackground</span><span class="p">()</span>

<span class="k">with</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">level3</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">wcs_l3</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">bkgrms</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="n">mmm_bkg</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data_bkgsub</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data_bkgsub</span> <span class="o">-=</span> <span class="n">bkg</span> 

<span class="c1"># Find stars</span>
<span class="c1"># F560W FWHM = 1.882 pix</span>
<span class="n">fwhm_psf</span> <span class="o">=</span> <span class="mf">1.882</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="n">fwhm_psf</span><span class="p">,</span> <span class="n">exclude_border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_separation</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">found_stars</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">)</span>

<span class="c1"># print first 10 rows</span>
<span class="n">found_stars</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=10</i>
<table id="table140065357102160" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>xcentroid</th><th>ycentroid</th><th>sharpness</th><th>roundness1</th><th>roundness2</th><th>npix</th><th>sky</th><th>peak</th><th>flux</th><th>mag</th></tr></thead>
<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float32</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1</td><td>546.2615248590856</td><td>5.40090706700177</td><td>0.7041937380599614</td><td>0.46773428</td><td>0.04273256330788055</td><td>25</td><td>0.0</td><td>-0.8653272390365601</td><td>1.6463868618011475</td><td>-0.5413297293846483</td></tr>
<tr><td>2</td><td>789.0983970730795</td><td>6.312157835017226</td><td>0.6691237944354219</td><td>-0.17942303</td><td>-0.8079555096758742</td><td>25</td><td>0.0</td><td>-0.5761210918426514</td><td>1.1000438928604126</td><td>-0.10352503572911273</td></tr>
<tr><td>3</td><td>845.9799634503643</td><td>3.6757970986043205</td><td>0.6829976607805458</td><td>0.043498766</td><td>-0.42254093349077776</td><td>25</td><td>0.0</td><td>-1.171976923942566</td><td>1.1794757843017578</td><td>-0.17922257214246215</td></tr>
<tr><td>4</td><td>899.9897053947699</td><td>6.39779821296389</td><td>0.5563295885896342</td><td>-0.13047144</td><td>0.2603567958961923</td><td>25</td><td>0.0</td><td>-0.9210708141326904</td><td>1.282814621925354</td><td>-0.2704097537749816</td></tr>
<tr><td>5</td><td>933.9483297710668</td><td>6.082630968636201</td><td>0.5395764543423918</td><td>-0.30286184</td><td>0.31405623969522456</td><td>25</td><td>0.0</td><td>-0.8810544013977051</td><td>1.310049295425415</td><td>-0.2932190947280454</td></tr>
<tr><td>6</td><td>385.6695305861909</td><td>5.6695305861908665</td><td>0.7041937004909312</td><td>0.32498807</td><td>0.0</td><td>25</td><td>0.0</td><td>-0.24849343299865723</td><td>2.248995780944824</td><td>-0.8799716017792757</td></tr>
<tr><td>7</td><td>385.3304694138091</td><td>5.6695305861908665</td><td>0.7041937004909312</td><td>-0.75487006</td><td>-7.402970179157126e-16</td><td>25</td><td>0.0</td><td>-0.24849343299865723</td><td>2.248995780944824</td><td>-0.8799716017792757</td></tr>
<tr><td>8</td><td>444.15413979694966</td><td>6.5255939563821155</td><td>0.5542676488294513</td><td>0.54399556</td><td>-0.0043752550961698635</td><td>25</td><td>0.0</td><td>-0.6147366762161255</td><td>1.59718656539917</td><td>-0.508389121265139</td></tr>
<tr><td>9</td><td>457.96743096331807</td><td>6.572213266744114</td><td>0.5819540250110783</td><td>-0.37343192</td><td>0.32949080159621963</td><td>25</td><td>0.0</td><td>-0.6794391870498657</td><td>1.4479076862335205</td><td>-0.40185218393906974</td></tr>
<tr><td>10</td><td>504.80151790231764</td><td>6.318931006256025</td><td>0.7041936997157474</td><td>-0.40236253</td><td>0.013733775120274237</td><td>25</td><td>0.0</td><td>-0.3774709701538086</td><td>2.122992515563965</td><td>-0.817371157747781</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the found stars</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

<span class="n">xypos</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>
<span class="n">aper</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">xypos</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">aper</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.patches.Circle at 0x7f6344552950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f63820ccdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6344553650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff946d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff97b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff97690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff97610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff97390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff97110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff978d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff96c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff969d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff96750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff964d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff96250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff95f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff6b7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff6a2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff6a310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff6aa50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff68490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f634404b150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ffbb750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ffbbe90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6387527b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff98790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff98510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff98290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff98950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff98e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff67110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff66410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff65b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff679d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff67bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff66ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff678d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff66010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff49810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff48910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f638714b550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381e2d250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381e2da50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381e2ce50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381e39050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381e389d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381e38910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381e39850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff58b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff58ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ce03d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ce2d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381d0f990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cda690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cd8a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cd8f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ca86d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ca8450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cab890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ca8490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381caaf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ca9650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cabdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381caab50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ca8f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381caa510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cab150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ca9ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f63445f29d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f63445f2cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381d52b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381d50e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381d53910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381d50610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381d50710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381d50290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf9290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf8d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cfaf90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf9850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf9210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cfa150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf81d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf9090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf8450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf9790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf87d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf9350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cfafd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b6a8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b6bc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b6ae10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b6b290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b68a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b6a090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b6bb50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b6b410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b69210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b6bed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b74250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b74dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b74910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b75350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b75650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b75950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b75510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b75ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b75d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b76210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b76850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b763d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b76e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b76f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b76e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b76fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b77450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b77990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b77ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381b77e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a882d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a885d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a888d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a88bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a88ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a891d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a894d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a897d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a89ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a89dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8a0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8a3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8a710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8a950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8ad10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8b010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8b310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8b790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8ba90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8bd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6bad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a682d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a685d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a688d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a68bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a68ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a691d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a694d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a697d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a69ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a69dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6a0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6a3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6a6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6a7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6ad90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6ae90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6b2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6b5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6b990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6be10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c20c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c21190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c21490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c21790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c21a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c21d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c22090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c22350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c22690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c22990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c22c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c22f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c23290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c23590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c23890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c23b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c23e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c20490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c20350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c20710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c20a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7add0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7b1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7b310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7b510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7ba90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7bd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a78310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a78690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a78b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a78f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a79410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a79890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a79d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7a190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7a610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7aa90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcc090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcc390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcc690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcc990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bccc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bccf90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcd290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcd590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcd890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcdb90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcde50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bce290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bce510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bce790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcea90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bced90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcf090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcf390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcf690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcf990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcfc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bcff90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c382d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c385d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c388d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c38bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c38ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c391d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c394d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c397d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c39ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c39dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3a0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3a3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3a6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3a9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3acd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3afd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3b2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3b5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3b8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3bbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3bed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3c210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3c510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3c810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3cb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3ce10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3d110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3d410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3d710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3da10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3dd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3e010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3e310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3e610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3e910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3ec10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3ef10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3f210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3f510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3f810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3fb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c3fe10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd8150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd8550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd87d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd8a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd8d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd9050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd9350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd9650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd9950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd9c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bd9f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bda250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bda550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bda850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdab50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdae50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdb150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdb450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdb750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdba50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdbd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdc090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdc390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdc690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdc990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdcc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdcf90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdd290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdd590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdd890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bddb90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdde90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bde190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bde490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bde790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdea90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bded90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdf090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdf390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdf690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdf990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdfc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bdff90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c442d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c445d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c448d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c44bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c44ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c451d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c454d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c457d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c45ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c45dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c460d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c463d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c46610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c46a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c46d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c46fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c472d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c475d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c478d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c47bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c47ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c48210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c48510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c48810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c48b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c48e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c49110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c49410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c49710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c49a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c49d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4a010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4a310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4a610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4a910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4ac10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4af10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4b210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4b510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4b810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4bb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c4be10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be4150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be4450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be4750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be4a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be4d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be5050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be5350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be5650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be5950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be5c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be5f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be6250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be6550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be6850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be6b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be6e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be7150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be7450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be7750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be7a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381be7d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c54090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c54410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c54710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c54a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c54e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c54f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c55310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c55610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c55910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c55c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c55f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c56210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c56510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c56810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c56b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c56e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c57110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c57690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c575d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c57a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c57d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c57f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bec2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bec5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bec8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381becbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381beced0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bed1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bed4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bed7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bedad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381beddd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bee0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bee3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bee6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bee9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381beecd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381beefd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bef2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bef5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bef8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381befbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381befed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf4210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf4510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf4810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf4b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf4e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf5110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf5410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf5710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf5a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf5d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf6010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf6310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf6610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf6910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf6c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf7050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf72d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf7550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf7810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf7b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf7e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c000d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c001d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c00b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c00bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c00cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c01410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c01710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c01a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c017d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c01ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c01cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c01fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c02810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c02c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c02f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c02ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c03510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c02d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c037d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c03e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c03d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c04090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c04390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c04690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c04990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c04c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c04f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c05290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c05590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c05890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c05b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c05e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c06190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c06490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c06790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c06a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c06d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c07090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c07390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c07690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c07990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c07c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c07f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c082d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c085d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c088d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c08bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c08ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c09190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c095d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c09850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c09ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c09dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0a0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0a3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0a6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0a9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0acd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0afd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0b2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0b5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0b8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0bbd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0bed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0c5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0c090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0c790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0c750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0cc90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0ced0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0d390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0dad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0d850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0da90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0dd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0e1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0e4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0e7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0efd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0eb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0f090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0f3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0f6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0f9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c0fe90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c24150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c24450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c24750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c24a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c24d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c25050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c25350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c25650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c25950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c25c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c25f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c26250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c26550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c26850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c26b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c26e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c27150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c27450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c27550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c279d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c27c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c27f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c58290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c58590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c58890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c58b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c58e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c59190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c59490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c59790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c59a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c59d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5a090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5a390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5a690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5a990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5ac90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5af90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5b290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5b590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5b890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5bb90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c5be90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf81d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf84d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf87d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf8ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf8dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf90d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf93d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf96d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf99d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf9cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bf9fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfa2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfa5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfa8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfabd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfaed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfb1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfb4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfb7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfbad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381bfbdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a60110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a60410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a60710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a60a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a60d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a61010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a61310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a61610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a61850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a61cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a61f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a62210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a62510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a62810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a62b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a62e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a63110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a63410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a63710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a63a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a63d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a64050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a64350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a64650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a64950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a64c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a64f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a65250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a65550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a65850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a65b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a65e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a66150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a66450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a66750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a66a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a66d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a67050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a67350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a67650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a67950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a67c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a67f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6c290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6c590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6c890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6cb90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6ce90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6d190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6d490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6d790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6da90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6dd90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6e090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6e390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6e690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6e990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6ec90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6ef90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6f290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6f590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6f890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6fb90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a6ff90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8c290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8c4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8c7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8cb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8cdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8d0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8d3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8d6d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8d9d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8dcd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8dfd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8e2d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8e5d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8e8d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8ebd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8eed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8f1d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8f4d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8f7d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8fad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a8fdd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a74110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a74410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a74710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a74a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a74d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a75010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a75310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a75610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a75910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a75c10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a75f10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a76210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a76510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a76810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a76b10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a76e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a77110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a77410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a77710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a77a10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a77d10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7c050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7c350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7c650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7c950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7cc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7cf50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7d250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7d550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7d850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7db50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7de50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7e0d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7e510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7e790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7ea50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7ed50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7f050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7f350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7f650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7f950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7fc50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a7ff50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a84290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a84590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a84890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a84b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a84e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a85190&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a85490&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a85790&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a85a90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a85d90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a86090&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a86390&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a86690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a86990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a86c90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a86f90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a87290&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a87590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a87890&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a87b90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a87e90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a901d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a904d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a907d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a90ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a90dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a910d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a913d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a916d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a919d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a91cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a91fd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a922d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a925d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a928d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a92bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a92ed0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a931d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a934d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a937d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a93ad0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a93dd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9c110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9c3d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9c810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9ca90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9cd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9d010&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9d310&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9d610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9d910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9dc10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9df10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9e210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9e510&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9e810&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9eb10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9ee10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9f110&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9f410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9f710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9fa10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381a9fd10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa0050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa0350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa0650&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa0950&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa0c50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa0f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa1250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa1550&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa1850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa1b50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa1e50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa2150&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa2450&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa2750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa2a50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa2d50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa3050&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa3350&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381aa3650&gt;]
</pre></div>
</div>
<img alt="../../../_images/6ce350cae3d154bb7f7d5e837ae0a6e1fe31638385b3e9f3d43ed17cd4617f6b.png" src="../../../_images/6ce350cae3d154bb7f7d5e837ae0a6e1fe31638385b3e9f3d43ed17cd4617f6b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;sharpness&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">],</span> <span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mag&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;roundness&#39;</span><span class="p">)</span>

<span class="n">mag0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span>
<span class="n">mag1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span>
<span class="k">for</span> <span class="n">ax_</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">ax_</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mag0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
    <span class="n">ax_</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mag1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>

<span class="n">sh0</span> <span class="o">=</span> <span class="mf">0.40</span>
<span class="n">sh1</span> <span class="o">=</span> <span class="mf">0.82</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">sh0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">sh1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>

<span class="n">rnd0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.40</span>
<span class="n">rnd1</span> <span class="o">=</span> <span class="mf">0.40</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">rnd0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">rnd1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7f6344039610&gt;
</pre></div>
</div>
<img alt="../../../_images/3e7384745c792d06176d8f99fd421f48c7d20089c65069b596a9fb0e35526750.png" src="../../../_images/3e7384745c792d06176d8f99fd421f48c7d20089c65069b596a9fb0e35526750.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mag0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">mag1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">rnd0</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;roundness2&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">rnd1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sh0</span><span class="p">)</span> 
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;sharpness&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">sh1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">found_stars</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">))</span>

<span class="n">found_stars_sel</span> <span class="o">=</span> <span class="n">found_stars</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stars found originally:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_stars</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stars in final selection:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">found_stars_sel</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of stars found originally: 790
Number of stars in final selection: 13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the selected stars</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data_bkgsub</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

<span class="n">xypos</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>
<span class="n">aper</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">xypos</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">aper</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.patches.Circle at 0x7f634416fd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff97e10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f638172b850&gt;,
 &lt;matplotlib.patches.Circle at 0x7f63817d6990&gt;,
 &lt;matplotlib.patches.Circle at 0x7f633ff52210&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381736910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f63817340d0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381736cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381736f50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f638170c250&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381737410&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381737690&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381737910&gt;]
</pre></div>
</div>
<img alt="../../../_images/471a4289d335abd75c5bc84d72acad422a7735ddd41132da2b031956272c2b54.png" src="../../../_images/471a4289d335abd75c5bc84d72acad422a7735ddd41132da2b031956272c2b54.png" />
</div>
</div>
</section>
<section id="generate-empirical-psf-grid-for-miri-f560w-using-webbpsf-a-class-anchor-id-grid2-a">
<h2>5.2 Generate empirical PSF grid for MIRI F560W using WebbPSF <a class="anchor" id="grid2"></a><a class="headerlink" href="#generate-empirical-psf-grid-for-miri-f560w-using-webbpsf-a-class-anchor-id-grid2-a" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psfgrid_filename</span> <span class="o">=</span> <span class="s1">&#39;miri_mirim_f560w_fovp101_samp4_npsf4.fits&#39;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">psfgrid_filename</span><span class="p">):</span>
    <span class="n">miri</span> <span class="o">=</span> <span class="n">webbpsf</span><span class="o">.</span><span class="n">MIRI</span><span class="p">()</span>
    <span class="n">miri</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="s1">&#39;F560W&#39;</span>
    <span class="n">psf_model</span> <span class="o">=</span> <span class="n">miri</span><span class="o">.</span><span class="n">psf_grid</span><span class="p">(</span><span class="n">num_psfs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">all_detectors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">psf_model</span> <span class="o">=</span> <span class="n">GriddedPSFModel</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">psfgrid_filename</span><span class="p">)</span>

<span class="n">psf_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running instrument: MIRI, filter: F560W
  Running detector: MIRIM
    Position 1/4: (0, 0) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:00:32,764 - stpipe - WARNING - /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/webbpsf/opds.py:1746: UserWarning: For (V2,V3) = [-6.36389848 -7.26853851] arcmin, Field point -6.3638984816102235 arcmin, -0.5632056 arcmin not within valid region for field dependence model of OTE WFE for MIRI: -8.254199999999999 arcmin--6.21738 arcmin, -2.557224 arcmin--0.5632056 arcmin. Clipping to closest available valid location, 0.031744109903437345 arcmin away from the requested coordinates.
  warnings.warn(f&#39;For (V2,V3) = {v2v3}, Field point {x_field_pt}, {y_field_pt} not within valid region for field dependence model of OTE WFE for {instrument}: {min_x_field}-{max_x_field}, {min_y_field}-{max_y_field}. Clipping to closest available valid location, {clip_dist} away from the requested coordinates.&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/4 centroid: (201.39504365744267, 201.46837962104274)
    Position 2/4: (0, 1023) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:00:36,779 - stpipe - WARNING - /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/webbpsf/opds.py:1746: UserWarning: For (V2,V3) = [-6.21257653 -5.39972458] arcmin, Field point -6.21738 arcmin, -2.4002754231217454 arcmin not within valid region for field dependence model of OTE WFE for MIRI: -8.254199999999999 arcmin--6.21738 arcmin, -2.557224 arcmin--0.5632056 arcmin. Clipping to closest available valid location, 0.00480347054204433 arcmin away from the requested coordinates.
  warnings.warn(f&#39;For (V2,V3) = {v2v3}, Field point {x_field_pt}, {y_field_pt} not within valid region for field dependence model of OTE WFE for {instrument}: {min_x_field}-{max_x_field}, {min_y_field}-{max_y_field}. Clipping to closest available valid location, {clip_dist} away from the requested coordinates.&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 2/4 centroid: (201.3020934606855, 201.31984343070152)
    Position 3/4: (1023, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 3/4 centroid: (201.42830769164877, 201.59926840411686)
    Position 4/4: (1023, 1023) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:00:48,456 - stpipe - WARNING - /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/astropy/io/fits/card.py:1036: VerifyWarning: Card is too long, comment will be truncated.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 4/4 centroid: (201.75498594600958, 201.4970454286807)
  Saving file: miri_mirim_f560w_fovp101_samp4_npsf4.fits
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;GriddedPSFModel(flux=1., x_0=0., y_0=0.)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psf_model</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/b6ffac80c5fd4e5a2a780d377245d511f1b337428dfd30012b2cc6afac598eb4.png" src="../../../_images/b6ffac80c5fd4e5a2a780d377245d511f1b337428dfd30012b2cc6afac598eb4.png" />
<img alt="../../../_images/b6ffac80c5fd4e5a2a780d377245d511f1b337428dfd30012b2cc6afac598eb4.png" src="../../../_images/b6ffac80c5fd4e5a2a780d377245d511f1b337428dfd30012b2cc6afac598eb4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the level 2 image</span>
<span class="c1"># here, we&#39;ll use the PID 1171 files</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;./mast/01171/&quot;</span>
<span class="n">level2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;jw01171004*cal.fits&#39;</span><span class="p">)))</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">level2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<span class="c1"># load data and convert units from MJy/sr to uJy</span>
<span class="k">with</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">bunit_data</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">dq</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;&lt;</span> <span class="n">unit</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">err</span> <span class="o">&lt;&lt;</span> <span class="n">unit</span>
    
    <span class="n">pixel_area</span> <span class="o">=</span> <span class="n">pixel_area</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">photometry</span><span class="o">.</span><span class="n">pixelarea_steradians</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">sr</span>
    <span class="n">data</span> <span class="o">*=</span> <span class="n">pixel_area</span>
    <span class="n">error</span> <span class="o">*=</span> <span class="n">pixel_area</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">uJy</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">uJy</span><span class="p">)</span>

    <span class="n">wcs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span>

<span class="n">data</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">error</span><span class="o">.</span><span class="n">unit</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./mast/01171/jw01171004001_02101_00001_mirimage_cal.fits
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Unit(&quot;uJy&quot;), Unit(&quot;uJy&quot;))
</pre></div>
</div>
</div>
</div>
</section>
<section id="psf-photometry-a-class-anchor-id-lmc3-a">
<h2>5.3 PSF Photometry <a class="anchor" id="lmc3"></a><a class="headerlink" href="#psf-photometry-a-class-anchor-id-lmc3-a" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># translate (x, y) positions from the level 3 image to the level 2 image</span>
<span class="n">xc</span> <span class="o">=</span> <span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]</span>
<span class="n">yc</span> <span class="o">=</span> <span class="n">found_stars_sel</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">wcs_l3</span><span class="o">.</span><span class="n">pixel_to_world</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
<span class="n">init_params</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span>
<span class="n">init_params</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">init_params</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>

<span class="c1"># we need to remove stars in the masked region of</span>
<span class="c1"># the level-2 data</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">400</span>
<span class="n">init_params</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([False,  True,  True,  True,  True, False,  True,  True,  True,
        True,  True,  True,  True])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the selected stars</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">simple_norm</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

<span class="n">xypos</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">init_params</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">init_params</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">aper</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">xypos</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">aper</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.patches.Circle at 0x7f638131fd50&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381c70bd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cf8cd0&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ceab10&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ce9710&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381cebe90&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ceb610&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ce8910&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ceb750&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ce8590&gt;,
 &lt;matplotlib.patches.Circle at 0x7f6381ce8f10&gt;]
</pre></div>
</div>
<img alt="../../../_images/21c4dd9cec5dbc9d3305ec7e6b524c86e9937f9de3d5c84a7e1e4a354a16c9a4.png" src="../../../_images/21c4dd9cec5dbc9d3305ec7e6b524c86e9937f9de3d5c84a7e1e4a354a16c9a4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_shape</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">localbkg_estimator</span> <span class="o">=</span> <span class="n">LocalBackground</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bkg_estimator</span><span class="o">=</span><span class="n">MMMBackground</span><span class="p">())</span>
<span class="n">psfphot</span> <span class="o">=</span> <span class="n">PSFPhotometry</span><span class="p">(</span><span class="n">psf_model</span><span class="p">,</span> <span class="n">fit_shape</span><span class="p">,</span> <span class="n">finder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aperture_radius</span><span class="o">=</span><span class="n">fit_shape</span><span class="p">,</span> 
                        <span class="n">localbkg_estimator</span><span class="o">=</span><span class="n">localbkg_estimator</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">phot</span> <span class="o">=</span> <span class="n">psfphot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="n">init_params</span><span class="p">)</span>
<span class="n">phot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-11-21 05:00:49,555 - stpipe - WARNING - /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages/photutils/psf/photometry.py:346: AstropyUserWarning: Input data contains unmasked non-finite values (NaN or inf), which were automatically ignored.
  warnings.warn(&#39;Input data contains unmasked non-finite values &#39;
</pre></div>
</div>
<div class="output text_html"><div><i>QTable length=11</i>
<table id="table140065345418384" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>group_id</th><th>local_bkg</th><th>x_init</th><th>y_init</th><th>flux_init</th><th>x_fit</th><th>y_fit</th><th>flux_fit</th><th>x_err</th><th>y_err</th><th>flux_err</th><th>npixfit</th><th>group_size</th><th>qfit</th><th>cfit</th><th>flags</th></tr></thead>
<thead><tr><th></th><th></th><th>uJy</th><th></th><th></th><th>uJy</th><th></th><th></th><th>uJy</th><th></th><th></th><th>uJy</th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th></tr></thead>
<tr><td>1</td><td>1</td><td>0.6448802831437852</td><td>660.8682340958862</td><td>73.30952825775023</td><td>99.22615357989018</td><td>660.9286846394467</td><td>73.20923844919115</td><td>60.8681980600657</td><td>0.0050856075958349055</td><td>0.005213347960631036</td><td>0.3507044813568311</td><td>25</td><td>1</td><td>0.6875349675263699</td><td>0.05071909144328579</td><td>0</td></tr>
<tr><td>2</td><td>2</td><td>0.5874391903047975</td><td>464.1246542280646</td><td>137.46955055574392</td><td>146.60569021592204</td><td>464.1612736578599</td><td>137.47656054126384</td><td>118.86790586339913</td><td>0.003612747996955323</td><td>0.0033265403113227777</td><td>0.493473142516204</td><td>25</td><td>1</td><td>0.7937337032069647</td><td>0.04584288712007397</td><td>0</td></tr>
<tr><td>3</td><td>3</td><td>0.6104557472178589</td><td>481.9300536591688</td><td>142.74569905705442</td><td>122.16382552364978</td><td>481.7942336547994</td><td>142.85534595605364</td><td>93.13605371445458</td><td>0.004066468627209195</td><td>0.0037182540675848004</td><td>0.4370216793482647</td><td>25</td><td>1</td><td>0.6532491049959812</td><td>0.05590328925087897</td><td>0</td></tr>
<tr><td>4</td><td>4</td><td>0.5496421364243962</td><td>553.43672949644</td><td>147.6140915866477</td><td>110.58509932779731</td><td>553.3332687437463</td><td>147.6279956521992</td><td>81.38350059142506</td><td>0.004045129874926056</td><td>0.004004966895486384</td><td>0.3840827233584172</td><td>25</td><td>1</td><td>0.7618745097066767</td><td>0.06556201317923223</td><td>0</td></tr>
<tr><td>5</td><td>5</td><td>0.5802685211656431</td><td>493.8538169846163</td><td>220.82325504415456</td><td>170.9292596067879</td><td>493.8793157655576</td><td>220.62652265893462</td><td>150.22386179966216</td><td>0.003358635097457586</td><td>0.0031756031119978185</td><td>0.604400981865906</td><td>25</td><td>1</td><td>0.5327777896677033</td><td>0.05003401088019915</td><td>0</td></tr>
<tr><td>6</td><td>6</td><td>0.5552616705110063</td><td>633.1485658474755</td><td>324.17790497032087</td><td>116.40546174421459</td><td>633.1391855542114</td><td>324.1804492328962</td><td>88.43072429485113</td><td>0.004024860983398037</td><td>0.004004495142547085</td><td>0.41252892491595267</td><td>25</td><td>1</td><td>0.9902255297083485</td><td>0.12838325600826472</td><td>0</td></tr>
<tr><td>7</td><td>7</td><td>0.5410288111266928</td><td>597.6581645996761</td><td>447.6985048034759</td><td>121.35040364262599</td><td>597.3590198542189</td><td>447.56140193618455</td><td>98.56227008651652</td><td>0.004116539536306176</td><td>0.0036472160284704304</td><td>0.4631820087266111</td><td>24</td><td>1</td><td>1.0760066465813045</td><td>0.04598820219382538</td><td>1</td></tr>
<tr><td>8</td><td>8</td><td>0.5712058916028622</td><td>546.6143269821247</td><td>529.1914918633589</td><td>259.8907892997661</td><td>546.8404355606814</td><td>529.2634236784783</td><td>251.86227681431046</td><td>0.0024193218378376147</td><td>0.0023130923903441785</td><td>0.7294551139699648</td><td>25</td><td>1</td><td>0.6666010174304932</td><td>0.02801968559292353</td><td>0</td></tr>
<tr><td>9</td><td>9</td><td>0.5766501870561154</td><td>453.82949747513493</td><td>549.258081072752</td><td>238.8740045482744</td><td>453.64985222857916</td><td>549.1688932057833</td><td>230.6362230696203</td><td>0.0025260579257618395</td><td>0.0027603261287867066</td><td>0.7252348583173828</td><td>25</td><td>1</td><td>0.7916554339315172</td><td>0.05213277450198142</td><td>0</td></tr>
<tr><td>10</td><td>10</td><td>0.543873813275104</td><td>581.7237520077483</td><td>589.2362246196259</td><td>150.4488293995264</td><td>581.8579817852578</td><td>589.3358089492639</td><td>129.7767129600465</td><td>0.0034935348032658557</td><td>0.0032757524442253664</td><td>0.5187529531837481</td><td>25</td><td>1</td><td>0.9165073112371286</td><td>0.040711935582376686</td><td>0</td></tr>
<tr><td>11</td><td>11</td><td>0.5791730733885281</td><td>626.719046718948</td><td>619.1527113454919</td><td>252.41894351622514</td><td>626.6242165721334</td><td>619.0989132934759</td><td>231.22037687602403</td><td>0.002474782019955752</td><td>0.0028746739738683305</td><td>0.7257771750534989</td><td>25</td><td>1</td><td>0.7784710557914897</td><td>0.03879531357454977</td><td>0</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert fit flux from uJy to ABmag</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">phot</span><span class="p">[</span><span class="s1">&#39;flux_fit&#39;</span><span class="p">]</span>
<span class="n">flux_err</span> <span class="o">=</span> <span class="n">phot</span><span class="p">[</span><span class="s1">&#39;flux_err&#39;</span><span class="p">]</span>
<span class="n">mag</span> <span class="o">=</span> <span class="n">phot</span><span class="p">[</span><span class="s1">&#39;flux_fit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">ABmag</span><span class="p">)</span>
<span class="n">magerr</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">flux_err</span> <span class="o">/</span> <span class="n">flux</span><span class="p">))</span>
<span class="n">magerr</span> <span class="o">=</span> <span class="n">magerr</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">ABmag</span>
<span class="n">mag</span><span class="p">,</span> <span class="n">magerr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Magnitude [19.43902389, 18.71233847, 18.97720542, 19.12365908,
             18.45815269, 19.03349204, 18.91572326, 17.89709219,
             17.99268121, 18.61700808, 17.98993474] mag(AB)&gt;,
 &lt;Magnitude [0.00623774, 0.00449804, 0.00508268, 0.00511199, 0.00435952,
             0.00505318, 0.00509034, 0.00314001, 0.00340874, 0.00433133,
             0.00340268] mag(AB)&gt;)
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr><a class="reference internal image-reference" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/MIRI/psf_photometry"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">MIRI PSF Photometry with Photutils</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of contents</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-a-class-anchor-id-intro-a">1. Introduction <a class="anchor" id="intro"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-imports-a-class-anchor-id-imports-a">1.1 Python Imports <a class="anchor" id="imports"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-set-up-required-data-for-webbpsf-and-synphot-a-class-anchor-id-setup-a">1.2 Download and Set up Required Data for WebbPSF and Synphot <a class="anchor" id="setup"></a></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#download-jwst-miri-data-a-class-anchor-id-data-a">2. Download JWST MIRI Data <a class="anchor" id="data"></a></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#single-bright-star-a-class-anchor-id-bso-a">3. Single Bright Star <a class="anchor" id="bso"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#single-level-2-file-a-class-anchor-id-bso2-a">3.1 Single Level 2 File <a class="anchor" id="bso2"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-empirical-psf-grid-for-miri-f770w-using-webbpsf-a-class-anchor-id-bso3-a">3.2 Generate empirical PSF grid for MIRI F770W using WebbPSF <a class="anchor" id="bso3"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#psf-photometry-a-class-anchor-id-bso4-a">3.3 PSF Photometry <a class="anchor" id="bso4"></a></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#faint-upper-limit-single-object-a-class-anchor-id-fso-a">4. Faint/Upper Limit, Single Object <a class="anchor" id="fso"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#note-you-can-go-significantly-deeper-with-the-level-3-combined-data-product">Note: you can go significantly deeper with the Level 3 combined data product</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stellar-field-lmc-a-class-anchor-id-lmc-a">5. Stellar Field (LMC) <a class="anchor" id="lmc"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-stars-single-level-2-file-a-class-anchor-id-lmc2-a">5.1 Multiple Stars, Single Level 2 File <a class="anchor" id="lmc2"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-empirical-psf-grid-for-miri-f560w-using-webbpsf-a-class-anchor-id-grid2-a">5.2 Generate empirical PSF grid for MIRI F560W using WebbPSF <a class="anchor" id="grid2"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#psf-photometry-a-class-anchor-id-lmc3-a">5.3 PSF Photometry <a class="anchor" id="lmc3"></a></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>